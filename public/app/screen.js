/*! For license information please see screen.js.LICENSE.txt */
!function(t){var n={};function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=n,i.d=function(t,n,e){i.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,n){if(1&n&&(t=i(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)i.d(e,r,function(n){return t[n]}.bind(null,r));return e},i.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(n,"a",n),n},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="",i(i.s=74)}([function(t,n){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,n,i){(function(t){function i(t){for(var n=t.toString(16);n.length<4;)n="0"+n;return n}function e(t){return"ArrayBuffer"==t.constructor.name&&(t=new Uint8Array(t)),n=String.fromCharCode.apply(null,t),decodeURIComponent(escape(n));var n}function r(t,n,i){var e=(t=unescape(encodeURIComponent(t))).length;i&&e++,n||(n=new ArrayBuffer(e));var r=new Uint8Array(n);i&&(r[t.length]=0);for(var o=0,s=t.length;o<s;o++)r[o]=t.charCodeAt(o);return n}var o="\n".charCodeAt(0);function s(t,n,i){"Object"==n.constructor.name&&(n=JSON.stringify(n)),t.write(r(n),i)}function c(t,n){var i=new Uint8Array(t.byteLength+n.byteLength);return i.set(t,0),i.set(n,t.byteLength),i}Uint8Array.prototype.sliceArrayBuffer=function(){return this.buffer.slice(this.byteOffset,this.byteOffset+this.byteLength)},Number.prototype.pad=function(t){for(var n=String(this);n.length<(t||2);)n="0"+n;return n};(new Date).getTime();var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(t,n){return n=n||0,this.lastIndexOf(t,n)===n}}),Object.fromArray=function(t){var n={};for(var i in t){var e=t[i];n[e]=e}return n};try{$.ajaxTransport("+binary",(function(t,n,i){if(window.FormData&&(t.dataType&&"binary"==t.dataType||t.data&&(window.ArrayBuffer&&t.data instanceof ArrayBuffer||window.Blob&&t.data instanceof Blob)))return{send:function(n,i){var e=new XMLHttpRequest,r=t.url,o=t.type,s=t.async||!0,c=t.responseType||"blob",a=t.data||null,u=t.username||null,h=t.password||null;for(var f in e.addEventListener("load",(function(){var n={};n[t.dataType]=e.response,i(e.status,e.statusText,n,e.getAllResponseHeaders())})),e.addEventListener("error",(function(){i(e.status,e.statusText,null,e.getAllResponseHeaders())})),e.open(o,r,s,u,h),n)e.setRequestHeader(f,n[f]);e.responseType=c,e.send(a)},abort:function(){i.abort()}}}))}catch(t){}var u,h,f;u={};function l(){}(h=function*(){}()).constructor.prototype.async=function(){var t=this,n=t.next();if(!n.done){var i,e,r=new Promise((function(t,n){i=t,e=n}));return c(),r}function o(){n=t.throw(new Error(arguments)),c()}function s(){var i=arguments[0];n=t.next(i),c()}function c(r){var c,a;if(n.done)i(n.value);else if(n.value)if(n.value.constructor!=Promise)if(n.value.constructor!=h.constructor){if(n.value==Error)c=!0,n=t.next(o);else{if(n.value!=l)throw new Error("Unexpected yield value for callback. Only Error and Success allowed.");a=!0,n=t.next(s)}if(!n.value)throw new Error("Double yield callbacks must explicitly define both Error and Success");if(n.value==Error&&c)throw new Error("Error callback already defined");if(n.value==l&&a)throw new Error("Success callback already defined");if(n.value!=Error&&n.value!=l)throw new Error("Unexpected yield value for callback. Only Error and Success allowed.");try{n=c?t.next(s):t.next(o)}catch(t){e(t)}}else n.value.async().then(s).catch(o);else n.value.then(s).catch(o);else n=t.next(s)}};try{f=!navigator}catch(t){f=!0}function d(){return f}function v(){return-1!=navigator.userAgent.indexOf("Electron")}d()||v()||(window.sharedGlobals=window),function(){if(!d()){var t="";if(window.IS_RELEASE){console.log,console.error,console.warn,console.info;function n(t){return function(){t.apply(console,arguments),i(Array.prototype.slice.call(arguments))}}console.error=n(console.error),console.log=n(console.log),console.warn=n(console.warn),console.info=n(console.info)}sharedGlobals.getConsoleLog=function(n){n(t)},window.gistConsoleLog=function(t,n){chrome.runtime.getBackgroundPage((function(i){e(i).then((function(n){t["background.txt"]=n;var i=chrome.app.window.getAll().map((function(n){return e(n.contentWindow).then((function(i){t["window-"+n.id+".txt"]=i}))}));return Promise.all(i)})).then((function(){var i={description:chrome.runtime.getManifest().name+" console log",public:!1,files:t};fetch("https://vysor.io/gist",{method:"POST",body:JSON.stringify(i)}).then((function(t){t.json().then((function(t){n(t.html_url)}))}))}))}))}}function i(n){try{for(var i in n)n[i]&&n[i].constructor!=String&&(n[i]=JSON.stringify(n[i]));t+=n.join(" ")+"\n"}catch(t){}}function e(t){return new Promise((function(n,i){t.getConsoleLog?t.getConsoleLog((function(t){n({content:t&&t.length?t:"log is empty"})})):n("getConsoleLog not found")}))}}(),n.str2ab=r,n.ab2str=e,n.readString=function(t,n){var i="";t.onClose=function(){n(i)},t.read((function n(r){i+=e(r),t.read(n)}))},n.readLine=function(t,n){var i=[];!function r(){t.read((function(s){for(var c=0;c<s.byteLength;c++)if(s[c]==o){var a=s.subarray(0,c);i.push(a);var u="";for(var h in i)u+=e(h=i[h]);var f=s.subarray(c+1);return t.unshift(f),void n(u)}i.push(s),r()}))}()},n.writeLine=function(t,n,i){"Object"==n.constructor.name&&(n=JSON.stringify(n)),s(t,n+"\n",i)},n.writeString=s,n.isNode=d,n.isElectron=v,n.base64ToArrayBuffer=function(t){for(var n=window.atob(t),i=n.length,e=new Uint8Array(i),r=0;r<i;r++){var o=n.charCodeAt(r);e[r]=o}return e.buffer},n.nextTick=function(t){setTimeout(t,0)},n.getAuthToken=function(n,i){if(!window.chrome||!window.chrome.identity)return console.error("no auth token implemented"),void t.nextTick(i);chrome.identity.getAuthToken({interactive:n,scopes:["https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/chromewebstore.readonly"]},(function(t){t||console.error("unable to get authToken",chrome.runtime.lastError),i(t)}))},n.make4Len16=i,n.throttleTimeout=function(t,n,i,e,r){if(t||(t={items:[]}),t.items.push(n),!t.timeout){function o(){delete t.timeout,e(t.items),t.items=[]}r&&o(t.items),t.timeout=setTimeout(o,i)}return t},n.bufferToHex=function(t){var n=new Uint8Array(t),i="";for(var e in n)i+=(e=n[e])<16?"0"+e.toString(16):e.toString(16);return i},n.hexToBuffer=function(t){for(var n=new ArrayBuffer(t.length/2),i=new Uint8Array(n),e=0;e<t.length/2;e++){var r=t.substr(2*e,2);i[e]=parseInt(r,16)}return n},n.Success=l,n.readLenLoop=function(t,n,i){var e=function(e){if(4!=e.byteLength)return t.destroy(),void n(null);var o=new DataView(e.buffer,e.byteOffset,4).getInt32(0,i);t.read(o,r)},r=function(t){n(t),o()},o=function(){t.read(4,e)};o()},n.arrayBufferToBase64=function(t){for(var n="",i=new Uint8Array(t),e=i.byteLength,r=0;r<e;r++)n+=String.fromCharCode(i[r]);return window.btoa(n)},n.writeLenData=function(t,n,i,e){var r=new ArrayBuffer(4);new DataView(r).setInt32(0,n.byteLength,e),t.write(c(new Uint8Array(r),new Uint8Array(n)).buffer,i)},n.makeUUID=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},n.appendBuffer=c,n.readLenPackets=function(t,n,i){var e,r=function(r){if(4!=r.byteLength)return t.destroy(),void n(null);var s=new DataView(r.buffer,r.byteOffset,4).getInt32(0,i);if(e)t.read(s,o);else{e=[],t.read(s,o);var c=e;e=void 0,c.length&&n(c)}},o=function(t){e?e.push(t):n([t]),s()},s=function(){t.read(4,r)};s()},n.hex2b64=function(t){var n,i,e="";for(n=0;n+3<=t.length;n+=3)i=parseInt(t.substring(n,n+3),16),e+=a.charAt(i>>6)+a.charAt(63&i);for(n+1==t.length?(i=parseInt(t.substring(n,n+1),16),e+=a.charAt(i<<2)):n+2==t.length&&(i=parseInt(t.substring(n,n+2),16),e+=a.charAt(i>>2)+a.charAt((3&i)<<4));(3&e.length)>0;)e+="=";return e},n.showNotification=function(t,n){if(console.log("notification:",t),window.chrome&&window.chrome.notifications){var i=chrome.runtime.getManifest(),e=i.name;n=n||i.icons[128],chrome.notifications.create({type:"basic",iconUrl:n,title:e,message:t})}},n.getQueryVariable=function(t,n){n||(n=window.location);for(var i=n.search.substring(1).split("&"),e=0;e<i.length;e++){var r=i[e].split("=");if(decodeURIComponent(r[0])==t)return decodeURIComponent(r[1])}},n.isBrowser=function(){return!window.chrome||!window.chrome.app||!window.chrome.app.window},n.copyTextToClipboard=function(t){var n=document.createElement("textarea");n.style.position="fixed",n.style.top=0,n.style.left=0,n.style.width="2em",n.style.height="2em",n.style.padding=0,n.style.border="none",n.style.outline="none",n.style.boxShadow="none",n.style.background="transparent",n.value=t,document.body.appendChild(n),n.select();try{document.execCommand("copy")}catch(t){console.log("Oops, unable to copy")}document.body.removeChild(n)}}).call(this,i(6))},function(t,n,i){(function(e){function r(){var t;try{t=n.storage.debug}catch(t){}return!t&&void 0!==e&&"env"in e&&(t=e.env.DEBUG),t}(n=t.exports=i(37)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+n.humanize(this.diff),!i)return;var e="color: "+this.color;t.splice(1,0,e,"color: inherit");var r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(r++,"%c"===t&&(o=r))})),t.splice(o,0,e)},n.save=function(t){try{null==t?n.storage.removeItem("debug"):n.storage.debug=t}catch(t){}},n.load=r,n.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},n.enable(r())}).call(this,i(6))},function(t,n,i){(function(t){var e=i(9).Buffer,r=!1;try{chrome&&chrome.sockets&&(chrome.sockets.tcp.onReceive.addListener((function(t){var n=o.readers[t.socketId];null!=n&&n.dataReceived(new Uint8Array(t.data))})),chrome.sockets.tcp.onReceiveError.addListener((function(t){var n=o.readers[t.socketId];null!=n&&(n.destroy(),n.dataReceived(null))})),chrome.sockets.tcpServer.onAccept.addListener((function(t){chrome.sockets.tcp.setPaused(t.clientSocketId,!1);var n=s.listeners[t.socketId];null!=n&&n(new o({socketId:t.clientSocketId}))})),r=!0)}catch(t){console.log("chrome app socket initialization failed"),console.warn(t)}function o(t,n){if(t.socketId)this.socketId=t.socketId,o.readers[this.socketId]=this;else if(r)chrome.sockets.tcp.create(function(i){this.socketId=i.socketId,chrome.sockets.tcp.connect(this.socketId,t.host,t.port,function(t){t?(chrome.runtime.lastError,this.destroy(),n(null)):(o.readers[i.socketId]=this,n(this))}.bind(this))}.bind(this));else{var i;t.ns?(this.ns=t.ns,i=!0):(this.ns=new require("net").Socket(),this.ns.connect({port:t.port,host:t.host},function(){i=!0,n(this)}.bind(this))),this.ns.on("close",function(){this.destroy(),i||n(null)}.bind(this)),this.ns.on("data",function(t){this.dataReceived(t)}.bind(this))}}function s(){}o.readers={},o.connect=function(t,n){return new o(t,n)},o.pump=function(t,n,i){if(!t||!n)return console.error("Socket.pump called with null socket",t,n),void i();var e=function(){t.read(r)}.bind(t),r=function(t){var i=t.buffer;(t.byteOffset||t.length!=i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+t.length)),n.write(i,e)}.bind(n);t.read(r),t.onClose=i},o.stream=function(t,n,i){o.pump(t,n,(function(){if(n&&n.destroy(),i){var t=i;i=null,t()}})),o.pump(n,t,(function(){if(t&&t.destroy(),i){var n=i;i=null,n()}}))},o.eat=function(t){!function n(){t.read(n)}()},o.prototype.read=function(){if(this.pendingCallback)throw new Error("double callback");if(!this.closed||this.pending){var t=0;"Number"==arguments[t].constructor.name?this.pendingLength=arguments[t++]:this.pendingLength=0;a=arguments[t];if(this.pending&&!this.paused){if(this.pendingLength){if(this.pendingLength>this.buffered())return void(this.pendingCallback=a)}else this.pendingLength=this.buffered();for(var n,i=0;i<this.pendingLength;){var e=this.pending.shift();this.bufferedLength-=e.length,this.pending.length||delete this.pending;var r=e,o=Math.min(r.byteLength,this.pendingLength-i);if(o!=r.byteLength){var s=r.subarray(0,o),c=r.subarray(o);this.unshift(c),r=s.slice()}n||r.byteLength==this.pendingLength||(n=new Uint8Array(this.pendingLength)),n?n.set(r,i):n=r,i+=r.byteLength}a(n)}else this.pendingCallback=a}else{var a;(a=this.onClose)&&(delete this.onClose,a())}},o.prototype.write=function(n,i){if(this.pendingWrite)if(this.bufferWrites){null!=i&&console.error("using callbacks in buffered mode?");var o=this.pendingWrite;this.pendingWrite=function(){o&&o(),this.write(n,i)}.bind(this)}else console.error("write is already in progress!");if(null==i&&(this.bufferWrites||console.error("write callback is null?"),i=function(){}),this.pendingWrite=i,r)chrome.sockets.tcp.send(this.socketId,n,function(t){chrome.runtime.lastError,t&&!t.resultCode?t.bytesSent<n.byteLength?this.write(n.slice(t.bytesSent),i):(delete this.pendingWrite,i()):delete this.pendingWrite}.bind(this));else{if(!this.ns)return;if(!n.byteLength)return void t.nextTick(function(){delete this.pendingWrite,i()}.bind(this));this.ns.write(e.from(n),function(){delete this.pendingWrite,i()}.bind(this))}},o.prototype.destroy=function(t,n){r?chrome.sockets.tcp.close(this.socketId,(function(){chrome.runtime.lastError})):(this.dataReceived(null),this.ns&&(this.ns.destroy(),delete this.ns))},o.prototype.unshift=function(t){0!=t.byteLength&&(this.pending?this.pending.unshift(t):this.pending=[t],this.bufferedLength||(this.bufferedLength=0),this.bufferedLength+=t.length)},o.prototype.dataReceived=function(t){if(t&&(t.asUint8Array&&(t=t.asUint8Array()),t.constructor==ArrayBuffer&&(t=new Uint8Array(t))),t&&t.length){var n=new Uint8Array(t);this.pending?this.pending.push(n):this.pending=[n]}if(null==t?this.closed=!0:(this.bufferedLength||(this.bufferedLength=0),this.bufferedLength+=t.length),!this.paused&&this.pending&&this.pending.length){var i=this.pendingLength;(e=this.pendingCallback)&&(delete this.pendingCallback,this.read(i,e))}else{var e=this.onClose;this.closed&&e&&(delete this.onClose,e())}},o.prototype.buffered=function(){return this.bufferedLength},o.prototype.pause=function(){this.paused||(this.paused=!0,this.onPause())},o.prototype.resume=function(){this.paused&&(this.paused=!1,this.onResume())},o.prototype.onResume=function(){chrome.sockets.tcp.setPaused(this.socketId,!1,(function(){}))},o.prototype.onPause=function(){chrome.sockets.tcp.setPaused(this.socketId,!0,(function(){}))},s.listeners={},s.prototype.__proto__=o.prototype,s.prototype.destroy=function(){r?chrome.sockets.tcpServer.close(this.socketId,(function(){chrome.runtime.lastError})):this.ns&&(this.ns.close(),delete this.ns)},s.prototype.listen=function(t,n,i){var e,c;"Number"==t.constructor.name?(e=t,c="0.0.0.0"):(c=t.address,e=t.port),r?chrome.sockets.tcpServer.create(function(t){this.socketId=t.socketId,s.listeners[this.socketId]=n,chrome.sockets.tcpServer.listen(t.socketId,c,e,function(t){if(chrome.runtime.lastError,t)return this.destroy(),void(i&&i(t));chrome.sockets.tcpServer.getInfo(this.socketId,function(n){this.localAddress=n.localAddress,this.localPort=n.localPort,i&&i(t)}.bind(this))}.bind(this))}.bind(this)):(this.ns=require("net").createServer(function(t){n(new o({ns:t}))}.bind(this)),this.ns.on("close",function(){this.destroy()}.bind(this)),this.ns.on("error",function(t){i&&i(t)}.bind(this)),this.ns.on("listening",function(){var t=this.ns.address();this.localAddress=t.address,this.localPort=t.port,i&&i()}.bind(this)),this.ns.listen({port:e,host:c}))},n.Socket=o,n.Server=s}).call(this,i(6))},function(t,n,i){function e(t){if(t)return function(t){for(var n in e.prototype)t[n]=e.prototype[n];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,n){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(n),this},e.prototype.once=function(t,n){function i(){this.off(t,i),n.apply(this,arguments)}return i.fn=n,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,n){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,e=this._callbacks["$"+t];if(!e)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<e.length;r++)if((i=e[r])===n||i.fn===n){e.splice(r,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var n=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i)for(var e=0,r=(i=i.slice(0)).length;e<r;++e)i[e].apply(this,n);return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,n,i){var e,r=i(44),o=i(26),s=i(45),c=i(46),a=i(47);"undefined"!=typeof ArrayBuffer&&(e=i(48));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),h="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),f=u||h;n.protocol=3;var l=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=r(l),v={type:"error",data:"parser error"},p=i(49);function y(t,n,i){for(var e=new Array(t.length),r=c(t.length,i),o=function(t,i,r){n(i,(function(n,i){e[t]=i,r(n,e)}))},s=0;s<t.length;s++)o(s,t[s],r)}n.encodePacket=function(t,i,e,r){"function"==typeof i&&(r=i,i=!1),"function"==typeof e&&(r=e,e=null);var o=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(t,i,e){if(!i)return n.encodeBase64Packet(t,e);var r=t.data,o=new Uint8Array(r),s=new Uint8Array(1+r.byteLength);s[0]=l[t.type];for(var c=0;c<o.length;c++)s[c+1]=o[c];return e(s.buffer)}(t,i,r);if(void 0!==p&&o instanceof p)return function(t,i,e){if(!i)return n.encodeBase64Packet(t,e);if(f)return function(t,i,e){if(!i)return n.encodeBase64Packet(t,e);var r=new FileReader;return r.onload=function(){n.encodePacket({type:t.type,data:r.result},i,!0,e)},r.readAsArrayBuffer(t.data)}(t,i,e);var r=new Uint8Array(1);r[0]=l[t.type];var o=new p([r.buffer,t.data]);return e(o)}(t,i,r);if(o&&o.base64)return function(t,i){var e="b"+n.packets[t.type]+t.data.data;return i(e)}(t,r);var s=l[t.type];return void 0!==t.data&&(s+=e?a.encode(String(t.data),{strict:!1}):String(t.data)),r(""+s)},n.encodeBase64Packet=function(t,i){var e,r="b"+n.packets[t.type];if(void 0!==p&&t.data instanceof p){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];i(r+t)},o.readAsDataURL(t.data)}try{e=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(n){for(var s=new Uint8Array(t.data),c=new Array(s.length),a=0;a<s.length;a++)c[a]=s[a];e=String.fromCharCode.apply(null,c)}return r+=btoa(e),i(r)},n.decodePacket=function(t,i,e){if(void 0===t)return v;if("string"==typeof t){if("b"===t.charAt(0))return n.decodeBase64Packet(t.substr(1),i);if(e&&!1===(t=function(t){try{t=a.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return v;var r=t.charAt(0);return Number(r)==r&&d[r]?t.length>1?{type:d[r],data:t.substring(1)}:{type:d[r]}:v}r=new Uint8Array(t)[0];var o=s(t,1);return p&&"blob"===i&&(o=new p([o])),{type:d[r],data:o}},n.decodeBase64Packet=function(t,n){var i=d[t.charAt(0)];if(!e)return{type:i,data:{base64:!0,data:t.substr(1)}};var r=e.decode(t.substr(1));return"blob"===n&&p&&(r=new p([r])),{type:i,data:r}},n.encodePayload=function(t,i,e){"function"==typeof i&&(e=i,i=null);var r=o(t);if(i&&r)return p&&!f?n.encodePayloadAsBlob(t,e):n.encodePayloadAsArrayBuffer(t,e);if(!t.length)return e("0:");y(t,(function(t,e){n.encodePacket(t,!!r&&i,!1,(function(t){e(null,function(t){return t.length+":"+t}(t))}))}),(function(t,n){return e(n.join(""))}))},n.decodePayload=function(t,i,e){if("string"!=typeof t)return n.decodePayloadAsBinary(t,i,e);var r;if("function"==typeof i&&(e=i,i=null),""===t)return e(v,0,1);for(var o,s,c="",a=0,u=t.length;a<u;a++){var h=t.charAt(a);if(":"===h){if(""===c||c!=(o=Number(c)))return e(v,0,1);if(c!=(s=t.substr(a+1,o)).length)return e(v,0,1);if(s.length){if(r=n.decodePacket(s,i,!1),v.type===r.type&&v.data===r.data)return e(v,0,1);if(!1===e(r,a+o,u))return}a+=o,c=""}else c+=h}return""!==c?e(v,0,1):void 0},n.encodePayloadAsArrayBuffer=function(t,i){if(!t.length)return i(new ArrayBuffer(0));y(t,(function(t,i){n.encodePacket(t,!0,!0,(function(t){return i(null,t)}))}),(function(t,n){var e=n.reduce((function(t,n){var i;return t+(i="string"==typeof n?n.length:n.byteLength).toString().length+i+2}),0),r=new Uint8Array(e),o=0;return n.forEach((function(t){var n="string"==typeof t,i=t;if(n){for(var e=new Uint8Array(t.length),s=0;s<t.length;s++)e[s]=t.charCodeAt(s);i=e.buffer}r[o++]=n?0:1;var c=i.byteLength.toString();for(s=0;s<c.length;s++)r[o++]=parseInt(c[s]);r[o++]=255;for(e=new Uint8Array(i),s=0;s<e.length;s++)r[o++]=e[s]})),i(r.buffer)}))},n.encodePayloadAsBlob=function(t,i){y(t,(function(t,i){n.encodePacket(t,!0,!0,(function(t){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);t=e.buffer,n[0]=0}var o=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(o.length+1);for(r=0;r<o.length;r++)s[r]=parseInt(o[r]);if(s[o.length]=255,p){var c=new p([n.buffer,s.buffer,t]);i(null,c)}}))}),(function(t,n){return i(new p(n))}))},n.decodePayloadAsBinary=function(t,i,e){"function"==typeof i&&(e=i,i=null);for(var r=t,o=[];r.byteLength>0;){for(var c=new Uint8Array(r),a=0===c[0],u="",h=1;255!==c[h];h++){if(u.length>310)return e(v,0,1);u+=c[h]}r=s(r,2+u.length),u=parseInt(u);var f=s(r,0,u);if(a)try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(t){var l=new Uint8Array(f);f="";for(h=0;h<l.length;h++)f+=String.fromCharCode(l[h])}o.push(f),r=s(r,u)}var d=o.length;o.forEach((function(t,r){e(n.decodePacket(t,i,!0),r,d)}))}},function(t,n){var i,e,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(n){try{return i.call(null,t,0)}catch(n){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{e="function"==typeof clearTimeout?clearTimeout:s}catch(t){e=s}}();var a,u=[],h=!1,f=-1;function l(){h&&a&&(h=!1,a.length?u=a.concat(u):f=-1,u.length&&d())}function d(){if(!h){var t=c(l);h=!0;for(var n=u.length;n;){for(a=u,u=[];++f<n;)a&&a[f].run();f=-1,n=u.length}a=null,h=!1,function(t){if(e===clearTimeout)return clearTimeout(t);if((e===s||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}(t)}}function v(t,n){this.fun=t,this.array=n}function p(){}r.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)n[i-1]=arguments[i];u.push(new v(t,n)),1!==u.length||h||c(d)},v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,n){n.encode=function(t){var n="";for(var i in t)t.hasOwnProperty(i)&&(n.length&&(n+="&"),n+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return n},n.decode=function(t){for(var n={},i=t.split("&"),e=0,r=i.length;e<r;e++){var o=i[e].split("=");n[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return n}},function(t,n){t.exports=function(t,n){var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,n,i){"use strict";(function(t){var e=i(15),r=i(16),o=i(17);function s(){return a.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(t,n){if(s()<n)throw new RangeError("Invalid typed array length");return a.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n)).__proto__=a.prototype:(null===t&&(t=new a(n)),t.length=n),t}function a(t,n,i){if(!(a.TYPED_ARRAY_SUPPORT||this instanceof a))return new a(t,n,i);if("number"==typeof t){if("string"==typeof n)throw new Error("If encoding is specified then the first argument must be a string");return f(this,t)}return u(this,t,n,i)}function u(t,n,i,e){if("number"==typeof n)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer?function(t,n,i,e){if(n.byteLength,i<0||n.byteLength<i)throw new RangeError("'offset' is out of bounds");if(n.byteLength<i+(e||0))throw new RangeError("'length' is out of bounds");n=void 0===i&&void 0===e?new Uint8Array(n):void 0===e?new Uint8Array(n,i):new Uint8Array(n,i,e);a.TYPED_ARRAY_SUPPORT?(t=n).__proto__=a.prototype:t=l(t,n);return t}(t,n,i,e):"string"==typeof n?function(t,n,i){"string"==typeof i&&""!==i||(i="utf8");if(!a.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var e=0|v(n,i),r=(t=c(t,e)).write(n,i);r!==e&&(t=t.slice(0,r));return t}(t,n,i):function(t,n){if(a.isBuffer(n)){var i=0|d(n.length);return 0===(t=c(t,i)).length?t:(n.copy(t,0,0,i),t)}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||(e=n.length)!=e?c(t,0):l(t,n);if("Buffer"===n.type&&o(n.data))return l(t,n.data)}var e;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,n)}function h(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function f(t,n){if(h(n),t=c(t,n<0?0:0|d(n)),!a.TYPED_ARRAY_SUPPORT)for(var i=0;i<n;++i)t[i]=0;return t}function l(t,n){var i=n.length<0?0:0|d(n.length);t=c(t,i);for(var e=0;e<i;e+=1)t[e]=255&n[e];return t}function d(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function v(t,n){if(a.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var e=!1;;)switch(n){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return P(t).length;default:if(e)return z(t).length;n=(""+n).toLowerCase(),e=!0}}function p(t,n,i){var e=!1;if((void 0===n||n<0)&&(n=0),n>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(n>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return F(this,n,i);case"utf8":case"utf-8":return E(this,n,i);case"ascii":return x(this,n,i);case"latin1":case"binary":return $(this,n,i);case"base64":return T(this,n,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,n,i);default:if(e)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),e=!0}}function y(t,n,i){var e=t[n];t[n]=t[i],t[i]=e}function w(t,n,i,e,r){if(0===t.length)return-1;if("string"==typeof i?(e=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof n&&(n=a.from(n,e)),a.isBuffer(n))return 0===n.length?-1:m(t,n,i,e,r);if("number"==typeof n)return n&=255,a.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,n,i):Uint8Array.prototype.lastIndexOf.call(t,n,i):m(t,[n],i,e,r);throw new TypeError("val must be string, number or Buffer")}function m(t,n,i,e,r){var o,s=1,c=t.length,a=n.length;if(void 0!==e&&("ucs2"===(e=String(e).toLowerCase())||"ucs-2"===e||"utf16le"===e||"utf-16le"===e)){if(t.length<2||n.length<2)return-1;s=2,c/=2,a/=2,i/=2}function u(t,n){return 1===s?t[n]:t.readUInt16BE(n*s)}if(r){var h=-1;for(o=i;o<c;o++)if(u(t,o)===u(n,-1===h?0:o-h)){if(-1===h&&(h=o),o-h+1===a)return h*s}else-1!==h&&(o-=o-h),h=-1}else for(i+a>c&&(i=c-a),o=i;o>=0;o--){for(var f=!0,l=0;l<a;l++)if(u(t,o+l)!==u(n,l)){f=!1;break}if(f)return o}return-1}function g(t,n,i,e){i=Number(i)||0;var r=t.length-i;e?(e=Number(e))>r&&(e=r):e=r;var o=n.length;if(o%2!=0)throw new TypeError("Invalid hex string");e>o/2&&(e=o/2);for(var s=0;s<e;++s){var c=parseInt(n.substr(2*s,2),16);if(isNaN(c))return s;t[i+s]=c}return s}function b(t,n,i,e){return V(z(n,t.length-i),t,i,e)}function k(t,n,i,e){return V(function(t){for(var n=[],i=0;i<t.length;++i)n.push(255&t.charCodeAt(i));return n}(n),t,i,e)}function A(t,n,i,e){return k(t,n,i,e)}function C(t,n,i,e){return V(P(n),t,i,e)}function S(t,n,i,e){return V(function(t,n){for(var i,e,r,o=[],s=0;s<t.length&&!((n-=2)<0);++s)i=t.charCodeAt(s),e=i>>8,r=i%256,o.push(r),o.push(e);return o}(n,t.length-i),t,i,e)}function T(t,n,i){return 0===n&&i===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,i))}function E(t,n,i){i=Math.min(t.length,i);for(var e=[],r=n;r<i;){var o,s,c,a,u=t[r],h=null,f=u>239?4:u>223?3:u>191?2:1;if(r+f<=i)switch(f){case 1:u<128&&(h=u);break;case 2:128==(192&(o=t[r+1]))&&(a=(31&u)<<6|63&o)>127&&(h=a);break;case 3:o=t[r+1],s=t[r+2],128==(192&o)&&128==(192&s)&&(a=(15&u)<<12|(63&o)<<6|63&s)>2047&&(a<55296||a>57343)&&(h=a);break;case 4:o=t[r+1],s=t[r+2],c=t[r+3],128==(192&o)&&128==(192&s)&&128==(192&c)&&(a=(15&u)<<18|(63&o)<<12|(63&s)<<6|63&c)>65535&&a<1114112&&(h=a)}null===h?(h=65533,f=1):h>65535&&(h-=65536,e.push(h>>>10&1023|55296),h=56320|1023&h),e.push(h),r+=f}return function(t){var n=t.length;if(n<=4096)return String.fromCharCode.apply(String,t);var i="",e=0;for(;e<n;)i+=String.fromCharCode.apply(String,t.slice(e,e+=4096));return i}(e)}n.Buffer=a,n.SlowBuffer=function(t){+t!=t&&(t=0);return a.alloc(+t)},n.INSPECT_MAX_BYTES=50,a.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),n.kMaxLength=s(),a.poolSize=8192,a._augment=function(t){return t.__proto__=a.prototype,t},a.from=function(t,n,i){return u(null,t,n,i)},a.TYPED_ARRAY_SUPPORT&&(a.prototype.__proto__=Uint8Array.prototype,a.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&a[Symbol.species]===a&&Object.defineProperty(a,Symbol.species,{value:null,configurable:!0})),a.alloc=function(t,n,i){return function(t,n,i,e){return h(n),n<=0?c(t,n):void 0!==i?"string"==typeof e?c(t,n).fill(i,e):c(t,n).fill(i):c(t,n)}(null,t,n,i)},a.allocUnsafe=function(t){return f(null,t)},a.allocUnsafeSlow=function(t){return f(null,t)},a.isBuffer=function(t){return!(null==t||!t._isBuffer)},a.compare=function(t,n){if(!a.isBuffer(t)||!a.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var i=t.length,e=n.length,r=0,o=Math.min(i,e);r<o;++r)if(t[r]!==n[r]){i=t[r],e=n[r];break}return i<e?-1:e<i?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,n){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);var i;if(void 0===n)for(n=0,i=0;i<t.length;++i)n+=t[i].length;var e=a.allocUnsafe(n),r=0;for(i=0;i<t.length;++i){var s=t[i];if(!a.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(e,r),r+=s.length}return e},a.byteLength=v,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<t;n+=2)y(this,n,n+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<t;n+=4)y(this,n,n+3),y(this,n+1,n+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<t;n+=8)y(this,n,n+7),y(this,n+1,n+6),y(this,n+2,n+5),y(this,n+3,n+4);return this},a.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?E(this,0,t):p.apply(this,arguments)},a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",i=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},a.prototype.compare=function(t,n,i,e,r){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===i&&(i=t?t.length:0),void 0===e&&(e=0),void 0===r&&(r=this.length),n<0||i>t.length||e<0||r>this.length)throw new RangeError("out of range index");if(e>=r&&n>=i)return 0;if(e>=r)return-1;if(n>=i)return 1;if(this===t)return 0;for(var o=(r>>>=0)-(e>>>=0),s=(i>>>=0)-(n>>>=0),c=Math.min(o,s),u=this.slice(e,r),h=t.slice(n,i),f=0;f<c;++f)if(u[f]!==h[f]){o=u[f],s=h[f];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(t,n,i){return-1!==this.indexOf(t,n,i)},a.prototype.indexOf=function(t,n,i){return w(this,t,n,i,!0)},a.prototype.lastIndexOf=function(t,n,i){return w(this,t,n,i,!1)},a.prototype.write=function(t,n,i,e){if(void 0===n)e="utf8",i=this.length,n=0;else if(void 0===i&&"string"==typeof n)e=n,i=this.length,n=0;else{if(!isFinite(n))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n|=0,isFinite(i)?(i|=0,void 0===e&&(e="utf8")):(e=i,i=void 0)}var r=this.length-n;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");e||(e="utf8");for(var o=!1;;)switch(e){case"hex":return g(this,t,n,i);case"utf8":case"utf-8":return b(this,t,n,i);case"ascii":return k(this,t,n,i);case"latin1":case"binary":return A(this,t,n,i);case"base64":return C(this,t,n,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,n,i);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function x(t,n,i){var e="";i=Math.min(t.length,i);for(var r=n;r<i;++r)e+=String.fromCharCode(127&t[r]);return e}function $(t,n,i){var e="";i=Math.min(t.length,i);for(var r=n;r<i;++r)e+=String.fromCharCode(t[r]);return e}function F(t,n,i){var e=t.length;(!n||n<0)&&(n=0),(!i||i<0||i>e)&&(i=e);for(var r="",o=n;o<i;++o)r+=j(t[o]);return r}function U(t,n,i){for(var e=t.slice(n,i),r="",o=0;o<e.length;o+=2)r+=String.fromCharCode(e[o]+256*e[o+1]);return r}function I(t,n,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+n>i)throw new RangeError("Trying to access beyond buffer length")}function N(t,n,i,e,r,o){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>r||n<o)throw new RangeError('"value" argument is out of bounds');if(i+e>t.length)throw new RangeError("Index out of range")}function B(t,n,i,e){n<0&&(n=65535+n+1);for(var r=0,o=Math.min(t.length-i,2);r<o;++r)t[i+r]=(n&255<<8*(e?r:1-r))>>>8*(e?r:1-r)}function O(t,n,i,e){n<0&&(n=4294967295+n+1);for(var r=0,o=Math.min(t.length-i,4);r<o;++r)t[i+r]=n>>>8*(e?r:3-r)&255}function R(t,n,i,e,r,o){if(i+e>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function M(t,n,i,e,o){return o||R(t,0,i,4),r.write(t,n,i,e,23,4),i+4}function D(t,n,i,e,o){return o||R(t,0,i,8),r.write(t,n,i,e,52,8),i+8}a.prototype.slice=function(t,n){var i,e=this.length;if((t=~~t)<0?(t+=e)<0&&(t=0):t>e&&(t=e),(n=void 0===n?e:~~n)<0?(n+=e)<0&&(n=0):n>e&&(n=e),n<t&&(n=t),a.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,n)).__proto__=a.prototype;else{var r=n-t;i=new a(r,void 0);for(var o=0;o<r;++o)i[o]=this[o+t]}return i},a.prototype.readUIntLE=function(t,n,i){t|=0,n|=0,i||I(t,n,this.length);for(var e=this[t],r=1,o=0;++o<n&&(r*=256);)e+=this[t+o]*r;return e},a.prototype.readUIntBE=function(t,n,i){t|=0,n|=0,i||I(t,n,this.length);for(var e=this[t+--n],r=1;n>0&&(r*=256);)e+=this[t+--n]*r;return e},a.prototype.readUInt8=function(t,n){return n||I(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,n){return n||I(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,n){return n||I(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,n){return n||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,n){return n||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,n,i){t|=0,n|=0,i||I(t,n,this.length);for(var e=this[t],r=1,o=0;++o<n&&(r*=256);)e+=this[t+o]*r;return e>=(r*=128)&&(e-=Math.pow(2,8*n)),e},a.prototype.readIntBE=function(t,n,i){t|=0,n|=0,i||I(t,n,this.length);for(var e=n,r=1,o=this[t+--e];e>0&&(r*=256);)o+=this[t+--e]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*n)),o},a.prototype.readInt8=function(t,n){return n||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,n){n||I(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},a.prototype.readInt16BE=function(t,n){n||I(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},a.prototype.readInt32LE=function(t,n){return n||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,n){return n||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,n){return n||I(t,4,this.length),r.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,n){return n||I(t,4,this.length),r.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,n){return n||I(t,8,this.length),r.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,n){return n||I(t,8,this.length),r.read(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,n,i,e){(t=+t,n|=0,i|=0,e)||N(this,t,n,i,Math.pow(2,8*i)-1,0);var r=1,o=0;for(this[n]=255&t;++o<i&&(r*=256);)this[n+o]=t/r&255;return n+i},a.prototype.writeUIntBE=function(t,n,i,e){(t=+t,n|=0,i|=0,e)||N(this,t,n,i,Math.pow(2,8*i)-1,0);var r=i-1,o=1;for(this[n+r]=255&t;--r>=0&&(o*=256);)this[n+r]=t/o&255;return n+i},a.prototype.writeUInt8=function(t,n,i){return t=+t,n|=0,i||N(this,t,n,1,255,0),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},a.prototype.writeUInt16LE=function(t,n,i){return t=+t,n|=0,i||N(this,t,n,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):B(this,t,n,!0),n+2},a.prototype.writeUInt16BE=function(t,n,i){return t=+t,n|=0,i||N(this,t,n,2,65535,0),a.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):B(this,t,n,!1),n+2},a.prototype.writeUInt32LE=function(t,n,i){return t=+t,n|=0,i||N(this,t,n,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):O(this,t,n,!0),n+4},a.prototype.writeUInt32BE=function(t,n,i){return t=+t,n|=0,i||N(this,t,n,4,4294967295,0),a.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):O(this,t,n,!1),n+4},a.prototype.writeIntLE=function(t,n,i,e){if(t=+t,n|=0,!e){var r=Math.pow(2,8*i-1);N(this,t,n,i,r-1,-r)}var o=0,s=1,c=0;for(this[n]=255&t;++o<i&&(s*=256);)t<0&&0===c&&0!==this[n+o-1]&&(c=1),this[n+o]=(t/s>>0)-c&255;return n+i},a.prototype.writeIntBE=function(t,n,i,e){if(t=+t,n|=0,!e){var r=Math.pow(2,8*i-1);N(this,t,n,i,r-1,-r)}var o=i-1,s=1,c=0;for(this[n+o]=255&t;--o>=0&&(s*=256);)t<0&&0===c&&0!==this[n+o+1]&&(c=1),this[n+o]=(t/s>>0)-c&255;return n+i},a.prototype.writeInt8=function(t,n,i){return t=+t,n|=0,i||N(this,t,n,1,127,-128),a.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},a.prototype.writeInt16LE=function(t,n,i){return t=+t,n|=0,i||N(this,t,n,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):B(this,t,n,!0),n+2},a.prototype.writeInt16BE=function(t,n,i){return t=+t,n|=0,i||N(this,t,n,2,32767,-32768),a.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):B(this,t,n,!1),n+2},a.prototype.writeInt32LE=function(t,n,i){return t=+t,n|=0,i||N(this,t,n,4,2147483647,-2147483648),a.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):O(this,t,n,!0),n+4},a.prototype.writeInt32BE=function(t,n,i){return t=+t,n|=0,i||N(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),a.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):O(this,t,n,!1),n+4},a.prototype.writeFloatLE=function(t,n,i){return M(this,t,n,!0,i)},a.prototype.writeFloatBE=function(t,n,i){return M(this,t,n,!1,i)},a.prototype.writeDoubleLE=function(t,n,i){return D(this,t,n,!0,i)},a.prototype.writeDoubleBE=function(t,n,i){return D(this,t,n,!1,i)},a.prototype.copy=function(t,n,i,e){if(i||(i=0),e||0===e||(e=this.length),n>=t.length&&(n=t.length),n||(n=0),e>0&&e<i&&(e=i),e===i)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(e<0)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),t.length-n<e-i&&(e=t.length-n+i);var r,o=e-i;if(this===t&&i<n&&n<e)for(r=o-1;r>=0;--r)t[r+n]=this[r+i];else if(o<1e3||!a.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+n]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),n);return o},a.prototype.fill=function(t,n,i,e){if("string"==typeof t){if("string"==typeof n?(e=n,n=0,i=this.length):"string"==typeof i&&(e=i,i=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==e&&"string"!=typeof e)throw new TypeError("encoding must be a string");if("string"==typeof e&&!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e)}else"number"==typeof t&&(t&=255);if(n<0||this.length<n||this.length<i)throw new RangeError("Out of range index");if(i<=n)return this;var o;if(n>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(o=n;o<i;++o)this[o]=t;else{var s=a.isBuffer(t)?t:z(new a(t,e).toString()),c=s.length;for(o=0;o<i-n;++o)this[o+n]=s[o%c]}return this};var _=/[^+\/0-9A-Za-z-_]/g;function j(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,n){var i;n=n||1/0;for(var e=t.length,r=null,o=[],s=0;s<e;++s){if((i=t.charCodeAt(s))>55295&&i<57344){if(!r){if(i>56319){(n-=3)>-1&&o.push(239,191,189);continue}if(s+1===e){(n-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(n-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(n-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((n-=1)<0)break;o.push(i)}else if(i<2048){if((n-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((n-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((n-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function P(t){return e.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(_,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,n,i,e){for(var r=0;r<e&&!(r+i>=n.length||r>=t.length);++r)n[r+i]=t[r];return r}}).call(this,i(0))},function(t,n,i){var e=i(2)("socket.io-parser"),r=i(4),o=i(39),s=i(11),c=i(22);function a(){}n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=a,n.Decoder=f;var u=n.ERROR+'"encode error"';function h(t){var i=""+t.type;if(n.BINARY_EVENT!==t.type&&n.BINARY_ACK!==t.type||(i+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(i+=t.nsp+","),null!=t.id&&(i+=t.id),null!=t.data){var r=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===r)return u;i+=r}return e("encoded %j as %s",t,i),i}function f(){this.reconstructor=null}function l(t){this.reconPack=t,this.buffers=[]}function d(t){return{type:n.ERROR,data:"parser error: "+t}}a.prototype.encode=function(t,i){(e("encoding packet %j",t),n.BINARY_EVENT===t.type||n.BINARY_ACK===t.type)?function(t,n){o.removeBlobs(t,(function(t){var i=o.deconstructPacket(t),e=h(i.packet),r=i.buffers;r.unshift(e),n(r)}))}(t,i):i([h(t)])},r(f.prototype),f.prototype.add=function(t){var i;if("string"==typeof t)i=function(t){var i=0,r={type:Number(t.charAt(0))};if(null==n.types[r.type])return d("unknown packet type "+r.type);if(n.BINARY_EVENT===r.type||n.BINARY_ACK===r.type){for(var o="";"-"!==t.charAt(++i)&&(o+=t.charAt(i),i!=t.length););if(o!=Number(o)||"-"!==t.charAt(i))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===t.charAt(i+1))for(r.nsp="";++i;){if(","===(a=t.charAt(i)))break;if(r.nsp+=a,i===t.length)break}else r.nsp="/";var c=t.charAt(i+1);if(""!==c&&Number(c)==c){for(r.id="";++i;){var a;if(null==(a=t.charAt(i))||Number(a)!=a){--i;break}if(r.id+=t.charAt(i),i===t.length)break}r.id=Number(r.id)}if(t.charAt(++i)){var u=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(i));if(!(!1!==u&&(r.type===n.ERROR||s(u))))return d("invalid payload");r.data=u}return e("decoded %s as %j",t,r),r}(t),n.BINARY_EVENT===i.type||n.BINARY_ACK===i.type?(this.reconstructor=new l(i),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",i)):this.emit("decoded",i);else{if(!c(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(i=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",i))}},f.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},l.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var n=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null},l.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,n){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,n,i){(function(n){var e=i(42);t.exports=function(t){var i=t.xdomain,r=t.xscheme,o=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!i||e))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!r&&o)return new XDomainRequest}catch(t){}if(!i)try{return new(n[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}).call(this,i(0))},function(t,n,i){var e=i(5),r=i(4);function o(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}t.exports=o,r(o.prototype),o.prototype.onError=function(t,n){var i=new Error(t);return i.type="TransportError",i.description=n,this.emit("error",i),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(t){var n=e.decodePacket(t,this.socket.binaryType);this.onPacket(n)},o.prototype.onPacket=function(t){this.emit("packet",t)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,n,i){const{Socket:e,Server:r}=i(3),{nextTick:o,readString:s,str2ab:c,ab2str:a,make4Len16:u,appendBuffer:h,hex2b64:f,showNotification:l}=i(1),d=i(18),v=i(19);let p;function y(t){this.socket=t,this.zero_mask=(1<<30)-1,this.type="tcp",t.onClose=function(){var t=this.currentRead;t&&(delete this.currentRead,t({resultCode:-1}))}.bind(this)}function w(t,n){this.onConnected=n,this.transport=t,this.currentSocketId=0,this.sockets={},this.forwards={},this.maxPayload=w.MAX_PAYLOAD}function m(t){var n={};"String"!=t.constructor.name&&(t=a(t));var i=t.replace("device::","").split(";");for(var e in i){var r=(e=i[e]).split("=");2==r.length&&(n[r[0]]=r[1])}return n}function g(t,n,i){i||(i=function(){}),this.device=t,this.localId=n,this.onConnected=i}function b(t){var n=(t=t||{}).port||5037,i=!1!==t.start;this.currentSocketId=1,this.pendingDevices={},this.port=n,this.adbDevices={},this.clients={},i&&this.start()}function k(t,n){this.server=t,this.socket=n}p=window.chrome&&window.chrome.usb?d.getUserSelectedDevices:v.getUserSelectedDevices,y.prototype.destroy=function(){this.socket.destroy()},y.prototype.write=function(t,n){if(this.writing)return this.pendingWrites||(this.pendingWrites=[]),void this.pendingWrites.push({data:t,callback:n});this.writing=!0,this.socket.write(t,function(){if(this.writing=!1,n({resultCode:0}),this.pendingWrites){var t=this.pendingWrites.shift();this.pendingWrites.length||(this.pendingWrites=null),this.write(t.data,t.callback)}}.bind(this))},y.prototype.read=function(t,n){this.currentRead=n,this.socket.read(t,(function(t){delete this.currentRead,n({resultCode:0,data:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)})}))},w.prototype.fatal=function(t){console.log("fatal error",JSON.stringify(t));var n=this.onConnected;n?(delete this.onConnected,n()):this.onError&&(this.onError(),delete this.onError),this.destroy()},w.prototype.destroy=function(){for(var t in this.sockets)(t=this.sockets[t]).dataReceived(null);this.forwards&&$.each(this.forwards,(function(t,n){n.destroy()})),this.transport.destroy()},w.kCommandSYNC=1129208147,w.kCommandCNXN=1314410051,w.kCommandOPEN=1313165391,w.kCommandOKAY=1497451343,w.kCommandCLSE=1163086915,w.kCommandWRTE=1163154007,w.kCommandAUTH=1213486401,w.kAuthToken=1,w.kAuthSignature=2,w.kAuthRSAPublicKey=3,w.ADB_PROTOCOL_VERSION=16777216,w.ADB_VERSION=40,w.MAX_PAYLOAD=4096,w.checksum=function(t){t=new Uint8Array(t);for(var n=0,i=0;i<t.byteLength;i++)n+=t[i];return 4294967295&n},w.prototype.sendMessage=function(t,n,i,e,r){e||(e=""),"String"==e.constructor.name&&(e=c(e));var o=!0;e.byteLength||(o=!1),t==w.kCommandAUTH&&n==w.kAuthSignature&&(o=!1),t==w.kCommandWRTE&&(o=!1);var s=e.byteLength;if(o&&s++,o){var a=new ArrayBuffer(e.byteLength+1);(u=new Uint8Array(a)).set(new Uint8Array(e)),u[a.byteLength-1]=0,e=a}var u,h=new ArrayBuffer(24);(u=new DataView(h)).setUint32(0,t,!0),u.setUint32(4,n,!0),u.setUint32(8,i,!0),u.setUint32(12,s,!0),u.setUint32(16,w.checksum(e),!0),u.setUint32(20,4294967295^t,!0),this.transport.write(h,function(t){t.resultCode&&this.fatal(t),!e.byteLength&&r&&r()}.bind(this)),e.byteLength&&this.transport.write(e,function(t){t.resultCode&&this.fatal(t),r&&r()}.bind(this))},w.prototype.getKey=function(t){if(window.chrome&&window.chrome.storage)chrome.storage.local.get("adbkey",(function(n){var i=n.adbkey,e=new JSEncrypt({default_key_size:2048});i?e.setPrivateKey(i):(i=e.getPrivateKeyB64(),e.setPrivateKey(i),chrome.storage.local.set({adbkey:i})),t(e)}));else{var n=new JSEncrypt({default_key_size:2048});try{var i=localStorage.getItem("adbkey");if(!i)throw new Error;var e=JSON.parse(i);n.setPrivateKey(e)}catch(t){e=n.getPrivateKeyB64(),n.setPrivateKey(e),localStorage.setItem("adbkey",JSON.stringify(e))}o(()=>t(n))}},w.prototype._convertToMinCrypt=function(t){var n=BigInteger.ONE.shiftLeft(32),i=t.n.clone(),e=BigInteger.ONE.shiftLeft(1).pow(2048),r=e.multiply(e).mod(i),o=new Uint32Array(131);o[0]=64,o[1]=n.subtract(i.modInverse(n)).intValue();for(var s=2,c=66;s<66;++s,++c)o[s]=i.mod(n).intValue(),i=i.divide(n),o[c]=r.mod(n).intValue(),r=r.divide(n);o[o.length-1]=t.e;var a="",u=new Uint8Array(o.buffer);for(s=0;s<u.length;++s){var h=u[s].toString(16);1==h.length&&(a+="0"),a+=h}return f(a)+" adb@chrome"},w.prototype.sign=function(t,n){if(null==t)throw"AuthManager is not initialized";var i=new Uint8Array(256);i[0]=0,i[1]=1;for(var e=[0,48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],r=256-e.length-n.byteLength,o=2;o<r;o++)i[o]=255;i.set(new Uint8Array(e),r),r+=e.length,i.set(new Uint8Array(n),r);var s=new BigInteger(Array.apply([],i));return new Uint8Array(t.doPrivate(s).toByteArray()).buffer},w.parseConnectionPayload=m,w.prototype.handleUnknown=function(t,n){console.log("no idea what this socket is."),this.sendMessage(w.kCommandCLSE,t,n)},w.prototype.handleMessage=function(t,n){var i=t.getUint32(0,!0),e=t.getUint32(4,!0),r=t.getUint32(8,!0);switch(i){case w.kCommandOPEN:this.onOpenSocket&&this.onOpenSocket(n,e);break;case w.kCommandAUTH:console.log("auth:",this),this.getKey(function(t){if(this.sentSignature){var i=this._convertToMinCrypt(t.getKey());this.sendMessage(w.kCommandAUTH,w.kAuthRSAPublicKey,0,i),l('Check your Android device and click "Allow USB Debugging".')}else{this.sentSignature=!0;var e=this.sign(t.getKey(),n);this.sendMessage(w.kCommandAUTH,w.kAuthSignature,0,e,(function(){}))}}.bind(this));break;case w.kCommandOKAY:var o=e,s=r;if(!(u=this.sockets[s]))return void this.handleUnknown(s,o);(h=u.onConnected)&&(delete u.onConnected,u.remoteId=o,h(u));var c=u.pendingWrite;if(c)return h=u.wrote,delete u.wrote,delete u.pendingWrite,void u.write(c,h);(h=u.wrote)&&(delete u.wrote,h());break;case w.kCommandCNXN:this.rawProperties=a(n),this.properties=m(n),(h=this.onConnected)&&(delete this.onConnected,h(this));break;case w.kCommandWRTE:o=e,s=r;if(!(u=this.sockets[s]))return void this.handleUnknown(s,o);u.paused||this.sendMessage(w.kCommandOKAY,u.localId,u.remoteId),u.dataReceived(new Uint8Array(n));break;case w.kCommandCLSE:var u,h;o=e,s=r;if(!(u=this.sockets[s]))return void console.log("asked to close unknown socket?");delete this.sockets[s],u.destroy(),(h=u.onConnected)&&(delete u.onConnected,h());break;default:console.log("unknown command: ",i.toString(16),e,r,n)}},w.prototype.onReceiveMessage=function(t){if(t.resultCode)this.fatal(t);else{var n=new DataView(t.data),i=n.getUint32(12,!0);if(i)this.transport.read(i,function(t){if(t.resultCode)this.fatal(t);else{var i=t.data;if(w.checksum(i)==n.getUint32(16,!0))try{this.handleMessage(n,i)}finally{this.receiveMessages()}else this.receiveMessages()}}.bind(this));else try{this.handleMessage(n,null)}finally{this.receiveMessages()}}},w.prototype.receiveMessages=function(){this.transport.read(24,this.onReceiveMessage.bind(this))},w.prototype.forwardPort=function(t){var n=new r;n.listen({port:t.fromPort,address:"127.0.0.1"},function(n){this.newSocket(t.to,function(t){t?e.stream(n,t):n.destroy()}.bind(this))}.bind(this),function(){this.forwards[t.fromPort]=n}.bind(this))},w.prototype.newAdbSocket=function(t,n){return this.createSocket?this.createSocket(t,n):new g(this,t,n)},w.prototype.newSocket=function(t,n){var i=++this.currentSocketId;this.sockets[i]=this.newAdbSocket(i,n),this.sendMessage(w.kCommandOPEN,i,0,t)},g.prototype.write=function(t,n){if(this.pendingWrite||this.wrote)throw console.log("bad adb socket state, already writing"),new Error("bad adb socket state, already writing");var i=Math.min(this.device.transport.zero_mask,this.device.maxPayload);i<t.byteLength?(this.pendingWrite=t.slice(i),t=t.slice(0,i)):this.pendingWrite=null,this.wrote=n,this.device.sendMessage(w.kCommandWRTE,this.localId,this.remoteId,t)},g.prototype.destroy=function(){this.device.sendMessage(w.kCommandCLSE,this.localId,this.remoteId),this.dataReceived(null)},g.prototype.buffered=e.prototype.buffered,g.prototype.dataReceived=e.prototype.dataReceived,g.prototype.read=e.prototype.read,g.prototype.pause=e.prototype.pause,g.prototype.resume=e.prototype.resume,g.prototype.unshift=e.prototype.unshift,g.prototype.onPause=function(){},g.prototype.onResume=function(){this.device.sendMessage(w.kCommandOKAY,this.localId,this.remoteId)},b.prototype.onOpenSocket=function(t,n){var i=this,r=a(t).split(":"),o=Number.parseInt(r[1]);e.connect({host:"127.0.0.1",port:o},(function(t){if(t){var r=++i.currentSocketId,o=i.newAdbSocket(r);o.remoteId=n,i.sockets[r]=o,i.sendMessage(w.kCommandOKAY,r,n),e.stream(t,o)}else i.sendMessage(w.kCommandOKAY,0,n)}))},b.prototype.start=function(){if(this.server)console.log("ADB Server started while already started");else{this.clients={},this.adbDevices={},this.pendingDevices={},this.refreshing={};var t=new r;this.dummyListen||t.listen({port:this.port,address:"127.0.0.1"},function(t){var n=new k(this,t),i=++this.currentSocketId;this.clients[i]=n,t.onClose=function(){delete this.clients[i]}.bind(this),n.receiveHeader()}.bind(this),function(n){n?console.log("adb server failed to listen: "+n):(console.log("ADB Server started"),this.server=t)}.bind(this))}},b.prototype.isRunning=function(){return null!=this.server},b.prototype.kill=function(){for(var t in this.server.destroy(),this.server=null,this.refreshing={},this.clients)(t=this.clients[t]).socket.destroy();for(var n in this.clients={},this.adbDevices)(n=this.adbDevices[n]).destroy();this.adbDevices={},this.pendingDevices={}},b.prototype.withAdbDevice=function(t,n){t.onError=function(){delete this.adbDevices[t.serialno],this.internalOnDevicesChanged()}.bind(this);var i=function(i){t.serialno=i.trim(),this.adbDevices[t.serialno]=t,console.log("found device: "+t.serialno),this.internalOnDevicesChanged(),n(t)}.bind(this);t.serialno?i(t.serialno):t.newSocket("shell:getprop ro.serialno",function(t){s(t,function(t){i(t)}.bind(this))}.bind(this))},b.prototype.tryDevice=function(t,n){var i=t.serialno,e=this.pendingDevices,r=this;function o(o){console.log("trying intrface",o);var s=o.interfaceNumber;return!e[s]&&(e[s]=t,console.log("claiming:",JSON.stringify(o)),t.claimInterface(o.interfaceNumber).then(()=>{console.log("claimed interface"),function(t,n,i){console.log("connecting");var e=new w(t.newTransport(n),i);console.log("sending CNXN"),e.sendMessage(w.kCommandCNXN,w.ADB_PROTOCOL_VERSION,w.MAX_PAYLOAD,"host::"),console.log("starting receive loop"),e.receiveMessages()}(t,o,(function(t){if(console.log("usb adb connected"),!t)return delete e[s],void n();t.serialno=i,t.onOpenSocket=r.onOpenSocket,r.withAdbDevice(t,(function(t){delete e[s],n(t)}))}))}).catch(t=>{console.log("unable claim interface",JSON.stringify(t))}),!0)}t.listInterfaces().then(n=>{console.log("got interfaces",JSON.stringify(n));var i=!1;for(var e in n)255==(e=n[e]).interfaceClass&&66==e.interfaceSubclass&&1==e.interfaceProtocol&&(i|=o(e));i||t.close()}).catch(t=>{console.log("unable list interfaces",t),n&&n()})},b.prototype.refreshDevice=function(t,n){t.open().then(()=>{this.start(),console.log("opened "+t.serialNumber),this.tryDevice(t,i=>{console.log("try device done",i),i&&(i.usbDevice=t.device),n(i)})}).catch(t=>{console.log("unable to open device",JSON.stringify(t)),n()})},b.prototype.internalOnDevicesChanged=function(){for(var t in this.clients)if((t=this.clients[t]).tracking){var n=t.getDevicesString();n.length||(n="0000\n"),t.socket.write(c(n),(function(){}))}},b.prototype.stop=function(){this.server.destroy()},k.prototype.resolveTransport=function(t,n){if(n){var i=this.server.adbDevices[n];return i||"device not found"}var e=Object.keys(this.server.adbDevices);if(e>1)return"more than one device";if(0==e)return"no devices connected";for(var r in this.server.adbDevices)return this.server.adbDevices[r]},k.prototype.write=function(t,n,i){n||(n="OKAY");var e=(t=c(t)).byteLength,r=u(e);r=c(n+r);var o=h(new Uint8Array(r),new Uint8Array(t)).buffer;i||(i=function(){this.socket.destroy()}.bind(this)),this.socket.write(o,i)},k.prototype.getDevicesString=function(t){var n=(t=t||{}).longformDevices,i="";for(var e in this.server.adbDevices)i+=(e=this.server.adbDevices[e]).serialno+"\tdevice",n&&("usb"==e.transport.type?i+=" usb:"+e.transport.iface.interfaceNumber:i+=" tpcip:something",i+=" product:"+e.properties["ro.product.name"],i+=" model:"+e.properties["ro.product.model"],i+=" device:"+e.properties["ro.product.device"]),i+="\n";return i},k.prototype.writeDevices=function(t,n){this.write(this.getDevicesString(t),null,n)},k.prototype.handlePayload=function(t){var n=(t=a(t)).split(":"),i=t;switch("host-serial"==n[0]&&(n[0]="host",b=n.splice(1,1)[0],Number.isInteger(parseInt(n[1]))&&(b+=":"+n.splice(1,1)[0])),n.length>=2&&(i=n[0]+":"+n[1]),i){case"host:version":this.write(u(w.ADB_VERSION));break;case"host:devices-l":case"host:devices":var r="host:devices-l"==t;this.writeDevices({longformDevices:r});break;case"host:features":if("String"==(g=this.resolveTransport(t,b)).constructor.name){this.write(g,"FAIL");break}var o=g.properties.features;o||(o=""),this.write(u(o));break;case"host:transport-usb":case"host:transport-any":if("String"==(g=this.resolveTransport(t,b)).constructor.name){this.write(g,"FAIL");break}this.transport=g,this.socket.write(c("OKAY"),(function(){}));break;case"host:kill":this.server.kill();break;case"host:disconnect":if(n.length>4){this.write("host:disconnect only takes 1 argument","FAIL");break}if(n.length>2)if((d=n[2]).length){var s=5555;n.length>3&&(s=Number.parseInt(n[3]));var h=d+":"+s;(f=this.server.adbDevices[h])&&"tcp"==f.transport.type&&f.destroy(),this.write("disconnected");break}for(var f in this.server.adbDevices)"tcp"==(f=this.server.adbDevices[f]).transport.type&&f.destroy();this.write("disconnected");break;case"host:connect":if(n.length<3){this.write("need more arguments for connect <host>[:<port>]","FAIL");break}var d=n[2];s=5555;n.length>3&&(s=Number.parseInt(n[3])),e.connect({host:d,port:s},function(t,n){if(!t)return console.error("connect failed"),this.write("unable to connect to "+d+" "+s+": "+n,"FAIL"),this;var i=new w(new y(t),function(t){this.server.withAdbDevice(t,function(){var t="connected to "+d+":"+s;console.log(t),this.write(t)}.bind(this))}.bind(this));i.onOpenSocket=this.onOpenSocket,i.serialno=d+":"+s,t.onClose=function(){i.fatal("socket closed")}.bind(this),i.sendMessage(w.kCommandCNXN,w.ADB_PROTOCOL_VERSION,w.MAX_PAYLOAD,"host::"),i.receiveMessages()}.bind(this));break;case"host:track-devices":this.tracking=(new Date).getTime(),this.writeDevices({},(function(){}));break;case"host:forward":var v=n.join(":").substring(i.length+1).split(";"),p=v[0].split(":"),m=parseInt(p[1]);if("String"==(g=this.resolveTransport(t,b)).constructor.name){this.write(g,"FAIL");break}g.forwardPort({fromPort:m,to:v[1]}),this.socket.write(c("OKAYOKAY"),function(){}.bind(this));break;default:var g;if(this.transport)return void(g=this.transport).newSocket(t,function(t){t?(this.socket.write(c("OKAY"),(function(){})),e.stream(t,this.socket)):this.socket.write(c("OKAY"),function(){this.socket.destroy()}.bind(this))}.bind(this));if(t.startsWith("host:transport:")){var b=t.substr("host:transport:".length);if(!(f=this.server.adbDevices[b]))return void this.write("device not found","FAIL");this.transport=f,this.socket.write(c("OKAY"),(function(){}));break}console.log("unknown request: "+t),this.write("unknown command: "+t,"FAIL"),l(appName+"'s adb server encountered an unknown adb command.\nYou may want to close "+appName+" and start your adb binary manually.")}this.receiveHeader()},k.prototype.receivePayload=function(t){var n=parseInt(a(t),16);this.socket.read(n,this.handlePayload.bind(this))},k.prototype.receiveHeader=function(){this.socket.read(4,this.receivePayload.bind(this))},n.AdbDevice=w,n.AdbServer=b,n.AdbTcpTransport=y,n.getUserSelectedDevices=p},function(t,n,i){"use strict";n.byteLength=function(t){var n=u(t),i=n[0],e=n[1];return 3*(i+e)/4-e},n.toByteArray=function(t){var n,i,e=u(t),s=e[0],c=e[1],a=new o(function(t,n,i){return 3*(n+i)/4-i}(0,s,c)),h=0,f=c>0?s-4:s;for(i=0;i<f;i+=4)n=r[t.charCodeAt(i)]<<18|r[t.charCodeAt(i+1)]<<12|r[t.charCodeAt(i+2)]<<6|r[t.charCodeAt(i+3)],a[h++]=n>>16&255,a[h++]=n>>8&255,a[h++]=255&n;2===c&&(n=r[t.charCodeAt(i)]<<2|r[t.charCodeAt(i+1)]>>4,a[h++]=255&n);1===c&&(n=r[t.charCodeAt(i)]<<10|r[t.charCodeAt(i+1)]<<4|r[t.charCodeAt(i+2)]>>2,a[h++]=n>>8&255,a[h++]=255&n);return a},n.fromByteArray=function(t){for(var n,i=t.length,r=i%3,o=[],s=0,c=i-r;s<c;s+=16383)o.push(h(t,s,s+16383>c?c:s+16383));1===r?(n=t[i-1],o.push(e[n>>2]+e[n<<4&63]+"==")):2===r&&(n=(t[i-2]<<8)+t[i-1],o.push(e[n>>10]+e[n>>4&63]+e[n<<2&63]+"="));return o.join("")};for(var e=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,a=s.length;c<a;++c)e[c]=s[c],r[s.charCodeAt(c)]=c;function u(t){var n=t.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=n),[i,i===n?0:4-i%4]}function h(t,n,i){for(var r,o,s=[],c=n;c<i;c+=3)r=(t[c]<<16&16711680)+(t[c+1]<<8&65280)+(255&t[c+2]),s.push(e[(o=r)>>18&63]+e[o>>12&63]+e[o>>6&63]+e[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,n){n.read=function(t,n,i,e,r){var o,s,c=8*r-e-1,a=(1<<c)-1,u=a>>1,h=-7,f=i?r-1:0,l=i?-1:1,d=t[n+f];for(f+=l,o=d&(1<<-h)-1,d>>=-h,h+=c;h>0;o=256*o+t[n+f],f+=l,h-=8);for(s=o&(1<<-h)-1,o>>=-h,h+=e;h>0;s=256*s+t[n+f],f+=l,h-=8);if(0===o)o=1-u;else{if(o===a)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,e),o-=u}return(d?-1:1)*s*Math.pow(2,o-e)},n.write=function(t,n,i,e,r,o){var s,c,a,u=8*o-r-1,h=(1<<u)-1,f=h>>1,l=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=e?0:o-1,v=e?1:-1,p=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(c=isNaN(n)?1:0,s=h):(s=Math.floor(Math.log(n)/Math.LN2),n*(a=Math.pow(2,-s))<1&&(s--,a*=2),(n+=s+f>=1?l/a:l*Math.pow(2,1-f))*a>=2&&(s++,a/=2),s+f>=h?(c=0,s=h):s+f>=1?(c=(n*a-1)*Math.pow(2,r),s+=f):(c=n*Math.pow(2,f-1)*Math.pow(2,r),s=0));r>=8;t[i+d]=255&c,d+=v,c/=256,r-=8);for(s=s<<r|c,u+=r;u>0;t[i+d]=255&s,d+=v,s/=256,u-=8);t[i+d-v]|=128*p}},function(t,n){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,n,i){const{Socket:e,Server:r}=i(3),{str2ab:o,ab2str:s,make4Len16:c,appendBuffer:a,hex2b64:u,showNotification:h}=i(1);class f{constructor(t){this.device=t}get vendorId(){return this.device.vendorId}get productId(){return this.device.productId}get serialNumber(){return this.device.serialNumber}claimInterface(t){return new Promise((n,i)=>{chrome.usb.claimInterface(this.connectionHandle,t,()=>{var t=chrome.runtime.lastError;t?i(t):n()})})}listInterfaces(){return new Promise((t,n)=>{chrome.usb.listInterfaces(this.connectionHandle,i=>{i?t(i):n(chrome.runtime.lastError)})})}open(){return new Promise((t,n)=>{chrome.usb.openDevice(this.device,i=>{this.connectionHandle=i,i?(console.log("opened adb"),t()):n(chrome.runtime.lastError)})})}close(){chrome.usb.closeDevice(this.connectionHandle)}newTransport(t){return new l(this.connectionHandle,t)}}function l(t,n){for(var i in this.handle=t,this.iface=n,this.type="usb",n.endpoints)"bulk"==(i=n.endpoints[i]).type&&(this.zero_mask=i.maximumPacketSize-1,"in"==i.direction?this.in=i:this.out=i)}l.prototype.destroy=function(){chrome.usb.releaseInterface(this.handle,this.iface.interfaceNumber,function(){chrome.runtime.lastError,chrome.usb.closeDevice(this.handle,(function(){chrome.runtime.lastError}))}.bind(this))},l.prototype.write=function(t,n){if(this.writing)return this.pendingWrites||(this.pendingWrites=[]),void this.pendingWrites.push({data:t,callback:n});var i={direction:"out",endpoint:this.out.address,data:t};this.writing=!0,chrome.usb.bulkTransfer(this.handle,i,function(t){if(chrome.runtime.lastError,this.writing=!1,n(t),this.pendingWrites){var i=this.pendingWrites.shift();this.pendingWrites.length||(this.pendingWrites=null),this.write(i.data,i.callback)}}.bind(this))},l.prototype.read=function(t,n){var i={direction:"in",endpoint:this.in.address,length:t};chrome.usb.bulkTransfer(this.handle,i,(function(t){chrome.runtime.lastError,n(t)}))},n.getUserSelectedDevices=function(){return new Promise((t,n)=>{chrome.usb.getUserSelectedDevices({filters:[{interfaceClass:255,interfaceSubclass:66,interfaceProtocol:1}]},(function(n){t(n.map(t=>new f(t)))}))})}},function(t,n){class i{constructor(t){this.device=t}get vendorId(){return this.device.vendorId}get productId(){return this.device.productId}get serialNumber(){return this.device.serialNumber}async open(){await this.device.open()}async close(){await this.device.close()}async claimInterface(t){return await this.device.claimInterface(t)}async listInterfaces(){return null===this.device.configuration&&await this.device.selectConfiguration(1),this.device.configuration.interfaces.map(t=>{let n=t.alternate||t.alternates[0],{interfaceClass:i,interfaceName:e,interfaceProtocol:r,interfaceSubclass:o,endpoints:s}=n;return{interfaceNumber:t.interfaceNumber,interfaceClass:i,interfaceName:e,interfaceProtocol:r,interfaceSubclass:o,endpoints:s}})}newTransport(t){return new e(this.device,t)}}class e{constructor(t,n){for(var i of(this.device=t,this.iface=n,n.endpoints))"bulk"==i.type&&(this.zero_mask=i.packetSize-1,"in"==i.direction?this.in=i:this.out=i)}destroy(){this.device.releaseInterface(iface.interfaceNumber)}async write(t,n){if(this.writing)return this.pendingWrites||(this.pendingWrites=[]),void this.pendingWrites.push({data:t,callback:n});var i;this.writing=!0;try{i=await this.device.transferOut(this.out.endpointNumber,t)}catch(t){i={resultCode:t}}finally{this.writing=!1}if(n(i),this.pendingWrites){var e=this.pendingWrites.shift();this.pendingWrites.length||(this.pendingWrites=null),this.write(e.data,e.callback)}}async read(t,n){var i;try{i={data:(i=await this.device.transferIn(this.in.endpointNumber,t)).data.buffer}}catch(t){i={resultCode:t}}n(i)}}n.getUserSelectedDevices=async function(){let t=await navigator.usb.requestDevice({filters:[{classCode:255,subclassCode:66,protocolCode:1}]});return[new i(t)]}},function(t,n,i){const{Socket:e}=i(3);function r(t){t&&(this.dataReceived(t),this.dataReceived(null))}r.prototype.write=function(t,n){throw new Error("write not supported on dummy socket")},r.prototype.destroy=function(){this.dataReceived(null)},r.prototype.buffered=e.prototype.buffered,r.prototype.unshift=e.prototype.unshift,r.prototype.dataReceived=e.prototype.dataReceived,r.prototype.read=e.prototype.read,r.prototype.pause=e.prototype.pause,r.prototype.resume=e.prototype.resume,r.prototype.buffered=e.prototype.buffered,r.prototype.onPause=function(){},r.prototype.onResume=function(){},t.exports=r},function(t,n){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var n=t,r=t.indexOf("["),o=t.indexOf("]");-1!=r&&-1!=o&&(t=t.substring(0,r)+t.substring(r,o).replace(/:/g,";")+t.substring(o,t.length));for(var s=i.exec(t||""),c={},a=14;a--;)c[e[a]]=s[a]||"";return-1!=r&&-1!=o&&(c.source=n,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c}},function(t,n,i){(function(n){t.exports=function(t){return i&&n.Buffer.isBuffer(t)||e&&(t instanceof n.ArrayBuffer||r(t))};var i="function"==typeof n.Buffer&&"function"==typeof n.Buffer.isBuffer,e="function"==typeof n.ArrayBuffer,r=e&&"function"==typeof n.ArrayBuffer.isView?n.ArrayBuffer.isView:function(t){return t.buffer instanceof n.ArrayBuffer}}).call(this,i(0))},function(t,n,i){var e=i(40),r=i(29),o=i(4),s=i(10),c=i(30),a=i(31),u=i(2)("socket.io-client:manager"),h=i(28),f=i(54),l=Object.prototype.hasOwnProperty;function d(t,n){if(!(this instanceof d))return new d(t,n);t&&"object"==typeof t&&(n=t,t=void 0),(n=n||{}).path=n.path||"/socket.io",this.nsps={},this.subs=[],this.opts=n,this.reconnection(!1!==n.reconnection),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor(n.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==n.timeout?2e4:n.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var i=n.parser||s;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=!1!==n.autoConnect,this.autoConnect&&this.open()}t.exports=d,d.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)l.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},d.prototype.updateSocketIds=function(){for(var t in this.nsps)l.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},d.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},o(d.prototype),d.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},d.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},d.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(t,n){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=e(this.uri,this.opts);var i=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=c(i,"open",(function(){r.onopen(),t&&t()})),s=c(i,"error",(function(n){if(u("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",n),t){var i=new Error("Connection error");i.data=n,t(i)}else r.maybeReconnectOnOpen()}));if(!1!==this._timeout){var a=this._timeout;u("connect attempt will timeout after %d",a);var h=setTimeout((function(){u("connect attempt timed out after %d",a),o.destroy(),i.close(),i.emit("error","timeout"),r.emitAll("connect_timeout",a)}),a);this.subs.push({destroy:function(){clearTimeout(h)}})}return this.subs.push(o),this.subs.push(s),this},d.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(c(t,"data",a(this,"ondata"))),this.subs.push(c(t,"ping",a(this,"onping"))),this.subs.push(c(t,"pong",a(this,"onpong"))),this.subs.push(c(t,"error",a(this,"onerror"))),this.subs.push(c(t,"close",a(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",a(this,"ondecoded")))},d.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},d.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},d.prototype.ondata=function(t){this.decoder.add(t)},d.prototype.ondecoded=function(t){this.emit("packet",t)},d.prototype.onerror=function(t){u("error",t),this.emitAll("error",t)},d.prototype.socket=function(t,n){var i=this.nsps[t];if(!i){i=new r(this,t,n),this.nsps[t]=i;var e=this;i.on("connecting",o),i.on("connect",(function(){i.id=e.generateId(t)})),this.autoConnect&&o()}function o(){~h(e.connecting,i)||e.connecting.push(i)}return i},d.prototype.destroy=function(t){var n=h(this.connecting,t);~n&&this.connecting.splice(n,1),this.connecting.length||this.close()},d.prototype.packet=function(t){u("writing packet %j",t);var n=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),n.encoding?n.packetBuffer.push(t):(n.encoding=!0,this.encoder.encode(t,(function(i){for(var e=0;e<i.length;e++)n.engine.write(i[e],t.options);n.encoding=!1,n.processPacketQueue()})))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},d.prototype.cleanup=function(){u("cleanup");for(var t=this.subs.length,n=0;n<t;n++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(t){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var n=this.backoff.duration();u("will wait %dms before reconnect attempt",n),this.reconnecting=!0;var i=setTimeout((function(){t.skipReconnect||(u("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open((function(n){n?(u("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",n.data)):(u("reconnect success"),t.onreconnect())})))}),n);this.subs.push({destroy:function(){clearTimeout(i)}})}},d.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,n,i){(function(t){var e=i(12),r=i(43),o=i(50),s=i(51);n.polling=function(n){var i=!1,s=!1,c=!1!==n.jsonp;if(t.location){var a="https:"===location.protocol,u=location.port;u||(u=a?443:80),i=n.hostname!==location.hostname||u!==n.port,s=n.secure!==a}if(n.xdomain=i,n.xscheme=s,"open"in new e(n)&&!n.forceJSONP)return new r(n);if(!c)throw new Error("JSONP disabled");return new o(n)},n.websocket=s}).call(this,i(0))},function(t,n,i){var e=i(13),r=i(7),o=i(5),s=i(8),c=i(27),a=i(2)("engine.io-client:polling");t.exports=h;var u=null!=new(i(12))({xdomain:!1}).responseType;function h(t){var n=t&&t.forceBase64;u&&!n||(this.supportsBinary=!1),e.call(this,t)}s(h,e),h.prototype.name="polling",h.prototype.doOpen=function(){this.poll()},h.prototype.pause=function(t){var n=this;function i(){a("paused"),n.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var e=0;this.polling&&(a("we are currently polling - waiting to pause"),e++,this.once("pollComplete",(function(){a("pre-pause polling complete"),--e||i()}))),this.writable||(a("we are currently writing - waiting to pause"),e++,this.once("drain",(function(){a("pre-pause writing complete"),--e||i()})))}else i()},h.prototype.poll=function(){a("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},h.prototype.onData=function(t){var n=this;a("polling got data %s",t);o.decodePayload(t,this.socket.binaryType,(function(t,i,e){if("opening"===n.readyState&&n.onOpen(),"close"===t.type)return n.onClose(),!1;n.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():a('ignoring poll - transport state "%s"',this.readyState))},h.prototype.doClose=function(){var t=this;function n(){a("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(a("transport open - closing"),n()):(a("transport not open - deferring close"),this.once("open",n))},h.prototype.write=function(t){var n=this;this.writable=!1;var i=function(){n.writable=!0,n.emit("drain")};o.encodePayload(t,this.supportsBinary,(function(t){n.doWrite(t,i)}))},h.prototype.uri=function(){var t=this.query||{},n=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||t.sid||(t.b64=1),t=r.encode(t),this.port&&("https"===n&&443!==Number(this.port)||"http"===n&&80!==Number(this.port))&&(i=":"+this.port),t.length&&(t="?"+t),n+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t}},function(t,n,i){(function(n){var e=i(11),r=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);t.exports=function t(i){if(!i||"object"!=typeof i)return!1;if(e(i)){for(var r=0,c=i.length;r<c;r++)if(t(i[r]))return!0;return!1}if("function"==typeof n&&n.isBuffer&&n.isBuffer(i)||"function"==typeof ArrayBuffer&&i instanceof ArrayBuffer||o&&i instanceof Blob||s&&i instanceof File)return!0;if(i.toJSON&&"function"==typeof i.toJSON&&1===arguments.length)return t(i.toJSON(),!0);for(var a in i)if(Object.prototype.hasOwnProperty.call(i,a)&&t(i[a]))return!0;return!1}}).call(this,i(9).Buffer)},function(t,n,i){"use strict";var e,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o={},s=0,c=0;function a(t){var n="";do{n=r[t%64]+n,t=Math.floor(t/64)}while(t>0);return n}function u(){var t=a(+new Date);return t!==e?(s=0,e=t):t+"."+a(s++)}for(;c<64;c++)o[r[c]]=c;u.encode=a,u.decode=function(t){var n=0;for(c=0;c<t.length;c++)n=64*n+o[t.charAt(c)];return n},t.exports=u},function(t,n){var i=[].indexOf;t.exports=function(t,n){if(i)return t.indexOf(n);for(var e=0;e<t.length;++e)if(t[e]===n)return e;return-1}},function(t,n,i){var e=i(10),r=i(4),o=i(53),s=i(30),c=i(31),a=i(2)("socket.io-client:socket"),u=i(7),h=i(26);t.exports=d;var f={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},l=r.prototype.emit;function d(t,n,i){this.io=t,this.nsp=n,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}r(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[s(t,"open",c(this,"onopen")),s(t,"packet",c(this,"onpacket")),s(t,"close",c(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},d.prototype.send=function(){var t=o(arguments);return t.unshift("message"),this.emit.apply(this,t),this},d.prototype.emit=function(t){if(f.hasOwnProperty(t))return l.apply(this,arguments),this;var n=o(arguments),i={type:(void 0!==this.flags.binary?this.flags.binary:h(n))?e.BINARY_EVENT:e.EVENT,data:n,options:{}};return i.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof n[n.length-1]&&(a("emitting packet with ack id %d",this.ids),this.acks[this.ids]=n.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this},d.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},d.prototype.onopen=function(){if(a("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?u.encode(this.query):this.query;a("sending connect packet with query %s",t),this.packet({type:e.CONNECT,query:t})}else this.packet({type:e.CONNECT})},d.prototype.onclose=function(t){a("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},d.prototype.onpacket=function(t){var n=t.nsp===this.nsp,i=t.type===e.ERROR&&"/"===t.nsp;if(n||i)switch(t.type){case e.CONNECT:this.onconnect();break;case e.EVENT:case e.BINARY_EVENT:this.onevent(t);break;case e.ACK:case e.BINARY_ACK:this.onack(t);break;case e.DISCONNECT:this.ondisconnect();break;case e.ERROR:this.emit("error",t.data)}},d.prototype.onevent=function(t){var n=t.data||[];a("emitting event %j",n),null!=t.id&&(a("attaching ack callback to event"),n.push(this.ack(t.id))),this.connected?l.apply(this,n):this.receiveBuffer.push(n)},d.prototype.ack=function(t){var n=this,i=!1;return function(){if(!i){i=!0;var r=o(arguments);a("sending ack %j",r),n.packet({type:h(r)?e.BINARY_ACK:e.ACK,id:t,data:r})}}},d.prototype.onack=function(t){var n=this.acks[t.id];"function"==typeof n?(a("calling ack %s with %j",t.id,t.data),n.apply(this,t.data),delete this.acks[t.id]):a("bad ack %s",t.id)},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)l.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){a("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(a("performing disconnect (%s)",this.nsp),this.packet({type:e.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},d.prototype.compress=function(t){return this.flags.compress=t,this},d.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,n){t.exports=function(t,n,i){return t.on(n,i),{destroy:function(){t.removeListener(n,i)}}}},function(t,n){var i=[].slice;t.exports=function(t,n){if("string"==typeof n&&(n=t[n]),"function"!=typeof n)throw new Error("bind() requires a function");var e=i.call(arguments,2);return function(){return n.apply(t,e.concat(i.call(arguments)))}}},function(t,n,i){const{Socket:e}=i(3),{ab2str:r,str2ab:o,make4Len16:s,readString:c}=i(1),a=i(20);var u={};function h(){}u.sendHostCommand=function(t,n){e.connect({host:"127.0.0.1",port:5037},(function(i){if(i){var e=t;t=s(t.length)+t,i.read(4,(function(t){var o=r(t);if("OKAY"!=o)return console.error("error in response to adb host command",e,o),i.destroy(),void n();i.read(4,(function(t){var e=r(t);0!=(t=parseInt(e,16))&&"OKAY"!=e?i.read(t,(function(t){n(i,t)})):n(i,new ArrayBuffer(0))}))})),i.write(o(t),(function(){}))}else n()}))},u.devices=function(t){var n={};function i(t){var i=t,e=(t=t.replace("\t"," ")).indexOf(" ");if(-1!=e){var r,o=t.substring(0,e);for(t=t.substring(e).trim();r!=t;)r=t,t=t.replace("  "," ");var s={},c=t.indexOf(" ");-1==c&&(c=t.length);var a,u=t.substring(0,c);for(t=t.substring(c+1);t.length&&-1!=(e=t.indexOf(":"));){var h,f=t.substring(0,e),l=t.substring(e+1),d=l.indexOf(" "),v=l.indexOf(":");if(-1==d||-1==v)h=l,t="";else for(;-1!=d&&d<v;)h=l.substring(0,d),t=l.substring(d+1),d=l.indexOf(" ",d+1);s[f]=h}a=s.model?s.model.replace("_"," "):o,n[o]={serialno:o,name:a,status:u,properties:i}}}u.sendHostCommand("host:devices-l",(function(e,o){if(e){e.destroy(),o=r(o),console.log("ADB devices:",o);var s=(o=o.trim()).split("\n");for(var c in s)i(c=s[c]);console.log("parsed ADB devices:",n),t(n)}else t()}))},u.killServer=function(t){u.sendHostCommand("host:kill-server",(function(n,i){n?(n.destroy(),i=r(i),t&&t()):t()}))},u.sendClientCommand=function(t,n){var i=t.command,c=t.serialno;e.connect({host:"127.0.0.1",port:5037},(function(t){if(t){t.read(4,(function(e){if("OKAY"!=r(e))return t.destroy(),void n(null);var c=i;c=s(c.length)+c,t.read(4,(function(i){if("OKAY"!=r(i))return t.destroy(),void n(null);n(t)})),t.write(o(c),(function(){}))}));var e="host:transport:"+c;e=s(e.length)+e,t.write(o(e),(function(){}))}else n()}))},u.shell=function(t,n){var i=t.command;t.serialno;u.getOrCreateSockFactory(t).newSocket("shell:"+i,(function(t){t?c(t,(function(t){n(t)})):n()}))},u.forward=function(t,n){var i="host-serial:"+t.serialno+":forward:"+t.from+";"+t.to;u.sendHostCommand(i,(function(t,i){t&&t.destroy(),n(t,i)}))},u.reverse=function(t,n){var i="reverse:forward:"+t.from+";"+t.to;u.sendClientCommand({serialno:t.serialno,command:i},(function(t,i){t?c(t,n):n()}))},h.MKID=function(t,n,i,e){return t.charCodeAt(0)|n.charCodeAt(0)<<8|i.charCodeAt(0)<<16|e.charCodeAt(0)<<24},h.ID_RECV=h.MKID("R","E","C","V"),h.ID_SEND=h.MKID("S","E","N","D"),h.ID_DONE=h.MKID("D","O","N","E"),h.ID_DATA=h.MKID("D","A","T","A"),h.DATA_MAX=65536,u.pull=function(t,n){var i,r=t.file,s=(t.serialno,t.fileEntry),c=t.socket;c||(c={write:function(t,n){i?(i.onwriteend=n,i.write(new Blob([t]))):s.createWriter((function(e){i=e,c.write(t,n)}))}});var f=new a;e.pump(f,c,(function(){n(s)})),u.getOrCreateSockFactory(t).newSocket("sync:",(function(t){if(t){var i=new ArrayBuffer(8),e=new DataView(i);e.setUint32(0,h.ID_RECV,!0),e.setUint32(4,r.length,!0),t.write(i,(function(){t.write(o(r),(function(){s()}))}))}else n();function s(){t.read(8,(function(i){var e=new DataView(i.buffer,i.byteOffset,i.byteLength),r=e.getUint32(0,!0);r!=h.ID_DATA?(t.destroy(),r!=h.ID_DONE?n():f.dataReceived(null)):function(n){t.read(n,(function(t){f.dataReceived(t),s()}))}(e.getUint32(4,!0))}))}}))},u.createSocketFactory=function(t){return{newSocket:function(n,i){u.sendClientCommand({serialno:t,command:n},i)}}},u.getOrCreateSockFactory=function(t){return t.socketFactory||u.createSocketFactory(t.serialno)},u.push=function(t,n){var i=t.file,e=(t.serialno,t.socket);u.getOrCreateSockFactory(t).newSocket("sync:",(function(t){if(t){var r=new ArrayBuffer(8),s=new DataView(r),c=i+",0644";s.setUint32(0,h.ID_SEND,!0),s.setUint32(4,c.length,!0),t.write(r,(function(){t.write(o(c),(function(){function i(){e.read((function(n){if(n.byteLength>h.DATA_MAX){var r=n.subarray(h.DATA_MAX);n=n.subarray(0,h.DATA_MAX),e.unshift(r)}!function(n){var e=new ArrayBuffer(8),r=new DataView(e);r.setUint32(0,h.ID_DATA,!0),r.setUint32(4,n.byteLength,!0),t.write(e,(function(){var e=n.buffer;(n.byteOffset||n.length!=e.byteLength)&&(e=e.slice(n.byteOffset,n.byteOffset+n.byteLength)),t.write(e,(function(){i()}))}))}(n)}))}e.onClose=function(){var i=new ArrayBuffer(8),e=new DataView(i);e.setUint32(0,h.ID_DONE,!0),e.setUint32(4,0,!0),t.write(i,(function(){t.read(8,(function(){n()}))}))},i()}))}))}else n()}))},t.exports=u},function(t,n,i){{let t=window.RTCSessionDescription||window.webkitRTCSessionDescription?window:require("wrtc");var e=t.RTCSessionDescription||t.webkitRTCSessionDescription,r=t.RTCPeerConnection||t.webkitRTCPeerConnection,o=t.RTCIceCandidate||t.webkitRTCIceCandidate}var s=i(3).Socket,c=i(34),{str2ab:a,ab2str:u,isNode:h}=i(1);function f(t,n){this.conn=t,this.dc=n,this.gotEof=!1,n.onmessage=function(t){var n=new Uint8Array(t.data),i=1==n[n.byteLength-1];this.dataReceived(n.subarray(0,n.byteLength-1)),i&&(this.gotEof=!0,this.destroy())}.bind(this),n.onclose=n.onerror=this.destroy.bind(this);try{this.needsBufferShim=h()||parseInt(/Chrome\/(\d\d)/.exec(navigator.userAgent)[1])<70}catch(t){}this.needsBufferShim||(n.bufferedAmountLowThreshold=0,n.onbufferedamountlow=this.writeable.bind(this))}function l(t,n,i){this.manager=t,this.peerConnection=n,this.key=i,this.peerConnection.oniceconnectionstatechange=function(){"disconnected"!=this.peerConnection.iceConnectionState&&"closed"!=this.peerConnection.iceConnectionState&&"failed"!=this.peerConnection.iceConnectionState||this.destroy()}.bind(this)}function d(t,n,i){this.senders=t,this.registrationId=n,this.rtcc=i,this.gcmRtcConnections={},this.gcmRtcListeners={},this.amazonTokens={}}f.prototype.buffered=s.prototype.buffered,f.prototype.unshift=s.prototype.unshift,f.prototype.dataReceived=s.prototype.dataReceived,f.prototype.read=s.prototype.read,f.prototype.pause=s.prototype.pause,f.prototype.resume=s.prototype.resume,f.prototype.buffered=s.prototype.buffered,f.prototype.writeable=function(){var t=this.writeCallback;t&&(delete this.writeCallback,t())},f.prototype.write=function(t,n){if(this.dc&&"open"==this.dc.readyState){this.writeCallback=n;var i=new Uint8Array(t.byteLength+1);if(i.set(new Uint8Array(t)),this.dc.send(i.buffer),!this.reentrantWrite)try{for(this.reentrantWrite=!0;this.writeCallback&&(0==this.dc.bufferedAmount||this.needsBufferShim);)this.writeable();this.writeCallback&&console.log("waiting for writable")}finally{this.reentrantWrite=!1}}else this.destroy()},f.prototype.destroy=function(){if(this.dataReceived(null),null!=this.dc){var t=this.dc;if(this.dc=null,t.onclose=null,t.onerror=null,"open"==t.readyState)try{t.send(new Uint8Array([1])),this.gotEof?this.conn.recycleChannel(t):this.conn.waitForEof(t)}catch(t){}}},l.prototype.waitForCommand=function(t){t.onmessage=function(n){if(1!=n.data.byteLength){this.removeChannel(t);var i=u(n.data),e=new f(this,t);this.openSocket(i,e)}}.bind(this)},l.prototype.compactChannels=function(){this.inboundChannels&&!this.inboundChannels.length&&(this.inboundChannels=null),this.outboundChannels&&!this.outboundChannels.length&&(this.outboundChannels=null)},l.prototype.getAppropriateChannels=function(t,n){var i;return t.inbound?(!this.inboundChannels&&n&&(this.inboundChannels=[]),i=this.inboundChannels):(!this.outboundChannels&&n&&(this.outboundChannels=[]),i=this.outboundChannels),i},l.prototype.removeChannel=function(t){if(channels=this.getAppropriateChannels(t),channels){var n=channels.indexOf(t);-1!=n&&(channels.splice(n,1),this.compactChannels())}},l.prototype.waitForEof=function(t){t.onmessage=function(n){var i=new Uint8Array(n.data);1==i[i.byteLength-1]&&this.recycleChannel(t)}.bind(this)},l.prototype.recycleChannel=function(t){this.getAppropriateChannels(t,!0).push(t),t.onclose=t.onerror=function(){this.removeChannel(t)}.bind(this),this.waitForCommand(t)},l.prototype.addCandidates=function(t){for(var n in t.candidates)console.log("remote candidate",t.candidates[n]),this.peerConnection.addIceCandidate(new o(t.candidates[n]))},l.prototype.setupPinger=function(t){var n;t.onmessage=function(t){},t.onclose=t.onerror=function(){clearTimeout(n),this.destroy()}.bind(this),function i(){t.send(a("ping")),n=setTimeout(i,1e3)}()},l.prototype.listenSockets=function(){this.peerConnection.ondatachannel=function(t){t.channel.inbound=!0,this.waitForCommand(t.channel)}.bind(this)},l.prototype.prepareChannel=function(t){var n=this.peerConnection.createDataChannel(t||"gcm",{ordered:!0});return n.binaryType="arraybuffer",n},l.prototype.newSocket=function(t,n){if("closed"!=this.peerConnection.signalingState)if(this.outboundChannels){var i=this.outboundChannels.shift();this.compactChannels(),i.send(a(t));var e=new f(this,i);n(e,this)}else{var r;(i=this.prepareChannel("gcm")).onopen=function(){if(!r){r=!0,i.send(a(t));var e=new f(this,i);n(e,this)}}.bind(this),"open"==i.readyState&&i.onopen()}else n()},l.prototype.destroy=function(){delete this.manager.gcmRtcConnections[this.key],"closed"!=this.peerConnection.signalingState&&this.peerConnection.close();var t=this.onClose;t&&(delete this.onClose,t())},d.prototype.onMessage=function(t){var n=JSON.parse(t.message),i=t.type,e=t.senderId,r=t.src,o=t.srcPort,s=t.dst||this.registrationId,c=t.dstPort;if("offer"!=i){if("answer"==i){var a=d.getKey(r,o,c),u=this.gcmRtcConnections[a];return u?void u.manager.incoming(e,r,o,s,c,n):(console.error("pending connection not found"),void console.error(t))}d.onUnknownMessage?d.onUnknownMessage(t):console.log("unknown message "+i)}else{var h=this.gcmRtcListeners[c];h?h.listener.incoming(e,r,o,s,c,n,h.listenCallback):console.log("not listening on "+c)}};var v,p=!1;try{p=!(!chrome||!chrome.gcm)}catch(t){}d.hasLoadedChannels=!1,d.start=function(t,n,e){if(console.log("starting GtcRtcManger"),p){var r=Object.keys(t);chrome.gcm.register(r,(function(i){if(chrome.runtime.lastError,i){var r=new d(t,i,n);chrome.gcm.onMessage.addListener((function(t){r.onMessage(t.data)})),e(r)}else e()}))}else{function o(t){var n=t("https://push.clockworkmod.com");n.on("registration",(function(t){t="web:"+t,s.registrationId?(s.registrationId=t,s.onRegistrationIdChanged&&s.onRegistrationIdChanged(t)):(s.registrationId=t,e(s))})),n.on("data",(function(t){s.onMessage(t)}))}var s=new d(t,null,n);if(h())o(i(35));else{c="https://push.clockworkmod.com/socket.io/socket.io.js",a=function(){o(io)},u=document.createElement("script"),f=document.getElementsByTagName("script")[0],u.async=1,u.onload=u.onreadystatechange=function(t,n){(n||!u.readyState||/loaded|complete/.test(u.readyState))&&(u.onload=u.onreadystatechange=null,u=void 0,n||a&&a())},u.src=c,f.parentNode.insertBefore(u,f)}}var c,a,u,f},d.prototype.wrapMessage=function(t,n,i,e,r,o,s){return{senderId:t,src:e,srcPort:r,dst:n,dstPort:i,type:o,message:JSON.stringify(s)}},d.prototype.sendGcm=function(t,n,i,e,r,o,s){var c=this.wrapMessage(t,n,i,e,r,o,s);return this.sendWrappedMessage(t,n,c)},d.prototype.sendWrappedMessage=function(t,n,i){if(t||(t=this.defaultSenderId),n.startsWith("web:"))return c(n.substring(4),{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}}).then(t=>t.json());if(n.startsWith("amzn")){var e;if(!this.amazonTokens[t]||this.amazonTokens[t].accessTokenExpiration<Date.now()){var r=this.senders[t];console.log(t,r);var o={grant_type:"client_credentials",scope:"messaging:push",client_id:t,client_secret:r},s=Object.entries(o).map(([t,n])=>`${encodeURIComponent(t)}=${encodeURIComponent(n)}`).join("&");e=c("https://api.amazon.com/auth/O2/token",{method:"POST",body:s,headers:{"Content-type":"application/x-www-form-urlencoded;charset=UTF-8"}}).then(t=>t.json()).then(n=>(this.amazonTokens[t]={},this.amazonTokens[t].accessToken=n.access_token,this.amazonTokens[t].accessTokenExpiration=Date.now()+n.expires_in-30,n.access_token))}else console.log("token valid for",this.amazonTokens[t].accessTokenExpiration-Date.now()),e=Promise.resolve(this.amazonTokens[t].accessToken);return e.then(t=>c(`https://api.amazon.com/messaging/registrations/${n}/messages`,{method:"POST",body:JSON.stringify({data:i}),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${t}`,"X-Amzn-Type-Version":"com.amazon.device.messaging.ADMMessage@1.0","X-Amzn-Accept-Type":"com.amazon.device.messaging.ADMSendResult@1.0"}}).then(t=>t.json()))}return c("https://fcm.googleapis.com/fcm/send",{method:"POST",body:JSON.stringify({to:n,data:i}),headers:{"Content-Type":"application/json",Authorization:"key="+this.senders[t]}}).then(t=>t.json())},d.getKey=function(t,n,i){return i+":"+n+":"+t},d.dictionaryKeys="0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v w x y z".split(" "),d.sdpDictionary={},d.addDictionary=function(t){var n=d.dictionaryKeys[Object.keys(d.sdpDictionary).length];d.sdpDictionary[n]=t},d.replaceAll=function(t,n,i){n=n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var e=new RegExp(n,"g");return t.replace(e,i)},d.compressSdp=function(t){for(var n in t=t.replace("\\","\\\\"),d.sdpDictionary){var i=d.sdpDictionary[n];t=d.replaceAll(t,i,"\\"+n)}return t},d.decompressSdp=function(t){for(var n in d.sdpDictionary){var i=d.sdpDictionary[n];t=t.replace(new RegExp(`([^\\\\])\\\\${n}`,"g"),"$1"+i)}return t},(v=d.addDictionary)("a=rtpmap:"),v("a=extmap:"),v("a=rtcp-fb:"),v("a=fmtp:"),v("level-asymmetry-allowed="),v("packetization-mode="),v("profile-level-id="),v("90000"),v("rtx/90000"),v("H264/90000"),v("transport-cc"),v("x-google-profile-id"),v("nack pli"),v("goog-remb"),v("ccm fir"),v("telephone-event/"),v("http://www.webrtc.org/experiments/rtp-hdrext/"),v("urn:ietf:params:rtp-hdrext:toffset"),v("http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"),v("urn:3gpp:video-orientation"),v("http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"),v("http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"),v("http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"),v("http://www.webrtc.org/experiments/rtp-hdrext/video-timing"),v("http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"),d.prototype.setupPeerConnection=function(t,n,i,e,o,s,c){var a,u=new r(this.rtcc),h=function(r){var a,u=[],h=c(),f=(h.sdp,{type:h.type,sdp:d.compressSdp(h.sdp)}),l=JSON.stringify(f).length;for(var v in r)null!=(v=r[v])&&(u.push(v),l+JSON.stringify(u).length>3200&&(a=!0,this.sendGcm(n,i,e,o,s,t,{desc:f,candidates:u}),u=[]));(u.length>0||!a)&&this.sendGcm(n,i,e,o,s,t,{desc:f,candidates:u})}.bind(this);u.onicecandidate=function(t){t.candidate?(console.log("candidate",t.candidate),a=function(t,n,i,e,r){if(t||(t={items:[]}),t.items.push(n),!t.timeout){function o(){delete t.timeout,e(t.items),t.items=[]}r&&o(t.items),t.timeout=setTimeout(o,i)}return t}(a,t.candidate,500,h)):console.log("done sending ice candidates")}.bind(this);var f=d.getKey(i,e,s),v=new l(this,u,f);return v.sendConnect=h,u.onsignalingstatechange=function(t){"stable"==u.signalingState?this.gcmRtcConnections[f]:"closed"==u.signalingState&&v.destroy()}.bind(this),this.gcmRtcConnections[f]=v,v},d.prototype.connect=function(t){return new Promise((n,i)=>{var e=t.senderId,r=t.registrationId,o=t.port;if(!r)throw new Error("registrationId was null on connect");var s,c=Math.random().toString(16),a=this.setupPeerConnection("offer",e,r,o,this.registrationId,c,(function(){return s})),u=a.peerConnection;try{-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&t.offerToReceiveAudio&&t.offerToReceiveVideo&&(u.addTransceiver("audio"),u.addTransceiver("video"))}catch(t){}var h=setTimeout((function(){a.destroy(),i(new Error("Timeout waiting for RTC Connection"))}),3e4);function f(t){u.createOffer(t).then((function(t){s=t,console.log(t),u.setLocalDescription(t),a.sendConnect([])}))}if(t.offerToReceiveAudio||t.offerToReceiveVideo||t.audio){function l(){u.ontrack=function(t){a.streams=t.streams,console.log("got the remote stream"),clearTimeout(h),n(a)},f({offerToReceiveAudio:!!t.offerToReceiveAudio,offerToReceiveVideo:!!t.offerToReceiveVideo,voiceActivityDetection:!1})}if(!t.audio)return void l();navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){t.getTracks().forEach((function(n){u.addTrack(n,t)})),l()})).catch(t=>{console.error("audio fail",t),l()})}else{var d=a.prepareChannel("pinger");d.onopen=function(){console.log("got rtc pinger"),a.setupPinger(d),clearTimeout(h),n(a)},a.listenSockets(),f({})}})},d.prototype.isListening=function(t){return null!=this.gcmRtcListeners[t]},d.prototype.stopListen=function(t){delete this.gcmRtcListeners[t]},d.prototype.listen=function(t,n){this.gcmRtcListeners[t]?console.log("already listening on gcm port "+t):this.gcmRtcListeners[t]={listener:this,listenCallback:n}},d.prototype.incoming=function(t,n,i,r,o,s,c){var a=d.getKey(n,i,o),u=this.gcmRtcConnections[a];if(u){if(!u.remoteDesc){l=s.desc.sdp;s.desc.sdp=d.decompressSdp(l),u.remoteDesc=new e(s.desc),(f=u.peerConnection).setRemoteDescription(u.remoteDesc)}}else{if(!n)return void console.warn("received null registraition on incoming message. ignoring");var h;u=this.setupPeerConnection("answer",t,n,i,r,o,(function(){return h}));var f,l=s.desc.sdp;s.desc.sdp=d.decompressSdp(l),u.remoteDesc=new e(s.desc),(f=u.peerConnection).ondatachannel=function(t){console.log("got rtc pinger"),this.setupPinger(t.channel),c(u),this.listenSockets()}.bind(u),f.setRemoteDescription(u.remoteDesc,(function(){f.createAnswer().then((function(t){h=t,f.setLocalDescription(t)}),(function(){console.error("answer error",arguments)}))}))}u.addCandidates(s)},n.GcmRtcSocket=f,n.GcmRtcManager=d},function(t,n,i){"use strict";var e=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}();t.exports=n=e.fetch,n.default=e.fetch.bind(e),n.Headers=e.Headers,n.Request=e.Request,n.Response=e.Response},function(t,n,i){var e=i(36),r=i(10),o=i(23),s=i(2)("socket.io-client");t.exports=n=a;var c=n.managers={};function a(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,r=e(t),a=r.source,u=r.id,h=r.path,f=c[u]&&h in c[u].nsps;return n.forceNew||n["force new connection"]||!1===n.multiplex||f?(s("ignoring socket cache for %s",a),i=o(a,n)):(c[u]||(s("new io instance for %s",a),c[u]=o(a,n)),i=c[u]),r.query&&!n.query&&(n.query=r.query),i.socket(r.path,n)}n.protocol=r.protocol,n.connect=a,n.Manager=i(23),n.Socket=i(29)},function(t,n,i){(function(n){var e=i(21),r=i(2)("socket.io-client:url");t.exports=function(t,i){var o=t;i=i||n.location,null==t&&(t=i.protocol+"//"+i.host);"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?i.protocol+t:i.host+t),/^(https?|wss?):\/\//.test(t)||(r("protocol-less url %s",t),t=void 0!==i?i.protocol+"//"+t:"https://"+t),r("parse %s",t),o=e(t));o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443"));o.path=o.path||"/";var s=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+s+":"+o.port,o.href=o.protocol+"://"+s+(i&&i.port===o.port?"":":"+o.port),o}}).call(this,i(0))},function(t,n,i){function e(t){var i;function e(){if(e.enabled){var t=e,r=+new Date,o=r-(i||r);t.diff=o,t.prev=i,t.curr=r,i=r;for(var s=new Array(arguments.length),c=0;c<s.length;c++)s[c]=arguments[c];s[0]=n.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var a=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(i,e){if("%%"===i)return i;a++;var r=n.formatters[e];if("function"==typeof r){var o=s[a];i=r.call(t,o),s.splice(a,1),a--}return i})),n.formatArgs.call(t,s);var u=e.log||n.log||console.log.bind(console);u.apply(t,s)}}return e.namespace=t,e.enabled=n.enabled(t),e.useColors=n.useColors(),e.color=function(t){var i,e=0;for(i in t)e=(e<<5)-e+t.charCodeAt(i),e|=0;return n.colors[Math.abs(e)%n.colors.length]}(t),e.destroy=r,"function"==typeof n.init&&n.init(e),n.instances.push(e),e}function r(){var t=n.instances.indexOf(this);return-1!==t&&(n.instances.splice(t,1),!0)}(n=t.exports=e.debug=e.default=e).coerce=function(t){return t instanceof Error?t.stack||t.message:t},n.disable=function(){n.enable("")},n.enable=function(t){var i;n.save(t),n.names=[],n.skips=[];var e=("string"==typeof t?t:"").split(/[\s,]+/),r=e.length;for(i=0;i<r;i++)e[i]&&("-"===(t=e[i].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")));for(i=0;i<n.instances.length;i++){var o=n.instances[i];o.enabled=n.enabled(o.namespace)}},n.enabled=function(t){if("*"===t[t.length-1])return!0;var i,e;for(i=0,e=n.skips.length;i<e;i++)if(n.skips[i].test(t))return!1;for(i=0,e=n.names.length;i<e;i++)if(n.names[i].test(t))return!0;return!1},n.humanize=i(38),n.instances=[],n.names=[],n.skips=[],n.formatters={}},function(t,n){var i=1e3,e=6e4,r=36e5,o=24*r;function s(t,n,i){if(!(t<n))return t<1.5*n?Math.floor(t/n)+" "+i:Math.ceil(t/n)+" "+i+"s"}t.exports=function(t,n){n=n||{};var c,a=typeof t;if("string"===a&&t.length>0)return function(t){if((t=String(t)).length>100)return;var n=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!n)return;var s=parseFloat(n[1]);switch((n[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*e;case"seconds":case"second":case"secs":case"sec":case"s":return s*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(t);if("number"===a&&!1===isNaN(t))return n.long?s(c=t,o,"day")||s(c,r,"hour")||s(c,e,"minute")||s(c,i,"second")||c+" ms":function(t){if(t>=o)return Math.round(t/o)+"d";if(t>=r)return Math.round(t/r)+"h";if(t>=e)return Math.round(t/e)+"m";if(t>=i)return Math.round(t/i)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,n,i){(function(t){var e=i(11),r=i(22),o=Object.prototype.toString,s="function"==typeof t.Blob||"[object BlobConstructor]"===o.call(t.Blob),c="function"==typeof t.File||"[object FileConstructor]"===o.call(t.File);n.deconstructPacket=function(t){var n=[],i=t.data,o=t;return o.data=function t(n,i){if(!n)return n;if(r(n)){var o={_placeholder:!0,num:i.length};return i.push(n),o}if(e(n)){for(var s=new Array(n.length),c=0;c<n.length;c++)s[c]=t(n[c],i);return s}if("object"==typeof n&&!(n instanceof Date)){s={};for(var a in n)s[a]=t(n[a],i);return s}return n}(i,n),o.attachments=n.length,{packet:o,buffers:n}},n.reconstructPacket=function(t,n){return t.data=function t(n,i){if(!n)return n;if(n&&n._placeholder)return i[n.num];if(e(n))for(var r=0;r<n.length;r++)n[r]=t(n[r],i);else if("object"==typeof n)for(var o in n)n[o]=t(n[o],i);return n}(t.data,n),t.attachments=void 0,t},n.removeBlobs=function(t,n){var i=0,o=t;!function t(a,u,h){if(!a)return a;if(s&&a instanceof Blob||c&&a instanceof File){i++;var f=new FileReader;f.onload=function(){h?h[u]=this.result:o=this.result,--i||n(o)},f.readAsArrayBuffer(a)}else if(e(a))for(var l=0;l<a.length;l++)t(a[l],l,a);else if("object"==typeof a&&!r(a))for(var d in a)t(a[d],d,a)}(o),i||n(o)}}).call(this,i(0))},function(t,n,i){t.exports=i(41),t.exports.parser=i(5)},function(t,n,i){(function(n){var e=i(24),r=i(4),o=i(2)("engine.io-client:socket"),s=i(28),c=i(5),a=i(21),u=i(7);function h(t,i){if(!(this instanceof h))return new h(t,i);i=i||{},t&&"object"==typeof t&&(i=t,t=null),t?(t=a(t),i.hostname=t.host,i.secure="https"===t.protocol||"wss"===t.protocol,i.port=t.port,t.query&&(i.query=t.query)):i.host&&(i.hostname=a(i.host).host),this.secure=null!=i.secure?i.secure:n.location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.agent=i.agent||!1,this.hostname=i.hostname||(n.location?location.hostname:"localhost"),this.port=i.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=i.query||{},"string"==typeof this.query&&(this.query=u.decode(this.query)),this.upgrade=!1!==i.upgrade,this.path=(i.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!i.forceJSONP,this.jsonp=!1!==i.jsonp,this.forceBase64=!!i.forceBase64,this.enablesXDR=!!i.enablesXDR,this.timestampParam=i.timestampParam||"t",this.timestampRequests=i.timestampRequests,this.transports=i.transports||["polling","websocket"],this.transportOptions=i.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=i.policyPort||843,this.rememberUpgrade=i.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=i.onlyBinaryUpgrades,this.perMessageDeflate=!1!==i.perMessageDeflate&&(i.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=i.pfx||null,this.key=i.key||null,this.passphrase=i.passphrase||null,this.cert=i.cert||null,this.ca=i.ca||null,this.ciphers=i.ciphers||null,this.rejectUnauthorized=void 0===i.rejectUnauthorized||i.rejectUnauthorized,this.forceNode=!!i.forceNode;var e="object"==typeof n&&n;e.global===e&&(i.extraHeaders&&Object.keys(i.extraHeaders).length>0&&(this.extraHeaders=i.extraHeaders),i.localAddress&&(this.localAddress=i.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}t.exports=h,h.priorWebsocketSuccess=!1,r(h.prototype),h.protocol=c.protocol,h.Socket=h,h.Transport=i(13),h.transports=i(24),h.parser=i(5),h.prototype.createTransport=function(t){o('creating transport "%s"',t);var n=function(t){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}(this.query);n.EIO=c.protocol,n.transport=t;var i=this.transportOptions[t]||{};return this.id&&(n.sid=this.id),new e[t]({query:n,socket:this,agent:i.agent||this.agent,hostname:i.hostname||this.hostname,port:i.port||this.port,secure:i.secure||this.secure,path:i.path||this.path,forceJSONP:i.forceJSONP||this.forceJSONP,jsonp:i.jsonp||this.jsonp,forceBase64:i.forceBase64||this.forceBase64,enablesXDR:i.enablesXDR||this.enablesXDR,timestampRequests:i.timestampRequests||this.timestampRequests,timestampParam:i.timestampParam||this.timestampParam,policyPort:i.policyPort||this.policyPort,pfx:i.pfx||this.pfx,key:i.key||this.key,passphrase:i.passphrase||this.passphrase,cert:i.cert||this.cert,ca:i.ca||this.ca,ciphers:i.ciphers||this.ciphers,rejectUnauthorized:i.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:i.perMessageDeflate||this.perMessageDeflate,extraHeaders:i.extraHeaders||this.extraHeaders,forceNode:i.forceNode||this.forceNode,localAddress:i.localAddress||this.localAddress,requestTimeout:i.requestTimeout||this.requestTimeout,protocols:i.protocols||void 0})},h.prototype.open=function(){var t;if(this.rememberUpgrade&&h.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var n=this;return void setTimeout((function(){n.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},h.prototype.setTransport=function(t){o("setting transport %s",t.name);var n=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){n.onDrain()})).on("packet",(function(t){n.onPacket(t)})).on("error",(function(t){n.onError(t)})).on("close",(function(){n.onClose("transport close")}))},h.prototype.probe=function(t){o('probing transport "%s"',t);var n=this.createTransport(t,{probe:1}),i=!1,e=this;function r(){if(e.onlyBinaryUpgrades){var r=!this.supportsBinary&&e.transport.supportsBinary;i=i||r}i||(o('probe transport "%s" opened',t),n.send([{type:"ping",data:"probe"}]),n.once("packet",(function(r){if(!i)if("pong"===r.type&&"probe"===r.data){if(o('probe transport "%s" pong',t),e.upgrading=!0,e.emit("upgrading",n),!n)return;h.priorWebsocketSuccess="websocket"===n.name,o('pausing current transport "%s"',e.transport.name),e.transport.pause((function(){i||"closed"!==e.readyState&&(o("changing transport and sending upgrade packet"),l(),e.setTransport(n),n.send([{type:"upgrade"}]),e.emit("upgrade",n),n=null,e.upgrading=!1,e.flush())}))}else{o('probe transport "%s" failed',t);var s=new Error("probe error");s.transport=n.name,e.emit("upgradeError",s)}})))}function s(){i||(i=!0,l(),n.close(),n=null)}function c(i){var r=new Error("probe error: "+i);r.transport=n.name,s(),o('probe transport "%s" failed because of error: %s',t,i),e.emit("upgradeError",r)}function a(){c("transport closed")}function u(){c("socket closed")}function f(t){n&&t.name!==n.name&&(o('"%s" works - aborting "%s"',t.name,n.name),s())}function l(){n.removeListener("open",r),n.removeListener("error",c),n.removeListener("close",a),e.removeListener("close",u),e.removeListener("upgrading",f)}h.priorWebsocketSuccess=!1,n.once("open",r),n.once("error",c),n.once("close",a),this.once("close",u),this.once("upgrading",f),n.open()},h.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",h.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var t=0,n=this.upgrades.length;t<n;t++)this.probe(this.upgrades[t])}},h.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var n=new Error("server error");n.code=t.data,this.onError(n);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else o('packet received with socket readyState "%s"',this.readyState)},h.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},h.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var n=this;n.pingTimeoutTimer=setTimeout((function(){"closed"!==n.readyState&&n.onClose("ping timeout")}),t||n.pingInterval+n.pingTimeout)},h.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){o("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},h.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},h.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},h.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},h.prototype.write=h.prototype.send=function(t,n,i){return this.sendPacket("message",t,n,i),this},h.prototype.sendPacket=function(t,n,i,e){if("function"==typeof n&&(e=n,n=void 0),"function"==typeof i&&(e=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){(i=i||{}).compress=!1!==i.compress;var r={type:t,data:n,options:i};this.emit("packetCreate",r),this.writeBuffer.push(r),e&&this.once("flush",e),this.flush()}},h.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?e():n()})):this.upgrading?e():n()}function n(){t.onClose("forced close"),o("socket closing - telling transport to close"),t.transport.close()}function i(){t.removeListener("upgrade",i),t.removeListener("upgradeError",i),n()}function e(){t.once("upgrade",i),t.once("upgradeError",i)}return this},h.prototype.onError=function(t){o("socket error %j",t),h.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},h.prototype.onClose=function(t,n){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,n),this.writeBuffer=[],this.prevBufferLen=0}},h.prototype.filterUpgrades=function(t){for(var n=[],i=0,e=t.length;i<e;i++)~s(this.transports,t[i])&&n.push(t[i]);return n}}).call(this,i(0))},function(t,n){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(n){t.exports=!1}},function(t,n,i){(function(n){var e=i(12),r=i(25),o=i(4),s=i(8),c=i(2)("engine.io-client:polling-xhr");function a(){}function u(t){if(r.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,n.location){var i="https:"===location.protocol,e=location.port;e||(e=i?443:80),this.xd=t.hostname!==n.location.hostname||e!==t.port,this.xs=t.secure!==i}}function h(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function f(){for(var t in h.requests)h.requests.hasOwnProperty(t)&&h.requests[t].abort()}t.exports=u,t.exports.Request=h,s(u,r),u.prototype.supportsBinary=!0,u.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new h(t)},u.prototype.doWrite=function(t,n){var i="string"!=typeof t&&void 0!==t,e=this.request({method:"POST",data:t,isBinary:i}),r=this;e.on("success",n),e.on("error",(function(t){r.onError("xhr post error",t)})),this.sendXhr=e},u.prototype.doPoll=function(){c("xhr poll");var t=this.request(),n=this;t.on("data",(function(t){n.onData(t)})),t.on("error",(function(t){n.onError("xhr poll error",t)})),this.pollXhr=t},o(h.prototype),h.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var i=this.xhr=new e(t),r=this;try{c("xhr open %s: %s",this.method,this.uri),i.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this.extraHeaders[o])}catch(t){}if("POST"===this.method)try{this.isBinary?i.setRequestHeader("Content-type","application/octet-stream"):i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{i.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in i&&(i.withCredentials=!0),this.requestTimeout&&(i.timeout=this.requestTimeout),this.hasXDR()?(i.onload=function(){r.onLoad()},i.onerror=function(){r.onError(i.responseText)}):i.onreadystatechange=function(){if(2===i.readyState)try{var t=i.getResponseHeader("Content-Type");r.supportsBinary&&"application/octet-stream"===t&&(i.responseType="arraybuffer")}catch(t){}4===i.readyState&&(200===i.status||1223===i.status?r.onLoad():setTimeout((function(){r.onError(i.status)}),0))},c("xhr data %s",this.data),i.send(this.data)}catch(t){return void setTimeout((function(){r.onError(t)}),0)}n.document&&(this.index=h.requestsCount++,h.requests[this.index]=this)},h.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},h.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},h.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},h.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=a:this.xhr.onreadystatechange=a,t)try{this.xhr.abort()}catch(t){}n.document&&delete h.requests[this.index],this.xhr=null}},h.prototype.onLoad=function(){var t;try{var n;try{n=this.xhr.getResponseHeader("Content-Type")}catch(t){}t="application/octet-stream"===n&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},h.prototype.hasXDR=function(){return void 0!==n.XDomainRequest&&!this.xs&&this.enablesXDR},h.prototype.abort=function(){this.cleanup()},h.requestsCount=0,h.requests={},n.document&&(n.attachEvent?n.attachEvent("onunload",f):n.addEventListener&&n.addEventListener("beforeunload",f,!1))}).call(this,i(0))},function(t,n){t.exports=Object.keys||function(t){var n=[],i=Object.prototype.hasOwnProperty;for(var e in t)i.call(t,e)&&n.push(e);return n}},function(t,n){t.exports=function(t,n,i){var e=t.byteLength;if(n=n||0,i=i||e,t.slice)return t.slice(n,i);if(n<0&&(n+=e),i<0&&(i+=e),i>e&&(i=e),n>=e||n>=i||0===e)return new ArrayBuffer(0);for(var r=new Uint8Array(t),o=new Uint8Array(i-n),s=n,c=0;s<i;s++,c++)o[c]=r[s];return o.buffer}},function(t,n){function i(){}t.exports=function(t,n,e){var r=!1;return e=e||i,o.count=t,0===t?n():o;function o(t,i){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(r=!0,n(t),n=e):0!==o.count||r||n(null,i)}}},function(t,n){var i,e,r,o=String.fromCharCode;function s(t){for(var n,i,e=[],r=0,o=t.length;r<o;)(n=t.charCodeAt(r++))>=55296&&n<=56319&&r<o?56320==(64512&(i=t.charCodeAt(r++)))?e.push(((1023&n)<<10)+(1023&i)+65536):(e.push(n),r--):e.push(n);return e}function c(t,n){if(t>=55296&&t<=57343){if(n)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function a(t,n){return o(t>>n&63|128)}function u(t,n){if(0==(4294967168&t))return o(t);var i="";return 0==(4294965248&t)?i=o(t>>6&31|192):0==(4294901760&t)?(c(t,n)||(t=65533),i=o(t>>12&15|224),i+=a(t,6)):0==(4292870144&t)&&(i=o(t>>18&7|240),i+=a(t,12),i+=a(t,6)),i+=o(63&t|128)}function h(){if(r>=e)throw Error("Invalid byte index");var t=255&i[r];if(r++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function f(t){var n,o;if(r>e)throw Error("Invalid byte index");if(r==e)return!1;if(n=255&i[r],r++,0==(128&n))return n;if(192==(224&n)){if((o=(31&n)<<6|h())>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&n)){if((o=(15&n)<<12|h()<<6|h())>=2048)return c(o,t)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&n)&&(o=(7&n)<<18|h()<<12|h()<<6|h())>=65536&&o<=1114111)return o;throw Error("Invalid UTF-8 detected")}t.exports={version:"2.1.2",encode:function(t,n){for(var i=!1!==(n=n||{}).strict,e=s(t),r=e.length,o=-1,c="";++o<r;)c+=u(e[o],i);return c},decode:function(t,n){var c=!1!==(n=n||{}).strict;i=s(t),e=i.length,r=0;for(var a,u=[];!1!==(a=f(c));)u.push(a);return function(t){for(var n,i=t.length,e=-1,r="";++e<i;)(n=t[e])>65535&&(r+=o((n-=65536)>>>10&1023|55296),n=56320|1023&n),r+=o(n);return r}(u)}}},function(t,n){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),e=0;e<t.length;e++)i[t.charCodeAt(e)]=e;n.encode=function(n){var i,e=new Uint8Array(n),r=e.length,o="";for(i=0;i<r;i+=3)o+=t[e[i]>>2],o+=t[(3&e[i])<<4|e[i+1]>>4],o+=t[(15&e[i+1])<<2|e[i+2]>>6],o+=t[63&e[i+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o},n.decode=function(t){var n,e,r,o,s,c=.75*t.length,a=t.length,u=0;"="===t[t.length-1]&&(c--,"="===t[t.length-2]&&c--);var h=new ArrayBuffer(c),f=new Uint8Array(h);for(n=0;n<a;n+=4)e=i[t.charCodeAt(n)],r=i[t.charCodeAt(n+1)],o=i[t.charCodeAt(n+2)],s=i[t.charCodeAt(n+3)],f[u++]=e<<2|r>>4,f[u++]=(15&r)<<4|o>>2,f[u++]=(3&o)<<6|63&s;return h}}()},function(t,n){var i=void 0!==i?i:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,e=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),r=e&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),o=i&&i.prototype.append&&i.prototype.getBlob;function s(t){return t.map((function(t){if(t.buffer instanceof ArrayBuffer){var n=t.buffer;if(t.byteLength!==n.byteLength){var i=new Uint8Array(t.byteLength);i.set(new Uint8Array(n,t.byteOffset,t.byteLength)),n=i.buffer}return n}return t}))}function c(t,n){n=n||{};var e=new i;return s(t).forEach((function(t){e.append(t)})),n.type?e.getBlob(n.type):e.getBlob()}function a(t,n){return new Blob(s(t),n||{})}"undefined"!=typeof Blob&&(c.prototype=Blob.prototype,a.prototype=Blob.prototype),t.exports=e?r?Blob:a:o?c:void 0},function(t,n,i){(function(n){var e=i(25),r=i(8);t.exports=u;var o,s=/\n/g,c=/\\n/g;function a(){}function u(t){e.call(this,t),this.query=this.query||{},o||(n.___eio||(n.___eio=[]),o=n.___eio),this.index=o.length;var i=this;o.push((function(t){i.onData(t)})),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",(function(){i.script&&(i.script.onerror=a)}),!1)}r(u,e),u.prototype.supportsBinary=!1,u.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),e.prototype.doClose.call(this)},u.prototype.doPoll=function(){var t=this,n=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),n.async=!0,n.src=this.uri(),n.onerror=function(n){t.onError("jsonp poll error",n)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(n,i):(document.head||document.body).appendChild(n),this.script=n,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)},u.prototype.doWrite=function(t,n){var i=this;if(!this.form){var e,r=document.createElement("form"),o=document.createElement("textarea"),a=this.iframeId="eio_iframe_"+this.index;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=a,r.method="POST",r.setAttribute("accept-charset","utf-8"),o.name="d",r.appendChild(o),document.body.appendChild(r),this.form=r,this.area=o}function u(){h(),n()}function h(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(t){i.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+i.iframeId+'">';e=document.createElement(t)}catch(t){(e=document.createElement("iframe")).name=i.iframeId,e.src="javascript:0"}e.id=i.iframeId,i.form.appendChild(e),i.iframe=e}this.form.action=this.uri(),h(),t=t.replace(c,"\\\n"),this.area.value=t.replace(s,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,i(0))},function(t,n,i){(function(n){var e,r=i(13),o=i(5),s=i(7),c=i(8),a=i(27),u=i(2)("engine.io-client:websocket"),h=n.WebSocket||n.MozWebSocket;if("undefined"==typeof window)try{e=i(52)}catch(t){}var f=h;function l(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=h&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(f=e),r.call(this,t)}f||"undefined"!=typeof window||(f=e),t.exports=l,c(l,r),l.prototype.name="websocket",l.prototype.supportsBinary=!0,l.prototype.doOpen=function(){if(this.check()){var t=this.uri(),n=this.protocols,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.localAddress&&(i.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?n?new f(t,n):new f(t):new f(t,n,i)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},l.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(n){t.onData(n.data)},this.ws.onerror=function(n){t.onError("websocket error",n)}},l.prototype.write=function(t){var i=this;this.writable=!1;for(var e=t.length,r=0,s=e;r<s;r++)!function(t){o.encodePacket(t,i.supportsBinary,(function(r){if(!i.usingBrowserWebSocket){var o={};if(t.options&&(o.compress=t.options.compress),i.perMessageDeflate)("string"==typeof r?n.Buffer.byteLength(r):r.length)<i.perMessageDeflate.threshold&&(o.compress=!1)}try{i.usingBrowserWebSocket?i.ws.send(r):i.ws.send(r,o)}catch(t){u("websocket closed before onclose event")}--e||c()}))}(t[r]);function c(){i.emit("flush"),setTimeout((function(){i.writable=!0,i.emit("drain")}),0)}},l.prototype.onClose=function(){r.prototype.onClose.call(this)},l.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},l.prototype.uri=function(){var t=this.query||{},n=this.secure?"wss":"ws",i="";return this.port&&("wss"===n&&443!==Number(this.port)||"ws"===n&&80!==Number(this.port))&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=a()),this.supportsBinary||(t.b64=1),(t=s.encode(t)).length&&(t="?"+t),n+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t},l.prototype.check=function(){return!(!f||"__initialize"in f&&this.name===l.prototype.name)}}).call(this,i(0))},function(t,n){},function(t,n){t.exports=function(t,n){for(var i=[],e=(n=n||0)||0;e<t.length;e++)i[e-n]=t[e];return i}},function(t,n){function i(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=i,i.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var n=Math.random(),i=Math.floor(n*this.jitter*t);t=0==(1&Math.floor(10*n))?t-i:t+i}return 0|Math.min(t,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(t){this.ms=t},i.prototype.setMax=function(t){this.max=t},i.prototype.setJitter=function(t){this.jitter=t}},function(t,n){function i(t){var n,i=$("#notificationModal"),e=i.find("#modal-ok"),r=i.find("#modal-cancel");e.unbind("click"),r.unbind("click"),i.unbind("hidden.bs.modal"),t.cancelButton=t.cancelButton||"Cancel",t.okButton=t.okButton||"OK",t.title=t.title||chrome.runtime.getManifest().name,t.body=t.body||"",t.hideCancel?r.hide():r.show(),e.text(t.okButton),r.text(t.cancelButton),i.find("#modal-title").text(t.title),i.find("#modal-body").html(t.body),e.click((function(){n=!0,t.ok&&t.ok()||$("#notificationModal").modal("hide")})),t.cancel&&(i.on("hidden.bs.modal",(function(){n||t.cancel()})),r.click(t.cancel)),$("#notificationModal").modal(),t.duration&&setTimeout((function(){$("#notificationModal").modal("hide")}),t.duration)}n.showModal=i,n.shortModal=function(t,n){i({title:t,body:n,duration:8e3,hideCancel:!0})}},function(t,n){function i(t){return t?(t.friendlyName&&!t.friendlyName.length&&delete t.friendlyName,t):null}function e(t){window.chrome&&window.chrome.storage?chrome.storage.local.get("device-settings",(function(n){t(n["device-settings"]||{})})):t({})}var r=[{name:"Default Settings",size:"reset",density:"reset"},{name:"Resizable (96dpi)",size:"reset",density:"96",freeSize:!0},{name:"Resizable (144dpi)",size:"reset",density:"144",freeSize:!0},{name:"1080p (96dpi)",size:"1920x1080",density:"96"},{name:"4K (144dpi)",size:"3840x2160",density:"144"},{name:"Galaxy Nexus",size:"720x1280",density:"320"},{name:"Nexus 4",size:"768x1280",density:"320"},{name:"Nexus 5",size:"1080x1920",density:"480"},{name:"Nexus 6",size:"1440x2560",density:"560"},{name:"Nexus 6p",size:"1440x2560",density:"560"},{name:"Nexus 7 (2012)",size:"800x1280",density:"213"},{name:"Nexus 7 (2013)",size:"1200x1920",density:"320"},{name:"Nexus 9",size:"1536x2048",density:"320"}];n.populateDisplaySettings=function(){for(var t in r){var n=r[t],i=new Option;$(i).html(n.name),$("#display-settings").append(i)}},n.loadDeviceSettings=function(t,n){t||(t="web");var o={showSoftKeys:!0,pinTitleBar:!0,alwaysOnTop:!1,bitrate:0,resolution:0,decoder:0,displaySettings:r[0],dimDisplay:!1};"inkwire"==t&&(o.pinTitleBar=!1,o.showSoftKeys=!1),e((function(e){n(i(e[t]||o))}))},n.applyDeviceSettings=function(t){$("#new-display-name").prop("value",t.friendlyName||null),$("#softkeys-check").prop("checked",!!t.showSoftKeys).change(),$("#pin-title-check").prop("checked",!!t.pinTitleBar).change(),$("#always-on-top-check").prop("checked",!!t.alwaysOnTop).change(),$("#bitrate").prop("selectedIndex",t.bitrate||0),$("#decoder").prop("selectedIndex",t.decoder||0),$("#resolution").prop("selectedIndex",t.resolution||0);var n=t.displaySettings&&t.displaySettings.name,i=0;for(var e in r){if(r[e].name==n){i=e;break}}$("#display-settings").prop("selectedIndex",i),$("#dim-display").prop("checked",!!t.dimDisplay),$("#auto-audio").prop("checked",!!t.autoAudio)},n.saveDeviceSettings=function(t,n,r){i(n),window.chrome&&window.chrome.storage&&t&&-1==t.indexOf("127.0.0.1")?e((function(i){i[t]=n,chrome.storage.local.set({"device-settings":i},r)})):r&&r()}},,function(t,n,i){t.exports=function(){return new Worker(i.p+"a792e79601db595bfb45.worker.js")}},function(t,n,i){(function(t){var i,e,r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=(e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(t){(t=t||{})||(t=void 0!==t?t:{});var n,i={};for(n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);var o,s=[],c="";c=self.location.href,e&&(c=e),c=0!==c.indexOf("blob:")?c.substr(0,c.lastIndexOf("/")+1):"",o=function(t){var n=new XMLHttpRequest;return n.open("GET",t,!1),n.responseType="arraybuffer",n.send(null),new Uint8Array(n.response)};var a,u,h=t.print||console.log.bind(console),f=t.printErr||console.warn.bind(console);for(n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);i=null,t.arguments&&(s=t.arguments),t.thisProgram&&t.thisProgram,t.quit&&t.quit,t.wasmBinary&&(a=t.wasmBinary),t.noExitRuntime&&t.noExitRuntime,"object"!==("undefined"==typeof WebAssembly?"undefined":r(WebAssembly))&&f("no native wasm support detected");var l,d,v,p,y,w,m,g=new WebAssembly.Table({initial:1,maximum:1,element:"anyfunc"}),b=!1;function k(n){l=n,t.HEAP8=d=new Int8Array(n),t.HEAP16=p=new Int16Array(n),t.HEAP32=y=new Int32Array(n),t.HEAPU8=v=new Uint8Array(n),t.HEAPU16=new Uint16Array(n),t.HEAPU32=new Uint32Array(n),t.HEAPF32=w=new Float32Array(n),t.HEAPF64=m=new Float64Array(n)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf8"),"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var A=t.TOTAL_MEMORY||16777216;function C(n){for(;n.length>0;){var i=n.shift();if("function"!=typeof i){var e=i.func;"number"==typeof e?void 0===i.arg?t.dynCall_v(e):t.dynCall_vi(e,i.arg):e(void 0===i.arg?null:i.arg)}else i()}}(u=t.wasmMemory?t.wasmMemory:new WebAssembly.Memory({initial:A/65536}))&&(l=u.buffer),A=l.byteLength,k(l),y[2188]=5251792;var S=[],T=[],E=[],x=[],$=0,F=null,U=null;function I(n){throw t.onAbort&&t.onAbort(n),h(n+=""),f(n),b=!0,n="abort("+n+"). Build with -s ASSERTIONS=1 for more info.",new WebAssembly.RuntimeError(n)}function N(t){return String.prototype.startsWith?t.startsWith("data:application/octet-stream;base64,"):0===t.indexOf("data:application/octet-stream;base64,")}t.preloadedImages={},t.preloadedAudios={};var B,O="TinyH264.wasm";function R(){try{if(a)return new Uint8Array(a);if(o)return o(O);throw"both async and sync fetching of the wasm failed"}catch(t){I(t)}}function M(t){try{return u.grow(t-l.byteLength+65535>>16),k(u.buffer),1}catch(t){}}N(O)||(B=O,O=t.locateFile?t.locateFile(B,c):c+B),T.push({func:function(){z()}});var D={a:function(t,n,i){v.set(v.subarray(n,n+i),t)},b:function(t){var n=d.length;if(t>2147418112)return!1;for(var i,e,r=1;r<=4;r*=2){var o=n*(1+.2/r);if(o=Math.min(o,t+100663296),M(Math.min(2147418112,((i=Math.max(16777216,t,o))%(e=65536)>0&&(i+=e-i%e),i))))return!0}return!1},memory:u,table:g},_=function(){var n={env:D,wasi_snapshot_preview1:D};function i(n,i){var e=n.exports;t.asm=e,function(n){if($--,t.monitorRunDependencies&&t.monitorRunDependencies($),0==$&&(null!==F&&(clearInterval(F),F=null),U)){var i=U;U=null,i()}}()}function e(t){i(t.instance)}function r(t){return(a||"function"!=typeof fetch?new Promise((function(t,n){t(R())})):fetch(O,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+O+"'";return t.arrayBuffer()})).catch((function(){return R()}))).then((function(t){return WebAssembly.instantiate(t,n)})).then(t,(function(t){f("failed to asynchronously prepare wasm: "+t),I(t)}))}if($++,t.monitorRunDependencies&&t.monitorRunDependencies($),t.instantiateWasm)try{return t.instantiateWasm(n,i)}catch(t){return f("Module.instantiateWasm callback failed with error: "+t),!1}return function(){if(a||"function"!=typeof WebAssembly.instantiateStreaming||N(O)||"function"!=typeof fetch)return r(e);fetch(O,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,n).then(e,(function(t){f("wasm streaming compile failed: "+t),f("falling back to ArrayBuffer instantiation"),r(e)}))}))}(),{}}();t.asm=_;var j,z=t.___wasm_call_ctors=function(){return(z=t.___wasm_call_ctors=t.asm.c).apply(null,arguments)};function P(n){function i(){j||(j=!0,b||(C(T),C(E),t.onRuntimeInitialized&&t.onRuntimeInitialized(),function(){if(t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)n=t.postRun.shift(),x.unshift(n);var n;C(x)}()))}n=n||s,$>0||(function(){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)n=t.preRun.shift(),S.unshift(n);var n;C(S)}(),$>0||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),i()}),1)):i()))}if(t._h264bsdInit=function(){return(t._h264bsdInit=t.asm.d).apply(null,arguments)},t._malloc=function(){return(t._malloc=t.asm.e).apply(null,arguments)},t._free=function(){return(t._free=t.asm.f).apply(null,arguments)},t._h264bsdDecode=function(){return(t._h264bsdDecode=t.asm.g).apply(null,arguments)},t._h264bsdShutdown=function(){return(t._h264bsdShutdown=t.asm.h).apply(null,arguments)},t._h264bsdAlloc=function(){return(t._h264bsdAlloc=t.asm.i).apply(null,arguments)},t._h264bsdFree=function(){return(t._h264bsdFree=t.asm.j).apply(null,arguments)},t.asm=_,t.getValue=function(t,n,i){switch("*"===(n=n||"i8").charAt(n.length-1)&&(n="i32"),n){case"i1":case"i8":return d[t>>0];case"i16":return p[t>>1];case"i32":case"i64":return y[t>>2];case"float":return w[t>>2];case"double":return m[t>>3];default:I("invalid type for getValue: "+n)}return null},t.then=function(n){if(j)n(t);else{var i=t.onRuntimeInitialized;t.onRuntimeInitialized=function(){i&&i(),n(t)}}return t},U=function t(){j||P(),j||(U=t)},t.run=P,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return P(),t});"object"===r(n)&&"object"===r(t)?t.exports=o:void 0===(i=function(){return o}.apply(n,[]))||(t.exports=i)}).call(this,i(68)(t))},,,,,,,,,function(t,n){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,n,i){const{isElectron:e}=i(1);function r(t,n,i){var r,o,s,c;$("#listener").empty(),e()?(r="host",o=null,s="application/x-ppapi-vysor"):(r="pnacl",o="video_decode/pnacl/Release",s=null),common.createNaClModule("video_decode",s,r,o,t,n,{},function(t){"decoder-falling-behind"==t.data?this.onDecoderFallingBehind&&this.onDecoderFallingBehind():"paint-falling-behind"==t.data||("graphics-context-null"==t.data?showModal({title:"Graphics Error: assert !context_->is_null()",body:'Vysor encountered an error with your graphics card. There is a possible solution available on the <a href="https://support.vysor.io/support/technical/graphics/" target="_blank">support page</a>.',hideCancel:!0}):"decoder-ready"==t.data&&(this.onReady?this.onReady():console.error("no listener for decoder-ready")))}.bind(this),function(){if(c)return console.error("NACL module has already initalized"),console.error(c),void console.error(new Error("NACL New Initialization Stack"));c=new Error("NACL Initialization Stack"),console.log("NACL module initialized"),console.log("decoder:",i),common.naclModule.postMessage(i)}.bind(this))}r.prototype.connectH264=function(t,n){common.naclModule&&common.naclModule.postMessage?common.naclModule.postMessage({type:"connectH264",hostCommand:prefixLen416("host:transport:"+t),clientCommand:prefixLen416("tcp:53517"),password:n+"\n"}):console.error("connectH264 called before initialization")},r.prototype.decode=function(t,n,i){common.naclModule&&common.naclModule.postMessage?common.naclModule.postMessage({buffer:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength,presentationTimeMs:n,syncFrame:i}):console.error("decode called before initialization")},r.prototype.queueAudio=function(t,n,i){common.naclModule.postMessage({type:"queueAudio",audioBuffer0:n.buffer,audioBuffer1:i.buffer,offset:t,length:n.byteLength})},t.exports=r},function(t,n,i){const{Server:e}=i(3),r=i(71),o=i(20),{appendBuffer:s,Success:c,hexToBuffer:a,writeLine:u,readLenLoop:h,arrayBufferToBase64:f,writeLenData:l,makeUUID:d}=i(1),{parseRTPPacket:v}=i(73);function p(){(this.audioListener=new e).listen({port:0,address:"127.0.0.1"},function(t){t.bufferWrites=!0,h(t,function(n){if(n){var i,e=$protobuf.roots.default.cast_channel.CastMessage.decode(n);e.payloadUtf8&&(i=JSON.parse(e.payloadUtf8)),console.log("received",e,i);var r=this.onMessage[e.namespace];r?r.bind(this)(t,e,i).async():console.error("unhandled cast message",e)}}.bind(this))}.bind(this),function(){this.onListening&&this.onListening()}.bind(this)),this.castId="fb720c4cbabca202da80e378fc8474dee136e04f"}p.prototype.sendUDP=function(t,n,i){var e=new DataView(new ArrayBuffer(8+t.byteLength+4));e.setUint32(0,e.byteLength-4+i.byteLength),e.setUint32(4,t.byteLength);for(var r=0;r<t.byteLength;r++)e.setUint8(8+r,t[r]);e.setUint32(8+t.byteLength,n);var o=s(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(i.buffer,i.byteOffset,i.byteLength));this.udpSocket.write(o)},p.prototype.resolveFile=function(t){return"/assets/"+MD5(t)},p.prototype.resolveAjax=function*(t){return yield $.ajax({url:this.resolveFile(t),type:"GET",dataType:"binary",responseType:"arraybuffer",processData:!1,success:yield c,error:yield Error})},p.prototype.stop=function(){this.audioQueue&&(this.audioQueue.stop(),this.audioQueue=null),null!=this.udpSocket&&(this.udpSocket.destroy(),this.udpSocket=null),this.sessionUUID=null,this.onStop&&this.onStop()},p.prototype.timeout=function(){delete this.rtpTimeout,this.stop()},p.prototype.resetTimeout=function(t){t=t||1e4,clearTimeout(this.rtpTimeout),this.rtpTimeout=setTimeout(this.timeout.bind(this),t)},p.prototype.connectUDP=function(t,n){this.stop(),this.onStart&&this.onStart(),this.resetTimeout(6e4),this.udpSocket=new o,this.context=n;a("8fce000400000002000000014341535400000064");var i=a("81c90007000000020000000100000000000000ef0000000027bfaff00000000080cf0004000000020400000283aff46335954e18"),e=0,s=0,c=function(t,n,i){this.resetTimeout(),i.id<e-32768&&s++,e=i.id;var r=new Uint8Array(this.aesIvMask).slice(0);r[11]^=255&i.id,r[10]^=i.id>>8&255,r[9]^=s%8;var o=function(t){this.writeAudio((s<<16)+i.id,t.slice(0));var n={aesKey:this.aesKey,aesIvMask:this.aesIvMask,packet:i,rolloverCount:s};this.audioQueue.queue(i.id,t,n)}.bind(this);window.crypto.subtle.decrypt({name:"AES-CTR",counter:r,length:16},this.cryptoAesKey,i.payload.slice(10)).then(t=>o(new Uint8Array(t)))}.bind(this),l=function(t,n,r){var o=r.getUint32(4),s=r.getUint32(10),c=i.slice(0);(c=new DataView(c)).setUint32(4,o+1),c.setUint32(8,o),c.setUint32(16,e),c.setUint32(24,s),c.setUint32(c.byteLength-4,(new Date).getTime()%4294967295),c.setUint32(c.byteLength-16,o+1),this.sendUDP(t,n,c)}.bind(this),d=function(t){var n=new DataView(t.buffer,t.byteOffset,t.byteLength),i=n.getInt32(0),e=t.slice(4,4+i),r=n.getInt32(4+i),o=t.slice(4+i+4),s=new DataView(o.buffer,o.byteOffset,o.byteLength),a=v(s);a.marker?l(e,r,s):c(e,r,a)}.bind(this);(function*(){var i=new Date,e=i.getUTCFullYear()+(i.getUTCMonth()+1).pad(2)+i.getUTCDate().pad(2)+"000000Z";try{var o=yield this.resolveAjax(e+".key.der"),s=yield this.resolveAjax(e+".der"),c=yield t.newSocket("tcp:53519",yield);if(!c)throw new Error("unable to connect to audio socket");this.udpSocket=c;var a=this.audioQueue=new r(n);a.sampleRate=this.sampleRate,a.numberOfChannels=this.numberOfChannels;var l=function(t){console.error("error decoding",t,arguments),this.audioQueue==a&&(this.audioQueue=null),a.stop(),this.udpSocket==c&&(this.udpSocket=null),c.destroy()}.bind(this);a.onError=l,c.onClose=l,c.bufferWrites=!0,yield u(c,password,yield),yield u(c,f(o),yield),yield u(c,f(s),yield),yield u(c,this.castId,yield),h(c,d)}catch(t){console.error("error connecting to udp",t)}}).bind(this)().async()},p.prototype.getPort=function(t,n){return this.audioListener.localPort},p.prototype.respond=function(t,n,i){return this.sendMessage(t,n.destinationId,n.sourceId,n.namespace,i)},p.prototype.sendMessage=function(t,n,i,e,r){"Object"==r.constructor.name&&(r=JSON.stringify(r));var o={protocolVersion:0,sourceId:n,destinationId:i,namespace:e,payloadType:"String"===r.constructor.name?0:1};o.payloadType?o.payloadBinary=r.constructor.encode(r).finish():o.payloadUtf8=r;var s=$protobuf.roots.default.cast_channel.CastMessage.encode(o).finish();l(t,s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength))},p.prototype.onMessage={},p.prototype.onMessage["urn:x-cast:com.google.cast.tp.deviceauth"]=function*(t,n){try{var i=new Date,e=i.getUTCFullYear()+(i.getUTCMonth()+1).pad(2)+i.getUTCDate().pad(2)+"000000Z",r=yield this.resolveAjax(e+".sig"),o=yield this.resolveAjax("cert-aa.der"),s=yield this.resolveAjax("cert-ab.der"),c=yield this.resolveAjax("cert-ac.der"),a=yield this.resolveAjax("cert-ad.der"),u={response:{signature:r=new Uint8Array(r),clientAuthCertificate:o=new Uint8Array(o),intermediateCertificate:[s=new Uint8Array(s),c=new Uint8Array(c),a=new Uint8Array(a)],signatureAlgorithm:1,senderNonce:null,hashAlgorithm:0,crl:null},error:null};this.respond(t,n,$protobuf.roots.default.cast_channel.DeviceAuthMessage.fromObject(u))}catch(t){console.error("error getting certs",t)}},p.prototype.onJSONMessage={},p.prototype.onJSONMessage.GET_APP_AVAILABILITY=function*(t,n,i){var e={availability:{},requestId:i.requestId,responseType:"GET_APP_AVAILABILITY"};$.each(i.appId,(function(t,n){e.availability[n]="APP_UNAVAILABLE"})),e["8E6C866D"]="APP_AVAILABLE",this.respond(t,n,e)},p.prototype.onJSONMessage.STOP=function*(t,n,i){this.sessionUUID=null,yield this.onJSONMessage.RECEIVER_STATUS.bind(this)(t,n,i,!0).async()},p.prototype.onJSONMessage.LAUNCH=function*(t,n,i){this.sessionUUID=d(),yield this.onJSONMessage.RECEIVER_STATUS.bind(this)(t,n,i,!0).async()},p.prototype.onJSONMessage.GET_STATUS=function*(t,n,i){yield this.onJSONMessage.RECEIVER_STATUS.bind(this)(t,n,i).async()},p.prototype.onJSONMessage.RECEIVER_STATUS=function*(t,n,i,e){var r={requestId:i.requestId,status:{userEq:{high_shelf:{frequency:4500,gain_db:0,quality:.707},low_shelf:{frequency:150,gain_db:0,quality:.707},max_peaking_eqs:0,peaking_eqs:[]},volume:{controlType:"master",level:1,muted:!1,stepInterval:.02}},type:"RECEIVER_STATUS"};this.sessionUUID&&(r.status.applications=[{appId:"8E6C866D",displayName:"Audio Mirroring",isIdleScreen:!1,launchedFromCloud:!1,namespaces:[{name:"urn:x-cast:com.google.cast.webrtc"},{name:"urn:x-cast:com.google.cast.media"},{name:"urn:x-cast:com.google.cast.debug"},{name:"urn:x-cast:com.google.cast.remoting"}],sessionId:this.sessionUUID,statusText:"Audio Mirroring",transportId:this.sessionUUID}]),e?this.sendMessage(t,n.destinationId,"*",n.namespace,r):this.respond(t,n,r)},p.prototype.onMessage["urn:x-cast:com.google.cast.receiver"]=function*(t,n,i){var e=this.onJSONMessage[i.type];e?yield e.bind(this)(t,n,i).async():console.error("unhandled cast json message",i)},p.prototype.onMessage["urn:x-cast:com.google.cast.media"]=p.prototype.onMessage["urn:x-cast:com.google.cast.receiver"],p.prototype.onMessage["urn:x-cast:com.google.cast.tp.heartbeat"]=function*(t,n){this.respond(t,n,{type:"PONG"})},p.prototype.onMessage["urn:x-cast:com.google.cast.tp.connection"]=function*(t,n){this.respond(t,n,{protocolVersion:0,type:"CONNECTED"})},p.prototype.onMessage["urn:x-cast:com.google.cast.receiver.discovery"]=function*(t,n,i){var e={controlNotifications:1,deviceCapabilities:2052,deviceIconUrl:"/setup/icon.png",deviceId:this.castId,deviceModel:"Google Home",friendlyName:"Kitchen",receiverMetricsId:"5C1CC5224680F4B2",requestId:i.requestId,type:"DEVICE_INFO",wifiProximityId:"FA8FCA7A7F1C"};this.respond(t,n,e)},p.prototype.onMessage["urn:x-cast:com.google.cast.webrtc"]=function*(t,n,i){for(var e in i.offer.supportedStreams){if(e=i.offer.supportedStreams[e],console.log("audio offer:",e),this.sampleRate=e.sampleRate,this.numberOfChannels=e.channels,null!=this.audioQueue){var r=this.audioQueue;r.sampleRate=this.sampleRate,r.numberOfChannels=this.numberOfChannels}48e3!=e.sampleRate&&console.warn("Offered sample rate is not 48000?",e.sampleRate),2!=e.channels&&console.warn("Offered channels is not 2?",e.channels)}var o={answer:{castMode:"mirroring",receiverRtcpEventLog:[0],rtpExtensions:[["adaptive_playout_delay"]],sendIndexes:[0],ssrcs:[2],udpPort:8010},result:"ok",seqNum:0,type:"ANSWER"};this.aesKey=a(i.offer.supportedStreams[0].aesKey),this.aesIvMask=a(i.offer.supportedStreams[0].aesIvMask),crypto.subtle.importKey("raw",this.aesKey,"AES-CTR",!1,["decrypt"]).then(i=>{this.cryptoAesKey=i,this.respond(t,n,o)})},p.prototype.siphon=function(t){this.pendingAudio=[],this.audioDump=t},p.prototype.writeAudio=function(t,n){if(this.audioDump){this.pendingAudio.push({id:t,decryptedBytes:n}),this.pendingAudio.sort((function(t,n){return t.id-n.id}));var i=this.pendingAudio.splice(0,50),e=this.pendingAudio;this.pendingAudio=i;for(var r=0;r<e.length;r++)this.audioDump.dataReceived(e[r].decryptedBytes)}},t.exports=p},function(t,n,i){const e=i(72),{appendBuffer:r,isBrowser:o,throttleTimeout:s}=i(1);function c(t){this.context=t,this.numSamples=1024,this.numSamplesDiv2=this.numSamples/2,this.numSamplesDiv4=this.numSamples/4,this.cleanup=this.numSamples/2,this.samples=new Array(this.numSamples),this.lastIndex=0}c.prototype.verify=function(t){t&&(255==t[0]&&240==(240&t[1])||(this.malformed=s(this.malformed,null,5e3,(function(){console.error("got a malformed adts sample?")}))))},c.prototype.stop=function(){null!=this.source&&this.source.stop(),this.pepperAudio&&this.pepperAudio.stop(),this.pepperAudio=null,this.source=null},c.prototype.queuePCMData=function(t,n,i){this.audioBuffer.copyToChannel(n,0,t*this.sampleLength),this.audioBuffer.copyToChannel(i,1,t*this.sampleLength),10==this.samplesDecoded&&this.source.start(),this.samplesDecoded++},c.prototype.decode=function(t,n){var i=(t+this.numSamples)%this.numSamples,s=o(),c=this.samples[i];if(null!=c){var a,u=(t-1+this.numSamples)%this.numSamples,h=(t+1)%this.numSamples;if(s)u=this.samples[u]||c,h=this.samples[h]||c;else if(u=this.samples[u],h=this.samples[h],!u||!h)return;var f=1;u?(f++,a=r(u,c)):a=c,h&&(f++,a=r(a,h)),this.context.decodeAudioData(a.sliceArrayBuffer(),function(n){if(s||this.pepperAudio||(console.log("pepper audio plugin created"),this.pepperAudio=new e),s&&!this.source){this.sampleLength=n.length/f;var r=n.sampleRate;console.log("audio sample rate",r),this.sampleRate&&r!=this.sampleRate&&(console.log("Decoded sampleRate does not match",r,this.sampleRate),r=this.sampleRate);var o=n.numberOfChannels;this.numberOfChannels&&n.numberOfChannels!=this.numberOfChannels&&(console.log("Decoded numberOfChannels does not match",o,this.numberOfChannels),o=this.numberOfChannels);var c=new AudioBuffer({length:this.sampleLength,numberOfChannels:o,sampleRate:r});this.silence=new Float32Array(this.sampleLength),c.copyFromChannel(this.silence,0),this.audioBuffer=new AudioBuffer({length:this.sampleLength*this.numSamples,numberOfChannels:o,sampleRate:r}),this.source=this.context.createBufferSource(),this.source.buffer=this.audioBuffer,this.source.loop=!0,this.source.connect(this.context.destination),this.samplesDecoded=0}if(s&&n.length!=this.sampleLength*f)console.error("unexpected decoded length");else{var a=n.length/f;0;var h=new Float32Array(a),l=new Float32Array(a);n.copyFromChannel(h,0,u?a:0),n.copyFromChannel(l,1,u?a:0),s?this.queuePCMData(i,h,l):this.pepperAudio.queueAudio(t,h,l)}}.bind(this),function(t){this.onError&&this.onError(n,f,a,t)}.bind(this))}else this.silence&&(this.audioBuffer.copyToChannel(this.silence,0,i*this.sampleLength),this.audioBuffer.copyToChannel(this.silence,1,i*this.sampleLength))},c.prototype.queue=function(t,n,i){var e=t%this.numSamples;if(e>=this.cleanup&&e<this.cleanup+this.numSamplesDiv4){for(var r=(this.cleanup+this.numSamplesDiv2)%this.numSamples,o=r+this.numSamplesDiv4,s=r;s<o;s++)this.samples[s]=null;this.cleanup=(this.cleanup+this.numSamplesDiv4)%this.numSamples}this.samples[e]=n,this.decode(t-1,i),this.decode(t,i),this.decode(t+1,i)},t.exports=c},function(t,n,i){const{isElectron:e}=i(1);function r(){var t,n,i,r;$("#listener2").empty(),e()?(t="host",n=null,i="application/x-ppapi-vysor-audio"):(t="pnacl",n="audio_playback/pnacl/Release",i=null),common2.createNaClModule("audio_playback",i,t,n,1,1,{},function(){}.bind(this),function(){if(r)return console.error("NACL module has already initalized"),console.error(r),void console.error(new Error("NACL New Initialization Stack"));r=new Error("NACL Initialization Stack"),console.log("NACL Audio module initialized")}.bind(this))}r.prototype.queueAudio=function(t,n,i){common2.naclModule&&common2.naclModule.postMessage&&common2.naclModule.postMessage({type:"queueAudio",audioBuffer0:n.buffer,audioBuffer1:i.buffer,id:t,sampleLength:n.byteLength/4})},r.prototype.stop=function(){common2.naclModule&&common2.naclModule.postMessage&&common2.naclModule.postMessage({type:"stop"})},t.exports=r},function(t,n){n.parseRTPPacket=function(t){const n=t.getUint8(0),i=t.getUint8(1)>>>7,e=4*(15&n)+(n>>4&1?16:12),r=t.buffer.slice(t.byteOffset+e);return{id:t.getUint16(2),timestamp:t.getUint32(4),ssrc:t.getUint32(8),length:r.byteLength,marker:i,payload:r}}},function(t,n,i){"use strict";i.r(n);var e=i(58),r=i.n(e);class o{constructor(t){this.gl=t,this.program=this.gl.createProgram()}attach(t){this.gl.attachShader(this.program,t)}link(){this.gl.linkProgram(this.program),this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)||console.error("Unable to initialize the shader program.")}use(){this.gl.useProgram(this.program)}getAttributeLocation(t){return this.gl.getAttribLocation(this.program,t)}getUniformLocation(t){return this.gl.getUniformLocation(this.program,t)}setUniformM4(t,n){this.gl.uniformMatrix4fv(t,!1,n)}}class s{static compile(t,n){let i;if("x-shader/x-fragment"===n.type)i=t.createShader(t.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!==n.type)throw new Error("Unknown shader type: "+n.type);i=t.createShader(t.VERTEX_SHADER)}if(t.shaderSource(i,n.source),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS))throw new Error("An error occurred compiling the shaders: "+t.getShaderInfoLog(i));return i}}const c={type:"x-shader/x-vertex",source:"\n  precision mediump float;\n\n  uniform mat4 u_projection;\n  attribute vec2 a_position;\n  attribute vec2 a_texCoord;\n  varying vec2 v_texCoord;\n  void main(){\n      v_texCoord = a_texCoord;\n      gl_Position = u_projection * vec4(a_position, 0.0, 1.0);\n  }\n"},a={type:"x-shader/x-fragment",source:"\n  precision lowp float;\n  \n  varying vec2 v_texCoord;\n  \n  uniform sampler2D yTexture;\n  uniform sampler2D uTexture;\n  uniform sampler2D vTexture;\n    \n  const mat4 conversion = mat4(\n    1.0,     0.0,     1.402,  -0.701,\n    1.0,    -0.344,  -0.714,   0.529,\n    1.0,     1.772,   0.0,    -0.886,\n    0.0,     0.0,     0.0,     0.0\n  );\n\n  void main(void) {\n    float yChannel = texture2D(yTexture, v_texCoord).x;\n    float uChannel = texture2D(uTexture, v_texCoord).x;\n    float vChannel = texture2D(vTexture, v_texCoord).x;\n    vec4 channels = vec4(yChannel, uChannel, vChannel, 1.0);\n    vec3 rgb = (channels * conversion).xyz;\n    gl_FragColor = vec4(rgb, 1.0);\n  }\n"};class u{static create(t){const n=this._initShaders(t),i=this._initShaderArgs(t,n),e=this._initBuffers(t);return new u(t,e,i,n)}static _initShaders(t){const n=new o(t);return n.attach(s.compile(t,c)),n.attach(s.compile(t,a)),n.link(),n.use(),n}static _initShaderArgs(t,n){const i={};return i.yTexture=n.getUniformLocation("yTexture"),i.uTexture=n.getUniformLocation("uTexture"),i.vTexture=n.getUniformLocation("vTexture"),i.u_projection=n.getUniformLocation("u_projection"),i.a_position=n.getAttributeLocation("a_position"),t.enableVertexAttribArray(i.a_position),i.a_texCoord=n.getAttributeLocation("a_texCoord"),t.enableVertexAttribArray(i.a_texCoord),i}static _initBuffers(t){return t.createBuffer()}constructor(t,n,i,e){this.gl=t,this.vertexBuffer=n,this.shaderArgs=i,this.program=e}setTexture(t,n,i){const e=this.gl;e.uniform1i(this.shaderArgs.yTexture,0),e.uniform1i(this.shaderArgs.uTexture,1),e.uniform1i(this.shaderArgs.vTexture,2),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t.texture),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,n.texture),e.activeTexture(e.TEXTURE2),e.bindTexture(e.TEXTURE_2D,i.texture)}use(){this.program.use()}release(){this.gl.useProgram(null)}updateShaderData(t,n){const{w:i,h:e}=t;this.gl.viewport(0,0,i,e),this.program.setUniformM4(this.shaderArgs.u_projection,[2/i,0,0,0,0,2/-e,0,0,0,0,1,0,-1,1,0,1]),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array([0,0,0,0,i,0,n.maxXTexCoord,0,i,e,n.maxXTexCoord,n.maxYTexCoord,i,e,n.maxXTexCoord,n.maxYTexCoord,0,e,0,n.maxYTexCoord,0,0,0,0]),this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.shaderArgs.a_position,2,this.gl.FLOAT,!1,16,0),this.gl.vertexAttribPointer(this.shaderArgs.a_texCoord,2,this.gl.FLOAT,!1,16,8)}draw(){const t=this.gl;t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),t.drawArrays(this.gl.TRIANGLE_STRIP,0,6),t.bindTexture(t.TEXTURE_2D,null)}}class h{static create(t,n){const i=t.createTexture();return t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null),new h(t,n,i)}constructor(t,n,i){this.gl=t,this.texture=i,this.format=n}subImage2dBuffer(t,n,i,e,r){const o=this.gl;o.bindTexture(o.TEXTURE_2D,this.texture),o.texSubImage2D(o.TEXTURE_2D,0,n,i,e,r,this.format,o.UNSIGNED_BYTE,t),o.bindTexture(o.TEXTURE_2D,null)}image2dBuffer(t,n,i){const e=this.gl;e.bindTexture(e.TEXTURE_2D,this.texture),e.texImage2D(e.TEXTURE_2D,0,this.format,n,i,0,this.format,e.UNSIGNED_BYTE,t),e.bindTexture(e.TEXTURE_2D,null)}delete(){this.gl.deleteTexture(this.texture),this.texture=null}}var f=class{constructor(t){this.canvas=t;const n=t.getContext("webgl");this.yuvSurfaceShader=u.create(n),this.yTexture=h.create(n,n.LUMINANCE),this.uTexture=h.create(n,n.LUMINANCE),this.vTexture=h.create(n,n.LUMINANCE)}onPicture(t,n,i){let e=this.canvas;e.width=n,e.height=i;const r=n,o=n/r,s=i/i,c=r*i,a=c>>2,u=t.subarray(0,c),h=t.subarray(c,c+a),f=t.subarray(c+a,c+2*a),l=i>>1,d=r>>1;let v=this.yTexture,p=this.uTexture,y=this.vTexture;v.image2dBuffer(u,r,i),p.image2dBuffer(h,d,l),y.image2dBuffer(f,d,l),this.yuvSurfaceShader.setTexture(v,p,y),this.yuvSurfaceShader.updateShaderData({w:n,h:i},{maxXTexCoord:o,maxYTexCoord:s}),this.yuvSurfaceShader.draw()}};var l=function(){function t(n,i){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.tinyH264Module=n,this.onPictureReady=i,this.pStorage=this.tinyH264Module._h264bsdAlloc(),this.pWidth=this.tinyH264Module._malloc(4),this.pHeight=this.tinyH264Module._malloc(4),this.pPicture=this.tinyH264Module._malloc(4),this._decBuffer=this.tinyH264Module._malloc(1048576),this.tinyH264Module._h264bsdInit(this.pStorage,0)}return t.prototype.release=function(){var t=this.pStorage;0!==t&&(this.tinyH264Module._h264bsdShutdown(t),this.tinyH264Module._h264bsdFree(t)),this.tinyH264Module._free(this.pWidth),this.tinyH264Module._free(this.pHeight),this.tinyH264Module._free(this.pPicture),this.pStorage=0,this.pWidth=0,this.pHeight=0},t.prototype.decode=function(n){if(n instanceof ArrayBuffer&&(n=new Uint8Array(n)),this.tinyH264Module.HEAPU8.set(n,this._decBuffer),this.tinyH264Module._h264bsdDecode(this.pStorage,this._decBuffer,n.byteLength,this.pPicture,this.pWidth,this.pHeight)===t.PIC_RDY){var i=this.tinyH264Module.getValue(this.pWidth,"i32"),e=this.tinyH264Module.getValue(this.pHeight,"i32"),r=this.tinyH264Module.getValue(this.pPicture,"i8*"),o=new Uint8Array(this.tinyH264Module.HEAPU8.subarray(r,r+i*e*3/2));this.onPictureReady(o,i,e)}},t}();l.RDY=0,l.PIC_RDY=1,l.HDRS_RDY=2,l.ERROR=3,l.PARAM_SET_ERROR=4,l.MEMALLOC_ERROR=5;var d=l,v=i(59),p=i.n(v);const y={"TinyH264.wasm":i.p+"f99175d3b657e4fac2c971aa69fe9513.asset"},w=p()({locateFile:t=>y[t]});let m=1;var g=class{constructor(t,n,i){this.queue=[],this.videoStreamId=m++,this.pendingDecodes=0,this.useOffscreenCanvas=!0,this.useWorker=!0,this.useWorker?(this.tinyH264Worker=new r.a,this.tinyH264Worker.addEventListener("message",n=>{const i=n.data;switch(i.type){case"pictureReady":this.onPictureReady(i);break;case"decoded":this.notifyDecoded();break;case"decoderReady":this.notifyReady(t)}})):(this.decoder=new d(w,(t,n,i)=>{this.canvasRenderer.onPicture(t,n,i)}),setTimeout(()=>this.notifyReady(t),0))}notifyDecoded(){this.pendingDecodes--,this.decodeNext()}notifyReady(t){this.initWebGLCanvas(t),this.onReady?this.onReady():console.error("no listener for decoder-ready")}initWebGLCanvas(t){for(;t.firstChild;)t.removeChild(t.firstChild);let n=document.createElement("canvas");if(n.style.width="100%",n.style.height="100%",t.append(n),this.useOffscreenCanvas&&n.transferControlToOffscreen){var i=n.transferControlToOffscreen();this.tinyH264Worker.postMessage({type:"canvas",canvas:i,renderStateId:this.videoStreamId},[i])}else this.canvasRenderer=new f(n)}onPictureReady(t){const{width:n,height:i,data:e}=t;this.canvasRenderer.onPicture(new Uint8Array(e),n,i)}release(){this.tinyH264Worker&&(tinyH264Worker.postMessage({type:"release",renderStateId:this.videoStreamId}),tinyH264Worker=null)}enqueueDecode(t){this.tinyH264Worker?this.tinyH264Worker.postMessage({type:"decode",data:t.buffer,offset:t.byteOffset,length:t.byteLength,renderStateId:this.videoStreamId},[t.buffer]):(this.decoder.decode(t),this.notifyDecoded())}decodeNext(){if(0==this.queue.length)return;if(this.pendingDecodes>10)return;this.pendingDecodes++;const t=this.queue.shift().video;this.enqueueDecode(t)}decode(t,n,i){i&&(this.queue=[]),this.queue.push({video:t,presentationTimeMs:n}),this.decodeNext()}};const{isBrowser:b,getQueryVariable:k,throttleTimeout:A,nextTick:C,isElectron:S,readLine:T,writeLine:E,readLenPackets:x}=i(1),F=i(32),{populateDisplaySettings:U,loadDeviceSettings:I,applyDeviceSettings:N,saveDeviceSettings:B,showNotification:O}=i(56),R=i(69),{showModal:M,shortModal:D}=i(55),{getUserSelectedDevices:_,AdbServer:j}=i(14),{GcmRtcManager:z}=i(33);var P,V,L,q,Y,J,W,H,X,K,G,Q,Z,tt,nt,it,et,rt,ot,st,ct=36,at=48,ut=vysorDefaultSettings,ht=function(){};const ft=i(70),lt=window.sharedGlobals;if(!b()){var dt=new ft;dt.onStop=function(){$("#headphones").show()},dt.onStart=function(){$("#headphones").hide()}}function vt(){if(!st)try{st=new AudioContext({latencyHint:"interactive",sampleRate:48e3}),console.log("Created AudioContext",st)}catch(t){console.error("Error creating AudioContext",t)}}function pt(){if(!b()&&window._lm&&window._lm._il){if(P&&!dt.udpSocket&&st){if(console.log("Connecting to UDP"),!L.castId){L.castId=function(t){for(var n="",i=0;i<t;i++)n+="abcdef0123456789".charAt(Math.floor(Math.random()*"abcdef0123456789".length));return n}(40),Nt()}dt.castId=L.castId,dt.connectUDP(adbSocketFactory,st),M({title:"Vysor Audio Output",body:'Vysor is waiting for the audio stream. Follow the <a target="_blank" href="https://github.com/koush/vysor.io/issues/426">instructions</a> to grant Vysor permission to capture your Android audio output.',okButton:"Open Instructions",ok:function(){C((function(){chrome.browser.openTab({url:"https://github.com/koush/vysor.io/issues/426"})}))},cancelButton:"OK"})}F.shell({socketFactory:adbSocketFactory,command:"am start -a android.settings.CAST_SETTINGS",serialno:device.serialno},(function(){console.log("asdsad")}))}}S()&&vt(),lt.siphonAudio=function(t){it&&(it.destroy(),it=null),t&&(it=S()?{dataReceived:function(n){n.asUint8Array&&(n=n.asUint8Array()),n.constructor==ArrayBuffer&&(n=new Uint8Array(n)),t.dataReceived(n)},destroy:function(){t.destroy()}}:t,dt.siphon(it))},lt.siphonFlv=function(t){nt&&(nt.destroy(),nt=null,et=null),t&&(nt=S()?{dataReceived:function(n){n.asUint8Array&&(n=n.asUint8Array()),n.constructor==ArrayBuffer&&(n=new Uint8Array(n)),t.dataReceived(n)},destroy:function(){t.destroy()}}:t,et=new FlashPackager(nt,H,X,30),rt=!0,At({type:"resolution",resolution:mt[L.resolution]}))};var yt,wt,mt=[0,.25,.5,.75,1],gt=[5e5,75e4,1e6,15e5,2e6,3e6,4e6,6e6,8e6],bt=["software","hardware","hardware_with_fallback","tinyh264"],kt=function(t,n){return n};function At(t){V&&(t.clientX&&(t.downDelta=Date.now()-Z,Q||(Q=$("#listener")),t.clientX=t.clientX/Q.width()*J,t.clientX>J||t.clientX<0)||t.clientY&&(Q||(Q=$("#mirror")),t.clientY=t.clientY/Q.height()*W,t.clientY>W||t.clientY<0)||V.send(JSON.stringify(t)))}function Ct(t,n){if(t){if("String"==t.constructor.name){if(t.startsWith("KEYCODE_"))return At({type:"keyevent",keyevent:t}),!0;switch(t){case"VYSOR_SHOW_TITLE_BAR":St();break;case"VYSOR_ENTER_FULLSCREEN":Ft(!0);break;case"VYSOR_EXIT_FULLSCREEN":Ft(!1);break;case"VYSOR_RECORD_SCREEN":b()||ht(n);break;case"VYSOR_SCREENSHOT":b()||chrome.browser.openTab({url:"http://127.0.0.1:"+window.httpPort+"/device/"+(device.id||device.serialno)+"/screenshot-"+Date.now()+".jpg"});break;case"VYSOR_OPEN_DEVICE_SETTINGS":showSettings(),b()||openList();break;case"VYSOR_ROTATE_SCREEN":At({type:"rotate"});break;default:return}return!0}return"Number"==t.constructor.name?(At({type:"keycode",keycode:t}),!0):t.keyevent?(At({type:"keyevent",keyevent:t.keyevent,shift:!!(t.shiftKey&&n&&n.shiftKey)}),!0):t.keycode?(At({type:"keycode",keycode:t.keycode,shift:!!(t.shiftKey&&n&&n.shiftKey)}),!0):void 0}}function St(){if("inkwire"!=q){if(ct)return clearTimeout(Y),void $(".head").fadeTo(0,1);$(".head").fadeTo(0,.8),clearTimeout(Y),Y=setTimeout((function(){$(".head").fadeOut()}),2e3)}else $(".head").hide()}function Tt(){return document.webkitFullscreenElement||document.msFullscreenElement||document.mozFullscreenElement||document.fullscreenElement}function Et(){return L&&L.displaySettings&&L.displaySettings.freeSize}function xt(){var t=innerWidth,n=innerHeight,i=screen.availWidth,e=screen.availHeight;(Tt()||Et()||b())&&(i=t,e=n),K>i&&(G=W/J*(K=i));if(G+at+ct+0>e&&(K=J/W*(G=e-at-ct-0)),K&&G){var r=Math.round(K),o=Math.round(G+at+ct);Tt()||Et()||(ot?ot=!1:(ot=!0,S()?(Math.abs(innerWidth-r)>=2||Math.abs(innerHeight-o)>=2)&&chrome.app.window.current().w.setContentSize(r,o):window.chrome&&window.chrome.app&&window.chrome.app.window&&(Math.abs(innerWidth-r)>=2&&(chrome.app.window.current().innerBounds.width=r),Math.abs(innerHeight-o)>=2&&(chrome.app.window.current().innerBounds.height=o))));var s=(t-K)/2,c=$("#mirror, #listener");c.css("left",s),c.css("top",(n-G-at+ct)/2),$(".foot").width(K),$(".foot").css("left",s),$(".overlay").width(K),$(".overlay").css("left",s),(c=$("#mirror, embed, #listener")).width(Math.round(K)),c.height(Math.round(G)),$("#dead, #drag, #reconnect").width(K),$("#dead, #drag, #reconnect").height(G+at+ct)}}function $t(t){window.chrome&&window.chrome.storage&&chrome.storage.local.get(["vysorUsage","vysorDailyUsage","lastDailyReport"],(function(n){var i=n.vysorUsage,e=n.lastDailyReport,r=n.vysorDailyUsage,o=Date.now();if(i||(i=0),r||(r=0),e){if(o>e+864e5){var s=r/36e5;(s=Math.round(2*s)/2)<=24&&s>=0&&(tracker.sendEvent("daily-usage",s.toString()),tracker.sendEvent("daily-usage-licensed",_lm._il)),r=0,chrome.storage.local.set({lastDailyReport:o})}}else chrome.storage.local.set({lastDailyReport:o});var c=i;i+=t,c<72e5&&i>72e5?window._lm&&window._lm._il||function(){if(L.hasRecommendedPro)return;L.hasRecommendedPro=!0,Nt(),M({title:"Vysor Pro",body:"Vysor Pro gives you high quality video, Audio Mirroring, and many more features. Please consider upgrading!",okButton:"Purchase Vysor Pro",ok:function(){_lm.startPurchase()}.bind(this)})}():i>108e5&&function(){if(L.hasRecommendedRate)return;L.hasRecommendedRate=!0,Nt(),M({title:"Vysor",body:"You seem to be finding Vysor useful. We'd love to hear your thoughts on the Play Store!'",okButton:"Rate Vysor",ok:function(){adbSocketFactory.newSocket("shell:am start -d http://play.google.com/store/apps/details?id=com.koushikdutta.vysor -a android.intent.action.VIEW")}.bind(this)})}(),r+=t,chrome.storage.local.set({vysorUsage:i,vysorDailyUsage:r})}))}function Ft(t){t?document.documentElement.requestFullscreen?document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen?document.documentElement.webkitRequestFullscreen():document.documentElement.msRequestFullscreen?document.documentElement.msRequestFullscreen():document.documentElement.mozRequestFullScreen&&document.documentElement.mozRequestFullScreen():document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozExitFullscreen?document.mozExitFullscreen():document.mskitExitFullscreen&&document.mskitExitFullscreen()}function Ut(){$(".topbuttonbar>.btn-toolbar").empty(),$(".head").attr("style",ut.titleBar.style);var t=ut.titleBar.buttonGroups;!function(){if(!b()){var t=$("<span id='headphones'></span>");t.attr("class","btn-group btn-group-xs"),t.attr("role","group");var n=$("<a></a>");n.attr("class","btn btn-default fa fa-headphones"),n.attr("title","Mute Phone and Mirror Audio"),n.click(kt("Audio Mirroring",(function(){vt(),pt()}))),t.append(n),$(".topbuttonbar>.btn-toolbar").append(t)}}(),$(t).each((function(t,n){var i=$("<span></span>");i.attr("class","btn-group btn-group-xs"),i.attr("role","group"),$(n).each((function(t,n){var e=$("<a></a>");e.attr("class","btn btn-default fa "+n.class),e.attr("title",n.title),e.click((function(t){Ct(n.event,t)})),i.append(e)})),$(".topbuttonbar>.btn-toolbar").append(i)}))}function It(){$(".foot-row").empty(),$(".foot-row").attr("style",ut.navigationBar.style);var t=ut.navigationBar.buttons,n=Math.round(100/t.length)+"%";$(t).each((function(t,i){var e=$("<span></span>");e.attr("class","fa fa-lg "+i.class),e.attr("title",i.title),e.width(n),e.click((function(){Ct(i.event)})),$(".foot-row").append(e)}))}function Nt(){B(device.id||device.serialno,L)}function Bt(){if(window._lm&&!_lm._il){for(var t=[],n=1;n<=9;n++)t.unshift(n);var i=t.length+1;$(t).each((function(t){setTimeout((function(){$(".title, title").text("Ad in "+t+" seconds.")}),1e3*(i-t))})),At({type:"toast",toast:"Vysor ad in "+i+" seconds.\nUpgrade for an ad free experience."}),setTimeout((function(){$(".title, title").text(L.friendlyName||device.name),V||(clearInterval(wt),wt=null),tracker.sendEvent("ad-impression"),adbSocketFactory.newSocket("shell:am start -n com.koushikdutta.vysor/.VysorAdActivity")}),1e3*i)}}function Ot(){window._lm&&window._lm._il&&(L.hasRecommendedHighQuality?function(){window._lm&&window._lm._il&&(L.hasRecommendedAudio||(L.hasRecommendedAudio=!0,Nt(),M({title:"Audio Mirroring",body:'You can mute your Android and Mirror audio to your computer by clicking the headphone icon in the toolbar above: <span class="fa fa-headphones"></span>',okButton:"Mirror Audio",ok:function(){vt(),pt()}.bind(this)})))}():(L.hasRecommendedHighQuality=!0,Nt(),M({title:"High Quality Video",body:"The video quality can be customized by clicking the Settings icon in the toolbar. Would you like to try the recommended High Quality settings?",okButton:"Use High Quality Settings",ok:function(){$("#high-quality-defaults").click(),Nt()}.bind(this)})))}window.tracker||(window.tracker={sendEvent:function(){},sendAppView:function(){}}),$(window).focus((function(){St(),At({type:"wakeup"})})),$(window).bind("paste",(function(t){var n=t.originalEvent.clipboardData.getData("text");n&&n.length&&At({type:"keychar",keychar:n})})),window.addEventListener("mousewheel",(function(t){At({type:"scroll",clientX:t.offsetX,clientY:t.offsetY,deltaX:t.wheelDeltaX/100,deltaY:t.wheelDeltaY/100})}),!1),$(window).keypress((function(t){var n=String.fromCharCode(t.keyCode);n.length&&At({type:"keychar",keychar:n})})),$(window).keydown((function(t){Ct(ut.keydown[t.keyCode]||ut.keydown[t.key],t)&&t.stopPropagation()})),$(window).resize((function(){W&&J&&(clearTimeout(yt),yt=setTimeout((function(){if(Et())At({type:"displaySettings",size:innerWidth+"x"+(innerHeight-ct-at),density:L.displaySettings.density});else{var t=innerWidth;K=t,G=t*(W/J),xt()}}),500))})),lt.docReady=function(){var t;kt=window._lm?function(t,n,i){return function(){if(tt&&!_lm._il)return M({title:"Vysor Pro",body:"The "+t+" feature is only available to Vysor Pro users.",okButton:"Upgrade",ok:function(){_lm.startPurchase()}}),void(i&&i.apply(this,arguments));n.apply(this,arguments)}}:function(t,n){return n},ht=kt("Record Screen",(function(t){$(t.target).hasClass("fa-stop-circle-o")?At({type:"stop-recording"}):At({type:"start-recording"}),$(t.target).toggleClass("fa-video-camera fa-stop-circle-o")})),$(document).on("dragover",(function(n){$("#drag").fadeIn(),clearTimeout(t),n.preventDefault(),n.stopPropagation()})),$(document).on("dragleave",(function(){t=setTimeout((function(){$("#drag").fadeOut()}),1e3)})),$(document).on("drop",kt("Drag and Drop",(function(t){if($("#drag").fadeOut(),t.preventDefault(),1==t.originalEvent.dataTransfer.files.length){var n=t.originalEvent.dataTransfer.files[0];console.log(n),F.push({socketFactory:adbSocketFactory,socket:new FileSocket(n),file:"/sdcard/vysor/"+n.name,serialno:device.serialno},(function(){var t="am start -a android.intent.action.VIEW -d file:/sdcard/vysor/"+n.name;if(n.type&&n.type.length)t+=" -t "+n.type;else if(n.name.endsWith(".apk"))return void F.shell({socketFactory:adbSocketFactory,command:"pm install -r /sdcard/vysor/"+n.name,serialno:device.serialno},(function(t){O("APK installation result: "+t.trim())}));F.shell({socketFactory:adbSocketFactory,command:t,serialno:device.serialno},(function(){O("File has been transfered and is being opened on the Android.")}))}))}else O("You may only drag and drop one file at a time.")}),(function(t){$("#drag").fadeOut(),t.preventDefault()}))),common.attachDefaultListeners(),common2.attachDefaultListeners(),$("#listener").mouseup((function(t){0==t.button&&At({type:t.type,clientX:t.offsetX,clientY:t.offsetY})})),$("#listener").bind("touchstart touchend touchmove",(function(t){var n;n="touchstart"==t.type?"mousedown":"touchend"==t.type?"mouseup":"mousemove";var i=t.currentTarget;t.stopPropagation(),t.preventDefault();var e=(t=t.originalEvent).touches[0];e||(e=t.changedTouches[0]);var r=document.createEvent("MouseEvent");r.initMouseEvent(n,!0,!0,window,t.detail,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),r.isTouch=!0,i.dispatchEvent(r)})),console.log("docReady"),$("#listener").mousedown((function(t){if(0==t.button)return Z=Date.now(),void At({type:t.type,clientX:t.offsetX,clientY:t.offsetY});Ct(ut.mousedown[t.button],t)})),$("#listener").mousemove((function(t){(0!=(1&t.buttons)||t.originalEvent.isTouch)&&At({type:t.type,clientX:t.offsetX,clientY:t.offsetY})})),$(".head").bind("mouseup mousedown mousemove",(function(t){t.stopPropagation(),St()})),$("#rotate-button").click((function(){At({type:"rotate"})})),$("#screenshot-button").click((function(){chrome.browser.openTab({url:"http://127.0.0.1:"+httpPort+"/device/"+(device.id||device.serialno)+"/screenshot-"+Date.now()+".jpg"})})),$("#record-button").click(kt("Record Screen",(function(){$("#record-button>span").hasClass("fa-video-camera")?At({type:"start-recording"}):At({type:"stop-recording"}),$("#record-button>span").toggleClass("fa-video-camera fa-stop-circle-o")}))),window.chrome&&window.chrome.app&&window.chrome.app.window||($("#screenshot-button").hide(),$("#record-button").hide()),$("#power").click((function(){At({type:"keycode",keycode:26})})),$("#volume-down").click((function(){At({type:"keycode",keycode:25})})),$("#volume-up").click((function(){At({type:"keycode",keycode:24})})),It(),Ut(),$("#reconnect-button").click((function(){tryReconnect(),$("#reconnect").hide()})),$("#settings-button").click((function(){showSettings(),b()||openList()})),$("#web-video-stream").click(kt("Web Video Stream",(function(){var t=$("#web-video-stream").text();$("#settings-modal").modal("hide"),copyTextToClipboard(t),setTimeout((function(){D("Copied Web Video Stream Link",t)}),500)})));var n=$("#new-display-name");function i(){$("#settings-modal").modal("hide");var t=$(n).prop("value");L.friendlyName=t,$(".title, title").text(L.friendlyName||device.name),Nt();var i=chrome.app.window.get("list");i&&i.contentWindow.updateDeviceName&&i.contentWindow.updateDeviceName(device.id||device.serialno,L.friendlyName||device.name)}function e(t,n){$("#bitrate").prop("selectedIndex",t),$("#resolution").prop("selectedIndex",n),L.bitrate=t,At({type:"bitrate",bitrate:t=gt[t]}),L.resolution=n,At({type:"resolution",resolution:n=mt[n]})}$(n).bind("keypress",(function(t){if(t.stopPropagation(),13==t.which)return i(),!1})),$("#settings-ok").click(i),$("#settings-defaults").click((function(){L=getDefaultDeviceSettings();try{tt=!1,N(L)}finally{tt=!0}At({type:"displaySettings",size:"reset",density:"reset",resolution:mt[L.resolution]})})),$("#softkeys-check").change((function(){L.showSoftKeys=this.checked,this.checked?($(".foot").show(),at=48):($(".foot").hide(),at=0),xt()})),$("#pin-title-check").change((function(){L.pinTitleBar=this.checked,ct=this.checked?36:0,xt(),St()})),$("#fullscreen-check").change(kt("Fullscreen Mode",(function(){Ft(this.checked)}),(function(){this.checked=!1}))),$("#always-on-top-check").change(kt("Always On Top",(function(){L.alwaysOnTop=this.checked,window.chrome&&window.chrome.app&&window.chrome.app.window&&chrome.app.window.current().setAlwaysOnTop(this.checked)}),(function(){this.checked=!1}))),$("#bitrate").change(kt("Video Quality",(function(){L.bitrate=this.selectedIndex,At({type:"bitrate",bitrate:gt[this.selectedIndex]})}),(function(){this.selectedIndex=0}))),$("#resolution").change(kt("Video Resolution",(function(){L.resolution=this.selectedIndex,At({type:"resolution",resolution:mt[this.selectedIndex]})}),(function(){this.selectedIndex=0}))),$("#decoder").change((function(){L.decoder=this.selectedIndex,At({type:"resolution",resolution:mt[L.resolution]})})),$("#low-quality-defaults").click(kt("Video Quality",(function(){e(0,0)}))),$("#medium-quality-defaults").click(kt("Video Quality",(function(){e(4,2)}))),$("#high-quality-defaults").click(kt("Video Quality",(function(){e(8,3)}))),$("#display-settings").change(kt("Display Settings",(function(){var t=function(){var t=commonDisplaySettings[this.selectedIndex],n=t.freeSize?innerWidth+"x"+(innerHeight-ct-at):t.size;L.displaySettings=t,Nt(),At({type:"displaySettings",size:n,density:t.density}),this.selectedIndex&&M({title:"Display Settings",body:"Please close the Vysor window before disconnecting your Android to reset your Display Settings.",hideCancel:!0})}.bind(this);0!=this.selectedIndex?M({title:"Display Settings",body:"The Display Settings feature is not recommended for non-Nexus devices and may require you to hard reset your device.",okButton:"Continue",ok:function(){$("#notificationModal").one("hidden.bs.modal",t)}.bind(this),cancel:function(){this.selectedIndex=0}.bind(this)}):t()}),(function(){this.selectedIndex=0}))),$("#dim-display").change(kt("Dim Dislay",(function(){L.dimDisplay=this.checked,Nt(),At({type:"dimDisplay",dimDisplay:this.checked})}),(function(){this.checked=!1}))),U(),xt(),St(),window.tracker&&tracker.sendAppView("screen")},lt.connectionReady=function(){var t;function n(n){if("displaySize"==n.type){var i=J,e=W;J=n.screenWidth,W=n.screenHeight,function(t,n){if(Et())K=J,G=W;else if(window.chrome&&window.chrome.app&&window.chrome.app.window&&Tt()&&(K=screen.availWidth,G=screen.availHeight),n==J&&t==W){var i=K;K=G,G=i}else{var e;e=J>W?Math.max(innerWidth,innerHeight):Math.min(innerWidth,innerHeight),K=e,G=e*(W/J)}xt()}(i,e)}else if("encodeSize"==n.type){if(H=n.encodeWidth,X=n.encodeHeight,!P)return void a();t=A(t,null,1e3,(function(){P.onClose=null,P.destroy(),P=null,a()}))}else if("clip"==n.type)copyTextToClipboard(n.clip);else if("password"==n.type);else if("recording"==n.type){var r=n.recording.replace("/sdcard/vysor/","");chrome.browser.openTab({url:"http://127.0.0.1:"+httpPort+"/device/"+(device.id||device.serialno)+"/sdcard-vysor/"+r})}else console.log("unknown",n)}console.log("connectionReady"),$("#loading").fadeIn(),$("#dead, #reconnect").fadeOut(),St(),device||console.error("device not defined on window object?"),window.chrome&&window.chrome.storage&&window.chrome.storage.local&&chrome.storage.local.get("vysorSettings",(function(t){ut={},Object.assign(ut,vysorDefaultSettings,t.vysorSettings);var n=ut.devices&&ut.devices[device.id||device.serialno]||{};ut.navigationBar=n.navigationBar||ut.navigationBar,ut.titleBar=n.titleBar||ut.titleBar,Object.assign(ut.keydown,n.keydown),Object.assign(ut.mousedown,n.mousedown),It(),Ut()}));var i=0;function e(){console.log("input websocket failed, retrying. attempt "+i+" out of 20"),setTimeout(r,500)}function r(){20!=++i?o((function(t){t?(V=t,P&&(P.onClose=null,P.destroy(),P=null),V.onopen=function(){console.log("input websocket opened"),b()||F.reverse({serialno:device.serialno,from:"tcp:8010",to:"tcp:"+dt.getPort()},(function(t){console.log("audio listener",t)})),V.onerror=null;var t=L.displaySettings||{},n=t.freeSize?innerWidth+"x"+(innerHeight-at-ct):"reset"==t.size?null:t.size,i="reset"==t.density?null:t.density;At({type:"password",password:password,resolution:mt[L.resolution],size:n,density:i,dimDisplay:L.dimDisplay})},V.onerror=e,V.onmessage=function(t){console.log("event from phone",t.data),n(JSON.parse(t.data))}):e()})):c()}window.adbSocketFactory||("adb-client"==adbSocketFactoryFactory.type?adbSocketFactory=F.createSocketFactory(adbSocketFactoryFactory.arguments.serialno):console.error("unknown adb socket factory factory",adbSocketFactoryFactory.type));var o=function(t){adbSocketFactory.newSocket("tcp:53518",(function(n){if(n){var i,e=function(){var t;i&&(i.length?t=i.shift():i=null,t&&E(n,t,e))};n.close=n.destroy.bind(n),n.send=function(t){i?i.push(t):(i=[],E(n,t,e))}.bind(n),t(n);var r=!1;n.onClose=function(){r||n.onerror&&n.onerror()},T(n,(function t(i){r||(r=!0,n.onopen&&n.onopen()),n.onmessage&&n.onmessage({data:i}),T(n,t)}))}else t()}))};function s(){window.tryReconnect?$("#reconnect").fadeIn():$("#dead").fadeIn(),$("#listener").empty()}function c(t){if(console.log("received socket",t),P&&(P.onClose=null,P.destroy(),P=null),P=t,$(".overlay").fadeOut(),t){t.name="h264",t.onClose=function(){try{s()}catch(t){console.log("eating error that occurs with jquery if window is being closed...")}console.log("closing input "),V&&V.close(),V=null,P==t&&(P=null)};var n=b()?3:0,i=bt[L.decoder||n];if(console.log("decoder: "+i),b()||"tinyh264"==i)var e=new g($("#listener")[0],H,X);else e=new R(H,X,i);var r,o,c=!0;e.onDecoderFallingBehind=function(){o=A(o,null,1e3,(function(){console.log("requesting sync frame"),At({type:"sync-frame"})}))},e.onReady=function(){console.log("starting read loop");var n=setTimeout((function(){O("Your Android screen is unavailable right now. This can sometimes be resolved by rebooting your Android.")}),5e3);window._lm&&(_lm._il||wt||(clearInterval(wt),wt=setInterval(Bt,9e5),setTimeout((function(){Bt()}),12e4))),x(t,(function(t){if(n){if(clearTimeout(n),n=void 0,Ot(),!window.chrome||!window.chrome.storage)return;At({type:"bitrate",bitrate:gt[L.bitrate]})}for(var i of t)a(i)}),!0)},xt()}else s();function a(n){var i=n.subarray(8),o=new DataView(n.buffer,n.byteOffset,8),s=o.getUint32(0,!0),a=0!=o.getUint32(4,!0);et&&t==P&&(c?et.addVideoHeader(i):rt||et.addVideoFrame(i,s,a)),c&&(rt=!1,c=!1),e.decode(i,s,a);var u=Date.now();if(r){var h=u-r;h>6e4&&(r=u,$t(h))}else r=u,tracker.sendEvent("view-device")}}function a(){adbSocketFactory.newSocket("tcp:53517",(function(t){t?E(t,password,(function(){c(t)})):c()}))}console.log("init"),I(device.id||device.serialno,(function(t){L=t,r(),window._lm&&window._lm._il||(L.bitrate=0,L.resolution=0,L.alwaysOnTop=!1),N(L),tt=!0,xt(),$(".title, title").text(L.friendlyName||device.name)}))},window.chrome&&window.chrome.app&&window.chrome.app.window?($(document).ready(docReady),function(){function t(){if(!Tt())return showSettings(),D(null,"Vysor has been maximized. If you wish enable Fullscreen Mode, it can be enabled in Settings."),void setTimeout((function(){chrome.app.window.current().restore()}),1e3)}chrome.app.window.current().onFullscreened.addListener(t),chrome.app.window.current().onMaximized.addListener(t)}()):(window.device={id:"web",serialno:"web"},"inkwire"==(q=k("mode"))&&(device={id:"inkwire",serialno:"inkwire"}),$(document).ready((function(){docReady(),"inkwire"==q&&($("title").text("Inkwire"),ct=0,$(".foot").hide(),at=0,xt());var t=k("registrationId");if(t){var n=k("senderId");n||(n="64148182473");var i,e=k("audio");"inkwire"==q&&(n="3505780036",e=!0),z.start({3505780036:"AIzaSyDt0GimPRhk8_d_4XjOYzQUn50UkvXhMtE",64148182473:"AIzaSyDd7k1v017osyYbIC92fyf-36s3pv0z73U"},{iceServers:[{urls:["turn:n0.clockworkmod.com","turn:n1.clockworkmod.com"],username:"foo",credential:"bar"}]},(function(r){console.log("attempting to connect to vysor from web"),(i=r).sharedDevices={};var o=k("channel");i.connect({senderId:n,registrationId:t,port:o}).then((function(r){console.log("web connection established"),e&&(console.log("attempting audio"),i.connect({senderId:n,registrationId:t,port:o,audio:!0,offerToReceiveAudio:!0}).then((function(t){console.log("got audio");var n=new Audio;n.srcObject=t.streams[0],n.play()}))),console.log("gcmConn",r),window.adbSocketFactory=r,console.log("starting remote vysor daemon"),r.newSocket("webstart",(function(t){console.log("waiting for password"),T(t,(function(n){t.destroy(),console.log("got password",n),window.password=n,connectionReady()}))}))}))}))}else M({title:"Select Android Device",body:"Select the Android device you want to mirror.",okButton:"Select",ok:function(){_().then(t=>{var n=new j({start:!1});n.dummyListen=!0;for(let i of t)n.refreshDevice(i,t=>{i=n.adbDevices[t.serialno]})})}})}))),lt.updateWindowStatusText=function(t){$("#loading-text").html(t)},lt.showSettings=function(){var t=$("#new-display-name");t.prop("value",L.friendlyName),t.prop("placeholder",device.name),$("#web-video-stream").text("http://127.0.0.1:"+window.httpPort+"/device/"+(device.id||device.serialno)+"/video.flv"),$("#web-audio-stream").text("http://127.0.0.1:"+window.httpPort+"/device/"+(device.id||device.serialno)+"/audio.adts"),$("#settings-modal").modal()}}]);
//# sourceMappingURL=screen.js.map