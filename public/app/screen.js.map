{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///(webpack)/buildin/global.js","webpack:////Volumes/Dev/Gradle/Chrome/lib/base/util.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/debug/src/browser.js","webpack:////Volumes/Dev/Gradle/Chrome/lib/socket/socket.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/component-emitter/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-parser/lib/browser.js","webpack:///./node_modules/process/browser.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/parseqs/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/component-inherit/index.js","webpack:///./node_modules/buffer/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/socket.io-parser/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/isarray/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-client/lib/xmlhttprequest.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-client/lib/transport.js","webpack:////Volumes/Dev/Gradle/Chrome/adb/adb.js","webpack:///./node_modules/base64-js/index.js","webpack:///./node_modules/ieee754/index.js","webpack:///./node_modules/isarray/index.js","webpack:////Volumes/Dev/Gradle/Chrome/adb/adb-chrome-usb.js","webpack:////Volumes/Dev/Gradle/Chrome/adb/adb-web-usb.js","webpack:////Volumes/Dev/Gradle/Chrome/lib/socket/dummysocket.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/parseuri/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/socket.io-parser/is-buffer.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/socket.io-client/lib/manager.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-client/lib/transports/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-client/lib/transports/polling.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/has-binary2/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/yeast/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/indexof/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/socket.io-client/lib/socket.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/socket.io-client/lib/on.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/component-bind/index.js","webpack:////Volumes/Dev/Gradle/Chrome/adb/adb-client.js","webpack:////Volumes/Dev/Gradle/Chrome/lib/socket/gcmsocket.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/node-fetch/browser.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/socket.io-client/lib/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/socket.io-client/lib/url.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/debug/src/debug.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/ms/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/socket.io-parser/binary.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-client/lib/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-client/lib/socket.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/has-cors/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-client/lib/transports/polling-xhr.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-parser/lib/keys.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/arraybuffer.slice/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/after/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-parser/lib/utf8.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/base64-arraybuffer/lib/base64-arraybuffer.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/blob/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-client/lib/transports/polling-jsonp.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/engine.io-client/lib/transports/websocket.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/to-array/index.js","webpack:////Volumes/Dev/Gradle/Chrome/node_modules/backo2/index.js","webpack:///./src/modal.js","webpack:///./src/device-settings.js","webpack:///./src/tinydecoder/H264NALDecoder.worker.js","webpack:///./node_modules/tinyh264/es/TinyH264.js","webpack:///(webpack)/buildin/module.js","webpack:///./src/pepper-decoder.js","webpack:///./src/cast/cast-server.js","webpack:///./src/cast/audio-queue.js","webpack:///./src/pepper-audio.js","webpack:///./src/cast/rtp.js","webpack:///./src/tinydecoder/ShaderProgram.js","webpack:///./src/tinydecoder/ShaderCompiler.js","webpack:///./src/tinydecoder/ShaderSources.js","webpack:///./src/tinydecoder/YUVSurfaceShader.js","webpack:///./src/tinydecoder/Texture.js","webpack:///./src/tinydecoder/CanvasRenderer.js","webpack:///./node_modules/tinyh264/es/TinyH264Decoder.js","webpack:///./src/tinydecoder/index.js","webpack:///./node_modules/tinyh264/es/TinyH264.wasm.asset","webpack:///./src/screen.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","g","this","Function","e","window","make4Len16","len","len16","toString","length","ab2str","buf","constructor","Uint8Array","String","fromCharCode","apply","decodeURIComponent","escape","str2ab","str","terminate","unescape","encodeURIComponent","ArrayBuffer","bufView","strLen","charCodeAt","slashN","writeString","socket","cb","JSON","stringify","write","appendBuffer","buffer1","buffer2","tmp","byteLength","set","sliceArrayBuffer","buffer","slice","byteOffset","Number","pad","size","Date","getTime","b64map","startsWith","configurable","writable","searchString","position","lastIndexOf","fromArray","arr","ret","val","$","ajaxTransport","options","originalOptions","jqXHR","FormData","dataType","data","Blob","send","headers","callback","xhr","XMLHttpRequest","url","type","async","responseType","username","password","addEventListener","response","status","statusText","getAllResponseHeaders","open","setRequestHeader","abort","cache","_isNode","Success","dummy","gen","iter","next","done","pResolve","pReject","promise","Promise","resolve","reject","prepNextAsyncCall","errorCallback","throw","Error","arguments","successCallback","haveIter","error","success","then","catch","navigator","isNode","isElectron","userAgent","indexOf","sharedGlobals","current","IS_RELEASE","console","log","warn","info","wrap","f","save","Array","getConsoleLog","gistConsoleLog","files","chrome","runtime","getBackgroundPage","background","getLogFromWindow","promises","app","getAll","map","w","contentWindow","id","all","gist","getManifest","fetch","method","body","json","html_url","args","join","content","readString","onClose","read","reader","readLine","pending","readMore","keep","subarray","push","b","remaining","unshift","writeLine","base64ToArrayBuffer","base64","binary_string","atob","bytes","ascii","nextTick","setTimeout","getAuthToken","interactive","identity","process","scopes","token","lastError","throttleTimeout","item","throttle","immediate","items","timeout","onTimeout","bufferToHex","view","hexToBuffer","substr","parseInt","readLenLoop","littleEndian","headerReader","destroy","DataView","getInt32","payloadReader","readHeader","arrayBufferToBase64","binary","btoa","writeLenData","ab","setInt32","makeUUID","s4","Math","floor","random","substring","readLenPackets","inRead","packets","undefined","hex2b64","h","charAt","showNotification","text","iconUrl","notifications","manifest","appName","icons","title","message","getQueryVariable","variable","location","vars","search","split","pair","isBrowser","copyTextToClipboard","textArea","document","createElement","style","top","left","width","height","padding","border","outline","boxShadow","appendChild","select","execCommand","err","removeChild","load","storage","debug","env","DEBUG","formatArgs","useColors","namespace","humanize","diff","color","splice","index","lastC","replace","match","namespaces","removeItem","toLowerCase","documentElement","WebkitAppearance","firebug","exception","table","RegExp","$1","local","localStorage","localstorage","colors","formatters","j","v","enable","Buffer","hasChromeSockets","sockets","tcp","onReceive","addListener","resultData","Socket","readers","socketId","dataReceived","onReceiveError","tcpServer","onAccept","acceptInfo","setPaused","clientSocketId","listener","Server","listeners","ignored","createInfo","connect","host","port","result","connected","on","pump","s1","s2","writeDone","stream","eat","pendingCallback","closed","argc","pendingLength","paused","buffered","totalRead","shift","bufferedLength","add","need","min","part","leftover","pendingWrite","bufferWrites","originalCallback","writeInfo","resultCode","bytesSent","from","close","payload","asUint8Array","pl","pause","onPause","resume","onResume","__proto__","listen","listening","address","getInfo","localAddress","localPort","createServer","Emitter","obj","mixin","event","fn","_callbacks","once","off","removeListener","removeAllListeners","removeEventListener","callbacks","emit","hasListeners","base64encoder","keys","hasBinary","sliceBuffer","after","utf8","isAndroid","test","isPhantomJS","dontSendBlobs","protocol","ping","pong","upgrade","noop","packetslist","ary","each","eachWithIndex","el","msg","encodePacket","packet","supportsBinary","utf8encode","encodeBase64Packet","contentArray","resultBuffer","encodeArrayBuffer","fr","FileReader","onload","readAsArrayBuffer","encodeBlobAsArrayBuffer","blob","encodeBlob","encodeBase64Object","encoded","encode","strict","b64data","b64","readAsDataURL","typed","basic","decodePacket","binaryType","utf8decode","decodeBase64Packet","decode","tryDecode","rest","encodePayload","isBinary","encodePayloadAsBlob","encodePayloadAsArrayBuffer","doneCallback","setLengthHeader","results","decodePayload","decodePayloadAsBinary","chr","encodedPackets","totalLength","reduce","acc","resultArray","bufferIndex","forEach","isString","lenStr","binaryIdentifier","lengthAry","bufferTail","buffers","tailArray","msgLength","total","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","concat","drainQueue","run","marker","runClearTimeout","Item","array","browser","argv","version","versions","prependListener","prependOnceListener","binding","cwd","chdir","dir","umask","qs","qry","pairs","a","ieee754","isArray","kMaxLength","TYPED_ARRAY_SUPPORT","createBuffer","that","RangeError","arg","encodingOrOffset","allocUnsafe","TypeError","fromArrayLike","fromArrayBuffer","string","encoding","isEncoding","actual","fromString","isBuffer","checked","copy","fromObject","assertSize","isView","loweredCase","utf8ToBytes","base64ToBytes","slowToString","start","end","hexSlice","utf8Slice","asciiSlice","latin1Slice","base64Slice","utf16leSlice","swap","bidirectionalIndexOf","isNaN","arrayIndexOf","indexSize","arrLength","valLength","readUInt16BE","foundIndex","found","hexWrite","offset","parsed","utf8Write","blitBuffer","asciiWrite","byteArray","asciiToBytes","latin1Write","base64Write","ucs2Write","units","hi","lo","utf16leToBytes","fromByteArray","res","secondByte","thirdByte","fourthByte","tempCodePoint","firstByte","codePoint","bytesPerSequence","codePoints","decodeCodePointsArray","SlowBuffer","alloc","INSPECT_MAX_BYTES","global","foo","typedArraySupport","poolSize","_augment","species","fill","allocUnsafeSlow","_isBuffer","compare","x","y","list","pos","swap16","swap32","swap64","equals","inspect","max","target","thisStart","thisEnd","thisCopy","targetCopy","includes","isFinite","toJSON","_arr","out","toHex","checkOffset","ext","checkInt","objectWriteUInt16","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","writeDouble","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt8","readUInt16LE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt8","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","limit","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","targetStart","code","INVALID_BASE64_RE","Infinity","leadSurrogate","toByteArray","trim","stringtrim","base64clean","src","dst","isBuf","Encoder","types","CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK","Decoder","ERROR_PACKET","encodeAsString","attachments","nsp","tryStringify","reconstructor","BinaryReconstructor","reconPack","removeBlobs","bloblessData","deconstruction","deconstructPacket","pack","encodeAsBinary","parse","tryParse","decodeString","takeBinaryData","finishedReconstruction","binData","reconstructPacket","hasCORS","opts","xdomain","xscheme","enablesXDR","XDomainRequest","parser","Transport","path","hostname","secure","query","timestampParam","timestampRequests","readyState","agent","pfx","passphrase","cert","ca","ciphers","rejectUnauthorized","forceNode","extraHeaders","onError","desc","description","doOpen","doClose","onOpen","onData","onPacket","AdbChromeUsbTransport","AdbWebUsbTransport","getUserSelectedDevices","AdbTcpTransport","zero_mask","currentRead","AdbDevice","transport","onConnected","currentSocketId","forwards","maxPayload","MAX_PAYLOAD","parseConnectionPayload","splits","parts","AdbSocket","device","localId","AdbServer","pendingDevices","adbDevices","clients","AdbClient","server","usb","writing","pendingWrites","fatal","kCommandSYNC","kCommandCNXN","kCommandOPEN","kCommandOKAY","kCommandCLSE","kCommandWRTE","kCommandAUTH","kAuthToken","kAuthSignature","kAuthRSAPublicKey","ADB_PROTOCOL_VERSION","ADB_VERSION","checksum","sum","sendMessage","command","arg0","arg1","appendZero","bodyLength","header","setUint32","getKey","adbkey","JSEncrypt","default_key_size","setPrivateKey","getPrivateKeyB64","keyString","getItem","setItem","_convertToMinCrypt","rsaKey","B32","BigInteger","ONE","shiftLeft","N","clone","R","RR","multiply","mod","pkey","Uint32Array","bitLength","subtract","modInverse","intValue","numWords","divide","hexStr","u8view","digit","sign","rsakey","ASN1_PREAMBLE","padEnd","doPrivate","handleUnknown","remoteId","handleMessage","getUint32","onOpenSocket","sentSignature","publicKey","signed","wrote","rawProperties","properties","onReceiveMessage","transferLen","receiveMessages","forwardPort","forwardingServer","fromPort","localSocket","newSocket","to","remoteSocket","newAdbSocket","createSocket","service","toWrite","remoteSocketId","adbSocket","refreshing","dummyListen","client","receiveHeader","isRunning","kill","withAdbDevice","adb","serialno","internalOnDevicesChanged","withSerial","tryDevice","tryInterface","number","interfaceNumber","claimInterface","iface","newTransport","connectUsbAdb","listInterfaces","interfaces","usedHandle","interfaceClass","interfaceSubclass","interfaceProtocol","refreshDevice","serialNumber","usbDevice","tracking","getDevicesString","stop","resolveTransport","num","longformDevices","devices","writeDevices","handlePayload","commandParts","hostCmd","isInteger","features","remoteHost","remotePort","remote","forwardParts","receivePayload","lens","getLens","validLen","placeHoldersLen","Arr","_byteLength","curByte","revLookup","uint8","extraBytes","len2","encodeChunk","lookup","output","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","abs","LN2","ChromeUsbDevice","vendorId","productId","connectionHandle","openDevice","closeDevice","AdbUsbTransport","handle","endpoint","endpoints","maximumPacketSize","direction","in","releaseInterface","transfer","bulkTransfer","filters","WebUsbDevice","configuration","selectConfiguration","alternate","alternates","interfaceName","packetSize","transferOut","endpointNumber","transferIn","requestDevice","classCode","subclassCode","protocolCode","DummySocket","re","exec","uri","source","authority","ipv6uri","withNativeBuffer","withNativeArrayBuffer","eio","Backoff","has","Manager","nsps","subs","reconnection","reconnectionAttempts","reconnectionDelay","reconnectionDelayMax","randomizationFactor","backoff","jitter","connecting","lastPing","packetBuffer","_parser","encoder","decoder","autoConnect","emitAll","updateSocketIds","generateId","engine","_reconnection","_reconnectionAttempts","_reconnectionDelay","setMin","_randomizationFactor","setJitter","_reconnectionDelayMax","setMax","_timeout","maybeReconnectOnOpen","reconnecting","attempts","reconnect","self","skipReconnect","openSub","onopen","errorSub","cleanup","timer","onping","onpong","ondata","ondecoded","onerror","onConnecting","processPacketQueue","subsLength","disconnect","reset","onclose","reason","delay","duration","onreconnect","attempt","XHR","JSONP","websocket","polling","xd","xs","jsonp","isSSL","forceJSONP","parseqs","inherit","yeast","Polling","hasXHR2","forceBase64","poll","doPoll","callbackfn","doWrite","schema","sid","withNativeBlob","withNativeFile","File","prev","alphabet","seed","now","decoded","toArray","hasBin","events","connect_error","connect_timeout","reconnect_attempt","reconnect_failed","reconnect_error","io","ids","acks","receiveBuffer","sendBuffer","disconnected","flags","subEvents","ev","compress","pop","onpacket","sameNamespace","rootNamespaceError","onconnect","onevent","onack","ondisconnect","ack","sent","emitBuffered","Adb","AdbSync","sendHostCommand","hostCommand","ok","rawPayload","newPayload","values","firstSpace","nextSpace","nextColon","lines","line","killServer","sendClientCommand","clientCommand","shell","getOrCreateSockFactory","forward","reverse","MKID","ID_RECV","ID_SEND","ID_DONE","ID_DATA","DATA_MAX","pull","fileWriter","file","fileEntry","onwriteend","createWriter","fw","msgView","readChunk","createSocketFactory","socketFactory","fileSocket","fileAndMode","extra","writeChunk","rtc","RTCSessionDescription","webkitRTCSessionDescription","RTCPeerConnection","webkitRTCPeerConnection","RTCIceCandidate","webkitRTCIceCandidate","GcmRtcSocket","conn","dc","gotEof","onmessage","ui","eof","needsBufferShim","bufferedAmountLowThreshold","onbufferedamountlow","writeable","GcmRtcConnection","manager","pc","peerConnection","oniceconnectionstatechange","iceConnectionState","GcmRtcManager","senders","registrationId","rtcc","gcmRtcConnections","gcmRtcListeners","amazonTokens","writeCallback","reentrantWrite","bufferedAmount","recycleChannel","waitForEof","waitForCommand","removeChannel","openSocket","compactChannels","inboundChannels","outboundChannels","getAppropriateChannels","channels","inbound","addCandidates","candidate","candidates","addIceCandidate","setupPinger","pinger","listenSockets","ondatachannel","channel","prepareChannel","label","createDataChannel","ordered","connectCallback","signalingState","hasOpened","onMessage","senderId","srcPort","dstPort","incoming","onUnknownMessage","listenCallback","ad","isChromeGcm","gcm","hasLoadedChannels","senderIds","register","withIO","onRegistrationIdChanged","script","prior","getElementsByTagName","onreadystatechange","_","isAbort","parentNode","insertBefore","wrapMessage","sendGcm","wrappedMessage","sendWrappedMessage","defaultSenderId","tokenPromise","accessTokenExpiration","secret","params","entries","k","tokenInfo","accessToken","access_token","expires_in","dictionaryKeys","sdpDictionary","addDictionary","curKey","replaceAll","replaceWhat","replaceTo","compressSdp","sdp","decompressSdp","setupPeerConnection","getDesc","sendConnect","sentOnce","portion","compressedDesc","descLen","onicecandidate","evt","onsignalingstatechange","offerToReceiveAudio","offerToReceiveVideo","addTransceiver","failureTimeout","doOffer","createOffer","setLocalDescription","audio","internal","ontrack","streams","voiceActivityDetection","mediaDevices","getUserMedia","getTracks","track","addTrack","isListening","stopListen","remoteDesc","setRemoteDescription","createAnswer","answer","getGlobal","default","Headers","Request","Response","managers","forceNew","multiplex","parseuri","loc","href","createDebug","prevTime","enabled","curr","ms","coerce","format","formatter","logFn","hash","selectColor","init","instances","stack","disable","names","skips","instance","plural","ceil","parseFloat","long","round","fmtShort","packetData","_deconstructPacket","placeholder","_placeholder","newData","_reconstructPacket","pendingBlobs","_removeBlobs","containingObject","fileReader","transports","transportOptions","writeBuffer","prevBufferLen","policyPort","rememberUpgrade","onlyBinaryUpgrades","perMessageDeflate","threshold","freeGlobal","upgrades","pingInterval","pingTimeout","pingIntervalTimer","pingTimeoutTimer","priorWebsocketSuccess","createTransport","EIO","requestTimeout","protocols","setTransport","onDrain","probe","failed","onTransportOpen","upgradeLosesBinary","upgrading","flush","freezeTransport","onTransportClose","onupgrade","onHandshake","setPing","filterUpgrades","onHeartbeat","sendPacket","waitForUpgrade","cleanupAndClose","filteredUpgrades","empty","unloadHandler","requests","request","req","sendXhr","pollXhr","setDisableHeaderCheck","withCredentials","hasXDR","onLoad","responseText","contentType","getResponseHeader","requestsCount","onSuccess","fromError","attachEvent","arraybuffer","abv","ii","count","err_cb","bail","proxy","byteCount","byteIndex","stringFromCharCode","ucs2decode","counter","checkScalarValue","toUpperCase","createByte","encodeCodePoint","symbol","readContinuationByte","continuationByte","decodeSymbol","byte1","byteString","ucs2encode","chars","encoded1","encoded2","encoded3","encoded4","bufferLength","BlobBuilder","WebKitBlobBuilder","MSBlobBuilder","MozBlobBuilder","blobSupported","blobSupportsArrayBufferView","blobBuilderSupported","append","getBlob","mapArrayBufferViews","chunk","BlobBuilderConstructor","bb","BlobConstructor","JSONPPolling","rNewline","rEscapedNewline","___eio","form","iframe","insertAt","head","area","iframeId","className","setAttribute","complete","initIframe","html","action","submit","NodeWebSocket","BrowserWebSocket","WebSocket","MozWebSocket","WS","usingBrowserWebSocket","check","ws","supports","addEventListeners","factor","rand","deviation","showModal","clickedOk","modal","find","cancel","unbind","cancelButton","okButton","hideCancel","hide","show","click","shortModal","sanitizeDeviceSettings","deviceSettings","friendlyName","loadAllDeviceSettings","vals","commonDisplaySettings","density","freeSize","populateDisplaySettings","Option","loadDeviceSettings","defaults","showSoftKeys","pinTitleBar","alwaysOnTop","bitrate","resolution","displaySettings","dimDisplay","applyDeviceSettings","prop","change","dname","matched","autoAudio","saveDeviceSettings","Worker","_scriptDir","Module","currentScript","moduleOverrides","readBinary","arguments_","scriptDirectory","wasmBinary","wasmMemory","WebAssembly","_typeof","HEAP8","HEAPU8","HEAP16","HEAP32","HEAPF32","HEAPF64","wasmTable","Table","ABORT","updateGlobalBufferAndViews","Int8Array","Int16Array","Int32Array","Uint16Array","Float32Array","Float64Array","TextDecoder","INITIAL_TOTAL_MEMORY","callRuntimeCallbacks","func","Memory","DYNAMICTOP_PTR","__ATPRERUN__","__ATINIT__","__ATMAIN__","__ATPOSTRUN__","runDependencies","runDependencyWatcher","dependenciesFulfilled","what","RuntimeError","isDataURI","filename","wasmBinaryFile","getBinary","emscripten_realloc_buffer","grow","___wasm_call_ctors","asmLibraryArg","dest","requestedSize","oldSize","multiple","cutDown","overGrownHeapSize","asm","receiveInstance","clearInterval","removeRunDependency","receiveInstantiatedSource","instantiateArrayBuffer","receiver","credentials","instantiate","instantiateStreaming","instantiateAsync","createWasm","calledRun","doRun","postRun","preRun","ptr","noSafe","old","runCaller","webpackPolyfill","deprecate","paths","children","PepperDecoder","encodeWidth","encodeHeight","tool","toolPath","hasInitialized","common","createNaClModule","onDecoderFallingBehind","onReady","naclModule","postMessage","connectH264","prefixLen416","video","presentationTimeMs","syncFrame","queueAudio","audioBuffer0","audioBuffer1","AudioQueue","parseRTPPacket","CastServer","audioListener","$protobuf","roots","cast_channel","CastMessage","payloadUtf8","handler","onListening","castId","sendUDP","prefix","setUint8","udpSocket","resolveFile","MD5","resolveAjax","ajax","processData","audioQueue","sessionUUID","onStop","rtpTimeout","resetTimeout","connectUDP","adbSocketFactory","context","onStart","rtpReceiverReportBytes","lastSequenceNumber","rolloverCount","onRtpPacket","addr","mask","aesIvMask","maski","withDecryptedBytes","decryptedBytes","writeAudio","debugInfo","aesKey","crypto","subtle","decrypt","cryptoAesKey","onRtcpPacket","ssrc","lastSRTimestamp","report","addrLen","dataView","rtpPacket","timestamp","getUTCFullYear","getUTCMonth","getUTCDate","sampleRate","numberOfChannels","cleanupSelf","getPort","respond","destinationId","sourceId","protocolVersion","payloadType","payloadBinary","finish","sig","ca1","ca2","ca3","signature","clientAuthCertificate","intermediateCertificate","signatureAlgorithm","senderNonce","hashAlgorithm","crl","DeviceAuthMessage","onJSONMessage","requestId","appId","availability","broadcast","applications","offer","supportedStreams","importKey","siphon","dump","pendingAudio","audioDump","sort","PepperAudio","numSamples","numSamplesDiv2","numSamplesDiv4","samples","lastIndex","verify","sample","malformed","pepperAudio","queuePCMData","floatSample0","floatSample1","audioBuffer","copyToChannel","sampleLength","samplesDecoded","useLegacy","adts","combined","before","decodeAudioData","silence","AudioBuffer","copyFromChannel","createBufferSource","loop","destination","floatSample","common2","buffer0","getUint8","payloadOffset","getUint16","ShaderProgram","gl","program","createProgram","shader","attachShader","linkProgram","getProgramParameter","LINK_STATUS","useProgram","getAttribLocation","getUniformLocation","uniformLocation","uniformMatrix4fv","ShaderCompiler","createShader","FRAGMENT_SHADER","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","vertexQuad","fragmentYUV","_initShaders","shaderArgs","_initShaderArgs","vertexBuffer","_initBuffers","attach","compile","link","use","yTexture","uTexture","vTexture","u_projection","a_position","getAttributeLocation","enableVertexAttribArray","a_texCoord","textureY","textureU","textureV","uniform1i","activeTexture","TEXTURE0","bindTexture","TEXTURE_2D","texture","TEXTURE1","TEXTURE2","encodedFrameSize","h264RenderState","viewport","setUniformM4","bindBuffer","ARRAY_BUFFER","bufferData","maxXTexCoord","maxYTexCoord","DYNAMIC_DRAW","vertexAttribPointer","FLOAT","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT","drawArrays","TRIANGLE_STRIP","Texture","createTexture","texParameteri","TEXTURE_MAG_FILTER","NEAREST","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","texSubImage2D","UNSIGNED_BYTE","texImage2D","deleteTexture","canvas","getContext","yuvSurfaceShader","LUMINANCE","stride","lumaSize","chromaSize","yBuffer","uBuffer","vBuffer","chromaHeight","chromaStride","image2dBuffer","setTexture","updateShaderData","draw","TinyH264Decoder","tinyH264Module","onPictureReady","Constructor","_classCallCheck","pStorage","_h264bsdAlloc","pWidth","_malloc","pHeight","pPicture","_decBuffer","_h264bsdInit","release","_h264bsdShutdown","_h264bsdFree","_free","nal","_h264bsdDecode","PIC_RDY","getValue","picPtr","pic","RDY","HDRS_RDY","PARAM_SET_ERROR","MEMALLOC_ERROR","assets","tinyH264","locateFile","videoStreamIdCounter","videoStreamId","pendingDecodes","useOffscreenCanvas","useWorker","tinyH264Worker","notifyDecoded","notifyReady","canvasRenderer","onPicture","decodeNext","initWebGLCanvas","firstChild","transferControlToOffscreen","offscreen","renderStateId","h264Nal","nextFrame","enqueueDecode","h264Socket","inputWebSocket","vysorMode","headFader","screenWidth","screenHeight","rectWidth","rectHeight","listenerDiv","downTime","useLicenseCheck","videoDumpSocket","audioDumpSocket","flash","needsRestartForVideoDump","ignoreNextResize","audioContext","titleBarHeight","bottomBarHeight","vysorSettings","vysorDefaultSettings","toggleRecord","castServer","ensureAudioContext","AudioContext","latencyHint","maybeConnectUDP","_lm","_il","makeId","saveMySettings","openTab","siphonAudio","siphonFlv","FlashPackager","sendEvent","resolutions","resizeTimeout","adInterval","bitrates","decoders","libind","clientX","downDelta","clientY","interpretEvent","keyevent","delayFadeHead","setFullscreen","httpPort","showSettings","openList","keycode","shiftKey","fadeTo","fadeOut","isFullscreen","webkitFullscreenElement","msFullscreenElement","mozFullscreenElement","fullscreenElement","isFreeSize","resizeWindow","iw","innerWidth","ih","innerHeight","maxWidth","screen","availWidth","maxHeight","availHeight","rw","rh","setContentSize","innerBounds","css","trackUsage","elapsed","vysorUsage","lastDailyReport","vysorDailyUsage","hoursUsed","tracker","beforeVysorUsage","hasRecommendedPro","startPurchase","recommendProOnce","hasRecommendedRate","recommendRateOnce","fullscreen","requestFullscreen","webkitRequestFullscreen","msRequestFullscreen","mozRequestFullScreen","exitFullscreen","webkitExitFullscreen","mozExitFullscreen","mskitExitFullscreen","setupTitleBar","attr","titleBar","buttonGroups","outer","buttonGroup","button","class","setupNavigationBar","navigationBar","buttons","showAd","countdown","toast","recommendHighQualityOnce","hasRecommendedHighQuality","hasRecommendedAudio","recommendAudioMirroringOnce","sendAppView","focus","pastedData","originalEvent","clipboardData","getData","keychar","offsetX","offsetY","deltaX","wheelDeltaX","deltaY","wheelDeltaY","keypress","keyCode","keydown","stopPropagation","resize","docReady","dragTimer","feature","fb","hasClass","toggleClass","fadeIn","preventDefault","dataTransfer","FileSocket","endsWith","attachDefaultListeners","mouseup","eventName","currentTarget","touches","changedTouches","clkEvt","createEvent","initMouseEvent","detail","screenX","screenY","isTouch","dispatchEvent","mousedown","mousemove","tryReconnect","edit","commit","newName","updateDeviceName","newDefaults","which","getDefaultDeviceSettings","setAlwaysOnTop","selectedIndex","applyChange","one","connectionReady","sizeThrottle","handleData","ow","oh","enforceAspectRatio","connect264","clip","recording","assign","deviceSpecific","attemptCount","reattempt","attemptConnection","createWebSocket","withSocket","adbSocketFactoryFactory","queued","hasConnected","onblob","socketFail","defaultDecoder","decoderSetting","frameTracker","syncFrameThrottle","isSps","firstRead","setInterval","withPayload","dv","addVideoHeader","addVideoFrame","ready","noFullscreen","restore","onFullscreened","onMaximized","gcmSocketManager","useAudio","iceServers","urls","credential","sharedDevices","gcmConn","Audio","srcObject","play","adbServer","updateWindowStatusText"],"mappings":"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","file":"screen.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 74);\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","function makeUUID() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n  return s4() + s4() + '-' + s4() + '-' + s4() + '-' + s4() + '-' + s4() + s4() + s4();\n}\n\nfunction nextTick(cb) {\n  setTimeout(cb, 0);\n}\n\nfunction prefixLen416(str) {\n  return make4Len16(str.length) + str;\n}\n\nfunction make4Len16(len) {\n  var len16 = len.toString(16);\n  while (len16.length < 4) {\n    len16 = '0' + len16;\n  }\n  return len16;\n}\n\nfunction encode_utf8(s) {\n  return unescape(encodeURIComponent(s));\n}\n\nfunction decode_utf8(s) {\n  return decodeURIComponent(escape(s));\n}\n\nfunction ab2str(buf) {\n  if (buf.constructor.name == 'ArrayBuffer') {\n    buf = new Uint8Array(buf);\n  }\n  return decode_utf8(String.fromCharCode.apply(null, buf));\n}\n\nfunction str2ab(str, buf, terminate) {\n  str = encode_utf8(str);\n  var len = str.length;\n  if (terminate)\n    len++;\n  if (!buf) {\n    buf = new ArrayBuffer(len);\n  }\n  var bufView = new Uint8Array(buf);\n  if (terminate)\n    bufView[str.length] = 0;\n  for (var i=0, strLen=str.length; i<strLen; i++) {\n    bufView[i] = str.charCodeAt(i);\n  }\n  return buf;\n}\n\nvar slashN = '\\n'.charCodeAt(0);\n\nUint8Array.prototype.sliceArrayBuffer = function() {\n  return this.buffer.slice(this.byteOffset, this.byteOffset + this.byteLength);\n}\n\nNumber.prototype.pad = function(size) {\n    var s = String(this);\n    while (s.length < (size || 2)) {s = \"0\" + s;}\n    return s;\n}\n\nfunction writeLine(socket, str, cb) {\n  if (str.constructor.name == 'Object')\n    str = JSON.stringify(str);\n  writeString(socket, str + '\\n', cb);\n}\n\nfunction readLine(socket, cb) {\n  var pending = [];\n  function readMore() {\n    socket.read(function(buffer) {\n      for (var i = 0; i < buffer.byteLength; i++) {\n        if (buffer[i] == slashN) {\n          var keep = buffer.subarray(0, i);\n          pending.push(keep);\n          var data = \"\";\n          for (var b in pending) {\n            b = pending[b];\n            data += ab2str(b);\n          }\n\n          var remaining = buffer.subarray(i + 1);\n          socket.unshift(remaining);\n\n          cb(data);\n          return;\n        }\n      }\n\n      // we require more minerals\n      pending.push(buffer);\n      readMore();\n    });\n  }\n\n  readMore();\n}\n\nfunction readLenPackets(socket, cb, littleEndian) {\n  var inRead;\n\n  var headerReader = function(data) {\n    if (data.byteLength != 4) {\n      socket.destroy();\n      cb(null);\n      return;\n    }\n    var lenBuf = new DataView(data.buffer, data.byteOffset, 4);\n    var len = lenBuf.getInt32(0, littleEndian);\n\n    if (!inRead) {\n      inRead = [];\n      socket.read(len, payloadReader);\n      var packets = inRead;\n      inRead = undefined;\n      if (packets.length) {\n        cb(packets);\n      }\n    }\n    else {\n      socket.read(len, payloadReader);\n    }\n  }\n\n  var payloadReader = function(data) {\n    if (inRead) {\n      inRead.push(data);\n    }\n    else {\n      cb([data]);\n    }\n    readHeader();\n  }\n\n  var readHeader = function() {\n    socket.read(4, headerReader);\n  }\n\n  readHeader();\n}\n\nfunction readLenLoop(socket, cb, littleEndian) {\n  var headerReader = function(data) {\n    if (data.byteLength != 4) {\n      socket.destroy();\n      cb(null);\n      return;\n    }\n    var lenBuf = new DataView(data.buffer, data.byteOffset, 4);\n    var len = lenBuf.getInt32(0, littleEndian);\n    socket.read(len, payloadReader);\n  }\n\n  var payloadReader = function(data) {\n    cb(data);\n    readHeader();\n  }\n\n  var readHeader = function() {\n    socket.read(4, headerReader);\n  }\n\n  readHeader();\n}\n\nfunction writeLenData(socket, data, cb, littleEndian) {\n  var ab = new ArrayBuffer(4);\n  var lenBuf = new DataView(ab);\n  lenBuf.setInt32(0, data.byteLength, littleEndian);\n  socket.write(appendBuffer(new Uint8Array(ab), new Uint8Array(data)).buffer, cb);\n}\n\nfunction readString(socket, cb) {\n  var str = '';\n  socket.onClose = function() {\n    cb(str);\n  }\n  function reader(data) {\n    str += ab2str(data);\n    socket.read(reader);\n  }\n  socket.read(reader);\n}\n\nfunction writeString(socket, str, cb) {\n  if (str.constructor.name == 'Object')\n    str = JSON.stringify(str);\n  socket.write(str2ab(str), cb);\n}\n\nfunction appendBuffer(buffer1, buffer2) {\n  var tmp = new Uint8Array(buffer1.byteLength + buffer2.byteLength);\n  tmp.set(buffer1, 0);\n  tmp.set(buffer2, buffer1.byteLength);\n  return tmp;\n}\n\nvar timeThing = new Date().getTime();\nfunction timeTrace(stamp) {\n  var now = new Date().getTime();\n  console.log(stamp + \": \" + (now - timeThing));\n  timeThing = now;\n}\n\n\nfunction bufferToHex(buffer) {\n  var view = new Uint8Array(buffer);\n  var ret = '';\n\n  for (var b in view) {\n    b = view[b];\n    if(b < 0x10)\n      ret += \"0\" + b.toString(16);\n    else\n      ret += b.toString(16);\n  }\n\n  return ret;\n}\n\nfunction hexToBuffer(str) {\n  var buf = new ArrayBuffer(str.length / 2);\n  var view = new Uint8Array(buf);\n  for (var i = 0; i < str.length / 2; i++) {\n    var c = str.substr(i * 2, 2);\n    view[i] = parseInt(c, 16);\n  }\n  return buf;\n}\n\nfunction base64ToArrayBuffer(base64) {\n    var binary_string =  window.atob(base64);\n    var len = binary_string.length;\n    var bytes = new Uint8Array( len );\n    for (var i = 0; i < len; i++)        {\n        var ascii = binary_string.charCodeAt(i);\n        bytes[i] = ascii;\n    }\n    return bytes.buffer;\n}\n\nfunction arrayBufferToBase64( buffer ) {\n    var binary = ''\n    var bytes = new Uint8Array( buffer )\n    var len = bytes.byteLength;\n    for (var i = 0; i < len; i++) {\n        binary += String.fromCharCode( bytes[ i ] )\n    }\n    return window.btoa( binary );\n}\n\nvar b64map=\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\nvar b64pad=\"=\";\n\nfunction hex2b64(h) {\n  var i;\n  var c;\n  var ret = \"\";\n  for(i = 0; i+3 <= h.length; i+=3) {\n    c = parseInt(h.substring(i,i+3),16);\n    ret += b64map.charAt(c >> 6) + b64map.charAt(c & 63);\n  }\n  if(i+1 == h.length) {\n    c = parseInt(h.substring(i,i+1),16);\n    ret += b64map.charAt(c << 2);\n  }\n  else if(i+2 == h.length) {\n    c = parseInt(h.substring(i,i+2),16);\n    ret += b64map.charAt(c >> 2) + b64map.charAt((c & 3) << 4);\n  }\n  while((ret.length & 3) > 0) {\n    ret += b64pad;\n  }\n  return ret;\n}\n\nif (!String.prototype.startsWith) {\n  Object.defineProperty(String.prototype, 'startsWith', {\n    enumerable: false,\n    configurable: false,\n    writable: false,\n    value: function (searchString, position) {\n      position = position || 0;\n      return this.lastIndexOf(searchString, position) === position;\n    }\n  });\n}\n\nfunction getQueryVariable(variable, url) {\n    if (!url)\n      url = window.location;\n    var query = url.search.substring(1);\n    var vars = query.split('&');\n    for (var i = 0; i < vars.length; i++) {\n        var pair = vars[i].split('=');\n        if (decodeURIComponent(pair[0]) == variable) {\n            return decodeURIComponent(pair[1]);\n        }\n    }\n    // console.log('Query variable %s not found', variable);\n}\n\nObject.fromArray = function(arr) {\n  var ret = {};\n  for (var i in arr) {\n    var val = arr[i]\n    ret[val] = val;\n  }\n  return ret;\n}\n\n\n/**\n *\n * jquery.binarytransport.js\n *\n * @description. jQuery ajax transport for making binary data type requests.\n * @version 1.0\n * @author Henry Algus <henryalgus@gmail.com>\n *\n */\n\ntry {\n// use this transport for \"binary\" data type\n$.ajaxTransport(\"+binary\", function(options, originalOptions, jqXHR) {\n  // check for conditions and support for blob / arraybuffer response type\n  if (window.FormData && ((options.dataType && (options.dataType == 'binary')) || (options.data && ((window.ArrayBuffer && options.data instanceof ArrayBuffer) || (window.Blob && options.data instanceof Blob))))) {\n    return {\n      // create new XMLHttpRequest\n      send: function(headers, callback) {\n        // setup all variables\n        var xhr = new XMLHttpRequest(),\n          url = options.url,\n          type = options.type,\n          async = options.async || true,\n          // blob or arraybuffer. Default is blob\n          dataType = options.responseType || \"blob\",\n          data = options.data || null,\n          username = options.username || null,\n          password = options.password || null;\n\n        xhr.addEventListener('load', function() {\n          var data = {};\n          data[options.dataType] = xhr.response;\n          // make callback and send data\n          callback(xhr.status, xhr.statusText, data, xhr.getAllResponseHeaders());\n        });\n\n        xhr.addEventListener('error', function() {\n          callback(xhr.status, xhr.statusText, null, xhr.getAllResponseHeaders());\n        });\n\n        xhr.open(type, url, async, username, password);\n\n        // setup custom headers\n        for (var i in headers) {\n          xhr.setRequestHeader(i, headers[i]);\n        }\n\n        xhr.responseType = dataType;\n        xhr.send(data);\n      },\n      abort: function() {\n        jqXHR.abort();\n      }\n    };\n  }\n});\n}\ncatch (e) {}\n\nfunction throttleTimeout(token, item, throttle, cb, immediate) {\n  if (!token)\n    token = { items:[] };\n  token.items.push(item);\n  if (!token.timeout) {\n    function onTimeout() {\n      delete token.timeout;\n      cb(token.items);\n      token.items = [];\n    }\n    if (immediate)\n      onTimeout(token.items);\n    token.timeout = setTimeout(onTimeout, throttle);\n  }\n  return token;\n}\n\n\nfunction copyTextToClipboard(text) {\n  var textArea = document.createElement(\"textarea\");\n\n  //\n  // *** This styling is an extra step which is likely not required. ***\n  //\n  // Why is it here? To ensure:\n  // 1. the element is able to have focus and selection.\n  // 2. if element was to flash render it has minimal visual impact.\n  // 3. less flakyness with selection and copying which **might** occur if\n  //    the textarea element is not visible.\n  //\n  // The likelihood is the element won't even render, not even a flash,\n  // so some of these are just precautions. However in IE the element\n  // is visible whilst the popup box asking the user for permission for\n  // the web page to copy to the clipboard.\n  //\n\n  // Place in top-left corner of screen regardless of scroll position.\n  textArea.style.position = 'fixed';\n  textArea.style.top = 0;\n  textArea.style.left = 0;\n\n  // Ensure it has a small width and height. Setting to 1px / 1em\n  // doesn't work as this gives a negative w/h on some browsers.\n  textArea.style.width = '2em';\n  textArea.style.height = '2em';\n\n  // We don't need padding, reducing the size if it does flash render.\n  textArea.style.padding = 0;\n\n  // Clean up any borders.\n  textArea.style.border = 'none';\n  textArea.style.outline = 'none';\n  textArea.style.boxShadow = 'none';\n\n  // Avoid flash of white box if rendered for any reason.\n  textArea.style.background = 'transparent';\n\n\n  textArea.value = text;\n\n  document.body.appendChild(textArea);\n\n  textArea.select();\n\n  try {\n    var successful = document.execCommand('copy');\n    // var msg = successful ? 'successful' : 'unsuccessful';\n    // console.log('Copying text command was ' + msg);\n  } catch (err) {\n    console.log('Oops, unable to copy');\n  }\n\n  document.body.removeChild(textArea);\n}\n\nfunction showNotification(text, iconUrl) {\n  console.log('notification:', text);\n  if (!window.chrome || !window.chrome.notifications)\n    return;\n  var manifest = chrome.runtime.getManifest();\n  var appName = manifest.name;\n  iconUrl = iconUrl || manifest.icons[128];\n  chrome.notifications.create({\n    type: \"basic\",\n    iconUrl: iconUrl,\n    title: appName,\n    message: text\n  });\n}\n\nvar blobFromUrl = (function() {\n  var cache = {};\n\n  return function(url, cb) {\n    if (cache[url]) {\n      cb(cache[url]);\n      return;\n    }\n    var xhr = new XMLHttpRequest();\n    xhr.open('GET', url, true);\n    xhr.responseType = 'blob';\n    xhr.onload = function(e) {\n      cb(cache[url] = window.URL.createObjectURL(this.response));\n    };\n\n    xhr.send();\n  }\n})();\n\n\nfunction Success() {\n}\n\n(function() {\n\nfunction* dummy() {\n\n}\nvar n = dummy()\nn.constructor.prototype.async = function() {\n  var gen = this;\n  var iter = gen.next();\n  if (iter.done)\n    return;\n\n  var pResolve;\n  var pReject;\n\n  var promise = new Promise(function(resolve, reject) {\n    pResolve = resolve;\n    pReject = reject;\n    // do a thing, possibly async, then…\n  });\n\n  function errorCallback() {\n    iter = gen.throw(new Error(arguments))\n    prepNextAsyncCall();\n  }\n\n  function successCallback() {\n    var ret = arguments[0];\n    iter = gen.next(ret)\n    prepNextAsyncCall();\n  }\n\n  function prepNextAsyncCall(haveIter) {\n    var error;\n    var success;\n\n    if (iter.done) {\n      pResolve(iter.value);\n      return;\n    }\n\n    // implicit success callback here.\n    if (!iter.value) {\n      iter = gen.next(successCallback)\n      return;\n    }\n\n    if (iter.value.constructor == Promise) {\n      iter.value\n      .then(successCallback)\n      .catch(errorCallback);\n\n      // does not need to send anything back\n      // iter = gen.next();\n      return;\n    }\n    else if (iter.value.constructor == n.constructor) {\n      var promise = iter.value.async();\n      promise\n      .then(successCallback)\n      .catch(errorCallback);\n      return;\n    }\n\n    if (iter.value == Error) {\n      error = true;\n      iter = gen.next(errorCallback)\n    }\n    else if (iter.value == Success) {\n      success = true;\n      iter = gen.next(successCallback)\n    }\n    else {\n      throw new Error('Unexpected yield value for callback. Only Error and Success allowed.')\n    }\n\n    if (!iter.value)\n      throw new Error('Double yield callbacks must explicitly define both Error and Success')\n\n    if (iter.value == Error && error)\n      throw new Error('Error callback already defined');\n    else if (iter.value == Success && success)\n      throw new Error('Success callback already defined');\n    else if (iter.value != Error && iter.value != Success)\n      throw new Error('Unexpected yield value for callback. Only Error and Success allowed.')\n\n    try {\n      if (error)\n        iter = gen.next(successCallback)\n      else\n        iter = gen.next(errorCallback)\n    }\n    catch (e) {\n      pReject(e);\n    }\n  }\n\n  prepNextAsyncCall();\n  return promise;\n}\n\n\n})();\n\nfunction spewSocket(socket) {\n  socket.read(function(data) {\n    console.log(ab2str(data))\n    spewSocket(socket);\n  })\n}\n\nfunction getAuthToken(interactive, cb) {\n  if (!window.chrome || !window.chrome.identity) {\n    console.error('no auth token implemented');\n    process.nextTick(cb);\n    return;\n  }\n\n  chrome.identity.getAuthToken({\n    interactive: interactive,\n    // must use the exact same scopes used to submit the license or the token shits\n    scopes:\n    ['https://www.googleapis.com/auth/userinfo.profile',\n    'https://www.googleapis.com/auth/userinfo.email',\n    'https://www.googleapis.com/auth/chromewebstore.readonly']\n  },\n  function(token) {\n    if (!token)\n      console.error('unable to get authToken', chrome.runtime.lastError)\n    cb(token);\n  });\n}\n\nvar _isNode;\ntry {\n  // node will never have naviagor... electron and browser will\n  _isNode = !navigator;\n\n}\ncatch (e) {\n  _isNode = true;\n}\n\nfunction isNode() {\n  return _isNode;\n}\n\nfunction isElectron() {\n  return navigator.userAgent.indexOf('Electron') != -1;\n}\n\nfunction isBrowser() {\n  return !window.chrome || !window.chrome.app || !window.chrome.app.window;\n}\n\nif (!isNode() && !isElectron()) {\n  window.sharedGlobals = window;\n}\n\n(function() {\n  if (isNode()) return;\n  \n  var current = '';\n\n  function save(args) {\n    try {\n      for (var i in args) {\n        if (args[i] && args[i].constructor != String)\n          args[i] = JSON.stringify(args[i]);\n      }\n      current += args.join(' ') + '\\n';\n    }\n    catch (e) {\n    }\n  }\n\n\n  if (window.IS_RELEASE) {\n    var log = console.log;\n    var error = console.error;\n    var warn = console.warn;\n    var info = console.info;\n\n    function wrap(f) {\n      return function() {\n        f.apply(console, arguments);\n        save(Array.prototype.slice.call(arguments))\n      }\n    }\n\n    console.error = wrap(console.error);\n    console.log = wrap(console.log);\n    console.warn = wrap(console.warn);\n    console.info = wrap(console.info);\n  }\n\n  sharedGlobals.getConsoleLog = function(cb) {\n    cb(current);\n  }\n\n  function getLogFromWindow(w) {\n    return new Promise(function(resolve, reject) {\n      if (!w.getConsoleLog) {\n        resolve('getConsoleLog not found');\n        return;\n      }\n      w.getConsoleLog(function(log) {\n        resolve({\n          content: log && log.length ? log : 'log is empty'\n        });\n      })\n    })\n  }\n\n  window.gistConsoleLog = function(files, cb) {\n    chrome.runtime.getBackgroundPage(function(background) {\n      getLogFromWindow(background)\n      .then(function(log) {\n        files['background.txt'] = log;\n\n        var windows = chrome.app.window.getAll();\n        var promises = windows.map(function(w) {\n          return getLogFromWindow(w.contentWindow)\n          .then(function(log) {\n            files['window-' + w.id + '.txt'] = log;\n          })\n        })\n\n        return Promise.all(promises);\n      })\n      .then(function() {\n        var gist = {\n          \"description\": chrome.runtime.getManifest().name + ' console log',\n          \"public\": false,\n          \"files\": files\n        }\n\n        fetch('https://vysor.io/gist', {\n          method: 'POST',\n          body: JSON.stringify(gist)\n        })\n        .then(function(response) {\n          response.json().then(function(json) {\n            cb(json.html_url);\n          })\n        })\n      })\n    });\n  }\n\n})();\n\nexports.str2ab = str2ab;\nexports.ab2str = ab2str;\nexports.readString = readString;\nexports.readLine = readLine;\nexports.writeLine = writeLine;\nexports.writeString = writeString;\nexports.isNode = isNode;\nexports.isElectron = isElectron;\nexports.base64ToArrayBuffer = base64ToArrayBuffer;\nexports.nextTick = nextTick;\nexports.getAuthToken = getAuthToken;\nexports.make4Len16 = make4Len16;\nexports.throttleTimeout = throttleTimeout;\nexports.bufferToHex = bufferToHex;\nexports.hexToBuffer = hexToBuffer;\nexports.Success = Success;\nexports.readLenLoop = readLenLoop;\nexports.arrayBufferToBase64 = arrayBufferToBase64;\nexports.writeLenData = writeLenData;\nexports.makeUUID = makeUUID;\nexports.appendBuffer = appendBuffer;\nexports.readLenPackets = readLenPackets;\nexports.hex2b64 = hex2b64;\nexports.showNotification = showNotification;\nexports.getQueryVariable = getQueryVariable;\nexports.isBrowser = isBrowser;\nexports.copyTextToClipboard = copyTextToClipboard;","/**\n * This is the web browser implementation of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = require('./debug');\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = 'undefined' != typeof chrome\n               && 'undefined' != typeof chrome.storage\n                  ? chrome.storage.local\n                  : localstorage();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n  '#0000CC', '#0000FF', '#0033CC', '#0033FF', '#0066CC', '#0066FF', '#0099CC',\n  '#0099FF', '#00CC00', '#00CC33', '#00CC66', '#00CC99', '#00CCCC', '#00CCFF',\n  '#3300CC', '#3300FF', '#3333CC', '#3333FF', '#3366CC', '#3366FF', '#3399CC',\n  '#3399FF', '#33CC00', '#33CC33', '#33CC66', '#33CC99', '#33CCCC', '#33CCFF',\n  '#6600CC', '#6600FF', '#6633CC', '#6633FF', '#66CC00', '#66CC33', '#9900CC',\n  '#9900FF', '#9933CC', '#9933FF', '#99CC00', '#99CC33', '#CC0000', '#CC0033',\n  '#CC0066', '#CC0099', '#CC00CC', '#CC00FF', '#CC3300', '#CC3333', '#CC3366',\n  '#CC3399', '#CC33CC', '#CC33FF', '#CC6600', '#CC6633', '#CC9900', '#CC9933',\n  '#CCCC00', '#CCCC33', '#FF0000', '#FF0033', '#FF0066', '#FF0099', '#FF00CC',\n  '#FF00FF', '#FF3300', '#FF3333', '#FF3366', '#FF3399', '#FF33CC', '#FF33FF',\n  '#FF6600', '#FF6633', '#FF9900', '#FF9933', '#FFCC00', '#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\nfunction useColors() {\n  // NB: In an Electron preload script, document will be defined but not fully\n  // initialized. Since we know we're in Chrome, we'll just detect this case\n  // explicitly\n  if (typeof window !== 'undefined' && window.process && window.process.type === 'renderer') {\n    return true;\n  }\n\n  // Internet Explorer and Edge do not support colors.\n  if (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n    return false;\n  }\n\n  // is webkit? http://stackoverflow.com/a/16459606/376773\n  // document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n  return (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n    // is firebug? http://stackoverflow.com/a/398120/376773\n    (typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n    // is firefox >= v31?\n    // https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/) && parseInt(RegExp.$1, 10) >= 31) ||\n    // double check webkit in userAgent just in case we are in a worker\n    (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nexports.formatters.j = function(v) {\n  try {\n    return JSON.stringify(v);\n  } catch (err) {\n    return '[UnexpectedJSONParseError]: ' + err.message;\n  }\n};\n\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n  var useColors = this.useColors;\n\n  args[0] = (useColors ? '%c' : '')\n    + this.namespace\n    + (useColors ? ' %c' : ' ')\n    + args[0]\n    + (useColors ? '%c ' : ' ')\n    + '+' + exports.humanize(this.diff);\n\n  if (!useColors) return;\n\n  var c = 'color: ' + this.color;\n  args.splice(1, 0, c, 'color: inherit')\n\n  // the final \"%c\" is somewhat tricky, because there could be other\n  // arguments passed either before or after the %c, so we need to\n  // figure out the correct index to insert the CSS into\n  var index = 0;\n  var lastC = 0;\n  args[0].replace(/%[a-zA-Z%]/g, function(match) {\n    if ('%%' === match) return;\n    index++;\n    if ('%c' === match) {\n      // we only are interested in the *last* %c\n      // (the user may have provided their own)\n      lastC = index;\n    }\n  });\n\n  args.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.log()` when available.\n * No-op when `console.log` is not a \"function\".\n *\n * @api public\n */\n\nfunction log() {\n  // this hackery is required for IE8/9, where\n  // the `console.log` function doesn't have 'apply'\n  return 'object' === typeof console\n    && console.log\n    && Function.prototype.apply.call(console.log, console, arguments);\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\n\nfunction save(namespaces) {\n  try {\n    if (null == namespaces) {\n      exports.storage.removeItem('debug');\n    } else {\n      exports.storage.debug = namespaces;\n    }\n  } catch(e) {}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n  var r;\n  try {\n    r = exports.storage.debug;\n  } catch(e) {}\n\n  // If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n  if (!r && typeof process !== 'undefined' && 'env' in process) {\n    r = process.env.DEBUG;\n  }\n\n  return r;\n}\n\n/**\n * Enable namespaces listed in `localStorage.debug` initially.\n */\n\nexports.enable(load());\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n  try {\n    return window.localStorage;\n  } catch (e) {}\n}\n","var Buffer = require('buffer').Buffer;\n\nvar hasChromeSockets = false;\ntry {\n  if (chrome && chrome.sockets) {\n    chrome.sockets.tcp.onReceive.addListener(function(resultData) {\n      var socket = Socket.readers[resultData.socketId];\n      // could be owned by another process or something...\n      if (socket == null)\n        return;\n      // console.log('got data: ' + ab2str(resultData.data));\n      socket.dataReceived(new Uint8Array(resultData.data));\n    });\n    chrome.sockets.tcp.onReceiveError.addListener(function(resultData) {\n      var socket = Socket.readers[resultData.socketId];\n      // console.log('socket died');\n      // could be owned by another process or something...\n      if (socket == null)\n        return;\n      socket.destroy();\n      socket.dataReceived(null);\n    });\n  \n    chrome.sockets.tcpServer.onAccept.addListener(function(acceptInfo) {\n      chrome.sockets.tcp.setPaused(acceptInfo.clientSocketId, false);\n      var listener = Server.listeners[acceptInfo.socketId];\n      if (listener == null)\n        return;\n      listener(new Socket({socketId: acceptInfo.clientSocketId}));\n    });\n\n    hasChromeSockets = true;\n  }\n}\ncatch (ignored) {\n  console.log('chrome app socket initialization failed')\n  console.warn(ignored);\n}\n\n\nfunction Socket(options, cb) {\n  if (options.socketId) {\n    this.socketId = options.socketId;\n    Socket.readers[this.socketId] = this;\n  }\n  else if (hasChromeSockets) {\n    chrome.sockets.tcp.create(function(createInfo) {\n      this.socketId = createInfo.socketId;\n      chrome.sockets.tcp.connect(this.socketId, options.host, options.port, function(result) {\n        if (!result) {\n          Socket.readers[createInfo.socketId] = this;\n          cb(this);\n        }\n        else {\n          // must read this to prevent log spam\n          chrome.runtime.lastError;\n          this.destroy();\n          cb(null);\n        }\n      }.bind(this));\n    }.bind(this));\n  }\n  else {\n    // electron\n    var connected;\n    if (!options.ns) {\n      this.ns = new __non_webpack_require__('net').Socket();\n      this.ns.connect({\n        port: options.port,\n        host: options.host,\n      }, function() {\n        connected = true;\n        cb(this);\n      }.bind(this))\n    }\n    else {\n      this.ns = options.ns\n      connected = true;\n    }\n    this.ns.on('close', function() {\n      this.destroy();\n      if (!connected)\n        cb(null);\n    }.bind(this))\n    this.ns.on('data', function(d) {\n      this.dataReceived(d);\n    }.bind(this));\n  }\n}\nSocket.readers = {};\n\n\nSocket.connect = function(options, cb) {\n  return new Socket(options, cb);\n}\n\nSocket.pump = function(s1, s2, cb) {\n  if (!s1 || !s2) {\n    console.error('Socket.pump called with null socket', s1, s2);\n    cb();\n    return;\n  }\n\n  var writeDone = function() {\n    s1.read(reader);\n  }.bind(s1);\n  var reader = function(data) {\n    var buffer = data.buffer;\n    if (data.byteOffset || data.length != buffer.byteLength) {\n      buffer = buffer.slice(data.byteOffset, data.byteOffset + data.length);\n    }\n    s2.write(buffer, writeDone);\n  }.bind(s2);\n  s1.read(reader);\n  s1.onClose = cb;\n}\n\nSocket.stream = function(s1, s2, cb) {\n  Socket.pump(s1, s2, function() {\n    if (s2)\n      s2.destroy();\n    if (cb) {\n      var tmp = cb;\n      cb = null;\n      tmp();\n    }\n  });\n  Socket.pump(s2, s1, function() {\n    if (s1)\n      s1.destroy();\n    if (cb) {\n      var tmp = cb;\n      cb = null;\n      tmp();\n    }\n  });\n}\n\nSocket.eat = function(s) {\n  function reader() {\n    s.read(reader);\n  }\n  reader();\n}\n\nSocket.prototype.read = function() {\n  if (this.pendingCallback) {\n    throw new Error(\"double callback\");\n  }\n\n  // see if we need to alert a close event\n  if (this.closed && !this.pending) {\n    var cb = this.onClose;\n    if (cb) {\n      delete this.onClose;\n      cb();\n    }\n    return;\n  }\n\n  var argc = 0;\n  if (arguments[argc].constructor.name == 'Number') {\n    this.pendingLength = arguments[argc++];\n  }\n  else {\n    this.pendingLength = 0;\n  }\n  var cb = arguments[argc];\n\n  // see if we can fulfill this request\n  if (!this.pending || this.paused) {\n    // nope\n    this.pendingCallback = cb;\n    return;\n  }\n\n  if (!this.pendingLength) {\n    // take it all!\n    this.pendingLength = this.buffered();\n  }\n  else if (this.pendingLength > this.buffered()) {\n    this.pendingCallback = cb;\n    return;\n  }\n\n  var data;\n  var totalRead = 0;\n  while (totalRead < this.pendingLength) {\n    var buf = this.pending.shift();\n    this.bufferedLength -= buf.length;\n    // allow gc\n    if (!this.pending.length)\n      delete this.pending;\n    var add = buf;\n    var need = Math.min(add.byteLength, this.pendingLength - totalRead);\n    if (need != add.byteLength) {\n      var part = add.subarray(0, need);\n      var leftover = add.subarray(need);\n      this.unshift(leftover);\n      add = part.slice();\n    }\n    if (!data && add.byteLength != this.pendingLength)\n      data = new Uint8Array(this.pendingLength);\n    if (data) {\n      // append\n      data.set(add, totalRead);\n    }\n    else {\n      // this is exactly what we need, so just use this\n      data = add;\n    }\n    totalRead += add.byteLength;\n  }\n  cb(data);\n}\n\nSocket.prototype.write = function(data, cb) {\n  // console.log('writeing: ' + ab2str(data));\n  if (this.pendingWrite) {\n    if (this.bufferWrites) {\n      if (cb != null)\n        console.error('using callbacks in buffered mode?');\n      var originalCallback = this.pendingWrite;\n      this.pendingWrite = function() {\n        if (originalCallback)\n          originalCallback();\n        this.write(data, cb);\n      }.bind(this);\n    }\n    else {\n      console.error('write is already in progress!')\n    }\n  }\n  if (cb == null) {\n    if (!this.bufferWrites)\n      console.error('write callback is null?');\n    cb = function() {}\n  }\n  this.pendingWrite = cb;\n  if (hasChromeSockets) {\n    chrome.sockets.tcp.send(this.socketId, data, function(writeInfo) {\n      // must read this to prevent log spam\n      chrome.runtime.lastError;\n\n      if (!writeInfo || writeInfo.resultCode) {\n        // how to handle this?\n        delete this.pendingWrite;\n        return;\n      }\n      if (writeInfo.bytesSent < data.byteLength) {\n        this.write(data.slice(writeInfo.bytesSent), cb);\n      }\n      else {\n        delete this.pendingWrite;\n        cb();\n      }\n    }.bind(this));\n  }\n  else {\n    if (!this.ns)\n      return;\n    if (!data.byteLength) {\n      process.nextTick(function() {\n        delete this.pendingWrite;\n        cb();\n      }.bind(this));\n      return;\n    }\n    this.ns.write(Buffer.from(data), function() {\n      delete this.pendingWrite;\n      cb();\n    }.bind(this));\n  }\n}\n\nSocket.prototype.destroy = function(data, cb) {\n  if (hasChromeSockets) {\n    chrome.sockets.tcp.close(this.socketId, function() {\n      // must read this to prevent log spam\n      chrome.runtime.lastError;\n    });\n  }\n  else {\n    this.dataReceived(null);\n    if (this.ns) {\n      this.ns.destroy();\n      delete this.ns;\n    }\n  }\n}\n\nSocket.prototype.unshift = function(buffer) {\n  if (buffer.byteLength == 0)\n    return;\n  if (!this.pending)\n    this.pending = [buffer];\n  else\n    this.pending.unshift(buffer);\n  if (!this.bufferedLength)\n    this.bufferedLength = 0;\n  this.bufferedLength += buffer.length;\n}\n\nSocket.prototype.dataReceived = function(payload) {\n  if (payload) {\n    if (payload.asUint8Array)\n      payload = payload.asUint8Array();\n    if (payload.constructor == ArrayBuffer)\n      payload = new Uint8Array(payload);\n  }\n  // payload is a Uint8Array\n  // push any data we got into our queue\n  if (payload && payload.length) {\n    var arr = new Uint8Array(payload);\n    if (!this.pending)\n      this.pending = [arr]\n    else\n      this.pending.push(arr);\n  }\n  if (payload == null) {\n    this.closed = true;\n  }\n  else {\n    if (!this.bufferedLength)\n      this.bufferedLength = 0;\n    this.bufferedLength += payload.length;\n  }\n  // don't trigger callbacks if there's no data or if paused\n  if (this.paused || !this.pending || !this.pending.length) {\n    // if this socket died, let's alert.\n    var cb = this.onClose;\n    if (this.closed && cb) {\n      delete this.onClose;\n      cb();\n    }\n    return;\n  }\n  // alert the data callback\n  var pl = this.pendingLength;\n  var cb = this.pendingCallback;\n  if (cb) {\n    delete this.pendingCallback;\n    this.read(pl, cb);\n  }\n}\n\nSocket.prototype.buffered = function() {\n  // var ret = 0;\n  // if (this.pending) {\n  //   for (var buf in this.pending) {\n  //     buf = this.pending[buf];\n  //     ret += buf.byteLength;\n  //   }\n  // }\n  //\n  // if (ret != this.bufferedLength)\n  //   console.log('buffer length mismatch');\n\n  return this.bufferedLength;\n}\n\nSocket.prototype.pause = function() {\n  if (this.paused) {\n    return;\n  }\n  this.paused = true;\n  this.onPause();\n}\n\nSocket.prototype.resume = function() {\n  if (!this.paused) {\n    return;\n  }\n  this.paused = false;\n  this.onResume();\n}\n\nSocket.prototype.onResume = function() {\n  chrome.sockets.tcp.setPaused(this.socketId, false, function() {})\n}\n\nSocket.prototype.onPause = function() {\n  chrome.sockets.tcp.setPaused(this.socketId, true, function() {})\n}\n\n\n\nfunction Server() {\n}\nServer.listeners = {};\n\nServer.prototype.__proto__ = Socket.prototype;\n\nServer.prototype.destroy = function() {\n  if (hasChromeSockets) {\n    chrome.sockets.tcpServer.close(this.socketId, function() {\n      chrome.runtime.lastError;\n    });\n  }\n  else {\n    if (this.ns) {\n      this.ns.close();\n      delete this.ns;\n    }\n  }\n}\n\nServer.prototype.listen = function(args, cb, listening) {\n  var port;\n  var address;\n  if (args.constructor.name == 'Number') {\n    port = args;\n    address = '0.0.0.0';\n  }\n  else {\n    address = args.address;\n    port = args.port;\n  }\n  if (hasChromeSockets) {\n    chrome.sockets.tcpServer.create(function(createInfo) {\n      this.socketId = createInfo.socketId;\n      Server.listeners[this.socketId] = cb;\n      chrome.sockets.tcpServer.listen(createInfo.socketId, address, port, function(result) {\n        // must read this to prevent log spam\n        chrome.runtime.lastError;\n        if (result) {\n          this.destroy();\n          if (listening) {\n            listening(result);\n          }\n          return;\n        }\n        chrome.sockets.tcpServer.getInfo(this.socketId, function(info) {\n          this.localAddress = info.localAddress;\n          this.localPort = info.localPort;\n\n          if (listening) {\n            listening(result);\n          }\n        }.bind(this));\n      }.bind(this))\n    }.bind(this))\n  }\n  else {\n    this.ns = __non_webpack_require__('net').createServer(function(s) {\n      cb(new Socket({ns: s}))\n    }.bind(this));\n    this.ns.on('close', function() {\n      this.destroy();\n    }.bind(this))\n    this.ns.on('error', function(e) {\n      if (listening)\n        listening(e);\n    }.bind(this))\n    this.ns.on('listening', function() {\n      var info = this.ns.address();\n      this.localAddress = info.address;\n      this.localPort = info.port;\n\n      if (listening)\n        listening();\n    }.bind(this))\n    this.ns.listen({\n      port: port,\n      host: address,\n    })\n  }\n}\n\nexports.Socket = Socket;\nexports.Server = Server;\n","\r\n/**\r\n * Expose `Emitter`.\r\n */\r\n\r\nif (typeof module !== 'undefined') {\r\n  module.exports = Emitter;\r\n}\r\n\r\n/**\r\n * Initialize a new `Emitter`.\r\n *\r\n * @api public\r\n */\r\n\r\nfunction Emitter(obj) {\r\n  if (obj) return mixin(obj);\r\n};\r\n\r\n/**\r\n * Mixin the emitter properties.\r\n *\r\n * @param {Object} obj\r\n * @return {Object}\r\n * @api private\r\n */\r\n\r\nfunction mixin(obj) {\r\n  for (var key in Emitter.prototype) {\r\n    obj[key] = Emitter.prototype[key];\r\n  }\r\n  return obj;\r\n}\r\n\r\n/**\r\n * Listen on the given `event` with `fn`.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.on =\r\nEmitter.prototype.addEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || [])\r\n    .push(fn);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Adds an `event` listener that will be invoked a single\r\n * time then automatically removed.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.once = function(event, fn){\r\n  function on() {\r\n    this.off(event, on);\r\n    fn.apply(this, arguments);\r\n  }\r\n\r\n  on.fn = fn;\r\n  this.on(event, on);\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove the given callback for `event` or all\r\n * registered callbacks.\r\n *\r\n * @param {String} event\r\n * @param {Function} fn\r\n * @return {Emitter}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.off =\r\nEmitter.prototype.removeListener =\r\nEmitter.prototype.removeAllListeners =\r\nEmitter.prototype.removeEventListener = function(event, fn){\r\n  this._callbacks = this._callbacks || {};\r\n\r\n  // all\r\n  if (0 == arguments.length) {\r\n    this._callbacks = {};\r\n    return this;\r\n  }\r\n\r\n  // specific event\r\n  var callbacks = this._callbacks['$' + event];\r\n  if (!callbacks) return this;\r\n\r\n  // remove all handlers\r\n  if (1 == arguments.length) {\r\n    delete this._callbacks['$' + event];\r\n    return this;\r\n  }\r\n\r\n  // remove specific handler\r\n  var cb;\r\n  for (var i = 0; i < callbacks.length; i++) {\r\n    cb = callbacks[i];\r\n    if (cb === fn || cb.fn === fn) {\r\n      callbacks.splice(i, 1);\r\n      break;\r\n    }\r\n  }\r\n  return this;\r\n};\r\n\r\n/**\r\n * Emit `event` with the given args.\r\n *\r\n * @param {String} event\r\n * @param {Mixed} ...\r\n * @return {Emitter}\r\n */\r\n\r\nEmitter.prototype.emit = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  var args = [].slice.call(arguments, 1)\r\n    , callbacks = this._callbacks['$' + event];\r\n\r\n  if (callbacks) {\r\n    callbacks = callbacks.slice(0);\r\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\r\n      callbacks[i].apply(this, args);\r\n    }\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Return array of callbacks for `event`.\r\n *\r\n * @param {String} event\r\n * @return {Array}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.listeners = function(event){\r\n  this._callbacks = this._callbacks || {};\r\n  return this._callbacks['$' + event] || [];\r\n};\r\n\r\n/**\r\n * Check if this emitter has `event` handlers.\r\n *\r\n * @param {String} event\r\n * @return {Boolean}\r\n * @api public\r\n */\r\n\r\nEmitter.prototype.hasListeners = function(event){\r\n  return !! this.listeners(event).length;\r\n};\r\n","/**\n * Module dependencies.\n */\n\nvar keys = require('./keys');\nvar hasBinary = require('has-binary2');\nvar sliceBuffer = require('arraybuffer.slice');\nvar after = require('after');\nvar utf8 = require('./utf8');\n\nvar base64encoder;\nif (typeof ArrayBuffer !== 'undefined') {\n  base64encoder = require('base64-arraybuffer');\n}\n\n/**\n * Check if we are running an android browser. That requires us to use\n * ArrayBuffer with polling transports...\n *\n * http://ghinda.net/jpeg-blob-ajax-android/\n */\n\nvar isAndroid = typeof navigator !== 'undefined' && /Android/i.test(navigator.userAgent);\n\n/**\n * Check if we are running in PhantomJS.\n * Uploading a Blob with PhantomJS does not work correctly, as reported here:\n * https://github.com/ariya/phantomjs/issues/11395\n * @type boolean\n */\nvar isPhantomJS = typeof navigator !== 'undefined' && /PhantomJS/i.test(navigator.userAgent);\n\n/**\n * When true, avoids using Blobs to encode payloads.\n * @type boolean\n */\nvar dontSendBlobs = isAndroid || isPhantomJS;\n\n/**\n * Current protocol version.\n */\n\nexports.protocol = 3;\n\n/**\n * Packet types.\n */\n\nvar packets = exports.packets = {\n    open:     0    // non-ws\n  , close:    1    // non-ws\n  , ping:     2\n  , pong:     3\n  , message:  4\n  , upgrade:  5\n  , noop:     6\n};\n\nvar packetslist = keys(packets);\n\n/**\n * Premade error packet.\n */\n\nvar err = { type: 'error', data: 'parser error' };\n\n/**\n * Create a blob api even for blob builder when vendor prefixes exist\n */\n\nvar Blob = require('blob');\n\n/**\n * Encodes a packet.\n *\n *     <packet type id> [ <data> ]\n *\n * Example:\n *\n *     5hello world\n *     3\n *     4\n *\n * Binary is encoded in an identical principle\n *\n * @api private\n */\n\nexports.encodePacket = function (packet, supportsBinary, utf8encode, callback) {\n  if (typeof supportsBinary === 'function') {\n    callback = supportsBinary;\n    supportsBinary = false;\n  }\n\n  if (typeof utf8encode === 'function') {\n    callback = utf8encode;\n    utf8encode = null;\n  }\n\n  var data = (packet.data === undefined)\n    ? undefined\n    : packet.data.buffer || packet.data;\n\n  if (typeof ArrayBuffer !== 'undefined' && data instanceof ArrayBuffer) {\n    return encodeArrayBuffer(packet, supportsBinary, callback);\n  } else if (typeof Blob !== 'undefined' && data instanceof Blob) {\n    return encodeBlob(packet, supportsBinary, callback);\n  }\n\n  // might be an object with { base64: true, data: dataAsBase64String }\n  if (data && data.base64) {\n    return encodeBase64Object(packet, callback);\n  }\n\n  // Sending data as a utf-8 string\n  var encoded = packets[packet.type];\n\n  // data fragment is optional\n  if (undefined !== packet.data) {\n    encoded += utf8encode ? utf8.encode(String(packet.data), { strict: false }) : String(packet.data);\n  }\n\n  return callback('' + encoded);\n\n};\n\nfunction encodeBase64Object(packet, callback) {\n  // packet data is an object { base64: true, data: dataAsBase64String }\n  var message = 'b' + exports.packets[packet.type] + packet.data.data;\n  return callback(message);\n}\n\n/**\n * Encode packet helpers for binary types\n */\n\nfunction encodeArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var data = packet.data;\n  var contentArray = new Uint8Array(data);\n  var resultBuffer = new Uint8Array(1 + data.byteLength);\n\n  resultBuffer[0] = packets[packet.type];\n  for (var i = 0; i < contentArray.length; i++) {\n    resultBuffer[i+1] = contentArray[i];\n  }\n\n  return callback(resultBuffer.buffer);\n}\n\nfunction encodeBlobAsArrayBuffer(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  var fr = new FileReader();\n  fr.onload = function() {\n    exports.encodePacket({ type: packet.type, data: fr.result }, supportsBinary, true, callback);\n  };\n  return fr.readAsArrayBuffer(packet.data);\n}\n\nfunction encodeBlob(packet, supportsBinary, callback) {\n  if (!supportsBinary) {\n    return exports.encodeBase64Packet(packet, callback);\n  }\n\n  if (dontSendBlobs) {\n    return encodeBlobAsArrayBuffer(packet, supportsBinary, callback);\n  }\n\n  var length = new Uint8Array(1);\n  length[0] = packets[packet.type];\n  var blob = new Blob([length.buffer, packet.data]);\n\n  return callback(blob);\n}\n\n/**\n * Encodes a packet with binary data in a base64 string\n *\n * @param {Object} packet, has `type` and `data`\n * @return {String} base64 encoded message\n */\n\nexports.encodeBase64Packet = function(packet, callback) {\n  var message = 'b' + exports.packets[packet.type];\n  if (typeof Blob !== 'undefined' && packet.data instanceof Blob) {\n    var fr = new FileReader();\n    fr.onload = function() {\n      var b64 = fr.result.split(',')[1];\n      callback(message + b64);\n    };\n    return fr.readAsDataURL(packet.data);\n  }\n\n  var b64data;\n  try {\n    b64data = String.fromCharCode.apply(null, new Uint8Array(packet.data));\n  } catch (e) {\n    // iPhone Safari doesn't let you apply with typed arrays\n    var typed = new Uint8Array(packet.data);\n    var basic = new Array(typed.length);\n    for (var i = 0; i < typed.length; i++) {\n      basic[i] = typed[i];\n    }\n    b64data = String.fromCharCode.apply(null, basic);\n  }\n  message += btoa(b64data);\n  return callback(message);\n};\n\n/**\n * Decodes a packet. Changes format to Blob if requested.\n *\n * @return {Object} with `type` and `data` (if any)\n * @api private\n */\n\nexports.decodePacket = function (data, binaryType, utf8decode) {\n  if (data === undefined) {\n    return err;\n  }\n  // String data\n  if (typeof data === 'string') {\n    if (data.charAt(0) === 'b') {\n      return exports.decodeBase64Packet(data.substr(1), binaryType);\n    }\n\n    if (utf8decode) {\n      data = tryDecode(data);\n      if (data === false) {\n        return err;\n      }\n    }\n    var type = data.charAt(0);\n\n    if (Number(type) != type || !packetslist[type]) {\n      return err;\n    }\n\n    if (data.length > 1) {\n      return { type: packetslist[type], data: data.substring(1) };\n    } else {\n      return { type: packetslist[type] };\n    }\n  }\n\n  var asArray = new Uint8Array(data);\n  var type = asArray[0];\n  var rest = sliceBuffer(data, 1);\n  if (Blob && binaryType === 'blob') {\n    rest = new Blob([rest]);\n  }\n  return { type: packetslist[type], data: rest };\n};\n\nfunction tryDecode(data) {\n  try {\n    data = utf8.decode(data, { strict: false });\n  } catch (e) {\n    return false;\n  }\n  return data;\n}\n\n/**\n * Decodes a packet encoded in a base64 string\n *\n * @param {String} base64 encoded message\n * @return {Object} with `type` and `data` (if any)\n */\n\nexports.decodeBase64Packet = function(msg, binaryType) {\n  var type = packetslist[msg.charAt(0)];\n  if (!base64encoder) {\n    return { type: type, data: { base64: true, data: msg.substr(1) } };\n  }\n\n  var data = base64encoder.decode(msg.substr(1));\n\n  if (binaryType === 'blob' && Blob) {\n    data = new Blob([data]);\n  }\n\n  return { type: type, data: data };\n};\n\n/**\n * Encodes multiple messages (payload).\n *\n *     <length>:data\n *\n * Example:\n *\n *     11:hello world2:hi\n *\n * If any contents are binary, they will be encoded as base64 strings. Base64\n * encoded strings are marked with a b before the length specifier\n *\n * @param {Array} packets\n * @api private\n */\n\nexports.encodePayload = function (packets, supportsBinary, callback) {\n  if (typeof supportsBinary === 'function') {\n    callback = supportsBinary;\n    supportsBinary = null;\n  }\n\n  var isBinary = hasBinary(packets);\n\n  if (supportsBinary && isBinary) {\n    if (Blob && !dontSendBlobs) {\n      return exports.encodePayloadAsBlob(packets, callback);\n    }\n\n    return exports.encodePayloadAsArrayBuffer(packets, callback);\n  }\n\n  if (!packets.length) {\n    return callback('0:');\n  }\n\n  function setLengthHeader(message) {\n    return message.length + ':' + message;\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, !isBinary ? false : supportsBinary, false, function(message) {\n      doneCallback(null, setLengthHeader(message));\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(results.join(''));\n  });\n};\n\n/**\n * Async array map using after\n */\n\nfunction map(ary, each, done) {\n  var result = new Array(ary.length);\n  var next = after(ary.length, done);\n\n  var eachWithIndex = function(i, el, cb) {\n    each(el, function(error, msg) {\n      result[i] = msg;\n      cb(error, result);\n    });\n  };\n\n  for (var i = 0; i < ary.length; i++) {\n    eachWithIndex(i, ary[i], next);\n  }\n}\n\n/*\n * Decodes data when a payload is maybe expected. Possible binary contents are\n * decoded from their base64 representation\n *\n * @param {String} data, callback method\n * @api public\n */\n\nexports.decodePayload = function (data, binaryType, callback) {\n  if (typeof data !== 'string') {\n    return exports.decodePayloadAsBinary(data, binaryType, callback);\n  }\n\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var packet;\n  if (data === '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n  var length = '', n, msg;\n\n  for (var i = 0, l = data.length; i < l; i++) {\n    var chr = data.charAt(i);\n\n    if (chr !== ':') {\n      length += chr;\n      continue;\n    }\n\n    if (length === '' || (length != (n = Number(length)))) {\n      // parser error - ignoring payload\n      return callback(err, 0, 1);\n    }\n\n    msg = data.substr(i + 1, n);\n\n    if (length != msg.length) {\n      // parser error - ignoring payload\n      return callback(err, 0, 1);\n    }\n\n    if (msg.length) {\n      packet = exports.decodePacket(msg, binaryType, false);\n\n      if (err.type === packet.type && err.data === packet.data) {\n        // parser error in individual packet - ignoring payload\n        return callback(err, 0, 1);\n      }\n\n      var ret = callback(packet, i + n, l);\n      if (false === ret) return;\n    }\n\n    // advance cursor\n    i += n;\n    length = '';\n  }\n\n  if (length !== '') {\n    // parser error - ignoring payload\n    return callback(err, 0, 1);\n  }\n\n};\n\n/**\n * Encodes multiple messages (payload) as binary.\n *\n * <1 = binary, 0 = string><number from 0-9><number from 0-9>[...]<number\n * 255><data>\n *\n * Example:\n * 1 3 255 1 2 3, if the binary contents are interpreted as 8 bit integers\n *\n * @param {Array} packets\n * @return {ArrayBuffer} encoded payload\n * @api private\n */\n\nexports.encodePayloadAsArrayBuffer = function(packets, callback) {\n  if (!packets.length) {\n    return callback(new ArrayBuffer(0));\n  }\n\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(data) {\n      return doneCallback(null, data);\n    });\n  }\n\n  map(packets, encodeOne, function(err, encodedPackets) {\n    var totalLength = encodedPackets.reduce(function(acc, p) {\n      var len;\n      if (typeof p === 'string'){\n        len = p.length;\n      } else {\n        len = p.byteLength;\n      }\n      return acc + len.toString().length + len + 2; // string/binary identifier + separator = 2\n    }, 0);\n\n    var resultArray = new Uint8Array(totalLength);\n\n    var bufferIndex = 0;\n    encodedPackets.forEach(function(p) {\n      var isString = typeof p === 'string';\n      var ab = p;\n      if (isString) {\n        var view = new Uint8Array(p.length);\n        for (var i = 0; i < p.length; i++) {\n          view[i] = p.charCodeAt(i);\n        }\n        ab = view.buffer;\n      }\n\n      if (isString) { // not true binary\n        resultArray[bufferIndex++] = 0;\n      } else { // true binary\n        resultArray[bufferIndex++] = 1;\n      }\n\n      var lenStr = ab.byteLength.toString();\n      for (var i = 0; i < lenStr.length; i++) {\n        resultArray[bufferIndex++] = parseInt(lenStr[i]);\n      }\n      resultArray[bufferIndex++] = 255;\n\n      var view = new Uint8Array(ab);\n      for (var i = 0; i < view.length; i++) {\n        resultArray[bufferIndex++] = view[i];\n      }\n    });\n\n    return callback(resultArray.buffer);\n  });\n};\n\n/**\n * Encode as Blob\n */\n\nexports.encodePayloadAsBlob = function(packets, callback) {\n  function encodeOne(packet, doneCallback) {\n    exports.encodePacket(packet, true, true, function(encoded) {\n      var binaryIdentifier = new Uint8Array(1);\n      binaryIdentifier[0] = 1;\n      if (typeof encoded === 'string') {\n        var view = new Uint8Array(encoded.length);\n        for (var i = 0; i < encoded.length; i++) {\n          view[i] = encoded.charCodeAt(i);\n        }\n        encoded = view.buffer;\n        binaryIdentifier[0] = 0;\n      }\n\n      var len = (encoded instanceof ArrayBuffer)\n        ? encoded.byteLength\n        : encoded.size;\n\n      var lenStr = len.toString();\n      var lengthAry = new Uint8Array(lenStr.length + 1);\n      for (var i = 0; i < lenStr.length; i++) {\n        lengthAry[i] = parseInt(lenStr[i]);\n      }\n      lengthAry[lenStr.length] = 255;\n\n      if (Blob) {\n        var blob = new Blob([binaryIdentifier.buffer, lengthAry.buffer, encoded]);\n        doneCallback(null, blob);\n      }\n    });\n  }\n\n  map(packets, encodeOne, function(err, results) {\n    return callback(new Blob(results));\n  });\n};\n\n/*\n * Decodes data when a payload is maybe expected. Strings are decoded by\n * interpreting each byte as a key code for entries marked to start with 0. See\n * description of encodePayloadAsBinary\n *\n * @param {ArrayBuffer} data, callback method\n * @api public\n */\n\nexports.decodePayloadAsBinary = function (data, binaryType, callback) {\n  if (typeof binaryType === 'function') {\n    callback = binaryType;\n    binaryType = null;\n  }\n\n  var bufferTail = data;\n  var buffers = [];\n\n  while (bufferTail.byteLength > 0) {\n    var tailArray = new Uint8Array(bufferTail);\n    var isString = tailArray[0] === 0;\n    var msgLength = '';\n\n    for (var i = 1; ; i++) {\n      if (tailArray[i] === 255) break;\n\n      // 310 = char length of Number.MAX_VALUE\n      if (msgLength.length > 310) {\n        return callback(err, 0, 1);\n      }\n\n      msgLength += tailArray[i];\n    }\n\n    bufferTail = sliceBuffer(bufferTail, 2 + msgLength.length);\n    msgLength = parseInt(msgLength);\n\n    var msg = sliceBuffer(bufferTail, 0, msgLength);\n    if (isString) {\n      try {\n        msg = String.fromCharCode.apply(null, new Uint8Array(msg));\n      } catch (e) {\n        // iPhone Safari doesn't let you apply to typed arrays\n        var typed = new Uint8Array(msg);\n        msg = '';\n        for (var i = 0; i < typed.length; i++) {\n          msg += String.fromCharCode(typed[i]);\n        }\n      }\n    }\n\n    buffers.push(msg);\n    bufferTail = sliceBuffer(bufferTail, msgLength);\n  }\n\n  var total = buffers.length;\n  buffers.forEach(function(buffer, i) {\n    callback(exports.decodePacket(buffer, binaryType, true), i, total);\n  });\n};\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","/**\r\n * Compiles a querystring\r\n * Returns string representation of the object\r\n *\r\n * @param {Object}\r\n * @api private\r\n */\r\n\r\nexports.encode = function (obj) {\r\n  var str = '';\r\n\r\n  for (var i in obj) {\r\n    if (obj.hasOwnProperty(i)) {\r\n      if (str.length) str += '&';\r\n      str += encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]);\r\n    }\r\n  }\r\n\r\n  return str;\r\n};\r\n\r\n/**\r\n * Parses a simple querystring into an object\r\n *\r\n * @param {String} qs\r\n * @api private\r\n */\r\n\r\nexports.decode = function(qs){\r\n  var qry = {};\r\n  var pairs = qs.split('&');\r\n  for (var i = 0, l = pairs.length; i < l; i++) {\r\n    var pair = pairs[i].split('=');\r\n    qry[decodeURIComponent(pair[0])] = decodeURIComponent(pair[1]);\r\n  }\r\n  return qry;\r\n};\r\n","\nmodule.exports = function(a, b){\n  var fn = function(){};\n  fn.prototype = b.prototype;\n  a.prototype = new fn;\n  a.prototype.constructor = a;\n};","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","\n/**\n * Module dependencies.\n */\n\nvar debug = require('debug')('socket.io-parser');\nvar Emitter = require('component-emitter');\nvar binary = require('./binary');\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = 4;\n\n/**\n * Packet types.\n *\n * @api public\n */\n\nexports.types = [\n  'CONNECT',\n  'DISCONNECT',\n  'EVENT',\n  'ACK',\n  'ERROR',\n  'BINARY_EVENT',\n  'BINARY_ACK'\n];\n\n/**\n * Packet type `connect`.\n *\n * @api public\n */\n\nexports.CONNECT = 0;\n\n/**\n * Packet type `disconnect`.\n *\n * @api public\n */\n\nexports.DISCONNECT = 1;\n\n/**\n * Packet type `event`.\n *\n * @api public\n */\n\nexports.EVENT = 2;\n\n/**\n * Packet type `ack`.\n *\n * @api public\n */\n\nexports.ACK = 3;\n\n/**\n * Packet type `error`.\n *\n * @api public\n */\n\nexports.ERROR = 4;\n\n/**\n * Packet type 'binary event'\n *\n * @api public\n */\n\nexports.BINARY_EVENT = 5;\n\n/**\n * Packet type `binary ack`. For acks with binary arguments.\n *\n * @api public\n */\n\nexports.BINARY_ACK = 6;\n\n/**\n * Encoder constructor.\n *\n * @api public\n */\n\nexports.Encoder = Encoder;\n\n/**\n * Decoder constructor.\n *\n * @api public\n */\n\nexports.Decoder = Decoder;\n\n/**\n * A socket.io Encoder instance\n *\n * @api public\n */\n\nfunction Encoder() {}\n\nvar ERROR_PACKET = exports.ERROR + '\"encode error\"';\n\n/**\n * Encode a packet as a single string if non-binary, or as a\n * buffer sequence, depending on packet type.\n *\n * @param {Object} obj - packet object\n * @param {Function} callback - function to handle encodings (likely engine.write)\n * @return Calls callback with Array of encodings\n * @api public\n */\n\nEncoder.prototype.encode = function(obj, callback){\n  debug('encoding packet %j', obj);\n\n  if (exports.BINARY_EVENT === obj.type || exports.BINARY_ACK === obj.type) {\n    encodeAsBinary(obj, callback);\n  } else {\n    var encoding = encodeAsString(obj);\n    callback([encoding]);\n  }\n};\n\n/**\n * Encode packet as string.\n *\n * @param {Object} packet\n * @return {String} encoded\n * @api private\n */\n\nfunction encodeAsString(obj) {\n\n  // first is type\n  var str = '' + obj.type;\n\n  // attachments if we have them\n  if (exports.BINARY_EVENT === obj.type || exports.BINARY_ACK === obj.type) {\n    str += obj.attachments + '-';\n  }\n\n  // if we have a namespace other than `/`\n  // we append it followed by a comma `,`\n  if (obj.nsp && '/' !== obj.nsp) {\n    str += obj.nsp + ',';\n  }\n\n  // immediately followed by the id\n  if (null != obj.id) {\n    str += obj.id;\n  }\n\n  // json data\n  if (null != obj.data) {\n    var payload = tryStringify(obj.data);\n    if (payload !== false) {\n      str += payload;\n    } else {\n      return ERROR_PACKET;\n    }\n  }\n\n  debug('encoded %j as %s', obj, str);\n  return str;\n}\n\nfunction tryStringify(str) {\n  try {\n    return JSON.stringify(str);\n  } catch(e){\n    return false;\n  }\n}\n\n/**\n * Encode packet as 'buffer sequence' by removing blobs, and\n * deconstructing packet into object with placeholders and\n * a list of buffers.\n *\n * @param {Object} packet\n * @return {Buffer} encoded\n * @api private\n */\n\nfunction encodeAsBinary(obj, callback) {\n\n  function writeEncoding(bloblessData) {\n    var deconstruction = binary.deconstructPacket(bloblessData);\n    var pack = encodeAsString(deconstruction.packet);\n    var buffers = deconstruction.buffers;\n\n    buffers.unshift(pack); // add packet info to beginning of data list\n    callback(buffers); // write all the buffers\n  }\n\n  binary.removeBlobs(obj, writeEncoding);\n}\n\n/**\n * A socket.io Decoder instance\n *\n * @return {Object} decoder\n * @api public\n */\n\nfunction Decoder() {\n  this.reconstructor = null;\n}\n\n/**\n * Mix in `Emitter` with Decoder.\n */\n\nEmitter(Decoder.prototype);\n\n/**\n * Decodes an ecoded packet string into packet JSON.\n *\n * @param {String} obj - encoded packet\n * @return {Object} packet\n * @api public\n */\n\nDecoder.prototype.add = function(obj) {\n  var packet;\n  if (typeof obj === 'string') {\n    packet = decodeString(obj);\n    if (exports.BINARY_EVENT === packet.type || exports.BINARY_ACK === packet.type) { // binary packet's json\n      this.reconstructor = new BinaryReconstructor(packet);\n\n      // no attachments, labeled binary but no binary data to follow\n      if (this.reconstructor.reconPack.attachments === 0) {\n        this.emit('decoded', packet);\n      }\n    } else { // non-binary full packet\n      this.emit('decoded', packet);\n    }\n  }\n  else if (isBuf(obj) || obj.base64) { // raw binary data\n    if (!this.reconstructor) {\n      throw new Error('got binary data when not reconstructing a packet');\n    } else {\n      packet = this.reconstructor.takeBinaryData(obj);\n      if (packet) { // received final buffer\n        this.reconstructor = null;\n        this.emit('decoded', packet);\n      }\n    }\n  }\n  else {\n    throw new Error('Unknown type: ' + obj);\n  }\n};\n\n/**\n * Decode a packet String (JSON data)\n *\n * @param {String} str\n * @return {Object} packet\n * @api private\n */\n\nfunction decodeString(str) {\n  var i = 0;\n  // look up type\n  var p = {\n    type: Number(str.charAt(0))\n  };\n\n  if (null == exports.types[p.type]) {\n    return error('unknown packet type ' + p.type);\n  }\n\n  // look up attachments if type binary\n  if (exports.BINARY_EVENT === p.type || exports.BINARY_ACK === p.type) {\n    var buf = '';\n    while (str.charAt(++i) !== '-') {\n      buf += str.charAt(i);\n      if (i == str.length) break;\n    }\n    if (buf != Number(buf) || str.charAt(i) !== '-') {\n      throw new Error('Illegal attachments');\n    }\n    p.attachments = Number(buf);\n  }\n\n  // look up namespace (if any)\n  if ('/' === str.charAt(i + 1)) {\n    p.nsp = '';\n    while (++i) {\n      var c = str.charAt(i);\n      if (',' === c) break;\n      p.nsp += c;\n      if (i === str.length) break;\n    }\n  } else {\n    p.nsp = '/';\n  }\n\n  // look up id\n  var next = str.charAt(i + 1);\n  if ('' !== next && Number(next) == next) {\n    p.id = '';\n    while (++i) {\n      var c = str.charAt(i);\n      if (null == c || Number(c) != c) {\n        --i;\n        break;\n      }\n      p.id += str.charAt(i);\n      if (i === str.length) break;\n    }\n    p.id = Number(p.id);\n  }\n\n  // look up json data\n  if (str.charAt(++i)) {\n    var payload = tryParse(str.substr(i));\n    var isPayloadValid = payload !== false && (p.type === exports.ERROR || isArray(payload));\n    if (isPayloadValid) {\n      p.data = payload;\n    } else {\n      return error('invalid payload');\n    }\n  }\n\n  debug('decoded %s as %j', str, p);\n  return p;\n}\n\nfunction tryParse(str) {\n  try {\n    return JSON.parse(str);\n  } catch(e){\n    return false;\n  }\n}\n\n/**\n * Deallocates a parser's resources\n *\n * @api public\n */\n\nDecoder.prototype.destroy = function() {\n  if (this.reconstructor) {\n    this.reconstructor.finishedReconstruction();\n  }\n};\n\n/**\n * A manager of a binary event's 'buffer sequence'. Should\n * be constructed whenever a packet of type BINARY_EVENT is\n * decoded.\n *\n * @param {Object} packet\n * @return {BinaryReconstructor} initialized reconstructor\n * @api private\n */\n\nfunction BinaryReconstructor(packet) {\n  this.reconPack = packet;\n  this.buffers = [];\n}\n\n/**\n * Method to be called when binary data received from connection\n * after a BINARY_EVENT packet.\n *\n * @param {Buffer | ArrayBuffer} binData - the raw binary data received\n * @return {null | Object} returns null if more binary data is expected or\n *   a reconstructed packet object if all buffers have been received.\n * @api private\n */\n\nBinaryReconstructor.prototype.takeBinaryData = function(binData) {\n  this.buffers.push(binData);\n  if (this.buffers.length === this.reconPack.attachments) { // done with buffer list\n    var packet = binary.reconstructPacket(this.reconPack, this.buffers);\n    this.finishedReconstruction();\n    return packet;\n  }\n  return null;\n};\n\n/**\n * Cleans up binary packet reconstruction variables.\n *\n * @api private\n */\n\nBinaryReconstructor.prototype.finishedReconstruction = function() {\n  this.reconPack = null;\n  this.buffers = [];\n};\n\nfunction error(msg) {\n  return {\n    type: exports.ERROR,\n    data: 'parser error: ' + msg\n  };\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","// browser shim for xmlhttprequest module\n\nvar hasCORS = require('has-cors');\n\nmodule.exports = function (opts) {\n  var xdomain = opts.xdomain;\n\n  // scheme must be same when usign XDomainRequest\n  // http://blogs.msdn.com/b/ieinternals/archive/2010/05/13/xdomainrequest-restrictions-limitations-and-workarounds.aspx\n  var xscheme = opts.xscheme;\n\n  // XDomainRequest has a flow of not sending cookie, therefore it should be disabled as a default.\n  // https://github.com/Automattic/engine.io-client/pull/217\n  var enablesXDR = opts.enablesXDR;\n\n  // XMLHttpRequest can be disabled on IE\n  try {\n    if ('undefined' !== typeof XMLHttpRequest && (!xdomain || hasCORS)) {\n      return new XMLHttpRequest();\n    }\n  } catch (e) { }\n\n  // Use XDomainRequest for IE8 if enablesXDR is true\n  // because loading bar keeps flashing when using jsonp-polling\n  // https://github.com/yujiosaka/socke.io-ie8-loading-example\n  try {\n    if ('undefined' !== typeof XDomainRequest && !xscheme && enablesXDR) {\n      return new XDomainRequest();\n    }\n  } catch (e) { }\n\n  if (!xdomain) {\n    try {\n      return new global[['Active'].concat('Object').join('X')]('Microsoft.XMLHTTP');\n    } catch (e) { }\n  }\n};\n","/**\n * Module dependencies.\n */\n\nvar parser = require('engine.io-parser');\nvar Emitter = require('component-emitter');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Transport;\n\n/**\n * Transport abstract constructor.\n *\n * @param {Object} options.\n * @api private\n */\n\nfunction Transport (opts) {\n  this.path = opts.path;\n  this.hostname = opts.hostname;\n  this.port = opts.port;\n  this.secure = opts.secure;\n  this.query = opts.query;\n  this.timestampParam = opts.timestampParam;\n  this.timestampRequests = opts.timestampRequests;\n  this.readyState = '';\n  this.agent = opts.agent || false;\n  this.socket = opts.socket;\n  this.enablesXDR = opts.enablesXDR;\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx;\n  this.key = opts.key;\n  this.passphrase = opts.passphrase;\n  this.cert = opts.cert;\n  this.ca = opts.ca;\n  this.ciphers = opts.ciphers;\n  this.rejectUnauthorized = opts.rejectUnauthorized;\n  this.forceNode = opts.forceNode;\n\n  // other options for Node.js client\n  this.extraHeaders = opts.extraHeaders;\n  this.localAddress = opts.localAddress;\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Transport.prototype);\n\n/**\n * Emits an error.\n *\n * @param {String} str\n * @return {Transport} for chaining\n * @api public\n */\n\nTransport.prototype.onError = function (msg, desc) {\n  var err = new Error(msg);\n  err.type = 'TransportError';\n  err.description = desc;\n  this.emit('error', err);\n  return this;\n};\n\n/**\n * Opens the transport.\n *\n * @api public\n */\n\nTransport.prototype.open = function () {\n  if ('closed' === this.readyState || '' === this.readyState) {\n    this.readyState = 'opening';\n    this.doOpen();\n  }\n\n  return this;\n};\n\n/**\n * Closes the transport.\n *\n * @api private\n */\n\nTransport.prototype.close = function () {\n  if ('opening' === this.readyState || 'open' === this.readyState) {\n    this.doClose();\n    this.onClose();\n  }\n\n  return this;\n};\n\n/**\n * Sends multiple packets.\n *\n * @param {Array} packets\n * @api private\n */\n\nTransport.prototype.send = function (packets) {\n  if ('open' === this.readyState) {\n    this.write(packets);\n  } else {\n    throw new Error('Transport not open');\n  }\n};\n\n/**\n * Called upon open\n *\n * @api private\n */\n\nTransport.prototype.onOpen = function () {\n  this.readyState = 'open';\n  this.writable = true;\n  this.emit('open');\n};\n\n/**\n * Called with data.\n *\n * @param {String} data\n * @api private\n */\n\nTransport.prototype.onData = function (data) {\n  var packet = parser.decodePacket(data, this.socket.binaryType);\n  this.onPacket(packet);\n};\n\n/**\n * Called with a decoded packet.\n */\n\nTransport.prototype.onPacket = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon close.\n *\n * @api private\n */\n\nTransport.prototype.onClose = function () {\n  this.readyState = 'closed';\n  this.emit('close');\n};\n","const {Socket, Server} = require('../lib/socket/socket');\nconst {nextTick, readString, str2ab, ab2str, make4Len16, appendBuffer, hex2b64, showNotification} = require('../lib/base/util');\nconst AdbChromeUsbTransport = require('./adb-chrome-usb');\nconst AdbWebUsbTransport = require('./adb-web-usb');\n\nlet getUserSelectedDevices;\nif (window.chrome && window.chrome.usb) {\n  getUserSelectedDevices = AdbChromeUsbTransport.getUserSelectedDevices;\n}\nelse {\n  getUserSelectedDevices = AdbWebUsbTransport.getUserSelectedDevices;\n}\n\nfunction AdbTcpTransport(socket) {\n  this.socket = socket;\n  this.zero_mask = (1 << 30) - 1;\n  this.type = 'tcp';\n  socket.onClose = function() {\n    var cb = this.currentRead;\n    if (cb) {\n      delete this.currentRead;\n      cb({\n        resultCode: -1\n      })\n    }\n  }.bind(this);\n}\n\nAdbTcpTransport.prototype.destroy = function() {\n  this.socket.destroy();\n}\n\nAdbTcpTransport.prototype.write = function(data, callback) {\n  if (this.writing) {\n    if (!this.pendingWrites)\n      this.pendingWrites = [];\n    this.pendingWrites.push({data: data, callback: callback});\n    return;\n  }\n\n  this.writing = true;\n  this.socket.write(data, function() {\n    this.writing = false;\n    callback({\n      resultCode: 0\n    })\n    if (!this.pendingWrites)\n      return;\n    var next = this.pendingWrites.shift();\n    if (!this.pendingWrites.length)\n      this.pendingWrites = null;\n    this.write(next.data, next.callback);\n  }.bind(this));\n}\n\nAdbTcpTransport.prototype.read = function(len, cb) {\n  this.currentRead = cb;\n  this.socket.read(len, function(data) {\n    delete this.currentRead;\n    cb({\n      resultCode: 0,\n      data: data.buffer.slice(data.byteOffset, data.byteOffset + data.byteLength)\n    })\n  });\n}\n\nfunction AdbDevice(transport, cb) {\n  this.onConnected = cb;\n  this.transport = transport;\n  this.currentSocketId = 0;\n  this.sockets = {};\n  this.forwards = {};\n  this.maxPayload = AdbDevice.MAX_PAYLOAD;\n}\n\nAdbDevice.prototype.fatal = function(e) {\n  console.log('fatal error', JSON.stringify(e));\n  var cb = this.onConnected;\n  if (cb) {\n    delete this.onConnected;\n    cb();\n  }\n  else if (this.onError) {\n    this.onError();\n    delete this.onError;\n  }\n  this.destroy();\n}\n\nAdbDevice.prototype.destroy = function() {\n  for (var socket in this.sockets) {\n    socket = this.sockets[socket];\n    socket.dataReceived(null);\n  }\n  if (this.forwards) {\n    $.each(this.forwards, function(port, listener) {\n      listener.destroy();\n    })\n  }\n  this.transport.destroy();\n}\n\nAdbDevice.kCommandSYNC = 0x434e5953,\nAdbDevice.kCommandCNXN = 0x4e584e43,\nAdbDevice.kCommandOPEN = 0x4e45504f,\nAdbDevice.kCommandOKAY = 0x59414b4f,\nAdbDevice.kCommandCLSE = 0x45534c43,\nAdbDevice.kCommandWRTE = 0x45545257,\nAdbDevice.kCommandAUTH = 0x48545541\n\nAdbDevice.kAuthToken = 1;\nAdbDevice.kAuthSignature = 2;\nAdbDevice.kAuthRSAPublicKey = 3;\n\n// ADB protocol version\nAdbDevice.ADB_PROTOCOL_VERSION = 0x01000000;\n// ADB Version\nAdbDevice.ADB_VERSION = 40;\nAdbDevice.MAX_PAYLOAD = 4096;\n\nAdbDevice.checksum = function(data) {\n  data = new Uint8Array(data);\n  var sum = 0;\n  for (var i = 0; i < data.byteLength; i++) {\n    sum += data[i];\n  }\n  return sum & 0xFFFFFFFF;\n}\n\nAdbDevice.prototype.sendMessage = function(command, arg0, arg1, payload, cb) {\n  // Header (24):\n  // command\n  // arg0\n  // arg1\n  // body length\n  // checksum\n  // command ^ 0xffffffff\n\n  if (!payload) {\n    payload = '';\n  }\n\n  if (payload.constructor.name == 'String') {\n    payload = str2ab(payload);\n  }\n\n  var appendZero = true;\n  if (!payload.byteLength) {\n    appendZero = false;\n  }\n  if (command == AdbDevice.kCommandAUTH && arg0 == AdbDevice.kAuthSignature) {\n    appendZero = false;\n  }\n  if (command == AdbDevice.kCommandWRTE) {\n    appendZero = false;\n  }\n\n  var bodyLength = payload.byteLength;\n  if (appendZero) {\n    bodyLength++;\n  }\n\n  if (appendZero) {\n    var copy = new ArrayBuffer(payload.byteLength + 1);\n    var view = new Uint8Array(copy);\n    view.set(new Uint8Array(payload));\n    view[copy.byteLength - 1] = 0;\n    payload = copy;\n  }\n\n  var header = new ArrayBuffer(24);\n  var view = new DataView(header);\n\n  view.setUint32(0, command, true);\n  view.setUint32(4, arg0, true);\n  view.setUint32(8, arg1, true);\n  view.setUint32(12, bodyLength, true);\n  view.setUint32(16, AdbDevice.checksum(payload), true);\n  view.setUint32(20, command ^ 0xFFFFFFFF, true);\n\n  // new Uint8Array(data, 24).set(new Uint8Array(payload));\n\n  this.transport.write(header, function(result) {\n    if (result.resultCode) {\n      this.fatal(result);\n    }\n    if (!payload.byteLength && cb) {\n      cb();\n    }\n  }.bind(this));\n\n  if (payload.byteLength) {\n    this.transport.write(payload, function(result) {\n      if (result.resultCode) {\n        this.fatal(result);\n      }\n      if (cb) {\n        cb();\n      }\n    }.bind(this));\n  }\n}\n\nAdbDevice.prototype.getKey = function(cb) {\n  if (!window.chrome || !window.chrome.storage) {\n    var key = new JSEncrypt({default_key_size: 2048});\n    try {\n      var keyString = localStorage.getItem('adbkey');\n      if (!keyString)\n        throw new Error();\n      var adbkey = JSON.parse(keyString);\n      key.setPrivateKey(adbkey);\n    }\n    catch (e) {\n      adbkey = key.getPrivateKeyB64();\n      key.setPrivateKey(adbkey);\n      localStorage.setItem('adbkey', JSON.stringify(adbkey));\n    }\n    nextTick(() => cb(key));\n    return;\n  }\n\n  chrome.storage.local.get('adbkey', function(result) {\n    var adbkey = result.adbkey;\n    var key = new JSEncrypt({default_key_size: 2048});\n    if (!adbkey) {\n      adbkey = key.getPrivateKeyB64();\n      key.setPrivateKey(adbkey);\n      chrome.storage.local.set({'adbkey': adbkey})\n    }\n    else {\n      key.setPrivateKey(adbkey);\n    }\n    cb(key);\n  })\n}\n\nAdbDevice.prototype._convertToMinCrypt = function(rsaKey) {\n  var bitLength = 2048;//rsaKey.n.toByteArray().length * 8;\n  var numWords = bitLength / 8 / 4;\n\n  // B32 = 1 << 32 or 0x100000000L\n  var B32 = BigInteger.ONE.shiftLeft(32);\n\n  // modulus\n  var N = rsaKey.n.clone();\n\n  // R=2^2048\n  var R = BigInteger.ONE.shiftLeft(1).pow(bitLength);\n\n  // RR = R^2 % N\n  var RR = R.multiply(R).mod(N);\n\n  // Format:\n  //   int32 len\n  //   uint32 n0inv\n  //   uint32 n[numWords]\n  //   uint32 rr[numWords]\n  //   int32 exponent\n  var pkey = new Uint32Array(3 + numWords * 2);\n  pkey[0] = numWords;\n  pkey[1] = B32.subtract(N.modInverse(B32)).intValue();\n\n  var iEnd = numWords + 2;\n  for (var i = 2, j = 2 + numWords; i < iEnd; ++i, ++j) {\n    pkey[i] = N.mod(B32).intValue();\n    N = N.divide(B32);\n    pkey[j] = RR.mod(B32).intValue();\n    RR = RR.divide(B32);\n  }\n\n  pkey[pkey.length - 1] = rsaKey.e;\n\n  // Convert to hex string first since our Base64 only does that\n  var hexStr = \"\";\n  var u8view = new Uint8Array(pkey.buffer);\n  for (var i = 0; i < u8view.length; ++i) {\n    var digit = u8view[i].toString(16);\n    if (digit.length == 1) {\n      hexStr += \"0\";\n    }\n    hexStr += digit;\n  }\n\n  // TODO: allow setting a useful identifier\n  return hex2b64(hexStr) + \" adb@chrome\";\n};\n\nAdbDevice.prototype.sign = function(rsakey, data) {\n  if (rsakey == null) {\n    throw \"AuthManager is not initialized\";\n  }\n\n  var totalLen = 2048 / 8;//rsakey.n.toByteArray() * 4;\n\n  var array = new Uint8Array(totalLen);\n  array[0] = 0x00;\n  array[1] = 0x01;\n\n  var ASN1_PREAMBLE = [0x00, 0x30, 0x21, 0x30, 0x09, 0x06, 0x05, 0x2B, 0x0E, 0x03, 0x02, 0x1A, 0x05, 0x00, 0x04, 0x14];\n\n  // Subtract the preamble and hash length.\n  var padEnd = totalLen - ASN1_PREAMBLE.length - data.byteLength;\n  for (var i = 2; i < padEnd; i++) {\n    array[i] = 0xFF;\n  }\n\n  array.set(new Uint8Array(ASN1_PREAMBLE), padEnd);\n  padEnd += ASN1_PREAMBLE.length;\n  array.set(new Uint8Array(data), padEnd);\n\n  var msg = new BigInteger(Array.apply([], array));\n  return new Uint8Array(rsakey.doPrivate(msg).toByteArray()).buffer;\n};\n\nfunction parseConnectionPayload(payload) {\n  var ret = {};\n  if (payload.constructor.name != 'String')\n    payload = ab2str(payload);\n  var splits = payload.replace('device::', '').split(';');\n  for (var split in splits) {\n    split = splits[split];\n    var parts = split.split('=');\n    if (parts.length == 2) {\n      ret[parts[0]] = parts[1];\n    }\n  }\n  return ret;\n}\n\nAdbDevice.parseConnectionPayload = parseConnectionPayload;\n\nAdbDevice.prototype.handleUnknown = function(localId, remoteId) {\n  console.log('no idea what this socket is.');\n  this.sendMessage(AdbDevice.kCommandCLSE, localId, remoteId);\n}\n\nAdbDevice.prototype.handleMessage = function(header, payload) {\n  var command = header.getUint32(0, true);\n  var arg0 = header.getUint32(4, true);\n  var arg1 = header.getUint32(8, true);\n\n  switch (command) {\n  case AdbDevice.kCommandOPEN:\n    if (this.onOpenSocket)\n      this.onOpenSocket(payload, arg0)\n    break;\n  case AdbDevice.kCommandAUTH:\n    console.log('auth:', this);\n    // get the key and respond\n    this.getKey(function(rsakey) {\n      if (this.sentSignature) {\n        var publicKey = this._convertToMinCrypt(rsakey.getKey());\n        this.sendMessage(AdbDevice.kCommandAUTH, AdbDevice.kAuthRSAPublicKey, 0, publicKey);\n        showNotification('Check your Android device and click \"Allow USB Debugging\".');\n      }\n      else {\n        this.sentSignature = true;\n        var signed = this.sign(rsakey.getKey(), payload);\n        this.sendMessage(AdbDevice.kCommandAUTH, AdbDevice.kAuthSignature, 0, signed, function() {\n          // console.log(arguments);\n        });\n      }\n    }.bind(this))\n    break;\n  case AdbDevice.kCommandOKAY:\n    var remoteId = arg0;\n    var localId = arg1;\n    var socket = this.sockets[localId];\n    if (!socket) {\n      this.handleUnknown(localId, remoteId);\n      return;\n    }\n    var cb = socket.onConnected;\n    if (cb) {\n      delete socket.onConnected;\n      socket.remoteId = remoteId;\n      cb(socket);\n    }\n\n    // see if we need to pump more data out\n    var data = socket.pendingWrite;\n    if (data) {\n      cb = socket.wrote;\n      delete socket.wrote;\n      delete socket.pendingWrite;\n      socket.write(data, cb);\n      return;\n    }\n\n    // this socket can write more...\n    cb = socket.wrote;\n    if (cb) {\n      delete socket.wrote;\n      cb();\n    }\n    break;\n  case AdbDevice.kCommandCNXN:\n    this.rawProperties = ab2str(payload);\n    this.properties = parseConnectionPayload(payload)\n    var cb = this.onConnected;\n    if (cb) {\n      delete this.onConnected;\n      cb(this);\n    }\n    break;\n  case AdbDevice.kCommandWRTE:\n    var remoteId = arg0;\n    var localId = arg1;\n    var socket = this.sockets[localId];\n    if (!socket) {\n      this.handleUnknown(localId, remoteId);\n      return;\n    }\n    // if not paused, ask for more\n    if (!socket.paused) {\n      this.sendMessage(AdbDevice.kCommandOKAY, socket.localId, socket.remoteId);\n    }\n    socket.dataReceived(new Uint8Array(payload));\n    break;\n  case AdbDevice.kCommandCLSE:\n    var remoteId = arg0;\n    var localId = arg1;\n    var socket = this.sockets[localId];\n    if (!socket) {\n      console.log('asked to close unknown socket?');\n      return;\n    }\n    delete this.sockets[localId];\n    socket.destroy();\n    // closed without connecting\n    var cb = socket.onConnected;\n    if (cb) {\n      delete socket.onConnected;\n      cb();\n    }\n    break;\n  default:\n    console.log('unknown command: ', command.toString(16), arg0, arg1, payload);\n    break;\n  }\n}\n\nAdbDevice.prototype.onReceiveMessage = function(result) {\n  if (result.resultCode) {\n    this.fatal(result);\n    return;\n  }\n\n  var header = new DataView(result.data);\n  var transferLen = header.getUint32(12, true);\n\n  if (!transferLen) {\n    try {\n      this.handleMessage(header, null);\n    }\n    finally {\n      this.receiveMessages();\n    }\n    return;\n  }\n\n  this.transport.read(transferLen, function(result) {\n    if (result.resultCode) {\n      this.fatal(result);\n      return;\n    }\n\n    var payload = result.data;\n    if (AdbDevice.checksum(payload) != header.getUint32(16, true)) {\n      this.receiveMessages();\n      return;\n    }\n\n    try {\n      this.handleMessage(header, payload);\n    }\n    finally {\n      this.receiveMessages();\n    }\n  }.bind(this))\n}\n\nAdbDevice.prototype.receiveMessages = function() {\n  this.transport.read(24, this.onReceiveMessage.bind(this));\n}\n\nAdbDevice.prototype.forwardPort = function(args) {\n  var forwardingServer = new Server();\n  forwardingServer.listen({\n    port: args.fromPort,\n    address: '127.0.0.1'\n  }, function(localSocket) {\n    this.newSocket(args.to, function(remoteSocket) {\n      if (remoteSocket)\n        Socket.stream(localSocket, remoteSocket);\n      else\n        localSocket.destroy();\n    }.bind(this))\n  }.bind(this), function() {\n    this.forwards[args.fromPort] = forwardingServer;\n  }.bind(this));\n}\n\nAdbDevice.prototype.newAdbSocket = function(socketId, cb) {\n  var socket;\n  if (this.createSocket)\n    socket = this.createSocket(socketId, cb);\n  else\n    socket = new AdbSocket(this, socketId, cb);\n  return socket\n}\n\nAdbDevice.prototype.newSocket = function(service, cb) {\n  var socketId = ++this.currentSocketId;\n  this.sockets[socketId] = this.newAdbSocket(socketId, cb);\n  this.sendMessage(AdbDevice.kCommandOPEN, socketId, 0, service);\n}\n\nfunction AdbSocket(device, socketId, cb) {\n  if (!cb) {\n    cb = function() {\n    }\n  }\n\n  this.device = device;\n  this.localId = socketId;\n  this.onConnected = cb;\n}\n\nAdbSocket.prototype.write = function(data, cb) {\n  if (this.pendingWrite || this.wrote) {\n    console.log('bad adb socket state, already writing');\n    throw new Error('bad adb socket state, already writing');\n  }\n\n  var toWrite = Math.min(this.device.transport.zero_mask, this.device.maxPayload);\n  if (toWrite < data.byteLength) {\n    this.pendingWrite = data.slice(toWrite);\n    data = data.slice(0, toWrite);\n  }\n  else {\n    this.pendingWrite = null;\n  }\n  this.wrote = cb;\n  this.device.sendMessage(AdbDevice.kCommandWRTE, this.localId, this.remoteId, data);\n}\n\nAdbSocket.prototype.destroy = function() {\n  this.device.sendMessage(AdbDevice.kCommandCLSE, this.localId, this.remoteId);\n  this.dataReceived(null);\n}\n\nAdbSocket.prototype.buffered = Socket.prototype.buffered;\nAdbSocket.prototype.dataReceived = Socket.prototype.dataReceived;\nAdbSocket.prototype.read = Socket.prototype.read;\nAdbSocket.prototype.pause = Socket.prototype.pause;\nAdbSocket.prototype.resume = Socket.prototype.resume;\nAdbSocket.prototype.unshift = Socket.prototype.unshift;\n\nAdbSocket.prototype.onPause = function() {\n  // no op\n}\n\nAdbSocket.prototype.onResume = function() {\n  // tell the other side we want data again\n  this.device.sendMessage(AdbDevice.kCommandOKAY, this.localId, this.remoteId);\n}\n\nfunction connectUsbAdb(device, iface, cb) {\n  console.log('connecting');\n  var adb = new AdbDevice(device.newTransport(iface), cb);\n  console.log('sending CNXN');\n  adb.sendMessage(AdbDevice.kCommandCNXN, AdbDevice.ADB_PROTOCOL_VERSION, AdbDevice.MAX_PAYLOAD, \"host::\");\n  console.log('starting receive loop');\n  adb.receiveMessages();\n}\n\nfunction AdbServer(options) {\n  var options = options || {};\n  var port = options.port || 5037;\n  var start = options.start !== false;\n\n  this.currentSocketId = 1;\n  this.pendingDevices = {};\n  this.port = port;\n  this.adbDevices = {};\n  this.clients = {};\n  if (start) {\n    this.start();\n  }\n}\n\nAdbServer.prototype.onOpenSocket = function(payload, remoteSocketId) {\n  var device = this;\n  var destination = ab2str(payload);\n  var split = destination.split(':');\n  var port = Number.parseInt(split[1]);\n  Socket.connect({host: '127.0.0.1', port: port}, function (socket) {\n    if (!socket) {\n      device.sendMessage(AdbDevice.kCommandOKAY, 0, remoteSocketId);\n      return;\n    }\n\n    var socketId = ++device.currentSocketId;\n    var adbSocket = device.newAdbSocket(socketId);\n    adbSocket.remoteId = remoteSocketId;\n    device.sockets[socketId] = adbSocket;\n    device.sendMessage(AdbDevice.kCommandOKAY, socketId, remoteSocketId);\n    Socket.stream(socket, adbSocket);\n  });\n}\n\nfunction _nowMs() {\n  return new Date().getTime();\n}\n\nAdbServer.prototype.start = function() {\n  if (this.server) {\n    console.log('ADB Server started while already started');\n    return;\n  }\n  this.clients = {};\n  this.adbDevices = {};\n  this.pendingDevices = {};\n  this.refreshing = {};\n  var server = new Server();\n  if (this.dummyListen)\n    return;\n  server.listen({\n    port: this.port,\n    address: '127.0.0.1'\n  }, function(socket) {\n    var client = new AdbClient(this, socket);\n    var socketId = ++this.currentSocketId;\n    this.clients[socketId] = client;\n    socket.onClose = function() {\n      delete this.clients[socketId];\n    }.bind(this);\n    client.receiveHeader();\n  }.bind(this),\n  function(result) {\n    if (result) {\n      console.log('adb server failed to listen: ' + result);\n      return;\n    }\n    console.log('ADB Server started');\n    this.server = server;\n  }.bind(this));\n}\n\nAdbServer.prototype.isRunning = function() {\n  return this.server != null;\n}\n\nAdbServer.prototype.kill = function() {\n  // kill listener\n  this.server.destroy();\n  this.server = null;\n  this.refreshing = {};\n  // kill clients\n  for (var client in this.clients) {\n    client = this.clients[client];\n    client.socket.destroy();\n  }\n  this.clients = {};\n  // kill clients\n  for (var device in this.adbDevices) {\n    device = this.adbDevices[device];\n    device.destroy();\n  }\n  this.adbDevices = {};\n  this.pendingDevices = {};\n}\n\nAdbServer.prototype.withAdbDevice = function(adb, cb) {\n  adb.onError = function() {\n    delete this.adbDevices[adb.serialno];\n    this.internalOnDevicesChanged();\n  }.bind(this);\n\n  var withSerial = function(str) {\n    adb.serialno = str.trim();\n    this.adbDevices[adb.serialno] = adb;\n    console.log('found device: ' + adb.serialno);\n    this.internalOnDevicesChanged();\n    cb(adb);\n  }.bind(this);\n\n  if (adb.serialno) {\n    withSerial(adb.serialno);\n    return;\n  }\n\n  adb.newSocket('shell:getprop ro.serialno', function(adbSocket) {\n    readString(adbSocket, function(str) {\n      withSerial(str);\n    }.bind(this))\n  }.bind(this))\n}\n\nAdbServer.prototype.tryDevice = function(device, cb) {\n  var serialno = device.serialno;\n  var pending = this.pendingDevices;\n  var server = this;\n\n  function tryInterface(i) {\n    console.log('trying intrface', i);\n    var number = i.interfaceNumber;\n\n    // check pending\n    if (pending[number]) {\n      return false;\n    }\n\n    pending[number] = device;\n\n    console.log('claiming:', JSON.stringify(i));\n    device.claimInterface(i.interfaceNumber)\n    .then(() => {\n      console.log('claimed interface');\n\n      connectUsbAdb(device, i, function(adb) {\n        console.log(\"usb adb connected\");\n        if (!adb) {\n          delete pending[number];\n          cb();\n          return;\n        }\n\n        adb.serialno = serialno;\n        adb.onOpenSocket = server.onOpenSocket;\n\n        server.withAdbDevice(adb, function(adb) {\n          delete pending[number];\n          cb(adb);\n        });\n      })\n    })\n    .catch(e => {\n      console.log('unable claim interface', JSON.stringify(e));\n    })\n    return true;\n  }\n\n  device.listInterfaces()\n  .then(interfaces => {\n    console.log('got interfaces', JSON.stringify(interfaces))\n    var usedHandle = false;\n    for (var i in interfaces) {\n      i = interfaces[i];\n\n      if (i.interfaceClass == 0xff && i.interfaceSubclass == 0x42 && i.interfaceProtocol == 0x1) {\n          usedHandle |= tryInterface(i);\n      }\n    }\n    if (!usedHandle) {\n      device.close();\n    }\n  })\n  .catch(e => {\n      console.log('unable list interfaces', e);\n      if (cb)\n        cb();\n  })\n}\n\n\nAdbServer.prototype.refreshDevice = function(device, cb) {\n  device.open()\n  .then(() => {\n    this.start();\n    console.log('opened ' + device.serialNumber);\n    this.tryDevice(device, (adb) => {\n      console.log('try device done', adb);\n      if (adb) {\n        adb.usbDevice = device.device;\n      }\n      cb(adb);\n    })\n  })\n  .catch(e => {\n    console.log('unable to open device', JSON.stringify(e));\n    cb()\n  });\n}\n\nAdbServer.prototype.internalOnDevicesChanged = function() {\n  for (var client in this.clients) {\n    client = this.clients[client];\n    if (!client.tracking)\n      continue;\n    var payload = client.getDevicesString();\n    if (!payload.length)\n      payload = '0000\\n'\n    client.socket.write(str2ab(payload), function() {})\n  }\n}\n\nAdbServer.prototype.stop = function() {\n  this.server.destroy();\n}\n\nfunction AdbClient(server, socket) {\n  this.server = server;\n  this.socket = socket;\n}\n\nAdbClient.prototype.resolveTransport = function(transport, serialno) {\n  if (serialno) {\n    var ret = this.server.adbDevices[serialno];\n    if (!ret)\n      return 'device not found';\n    return ret;\n  }\n  var num = Object.keys(this.server.adbDevices);\n  if (num > 1) {\n    return \"more than one device\";\n  }\n  if (num == 0) {\n    return 'no devices connected';\n  }\n  for (var device in this.server.adbDevices) {\n    return this.server.adbDevices[device];\n  }\n}\n\nAdbClient.prototype.write = function(data, status, cb) {\n  if (!status) {\n    status = 'OKAY';\n  }\n  // console.log(data);\n  data = str2ab(data);\n  var len = data.byteLength;\n  var len16 = make4Len16(len);\n  len16 = str2ab(status + len16);\n  var payload = appendBuffer(new Uint8Array(len16), new Uint8Array(data)).buffer;\n  if (!cb) {\n    cb = function() {\n      this.socket.destroy();\n    }.bind(this);\n  }\n  this.socket.write(payload, cb)\n}\n\nAdbClient.prototype.getDevicesString = function(options) {\n  var options = options || {};\n  var longformDevices = options.longformDevices;\n  var devices = '';\n  for (var device in this.server.adbDevices) {\n    device = this.server.adbDevices[device];\n    devices += device.serialno + '\\tdevice';\n    if (longformDevices) {\n      if (device.transport.type == 'usb')\n        devices += ' usb:' + device.transport.iface.interfaceNumber;\n      else\n        devices += ' tpcip:' + 'something';\n      devices += ' product:' + device.properties['ro.product.name'];\n      devices += ' model:' + device.properties['ro.product.model'];\n      devices += ' device:' + device.properties['ro.product.device'];\n    }\n    devices += '\\n';\n  }\n  return devices;\n}\n\nAdbClient.prototype.writeDevices = function(options, cb) {\n  this.write(this.getDevicesString(options), null, cb);\n}\n\nAdbClient.prototype.handlePayload = function(data) {\n  data = ab2str(data);\n  // console.log(\"handling command: \" + data);\n  var commandParts = data.split(':');\n  var hostCmd = data;\n  var serialno;\n  if (commandParts[0] == 'host-serial') {\n    commandParts[0] = 'host';\n    serialno = commandParts.splice(1, 1)[0];\n    if (Number.isInteger(parseInt(commandParts[1]))) {\n      // this is in host:port format\n      serialno += ':' + commandParts.splice(1, 1)[0];\n    }\n  }\n  if (commandParts.length >= 2)\n    hostCmd = commandParts[0] + ':' + commandParts[1];\n\n  switch (hostCmd) {\n  case 'host:version':\n    this.write(make4Len16(AdbDevice.ADB_VERSION));\n    break;\n  case 'host:devices-l':\n  case 'host:devices':\n    var longformDevices = data == 'host:devices-l';\n    this.writeDevices({ longformDevices: longformDevices });\n    break;\n  case 'host:features':\n    var transport = this.resolveTransport(data, serialno);\n    if (transport.constructor.name == 'String') {\n      this.write(transport, 'FAIL');\n      break;\n    }\n    var features = transport.properties.features;\n    if (!features)\n      features = '';\n    this.write(make4Len16(features));\n    break;\n  case 'host:transport-usb':\n  case 'host:transport-any':\n    var transport = this.resolveTransport(data, serialno);\n    if (transport.constructor.name == 'String') {\n      this.write(transport, 'FAIL');\n      break;\n    }\n    this.transport = transport;\n    this.socket.write(str2ab('OKAY'), function() {})\n    break;\n  case 'host:kill':\n    this.server.kill();\n    break;\n  case 'host:disconnect':\n    if (commandParts.length > 4) {\n      this.write('host:disconnect only takes 1 argument', 'FAIL');\n      break;\n    }\n    if (commandParts.length > 2) {\n      var remoteHost = commandParts[2];\n      if (remoteHost.length) {\n        var remotePort = 5555;\n        if (commandParts.length > 3)\n          remotePort = Number.parseInt(commandParts[3]);\n        var remote = remoteHost + ':' + remotePort;\n        var device = this.server.adbDevices[remote];\n        if (device && device.transport.type == 'tcp')\n          device.destroy();\n        this.write('disconnected');\n        break;\n      }\n    }\n    for (var device in this.server.adbDevices) {\n      device = this.server.adbDevices[device];\n      if (device.transport.type == 'tcp')\n        device.destroy();\n    }\n    this.write('disconnected');\n    break;\n  case 'host:connect':\n    if (commandParts.length < 3) {\n      this.write('need more arguments for connect <host>[:<port>]', 'FAIL');\n      break;\n    }\n    var remoteHost = commandParts[2];\n    var remotePort = 5555;\n    if (commandParts.length > 3)\n      remotePort = Number.parseInt(commandParts[3]);\n    Socket.connect({host: remoteHost, port: remotePort}, function(socket, e) {\n      if (!socket) {\n        console.error('connect failed');\n        this.write('unable to connect to ' + remoteHost + ' ' + remotePort + ': ' + e, 'FAIL');\n        return this;\n      }\n      var adb = new AdbDevice(new AdbTcpTransport(socket), function(adb) {\n        this.server.withAdbDevice(adb, function() {\n          var response = 'connected to ' + remoteHost + ':' + remotePort;\n          console.log(response);\n          this.write(response);\n        }.bind(this))\n      }.bind(this));\n      adb.onOpenSocket = this.onOpenSocket;\n      adb.serialno = remoteHost + ':' + remotePort;\n      socket.onClose = function() {\n        adb.fatal('socket closed');\n      }.bind(this);\n      adb.sendMessage(AdbDevice.kCommandCNXN, AdbDevice.ADB_PROTOCOL_VERSION, AdbDevice.MAX_PAYLOAD, \"host::\");\n      adb.receiveMessages();\n    }.bind(this))\n    break;\n  case 'host:track-devices':\n    this.tracking = _nowMs();\n    this.writeDevices({}, function() {});\n    break;\n  case  'host:forward':\n    // host:forward:tcp:5000;tcp:5000\n    var forwardParts = commandParts.join(':').substring(hostCmd.length + 1).split(';');\n    var from = forwardParts[0].split(':');\n    var fromPort = parseInt(from[1]);\n    var transport = this.resolveTransport(data, serialno);\n    if (transport.constructor.name == 'String') {\n      this.write(transport, 'FAIL');\n      break;\n    }\n    transport.forwardPort({\n      fromPort: fromPort,\n      to: forwardParts[1]\n    })\n    this.socket.write(str2ab('OKAYOKAY'), function() {\n      // this.socket.destroy();\n    }.bind(this));\n    break;\n  default:\n    // check to see if a smart socket is pending\n    if (this.transport) {\n      var transport = this.transport;\n      transport.newSocket(data, function(socket) {\n        if (!socket) {\n          this.socket.write(str2ab('OKAY'), function() {\n            this.socket.destroy();\n          }.bind(this))\n          return\n        }\n        this.socket.write(str2ab('OKAY'), function() {})\n        Socket.stream(socket, this.socket);\n      }.bind(this));\n      return;\n    }\n\n    // check if this was a smart socket request for a specific device\n    var specific = 'host:transport:';\n    if (data.startsWith(specific)) {\n      var serialno = data.substr(specific.length);\n      var device = this.server.adbDevices[serialno];\n      if (!device) {\n        this.write('device not found', 'FAIL');\n        return;\n      }\n      this.transport = device;\n      this.socket.write(str2ab('OKAY'), function() {})\n      break;\n    }\n\n    // WAT\n    console.log('unknown request: ' + data);\n    this.write('unknown command: ' + data, 'FAIL');\n\n    showNotification(appName + \"\\'s adb server encountered an unknown adb command.\\nYou may want to close \" + appName + \" and start your adb binary manually.\");\n    break;\n  }\n  this.receiveHeader();\n}\n\nAdbClient.prototype.receivePayload = function(data) {\n  var len = parseInt(ab2str(data), 16);\n  this.socket.read(len, this.handlePayload.bind(this));\n}\n\nAdbClient.prototype.receiveHeader = function() {\n  this.socket.read(4, this.receivePayload.bind(this));\n}\n\nexports.AdbDevice = AdbDevice;\nexports.AdbServer = AdbServer;\nexports.AdbTcpTransport = AdbTcpTransport;\nexports.getUserSelectedDevices = getUserSelectedDevices;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(\n      uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)\n    ))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","exports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n","const { Socket, Server } = require('../lib/socket/socket');\nconst { str2ab, ab2str, make4Len16, appendBuffer, hex2b64, showNotification } = require('../lib/base/util');\n\nclass ChromeUsbDevice {\n  constructor(device) {\n    this.device = device;\n  }\n\n  get vendorId() {\n    return this.device.vendorId;\n  }\n\n  get productId() {\n    return this.device.productId;\n  }\n\n  get serialNumber() {\n    return this.device.serialNumber;\n  }\n\n  claimInterface(interfaceNumber) {\n    return new Promise((resolve, reject) => {\n      chrome.usb.claimInterface(this.connectionHandle, interfaceNumber, () => {\n        var error = chrome.runtime.lastError;\n        if (error) {\n          reject(error);\n          return;\n        }\n        resolve();\n      });\n    });\n  }\n\n  listInterfaces() {\n    return new Promise((resolve, reject) => {\n      chrome.usb.listInterfaces(this.connectionHandle, interfaces => {\n        if (!interfaces) {\n          reject(chrome.runtime.lastError);\n          return;\n        }\n\n        resolve(interfaces);\n      });\n    });\n  }\n\n  open() {\n    return new Promise((resolve, reject) => {\n      chrome.usb.openDevice(this.device, connectionHandle => {\n        this.connectionHandle = connectionHandle;\n\n        if (!connectionHandle) {\n          reject(chrome.runtime.lastError)\n          return;\n        }\n\n        console.log('opened adb');\n        resolve();\n      })\n    })\n  }\n\n  close() {\n    chrome.usb.closeDevice(this.connectionHandle);\n  }\n\n  newTransport(iface) {\n    return new AdbUsbTransport(this.connectionHandle, iface);\n  }\n}\n\nfunction AdbUsbTransport (handle, iface) {\n    this.handle = handle;\n    this.iface = iface;\n    this.type = 'usb';\n    for (var endpoint in iface.endpoints) {\n        endpoint = iface.endpoints[endpoint];\n        if (endpoint.type == 'bulk') {\n            this.zero_mask = endpoint.maximumPacketSize - 1;\n            if (endpoint.direction == 'in') {\n                this.in = endpoint;\n            }\n            else {\n                this.out = endpoint;\n            }\n        }\n    }\n}\n\nAdbUsbTransport.prototype.destroy = function () {\n    chrome.usb.releaseInterface(this.handle, this.iface.interfaceNumber, function () {\n        chrome.runtime.lastError;\n        chrome.usb.closeDevice(this.handle, function () {\n            chrome.runtime.lastError;\n        })\n    }.bind(this))\n}\n\nAdbUsbTransport.prototype.write = function (data, callback) {\n    if (this.writing) {\n        if (!this.pendingWrites)\n            this.pendingWrites = [];\n        this.pendingWrites.push({ data: data, callback: callback });\n        return;\n    }\n\n    var transfer = {\n        direction: \"out\",\n        endpoint: this.out.address,\n        data: data\n    }\n\n    this.writing = true;\n    chrome.usb.bulkTransfer(this.handle, transfer, function (result) {\n        chrome.runtime.lastError;\n        this.writing = false;\n        callback(result);\n        if (!this.pendingWrites)\n            return;\n        var next = this.pendingWrites.shift();\n        if (!this.pendingWrites.length)\n            this.pendingWrites = null;\n        this.write(next.data, next.callback);\n    }.bind(this));\n}\n\nAdbUsbTransport.prototype.read = function (len, cb) {\n    var transfer = {\n        direction: \"in\",\n        endpoint: this.in.address,\n        length: len\n    }\n    chrome.usb.bulkTransfer(this.handle, transfer, function (result) {\n        chrome.runtime.lastError;\n        cb(result);\n    });\n}\n\nfunction getUserSelectedDevices() {\n  return new Promise((resolve, reject) => {\n    chrome.usb.getUserSelectedDevices({\n      filters: [\n        {\n        interfaceClass: 0xff,\n        interfaceSubclass: 0x42,\n        interfaceProtocol: 0x1,\n        }\n      ]\n    }, function(devices) {\n      resolve(devices.map(device => new ChromeUsbDevice(device)));\n    });\n  })\n}\n\nexports.getUserSelectedDevices = getUserSelectedDevices;\n","async function getUserSelectedDevices () {\n  let device = await navigator.usb.requestDevice({\n    filters: [{\n      classCode: 0xff,\n      subclassCode: 0x42,\n      protocolCode: 0x1,\n    }]\n  })\n  return [new WebUsbDevice(device)]\n}\n\nclass WebUsbDevice {\n  constructor(device) {\n    this.device = device;\n  }\n\n  get vendorId () {\n    return this.device.vendorId;\n  }\n\n  get productId () {\n    return this.device.productId;\n  }\n\n  get serialNumber () {\n    return this.device.serialNumber;\n  }\n\n  async open () {\n    await this.device.open()\n  }\n\n  async close () {\n    await this.device.close();\n  }\n\n  async claimInterface (interfaceNumber) {\n    return await this.device.claimInterface(interfaceNumber);\n  }\n\n  async listInterfaces () {\n    if (this.device.configuration === null)\n      await this.device.selectConfiguration(1);\n    return this.device.configuration.interfaces.map(iface => {\n      let alternate = iface.alternate || iface.alternates[0];\n      let { interfaceClass,\n        interfaceName,\n        interfaceProtocol,\n        interfaceSubclass,\n        endpoints } = alternate;\n      return {\n        interfaceNumber: iface.interfaceNumber,\n        interfaceClass, interfaceName, interfaceProtocol, interfaceSubclass, endpoints,\n      }\n    });\n  }\n\n  newTransport (iface) {\n    return new AdbUsbTransport(this.device, iface);\n  }\n}\n\nclass AdbUsbTransport {\n  constructor(device, iface) {\n    this.device = device;\n    this.iface = iface;\n\n    for (var endpoint of iface.endpoints) {\n      if (endpoint.type == 'bulk') {\n        this.zero_mask = endpoint.packetSize - 1;\n        if (endpoint.direction == 'in') {\n          this.in = endpoint;\n        }\n        else {\n          this.out = endpoint;\n        }\n      }\n    }\n  }\n\n  destroy () {\n    this.device.releaseInterface(iface.interfaceNumber);\n  }\n\n  async write (data, callback) {\n    if (this.writing) {\n      if (!this.pendingWrites)\n        this.pendingWrites = [];\n      this.pendingWrites.push({ data: data, callback: callback });\n      return;\n    }\n\n    this.writing = true;\n    var result\n    try {\n      result = await this.device.transferOut(this.out.endpointNumber, data);\n    }\n    catch (e) {\n      result = {\n        resultCode: e,\n      }\n    }\n    finally {\n      this.writing = false;\n    }\n    callback(result);\n\n    if (!this.pendingWrites)\n      return;\n    var next = this.pendingWrites.shift();\n    if (!this.pendingWrites.length)\n      this.pendingWrites = null;\n    this.write(next.data, next.callback);\n  }\n\n  async read (len, cb) {\n    var result\n    try {\n      result = await this.device.transferIn(this.in.endpointNumber, len);\n      result = {\n        data: result.data.buffer,\n      }\n    }\n    catch (e) {\n      result = {\n        resultCode: e,\n      }\n    }\n\n    cb(result);\n  }\n}\n\nexports.getUserSelectedDevices = getUserSelectedDevices;\n","const {Socket} = require('./socket');\n\nfunction DummySocket(buffer) {\n  if (buffer) {\n    this.dataReceived(buffer);\n    this.dataReceived(null);\n  }\n}\n\nDummySocket.prototype.write = function(data, cb) {\n  throw new Error('write not supported on dummy socket')\n}\n\nDummySocket.prototype.destroy = function() {\n  this.dataReceived(null);\n}\n\nDummySocket.prototype.buffered = Socket.prototype.buffered;\nDummySocket.prototype.unshift = Socket.prototype.unshift;\nDummySocket.prototype.dataReceived = Socket.prototype.dataReceived;\nDummySocket.prototype.read = Socket.prototype.read;\nDummySocket.prototype.pause = Socket.prototype.pause;\nDummySocket.prototype.resume = Socket.prototype.resume;\nDummySocket.prototype.buffered = Socket.prototype.buffered;\n\nDummySocket.prototype.onPause = function() {\n  // no op\n}\n\nDummySocket.prototype.onResume = function() {\n}\n\nmodule.exports = DummySocket;","/**\r\n * Parses an URI\r\n *\r\n * @author Steven Levithan <stevenlevithan.com> (MIT license)\r\n * @api private\r\n */\r\n\r\nvar re = /^(?:(?![^:@]+:[^:@\\/]*@)(http|https|ws|wss):\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/;\r\n\r\nvar parts = [\r\n    'source', 'protocol', 'authority', 'userInfo', 'user', 'password', 'host', 'port', 'relative', 'path', 'directory', 'file', 'query', 'anchor'\r\n];\r\n\r\nmodule.exports = function parseuri(str) {\r\n    var src = str,\r\n        b = str.indexOf('['),\r\n        e = str.indexOf(']');\r\n\r\n    if (b != -1 && e != -1) {\r\n        str = str.substring(0, b) + str.substring(b, e).replace(/:/g, ';') + str.substring(e, str.length);\r\n    }\r\n\r\n    var m = re.exec(str || ''),\r\n        uri = {},\r\n        i = 14;\r\n\r\n    while (i--) {\r\n        uri[parts[i]] = m[i] || '';\r\n    }\r\n\r\n    if (b != -1 && e != -1) {\r\n        uri.source = src;\r\n        uri.host = uri.host.substring(1, uri.host.length - 1).replace(/;/g, ':');\r\n        uri.authority = uri.authority.replace('[', '').replace(']', '').replace(/;/g, ':');\r\n        uri.ipv6uri = true;\r\n    }\r\n\r\n    return uri;\r\n};\r\n","\nmodule.exports = isBuf;\n\nvar withNativeBuffer = typeof global.Buffer === 'function' && typeof global.Buffer.isBuffer === 'function';\nvar withNativeArrayBuffer = typeof global.ArrayBuffer === 'function';\n\nvar isView = (function () {\n  if (withNativeArrayBuffer && typeof global.ArrayBuffer.isView === 'function') {\n    return global.ArrayBuffer.isView;\n  } else {\n    return function (obj) { return obj.buffer instanceof global.ArrayBuffer; };\n  }\n})();\n\n/**\n * Returns true if obj is a buffer or an arraybuffer.\n *\n * @api private\n */\n\nfunction isBuf(obj) {\n  return (withNativeBuffer && global.Buffer.isBuffer(obj)) ||\n          (withNativeArrayBuffer && (obj instanceof global.ArrayBuffer || isView(obj)));\n}\n","\n/**\n * Module dependencies.\n */\n\nvar eio = require('engine.io-client');\nvar Socket = require('./socket');\nvar Emitter = require('component-emitter');\nvar parser = require('socket.io-parser');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:manager');\nvar indexOf = require('indexof');\nvar Backoff = require('backo2');\n\n/**\n * IE6+ hasOwnProperty\n */\n\nvar has = Object.prototype.hasOwnProperty;\n\n/**\n * Module exports\n */\n\nmodule.exports = Manager;\n\n/**\n * `Manager` constructor.\n *\n * @param {String} engine instance or engine uri/opts\n * @param {Object} options\n * @api public\n */\n\nfunction Manager (uri, opts) {\n  if (!(this instanceof Manager)) return new Manager(uri, opts);\n  if (uri && ('object' === typeof uri)) {\n    opts = uri;\n    uri = undefined;\n  }\n  opts = opts || {};\n\n  opts.path = opts.path || '/socket.io';\n  this.nsps = {};\n  this.subs = [];\n  this.opts = opts;\n  this.reconnection(opts.reconnection !== false);\n  this.reconnectionAttempts(opts.reconnectionAttempts || Infinity);\n  this.reconnectionDelay(opts.reconnectionDelay || 1000);\n  this.reconnectionDelayMax(opts.reconnectionDelayMax || 5000);\n  this.randomizationFactor(opts.randomizationFactor || 0.5);\n  this.backoff = new Backoff({\n    min: this.reconnectionDelay(),\n    max: this.reconnectionDelayMax(),\n    jitter: this.randomizationFactor()\n  });\n  this.timeout(null == opts.timeout ? 20000 : opts.timeout);\n  this.readyState = 'closed';\n  this.uri = uri;\n  this.connecting = [];\n  this.lastPing = null;\n  this.encoding = false;\n  this.packetBuffer = [];\n  var _parser = opts.parser || parser;\n  this.encoder = new _parser.Encoder();\n  this.decoder = new _parser.Decoder();\n  this.autoConnect = opts.autoConnect !== false;\n  if (this.autoConnect) this.open();\n}\n\n/**\n * Propagate given event to sockets and emit on `this`\n *\n * @api private\n */\n\nManager.prototype.emitAll = function () {\n  this.emit.apply(this, arguments);\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].emit.apply(this.nsps[nsp], arguments);\n    }\n  }\n};\n\n/**\n * Update `socket.id` of all sockets\n *\n * @api private\n */\n\nManager.prototype.updateSocketIds = function () {\n  for (var nsp in this.nsps) {\n    if (has.call(this.nsps, nsp)) {\n      this.nsps[nsp].id = this.generateId(nsp);\n    }\n  }\n};\n\n/**\n * generate `socket.id` for the given `nsp`\n *\n * @param {String} nsp\n * @return {String}\n * @api private\n */\n\nManager.prototype.generateId = function (nsp) {\n  return (nsp === '/' ? '' : (nsp + '#')) + this.engine.id;\n};\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Manager.prototype);\n\n/**\n * Sets the `reconnection` config.\n *\n * @param {Boolean} true/false if it should automatically reconnect\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnection = function (v) {\n  if (!arguments.length) return this._reconnection;\n  this._reconnection = !!v;\n  return this;\n};\n\n/**\n * Sets the reconnection attempts config.\n *\n * @param {Number} max reconnection attempts before giving up\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionAttempts = function (v) {\n  if (!arguments.length) return this._reconnectionAttempts;\n  this._reconnectionAttempts = v;\n  return this;\n};\n\n/**\n * Sets the delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelay = function (v) {\n  if (!arguments.length) return this._reconnectionDelay;\n  this._reconnectionDelay = v;\n  this.backoff && this.backoff.setMin(v);\n  return this;\n};\n\nManager.prototype.randomizationFactor = function (v) {\n  if (!arguments.length) return this._randomizationFactor;\n  this._randomizationFactor = v;\n  this.backoff && this.backoff.setJitter(v);\n  return this;\n};\n\n/**\n * Sets the maximum delay between reconnections.\n *\n * @param {Number} delay\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.reconnectionDelayMax = function (v) {\n  if (!arguments.length) return this._reconnectionDelayMax;\n  this._reconnectionDelayMax = v;\n  this.backoff && this.backoff.setMax(v);\n  return this;\n};\n\n/**\n * Sets the connection timeout. `false` to disable\n *\n * @return {Manager} self or value\n * @api public\n */\n\nManager.prototype.timeout = function (v) {\n  if (!arguments.length) return this._timeout;\n  this._timeout = v;\n  return this;\n};\n\n/**\n * Starts trying to reconnect if reconnection is enabled and we have not\n * started reconnecting yet\n *\n * @api private\n */\n\nManager.prototype.maybeReconnectOnOpen = function () {\n  // Only try to reconnect if it's the first time we're connecting\n  if (!this.reconnecting && this._reconnection && this.backoff.attempts === 0) {\n    // keeps reconnection from firing twice for the same reconnection loop\n    this.reconnect();\n  }\n};\n\n/**\n * Sets the current transport `socket`.\n *\n * @param {Function} optional, callback\n * @return {Manager} self\n * @api public\n */\n\nManager.prototype.open =\nManager.prototype.connect = function (fn, opts) {\n  debug('readyState %s', this.readyState);\n  if (~this.readyState.indexOf('open')) return this;\n\n  debug('opening %s', this.uri);\n  this.engine = eio(this.uri, this.opts);\n  var socket = this.engine;\n  var self = this;\n  this.readyState = 'opening';\n  this.skipReconnect = false;\n\n  // emit `open`\n  var openSub = on(socket, 'open', function () {\n    self.onopen();\n    fn && fn();\n  });\n\n  // emit `connect_error`\n  var errorSub = on(socket, 'error', function (data) {\n    debug('connect_error');\n    self.cleanup();\n    self.readyState = 'closed';\n    self.emitAll('connect_error', data);\n    if (fn) {\n      var err = new Error('Connection error');\n      err.data = data;\n      fn(err);\n    } else {\n      // Only do this if there is no fn to handle the error\n      self.maybeReconnectOnOpen();\n    }\n  });\n\n  // emit `connect_timeout`\n  if (false !== this._timeout) {\n    var timeout = this._timeout;\n    debug('connect attempt will timeout after %d', timeout);\n\n    // set timer\n    var timer = setTimeout(function () {\n      debug('connect attempt timed out after %d', timeout);\n      openSub.destroy();\n      socket.close();\n      socket.emit('error', 'timeout');\n      self.emitAll('connect_timeout', timeout);\n    }, timeout);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n\n  this.subs.push(openSub);\n  this.subs.push(errorSub);\n\n  return this;\n};\n\n/**\n * Called upon transport open.\n *\n * @api private\n */\n\nManager.prototype.onopen = function () {\n  debug('open');\n\n  // clear old subs\n  this.cleanup();\n\n  // mark as open\n  this.readyState = 'open';\n  this.emit('open');\n\n  // add new subs\n  var socket = this.engine;\n  this.subs.push(on(socket, 'data', bind(this, 'ondata')));\n  this.subs.push(on(socket, 'ping', bind(this, 'onping')));\n  this.subs.push(on(socket, 'pong', bind(this, 'onpong')));\n  this.subs.push(on(socket, 'error', bind(this, 'onerror')));\n  this.subs.push(on(socket, 'close', bind(this, 'onclose')));\n  this.subs.push(on(this.decoder, 'decoded', bind(this, 'ondecoded')));\n};\n\n/**\n * Called upon a ping.\n *\n * @api private\n */\n\nManager.prototype.onping = function () {\n  this.lastPing = new Date();\n  this.emitAll('ping');\n};\n\n/**\n * Called upon a packet.\n *\n * @api private\n */\n\nManager.prototype.onpong = function () {\n  this.emitAll('pong', new Date() - this.lastPing);\n};\n\n/**\n * Called with data.\n *\n * @api private\n */\n\nManager.prototype.ondata = function (data) {\n  this.decoder.add(data);\n};\n\n/**\n * Called when parser fully decodes a packet.\n *\n * @api private\n */\n\nManager.prototype.ondecoded = function (packet) {\n  this.emit('packet', packet);\n};\n\n/**\n * Called upon socket error.\n *\n * @api private\n */\n\nManager.prototype.onerror = function (err) {\n  debug('error', err);\n  this.emitAll('error', err);\n};\n\n/**\n * Creates a new socket for the given `nsp`.\n *\n * @return {Socket}\n * @api public\n */\n\nManager.prototype.socket = function (nsp, opts) {\n  var socket = this.nsps[nsp];\n  if (!socket) {\n    socket = new Socket(this, nsp, opts);\n    this.nsps[nsp] = socket;\n    var self = this;\n    socket.on('connecting', onConnecting);\n    socket.on('connect', function () {\n      socket.id = self.generateId(nsp);\n    });\n\n    if (this.autoConnect) {\n      // manually call here since connecting event is fired before listening\n      onConnecting();\n    }\n  }\n\n  function onConnecting () {\n    if (!~indexOf(self.connecting, socket)) {\n      self.connecting.push(socket);\n    }\n  }\n\n  return socket;\n};\n\n/**\n * Called upon a socket close.\n *\n * @param {Socket} socket\n */\n\nManager.prototype.destroy = function (socket) {\n  var index = indexOf(this.connecting, socket);\n  if (~index) this.connecting.splice(index, 1);\n  if (this.connecting.length) return;\n\n  this.close();\n};\n\n/**\n * Writes a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nManager.prototype.packet = function (packet) {\n  debug('writing packet %j', packet);\n  var self = this;\n  if (packet.query && packet.type === 0) packet.nsp += '?' + packet.query;\n\n  if (!self.encoding) {\n    // encode, then write to engine with result\n    self.encoding = true;\n    this.encoder.encode(packet, function (encodedPackets) {\n      for (var i = 0; i < encodedPackets.length; i++) {\n        self.engine.write(encodedPackets[i], packet.options);\n      }\n      self.encoding = false;\n      self.processPacketQueue();\n    });\n  } else { // add packet to the queue\n    self.packetBuffer.push(packet);\n  }\n};\n\n/**\n * If packet buffer is non-empty, begins encoding the\n * next packet in line.\n *\n * @api private\n */\n\nManager.prototype.processPacketQueue = function () {\n  if (this.packetBuffer.length > 0 && !this.encoding) {\n    var pack = this.packetBuffer.shift();\n    this.packet(pack);\n  }\n};\n\n/**\n * Clean up transport subscriptions and packet buffer.\n *\n * @api private\n */\n\nManager.prototype.cleanup = function () {\n  debug('cleanup');\n\n  var subsLength = this.subs.length;\n  for (var i = 0; i < subsLength; i++) {\n    var sub = this.subs.shift();\n    sub.destroy();\n  }\n\n  this.packetBuffer = [];\n  this.encoding = false;\n  this.lastPing = null;\n\n  this.decoder.destroy();\n};\n\n/**\n * Close the current socket.\n *\n * @api private\n */\n\nManager.prototype.close =\nManager.prototype.disconnect = function () {\n  debug('disconnect');\n  this.skipReconnect = true;\n  this.reconnecting = false;\n  if ('opening' === this.readyState) {\n    // `onclose` will not fire because\n    // an open event never happened\n    this.cleanup();\n  }\n  this.backoff.reset();\n  this.readyState = 'closed';\n  if (this.engine) this.engine.close();\n};\n\n/**\n * Called upon engine close.\n *\n * @api private\n */\n\nManager.prototype.onclose = function (reason) {\n  debug('onclose');\n\n  this.cleanup();\n  this.backoff.reset();\n  this.readyState = 'closed';\n  this.emit('close', reason);\n\n  if (this._reconnection && !this.skipReconnect) {\n    this.reconnect();\n  }\n};\n\n/**\n * Attempt a reconnection.\n *\n * @api private\n */\n\nManager.prototype.reconnect = function () {\n  if (this.reconnecting || this.skipReconnect) return this;\n\n  var self = this;\n\n  if (this.backoff.attempts >= this._reconnectionAttempts) {\n    debug('reconnect failed');\n    this.backoff.reset();\n    this.emitAll('reconnect_failed');\n    this.reconnecting = false;\n  } else {\n    var delay = this.backoff.duration();\n    debug('will wait %dms before reconnect attempt', delay);\n\n    this.reconnecting = true;\n    var timer = setTimeout(function () {\n      if (self.skipReconnect) return;\n\n      debug('attempting reconnect');\n      self.emitAll('reconnect_attempt', self.backoff.attempts);\n      self.emitAll('reconnecting', self.backoff.attempts);\n\n      // check again for the case socket closed in above events\n      if (self.skipReconnect) return;\n\n      self.open(function (err) {\n        if (err) {\n          debug('reconnect attempt error');\n          self.reconnecting = false;\n          self.reconnect();\n          self.emitAll('reconnect_error', err.data);\n        } else {\n          debug('reconnect success');\n          self.onreconnect();\n        }\n      });\n    }, delay);\n\n    this.subs.push({\n      destroy: function () {\n        clearTimeout(timer);\n      }\n    });\n  }\n};\n\n/**\n * Called upon successful reconnect.\n *\n * @api private\n */\n\nManager.prototype.onreconnect = function () {\n  var attempt = this.backoff.attempts;\n  this.reconnecting = false;\n  this.backoff.reset();\n  this.updateSocketIds();\n  this.emitAll('reconnect', attempt);\n};\n","/**\n * Module dependencies\n */\n\nvar XMLHttpRequest = require('xmlhttprequest-ssl');\nvar XHR = require('./polling-xhr');\nvar JSONP = require('./polling-jsonp');\nvar websocket = require('./websocket');\n\n/**\n * Export transports.\n */\n\nexports.polling = polling;\nexports.websocket = websocket;\n\n/**\n * Polling transport polymorphic constructor.\n * Decides on xhr vs jsonp based on feature detection.\n *\n * @api private\n */\n\nfunction polling (opts) {\n  var xhr;\n  var xd = false;\n  var xs = false;\n  var jsonp = false !== opts.jsonp;\n\n  if (global.location) {\n    var isSSL = 'https:' === location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    xd = opts.hostname !== location.hostname || port !== opts.port;\n    xs = opts.secure !== isSSL;\n  }\n\n  opts.xdomain = xd;\n  opts.xscheme = xs;\n  xhr = new XMLHttpRequest(opts);\n\n  if ('open' in xhr && !opts.forceJSONP) {\n    return new XHR(opts);\n  } else {\n    if (!jsonp) throw new Error('JSONP disabled');\n    return new JSONP(opts);\n  }\n}\n","/**\n * Module dependencies.\n */\n\nvar Transport = require('../transport');\nvar parseqs = require('parseqs');\nvar parser = require('engine.io-parser');\nvar inherit = require('component-inherit');\nvar yeast = require('yeast');\nvar debug = require('debug')('engine.io-client:polling');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Polling;\n\n/**\n * Is XHR2 supported?\n */\n\nvar hasXHR2 = (function () {\n  var XMLHttpRequest = require('xmlhttprequest-ssl');\n  var xhr = new XMLHttpRequest({ xdomain: false });\n  return null != xhr.responseType;\n})();\n\n/**\n * Polling interface.\n *\n * @param {Object} opts\n * @api private\n */\n\nfunction Polling (opts) {\n  var forceBase64 = (opts && opts.forceBase64);\n  if (!hasXHR2 || forceBase64) {\n    this.supportsBinary = false;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(Polling, Transport);\n\n/**\n * Transport name.\n */\n\nPolling.prototype.name = 'polling';\n\n/**\n * Opens the socket (triggers polling). We write a PING message to determine\n * when the transport is open.\n *\n * @api private\n */\n\nPolling.prototype.doOpen = function () {\n  this.poll();\n};\n\n/**\n * Pauses polling.\n *\n * @param {Function} callback upon buffers are flushed and transport is paused\n * @api private\n */\n\nPolling.prototype.pause = function (onPause) {\n  var self = this;\n\n  this.readyState = 'pausing';\n\n  function pause () {\n    debug('paused');\n    self.readyState = 'paused';\n    onPause();\n  }\n\n  if (this.polling || !this.writable) {\n    var total = 0;\n\n    if (this.polling) {\n      debug('we are currently polling - waiting to pause');\n      total++;\n      this.once('pollComplete', function () {\n        debug('pre-pause polling complete');\n        --total || pause();\n      });\n    }\n\n    if (!this.writable) {\n      debug('we are currently writing - waiting to pause');\n      total++;\n      this.once('drain', function () {\n        debug('pre-pause writing complete');\n        --total || pause();\n      });\n    }\n  } else {\n    pause();\n  }\n};\n\n/**\n * Starts polling cycle.\n *\n * @api public\n */\n\nPolling.prototype.poll = function () {\n  debug('polling');\n  this.polling = true;\n  this.doPoll();\n  this.emit('poll');\n};\n\n/**\n * Overloads onData to detect payloads.\n *\n * @api private\n */\n\nPolling.prototype.onData = function (data) {\n  var self = this;\n  debug('polling got data %s', data);\n  var callback = function (packet, index, total) {\n    // if its the first message we consider the transport open\n    if ('opening' === self.readyState) {\n      self.onOpen();\n    }\n\n    // if its a close packet, we close the ongoing requests\n    if ('close' === packet.type) {\n      self.onClose();\n      return false;\n    }\n\n    // otherwise bypass onData and handle the message\n    self.onPacket(packet);\n  };\n\n  // decode payload\n  parser.decodePayload(data, this.socket.binaryType, callback);\n\n  // if an event did not trigger closing\n  if ('closed' !== this.readyState) {\n    // if we got data we're not polling\n    this.polling = false;\n    this.emit('pollComplete');\n\n    if ('open' === this.readyState) {\n      this.poll();\n    } else {\n      debug('ignoring poll - transport state \"%s\"', this.readyState);\n    }\n  }\n};\n\n/**\n * For polling, send a close packet.\n *\n * @api private\n */\n\nPolling.prototype.doClose = function () {\n  var self = this;\n\n  function close () {\n    debug('writing close packet');\n    self.write([{ type: 'close' }]);\n  }\n\n  if ('open' === this.readyState) {\n    debug('transport open - closing');\n    close();\n  } else {\n    // in case we're trying to close while\n    // handshaking is in progress (GH-164)\n    debug('transport not open - deferring close');\n    this.once('open', close);\n  }\n};\n\n/**\n * Writes a packets payload.\n *\n * @param {Array} data packets\n * @param {Function} drain callback\n * @api private\n */\n\nPolling.prototype.write = function (packets) {\n  var self = this;\n  this.writable = false;\n  var callbackfn = function () {\n    self.writable = true;\n    self.emit('drain');\n  };\n\n  parser.encodePayload(packets, this.supportsBinary, function (data) {\n    self.doWrite(data, callbackfn);\n  });\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nPolling.prototype.uri = function () {\n  var query = this.query || {};\n  var schema = this.secure ? 'https' : 'http';\n  var port = '';\n\n  // cache busting is forced\n  if (false !== this.timestampRequests) {\n    query[this.timestampParam] = yeast();\n  }\n\n  if (!this.supportsBinary && !query.sid) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // avoid port if default for schema\n  if (this.port && (('https' === schema && Number(this.port) !== 443) ||\n     ('http' === schema && Number(this.port) !== 80))) {\n    port = ':' + this.port;\n  }\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  var ipv6 = this.hostname.indexOf(':') !== -1;\n  return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;\n};\n","/* global Blob File */\n\n/*\n * Module requirements.\n */\n\nvar isArray = require('isarray');\n\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof Blob === 'function' ||\n                        typeof Blob !== 'undefined' && toString.call(Blob) === '[object BlobConstructor]';\nvar withNativeFile = typeof File === 'function' ||\n                        typeof File !== 'undefined' && toString.call(File) === '[object FileConstructor]';\n\n/**\n * Module exports.\n */\n\nmodule.exports = hasBinary;\n\n/**\n * Checks for binary data.\n *\n * Supports Buffer, ArrayBuffer, Blob and File.\n *\n * @param {Object} anything\n * @api public\n */\n\nfunction hasBinary (obj) {\n  if (!obj || typeof obj !== 'object') {\n    return false;\n  }\n\n  if (isArray(obj)) {\n    for (var i = 0, l = obj.length; i < l; i++) {\n      if (hasBinary(obj[i])) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  if ((typeof Buffer === 'function' && Buffer.isBuffer && Buffer.isBuffer(obj)) ||\n    (typeof ArrayBuffer === 'function' && obj instanceof ArrayBuffer) ||\n    (withNativeBlob && obj instanceof Blob) ||\n    (withNativeFile && obj instanceof File)\n  ) {\n    return true;\n  }\n\n  // see: https://github.com/Automattic/has-binary/pull/4\n  if (obj.toJSON && typeof obj.toJSON === 'function' && arguments.length === 1) {\n    return hasBinary(obj.toJSON(), true);\n  }\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key) && hasBinary(obj[key])) {\n      return true;\n    }\n  }\n\n  return false;\n}\n","'use strict';\n\nvar alphabet = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_'.split('')\n  , length = 64\n  , map = {}\n  , seed = 0\n  , i = 0\n  , prev;\n\n/**\n * Return a string representing the specified number.\n *\n * @param {Number} num The number to convert.\n * @returns {String} The string representation of the number.\n * @api public\n */\nfunction encode(num) {\n  var encoded = '';\n\n  do {\n    encoded = alphabet[num % length] + encoded;\n    num = Math.floor(num / length);\n  } while (num > 0);\n\n  return encoded;\n}\n\n/**\n * Return the integer value specified by the given string.\n *\n * @param {String} str The string to convert.\n * @returns {Number} The integer value represented by the string.\n * @api public\n */\nfunction decode(str) {\n  var decoded = 0;\n\n  for (i = 0; i < str.length; i++) {\n    decoded = decoded * length + map[str.charAt(i)];\n  }\n\n  return decoded;\n}\n\n/**\n * Yeast: A tiny growing id generator.\n *\n * @returns {String} A unique id.\n * @api public\n */\nfunction yeast() {\n  var now = encode(+new Date());\n\n  if (now !== prev) return seed = 0, prev = now;\n  return now +'.'+ encode(seed++);\n}\n\n//\n// Map each character to its index.\n//\nfor (; i < length; i++) map[alphabet[i]] = i;\n\n//\n// Expose the `yeast`, `encode` and `decode` functions.\n//\nyeast.encode = encode;\nyeast.decode = decode;\nmodule.exports = yeast;\n","\nvar indexOf = [].indexOf;\n\nmodule.exports = function(arr, obj){\n  if (indexOf) return arr.indexOf(obj);\n  for (var i = 0; i < arr.length; ++i) {\n    if (arr[i] === obj) return i;\n  }\n  return -1;\n};","\n/**\n * Module dependencies.\n */\n\nvar parser = require('socket.io-parser');\nvar Emitter = require('component-emitter');\nvar toArray = require('to-array');\nvar on = require('./on');\nvar bind = require('component-bind');\nvar debug = require('debug')('socket.io-client:socket');\nvar parseqs = require('parseqs');\nvar hasBin = require('has-binary2');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = Socket;\n\n/**\n * Internal events (blacklisted).\n * These events can't be emitted by the user.\n *\n * @api private\n */\n\nvar events = {\n  connect: 1,\n  connect_error: 1,\n  connect_timeout: 1,\n  connecting: 1,\n  disconnect: 1,\n  error: 1,\n  reconnect: 1,\n  reconnect_attempt: 1,\n  reconnect_failed: 1,\n  reconnect_error: 1,\n  reconnecting: 1,\n  ping: 1,\n  pong: 1\n};\n\n/**\n * Shortcut to `Emitter#emit`.\n */\n\nvar emit = Emitter.prototype.emit;\n\n/**\n * `Socket` constructor.\n *\n * @api public\n */\n\nfunction Socket (io, nsp, opts) {\n  this.io = io;\n  this.nsp = nsp;\n  this.json = this; // compat\n  this.ids = 0;\n  this.acks = {};\n  this.receiveBuffer = [];\n  this.sendBuffer = [];\n  this.connected = false;\n  this.disconnected = true;\n  this.flags = {};\n  if (opts && opts.query) {\n    this.query = opts.query;\n  }\n  if (this.io.autoConnect) this.open();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Subscribe to open, close and packet events\n *\n * @api private\n */\n\nSocket.prototype.subEvents = function () {\n  if (this.subs) return;\n\n  var io = this.io;\n  this.subs = [\n    on(io, 'open', bind(this, 'onopen')),\n    on(io, 'packet', bind(this, 'onpacket')),\n    on(io, 'close', bind(this, 'onclose'))\n  ];\n};\n\n/**\n * \"Opens\" the socket.\n *\n * @api public\n */\n\nSocket.prototype.open =\nSocket.prototype.connect = function () {\n  if (this.connected) return this;\n\n  this.subEvents();\n  this.io.open(); // ensure open\n  if ('open' === this.io.readyState) this.onopen();\n  this.emit('connecting');\n  return this;\n};\n\n/**\n * Sends a `message` event.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.send = function () {\n  var args = toArray(arguments);\n  args.unshift('message');\n  this.emit.apply(this, args);\n  return this;\n};\n\n/**\n * Override `emit`.\n * If the event is in `events`, it's emitted normally.\n *\n * @param {String} event name\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.emit = function (ev) {\n  if (events.hasOwnProperty(ev)) {\n    emit.apply(this, arguments);\n    return this;\n  }\n\n  var args = toArray(arguments);\n  var packet = {\n    type: (this.flags.binary !== undefined ? this.flags.binary : hasBin(args)) ? parser.BINARY_EVENT : parser.EVENT,\n    data: args\n  };\n\n  packet.options = {};\n  packet.options.compress = !this.flags || false !== this.flags.compress;\n\n  // event ack callback\n  if ('function' === typeof args[args.length - 1]) {\n    debug('emitting packet with ack id %d', this.ids);\n    this.acks[this.ids] = args.pop();\n    packet.id = this.ids++;\n  }\n\n  if (this.connected) {\n    this.packet(packet);\n  } else {\n    this.sendBuffer.push(packet);\n  }\n\n  this.flags = {};\n\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.packet = function (packet) {\n  packet.nsp = this.nsp;\n  this.io.packet(packet);\n};\n\n/**\n * Called upon engine `open`.\n *\n * @api private\n */\n\nSocket.prototype.onopen = function () {\n  debug('transport is open - connecting');\n\n  // write connect packet if necessary\n  if ('/' !== this.nsp) {\n    if (this.query) {\n      var query = typeof this.query === 'object' ? parseqs.encode(this.query) : this.query;\n      debug('sending connect packet with query %s', query);\n      this.packet({type: parser.CONNECT, query: query});\n    } else {\n      this.packet({type: parser.CONNECT});\n    }\n  }\n};\n\n/**\n * Called upon engine `close`.\n *\n * @param {String} reason\n * @api private\n */\n\nSocket.prototype.onclose = function (reason) {\n  debug('close (%s)', reason);\n  this.connected = false;\n  this.disconnected = true;\n  delete this.id;\n  this.emit('disconnect', reason);\n};\n\n/**\n * Called with socket packet.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onpacket = function (packet) {\n  var sameNamespace = packet.nsp === this.nsp;\n  var rootNamespaceError = packet.type === parser.ERROR && packet.nsp === '/';\n\n  if (!sameNamespace && !rootNamespaceError) return;\n\n  switch (packet.type) {\n    case parser.CONNECT:\n      this.onconnect();\n      break;\n\n    case parser.EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.BINARY_EVENT:\n      this.onevent(packet);\n      break;\n\n    case parser.ACK:\n      this.onack(packet);\n      break;\n\n    case parser.BINARY_ACK:\n      this.onack(packet);\n      break;\n\n    case parser.DISCONNECT:\n      this.ondisconnect();\n      break;\n\n    case parser.ERROR:\n      this.emit('error', packet.data);\n      break;\n  }\n};\n\n/**\n * Called upon a server event.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onevent = function (packet) {\n  var args = packet.data || [];\n  debug('emitting event %j', args);\n\n  if (null != packet.id) {\n    debug('attaching ack callback to event');\n    args.push(this.ack(packet.id));\n  }\n\n  if (this.connected) {\n    emit.apply(this, args);\n  } else {\n    this.receiveBuffer.push(args);\n  }\n};\n\n/**\n * Produces an ack callback to emit with an event.\n *\n * @api private\n */\n\nSocket.prototype.ack = function (id) {\n  var self = this;\n  var sent = false;\n  return function () {\n    // prevent double callbacks\n    if (sent) return;\n    sent = true;\n    var args = toArray(arguments);\n    debug('sending ack %j', args);\n\n    self.packet({\n      type: hasBin(args) ? parser.BINARY_ACK : parser.ACK,\n      id: id,\n      data: args\n    });\n  };\n};\n\n/**\n * Called upon a server acknowlegement.\n *\n * @param {Object} packet\n * @api private\n */\n\nSocket.prototype.onack = function (packet) {\n  var ack = this.acks[packet.id];\n  if ('function' === typeof ack) {\n    debug('calling ack %s with %j', packet.id, packet.data);\n    ack.apply(this, packet.data);\n    delete this.acks[packet.id];\n  } else {\n    debug('bad ack %s', packet.id);\n  }\n};\n\n/**\n * Called upon server connect.\n *\n * @api private\n */\n\nSocket.prototype.onconnect = function () {\n  this.connected = true;\n  this.disconnected = false;\n  this.emit('connect');\n  this.emitBuffered();\n};\n\n/**\n * Emit buffered events (received and emitted).\n *\n * @api private\n */\n\nSocket.prototype.emitBuffered = function () {\n  var i;\n  for (i = 0; i < this.receiveBuffer.length; i++) {\n    emit.apply(this, this.receiveBuffer[i]);\n  }\n  this.receiveBuffer = [];\n\n  for (i = 0; i < this.sendBuffer.length; i++) {\n    this.packet(this.sendBuffer[i]);\n  }\n  this.sendBuffer = [];\n};\n\n/**\n * Called upon server disconnect.\n *\n * @api private\n */\n\nSocket.prototype.ondisconnect = function () {\n  debug('server disconnect (%s)', this.nsp);\n  this.destroy();\n  this.onclose('io server disconnect');\n};\n\n/**\n * Called upon forced client/server side disconnections,\n * this method ensures the manager stops tracking us and\n * that reconnections don't get triggered for this.\n *\n * @api private.\n */\n\nSocket.prototype.destroy = function () {\n  if (this.subs) {\n    // clean subscriptions to avoid reconnections\n    for (var i = 0; i < this.subs.length; i++) {\n      this.subs[i].destroy();\n    }\n    this.subs = null;\n  }\n\n  this.io.destroy(this);\n};\n\n/**\n * Disconnects the socket manually.\n *\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.close =\nSocket.prototype.disconnect = function () {\n  if (this.connected) {\n    debug('performing disconnect (%s)', this.nsp);\n    this.packet({ type: parser.DISCONNECT });\n  }\n\n  // remove socket from pool\n  this.destroy();\n\n  if (this.connected) {\n    // fire events\n    this.onclose('io client disconnect');\n  }\n  return this;\n};\n\n/**\n * Sets the compress flag.\n *\n * @param {Boolean} if `true`, compresses the sending data\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.compress = function (compress) {\n  this.flags.compress = compress;\n  return this;\n};\n\n/**\n * Sets the binary flag\n *\n * @param {Boolean} whether the emitted data contains binary\n * @return {Socket} self\n * @api public\n */\n\nSocket.prototype.binary = function (binary) {\n  this.flags.binary = binary;\n  return this;\n};\n","\n/**\n * Module exports.\n */\n\nmodule.exports = on;\n\n/**\n * Helper for subscriptions.\n *\n * @param {Object|EventEmitter} obj with `Emitter` mixin or `EventEmitter`\n * @param {String} event name\n * @param {Function} callback\n * @api public\n */\n\nfunction on (obj, ev, fn) {\n  obj.on(ev, fn);\n  return {\n    destroy: function () {\n      obj.removeListener(ev, fn);\n    }\n  };\n}\n","/**\n * Slice reference.\n */\n\nvar slice = [].slice;\n\n/**\n * Bind `obj` to `fn`.\n *\n * @param {Object} obj\n * @param {Function|String} fn or string\n * @return {Function}\n * @api public\n */\n\nmodule.exports = function(obj, fn){\n  if ('string' == typeof fn) fn = obj[fn];\n  if ('function' != typeof fn) throw new Error('bind() requires a function');\n  var args = slice.call(arguments, 2);\n  return function(){\n    return fn.apply(obj, args.concat(slice.call(arguments)));\n  }\n};\n","const {Socket} = require('../lib/socket/socket');\nconst {ab2str, str2ab, make4Len16, readString} = require('../lib/base/util');\nconst DummySocket = require('../lib/socket/dummysocket');\n\nvar Adb = {};\n\nAdb.sendHostCommand = function(command, cb) {\n  Socket.connect({host: '127.0.0.1', port: 5037}, function(socket) {\n    if (!socket) {\n      cb();\n      return;\n    }\n    var hostCommand = command;\n    command = make4Len16(command.length) + command;\n\n    socket.read(4, function(ok) {\n      var result = ab2str(ok);\n      if (result != 'OKAY') {\n        console.error('error in response to adb host command', hostCommand, result)\n        socket.destroy();\n        cb();\n        return;\n      }\n\n      socket.read(4, function(len) {\n        var lenStr = ab2str(len);\n        len = parseInt(lenStr, 16);\n        if (len == 0 || lenStr == 'OKAY') {\n          cb(socket, new ArrayBuffer(0));\n          return;\n        }\n        socket.read(len, function(data) {\n          cb(socket, data);\n        });\n      })\n    })\n\n    socket.write(str2ab(command), function() {})\n  });\n}\n\nAdb.devices = function(cb) {\n  var adbDevices = {};\n  function parseConnectionPayload(payload) {\n    var rawPayload = payload;\n    payload = payload.replace('\\t', ' ');\n    var i = payload.indexOf(' ');\n    if (i == -1)\n      return;\n\n    var serialno = payload.substring(0, i);\n\n    payload = payload.substring(i).trim();\n    var newPayload;\n    while (newPayload != payload) {\n      newPayload = payload;\n      payload = payload.replace('  ', ' ');\n    }\n\n    var values = {};\n    var firstSpace = payload.indexOf(' ');\n    if (firstSpace == -1)\n      firstSpace = payload.length\n    var status = payload.substring(0, firstSpace);\n    payload = payload.substring(firstSpace + 1);\n    while (payload.length) {\n      i = payload.indexOf(':');\n      if (i == -1)\n        break;\n      var key = payload.substring(0, i);\n      var rest = payload.substring(i + 1);\n      var nextSpace = rest.indexOf(' ');\n      var nextColon = rest.indexOf(':');\n      var value;\n      if (nextSpace == -1 || nextColon == -1) {\n        value = rest;\n        payload = '';\n      }\n      else {\n        while (nextSpace != -1 && nextSpace < nextColon) {\n          value = rest.substring(0, nextSpace);\n          payload = rest.substring(nextSpace + 1);\n          nextSpace = rest.indexOf(' ', nextSpace + 1);\n        }\n      }\n      values[key] = value;\n    }\n\n    // filter?\n    var name;\n    if (!values['model'])\n      name = serialno;\n    else\n      name = values['model'].replace('_', ' ');\n\n    adbDevices[serialno] = {\n      serialno: serialno,\n      name: name,\n      status: status,\n      properties: rawPayload\n    }\n  }\n\n  Adb.sendHostCommand('host:devices-l', function(socket, data) {\n    if (!socket) {\n      cb();\n      return;\n    }\n    socket.destroy();\n    data = ab2str(data);\n    console.log('ADB devices:', data);\n    // console.log(data);\n    data = data.trim();\n    var lines = data.split('\\n');\n    for (var line in lines) {\n      line = lines[line];\n      parseConnectionPayload(line);\n    }\n    console.log('parsed ADB devices:', adbDevices);\n    cb(adbDevices);\n  });\n}\n\nAdb.killServer = function(cb) {\n  Adb.sendHostCommand('host:kill-server', function(socket, data) {\n    if (!socket) {\n      cb();\n      return;\n    }\n    socket.destroy();\n    data = ab2str(data);\n    // console.log(data);\n    if (cb)\n      cb();\n  });\n}\n\nAdb.sendClientCommand = function(options, cb) {\n  var command = options.command;\n  var serialno = options.serialno;\n\n  Socket.connect({host: '127.0.0.1', port: 5037}, function(socket) {\n    if (!socket) {\n      cb();\n      return;\n    }\n    socket.read(4, function(data) {\n      var result = ab2str(data);\n      if (result != 'OKAY') {\n        socket.destroy();\n        cb(null);\n        return;\n      }\n\n      var clientCommand = command;\n      clientCommand = make4Len16(clientCommand.length) + clientCommand;\n      socket.read(4, function(data) {\n        var result = ab2str(data);\n        if (result != 'OKAY') {\n          socket.destroy();\n          cb(null);\n          return;\n        }\n        cb(socket);\n      });\n\n      socket.write(str2ab(clientCommand), function() {});\n    })\n\n    var hostCommand = 'host:transport:' + serialno;\n    hostCommand = make4Len16(hostCommand.length) + hostCommand;\n    socket.write(str2ab(hostCommand), function() {})\n  });\n}\n\nAdb.shell = function(options, cb) {\n  var command = options.command;\n  var serialno = options.serialno;\n\n  Adb.getOrCreateSockFactory(options).newSocket('shell:' + command,\n  function(socket) {\n    if (!socket) {\n      cb();\n      return;\n    }\n    readString(socket, function(str) {\n      cb(str);\n    });\n  });\n}\n\n\nAdb.forward = function(options, cb) {\n  // host:forward:tcp:5000;tcp:5000\n  var command = 'host-serial:' + options.serialno + ':forward:' + options.from + ';' + options.to;\n  Adb.sendHostCommand(command, function(socket, err) {\n    if (socket)\n      socket.destroy();\n    cb(socket, err);\n  })\n}\n\n\nAdb.reverse = function(options, cb) {\n  // host:forward:tcp:5000;tcp:5000\n  var command = 'reverse:forward:' + options.from + ';' + options.to;\n  Adb.sendClientCommand({\n    serialno: options.serialno,\n    command: command\n  }, function(socket, err) {\n    if (socket)\n      readString(socket, cb);\n    else \n      cb();\n  })\n}\n\n\nfunction AdbSync() {\n}\nAdbSync.MKID = function(a,b,c,d) { return  ((a.charCodeAt(0)) | ((b.charCodeAt(0)) << 8) | ((c.charCodeAt(0)) << 16) | ((d.charCodeAt(0)) << 24)) }\nAdbSync.ID_RECV = AdbSync.MKID('R','E','C','V')\nAdbSync.ID_SEND = AdbSync.MKID('S','E','N','D')\nAdbSync.ID_DONE = AdbSync.MKID('D','O','N','E')\nAdbSync.ID_DATA = AdbSync.MKID('D','A','T','A')\nAdbSync.DATA_MAX = 64 * 1024;\n\nAdb.pull = function(options, cb) {\n  var file = options.file;\n  var serialno = options.serialno;\n  var fileEntry = options.fileEntry;\n  var output = options.socket;\n\n  if (!output) {\n    (function() {\n      var fileWriter;\n\n      output = {\n        write: function(data, cb) {\n          if (!fileWriter) {\n              fileEntry.createWriter(function(fw) {\n                fileWriter = fw;\n                output.write(data, cb);\n              });\n              return;\n          }\n          fileWriter.onwriteend = cb;\n          fileWriter.write(new Blob([data]));\n        }\n      }\n    })();\n  }\n\n  var dummy = new DummySocket();\n  Socket.pump(dummy, output, function() {\n    cb(fileEntry);\n  });\n\n  Adb.getOrCreateSockFactory(options).newSocket('sync:',\n  function(socket) {\n    if (!socket) {\n      cb();\n      return;\n    }\n\n    function readChunk(len) {\n      socket.read(len, function(data) {\n        dummy.dataReceived(data);\n        readHeader();\n      })\n    }\n\n    function readHeader() {\n      socket.read(8, function(data) {\n        var view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n        var id = view.getUint32(0, true);\n        if (id == AdbSync.ID_DATA) {\n          var len = view.getUint32(4, true);\n          readChunk(len);\n          return;\n        }\n        socket.destroy();\n        if (id == AdbSync.ID_DONE) {\n          dummy.dataReceived(null);\n          return;\n        }\n        cb();\n      })\n    }\n\n    var msg = new ArrayBuffer(8);\n    var msgView = new DataView(msg);\n    msgView.setUint32(0, AdbSync.ID_RECV, true);\n    msgView.setUint32(4, file.length, true);\n\n    socket.write(msg, function() {\n      socket.write(str2ab(file), function() {\n        readHeader();\n      })\n    });\n  })\n}\n\nAdb.createSocketFactory = function(serialno) {\n  return {\n    newSocket: function(command, cb) {\n      Adb.sendClientCommand({\n        serialno: serialno,\n        command: command\n      },\n      cb);\n    }\n  };\n}\n\nAdb.getOrCreateSockFactory = function(opts) {\n  return opts.socketFactory || Adb.createSocketFactory(opts.serialno);\n}\n\nAdb.push = function(options, cb) {\n  var file = options.file;\n  var serialno = options.serialno;\n  var fileSocket = options.socket;\n\n  Adb.getOrCreateSockFactory(options).newSocket('sync:',\n  function(socket) {\n    if (!socket) {\n      cb();\n      return;\n    }\n\n    var msg = new ArrayBuffer(8);\n    var msgView = new DataView(msg);\n    var fileAndMode = file + ',0644';\n    msgView.setUint32(0, AdbSync.ID_SEND, true);\n    msgView.setUint32(4, fileAndMode.length, true);\n\n    socket.write(msg, function() {\n      socket.write(str2ab(fileAndMode), function() {\n        var done;\n        var writing = true;\n        fileSocket.onClose = function() {\n          var msg = new ArrayBuffer(8);\n          var msgView = new DataView(msg);\n          msgView.setUint32(0, AdbSync.ID_DONE, true);\n          msgView.setUint32(4, 0, true);\n          socket.write(msg, function() {\n            // socket.destroy();\n            // read back ID_OKAY\n            socket.read(8, function() {\n              cb();\n            })\n          });\n        }\n\n        function readChunk() {\n          fileSocket.read(function(data) {\n            if (data.byteLength > AdbSync.DATA_MAX) {\n              var extra = data.subarray(AdbSync.DATA_MAX);\n              data = data.subarray(0, AdbSync.DATA_MAX);\n              fileSocket.unshift(extra);\n            }\n            writeChunk(data);\n          })\n        }\n\n        function writeChunk(data) {\n          var msg = new ArrayBuffer(8);\n          var msgView = new DataView(msg);\n          msgView.setUint32(0, AdbSync.ID_DATA, true)\n          msgView.setUint32(4, data.byteLength, true)\n          socket.write(msg, function() {\n            var buffer = data.buffer;\n            if (data.byteOffset || data.length != buffer.byteLength) {\n              buffer = buffer.slice(data.byteOffset, data.byteOffset + data.byteLength);\n            }\n            socket.write(buffer, function() {\n              readChunk();\n            })\n          })\n        }\n\n        readChunk();\n      })\n    });\n  })\n}\n\nmodule.exports = Adb;\n","{\n  let rtc = (window.RTCSessionDescription || window.webkitRTCSessionDescription) ? window : __non_webpack_require__('wrtc');\n  var RTCSessionDescription = rtc.RTCSessionDescription || rtc.webkitRTCSessionDescription;\n  var RTCPeerConnection = rtc.RTCPeerConnection || rtc.webkitRTCPeerConnection;\n  var RTCIceCandidate = rtc.RTCIceCandidate || rtc.webkitRTCIceCandidate;\n}\n\nvar Socket = require('./socket').Socket;\nvar fetch = require('node-fetch')\nvar {str2ab, ab2str, isNode} = require('../base/util');\n\nfunction throttleTimeout(token, item, throttle, cb, immediate) {\n  if (!token)\n    token = { items:[] };\n  token.items.push(item);\n  if (!token.timeout) {\n    function onTimeout() {\n      delete token.timeout;\n      cb(token.items);\n      token.items = [];\n    }\n    if (immediate)\n      onTimeout(token.items);\n    token.timeout = setTimeout(onTimeout, throttle);\n  }\n  return token;\n}\n\nfunction GcmRtcSocket(conn, dc) {\n  this.conn = conn;\n  this.dc = dc;\n  this.gotEof = false;\n  dc.onmessage = function(message) {\n    var ui = new Uint8Array(message.data);\n    var eof = ui[ui.byteLength - 1] == 1;\n    this.dataReceived(ui.subarray(0, ui.byteLength - 1));\n    if (eof) {\n      this.gotEof = true;\n      this.destroy();\n    }\n    // console.log(ab2str(message.data));\n  }.bind(this);\n\n  dc.onclose = dc.onerror = this.destroy.bind(this);\n\n  try {\n    this.needsBufferShim = isNode() || parseInt(/Chrome\\/(\\d\\d)/.exec(navigator.userAgent)[1]) < 70;\n  }\n  catch (ignored) {\n  }\n\n  if (!this.needsBufferShim) {\n    dc.bufferedAmountLowThreshold = 0;\n    dc.onbufferedamountlow = this.writeable.bind(this);\n  }\n}\nGcmRtcSocket.prototype.buffered = Socket.prototype.buffered;\nGcmRtcSocket.prototype.unshift = Socket.prototype.unshift;\nGcmRtcSocket.prototype.dataReceived = Socket.prototype.dataReceived;\nGcmRtcSocket.prototype.read = Socket.prototype.read;\nGcmRtcSocket.prototype.pause = Socket.prototype.pause;\nGcmRtcSocket.prototype.resume = Socket.prototype.resume;\nGcmRtcSocket.prototype.buffered = Socket.prototype.buffered;\nGcmRtcSocket.prototype.writeable = function() {\n  var cb = this.writeCallback;\n  if (cb) {\n    delete this.writeCallback;\n    cb();\n  }\n}\nGcmRtcSocket.prototype.write = function(data, cb) {\n  if (!this.dc || this.dc.readyState != 'open') {\n    this.destroy();\n    return;\n  }\n\n  // this method currently works by sheer luck because adb protocol chunks everything\n  // to some max packet size which is under 16k. packets over 16k seem to be hit or miss\n  // with webrtc data channels.\n\n  this.writeCallback = cb;\n  var packet = new Uint8Array(data.byteLength + 1);\n  packet.set(new Uint8Array(data));\n  this.dc.send(packet.buffer);\n  if (this.reentrantWrite)\n    return;\n  try {\n    this.reentrantWrite = true;\n    while (this.writeCallback && (this.dc.bufferedAmount == 0 || this.needsBufferShim)) {\n      this.writeable();\n    }\n    if (this.writeCallback)\n      console.log('waiting for writable');\n  }\n  finally {\n    this.reentrantWrite = false;\n  }\n}\nGcmRtcSocket.prototype.destroy = function() {\n  this.dataReceived(null);\n\n  // console.log('dc destroy', this.dc.label);\n  if (this.dc == null)\n    return;\n\n  var dc = this.dc;\n  this.dc = null;\n  dc.onclose = null;\n  dc.onerror = null;\n  if (dc.readyState == 'open') {\n    try {\n      // send EOF signal\n      // this may fail if entire GCM Connection is being torn down or data channel died due to error\n      dc.send(new Uint8Array([1]));\n\n      // recycle\n      if (this.gotEof)\n        this.conn.recycleChannel(dc);\n      else\n        this.conn.waitForEof(dc);\n    }\n    catch (e) {\n      // eat the potential send error, don't recycle\n    }\n  }\n}\n\n\nfunction GcmRtcConnection(manager, pc, key) {\n  this.manager = manager;\n  this.peerConnection = pc;\n  this.key = key;\n\n  this.peerConnection.oniceconnectionstatechange = function() {\n    // this will allow shutdown of the app engine persistent connection once\n    // the peer to peer connection has been established\n    // UPDATE we don't use app engine connections anymore, and this seems to cause listen double peer connection creation bugs\n    // if (this.peerConnection.iceConnectionState != 'new' && this.peerConnection.iceConnectionState != 'checking') {\n    //   delete manager.gcmRtcConnections[key];\n    // }\n\n    // console.log('pc', this.peerConnection.iceConnectionState)\n    // connection dead, cleanup\n    if (this.peerConnection.iceConnectionState == 'disconnected' || this.peerConnection.iceConnectionState == 'closed' || this.peerConnection.iceConnectionState == 'failed') {\n      this.destroy();\n    }\n  }.bind(this);\n}\nGcmRtcConnection.prototype.waitForCommand = function(dc) {\n  dc.onmessage = function(message) {\n    // watch for dangling eof\n    if (message.data.byteLength == 1)\n      return;\n    this.removeChannel(dc);\n    var command = ab2str(message.data);\n    var socket = new GcmRtcSocket(this, dc);\n    this.openSocket(command, socket)\n  }.bind(this);\n}\nGcmRtcConnection.prototype.compactChannels = function() {\n  if (this.inboundChannels && !this.inboundChannels.length)\n    this.inboundChannels = null;\n  if (this.outboundChannels && !this.outboundChannels.length)\n    this.outboundChannels = null;\n}\nGcmRtcConnection.prototype.getAppropriateChannels = function(dc, create) {\n  // it's possible to have a race condition where both sides of this connection\n  // try to use a recycled datachannel at the same time, thus causing a race condition.\n  // so maintain inbound/outbound channel lists.\n  // only outbound channels can be used to initiate an outgoing connection, and that's\n  // the list they are created in and get recycled into.\n  var channels;\n  if (dc.inbound) {\n    if (!this.inboundChannels && create)\n      this.inboundChannels = []\n    channels = this.inboundChannels;\n  }\n  else {\n    if (!this.outboundChannels && create)\n      this.outboundChannels = []\n    channels = this.outboundChannels;\n  }\n  return channels\n}\nGcmRtcConnection.prototype.removeChannel = function(dc) {i\n  channels = this.getAppropriateChannels(dc);\n  if (!channels)\n    return;\n  var i = channels.indexOf(dc);\n  if (i == -1)\n    return;\n  channels.splice(i, 1);\n  this.compactChannels();\n}\nGcmRtcConnection.prototype.waitForEof = function(dc) {\n  dc.onmessage = function(message) {\n    var ui = new Uint8Array(message.data);\n    var eof = ui[ui.byteLength - 1] == 1;\n    if (eof)\n      this.recycleChannel(dc);\n  }.bind(this);\n}\nGcmRtcConnection.prototype.recycleChannel = function(dc) {\n  var channels = this.getAppropriateChannels(dc, true);\n  channels.push(dc);\n  dc.onclose = dc.onerror = function() {\n    this.removeChannel(dc);\n  }.bind(this);\n  this.waitForCommand(dc);\n}\nGcmRtcConnection.prototype.addCandidates = function(message) {\n  for (var candidate in message.candidates) {\n    console.log('remote candidate', message.candidates[candidate]);\n    this.peerConnection.addIceCandidate(new RTCIceCandidate(message.candidates[candidate]));\n  }\n}\nGcmRtcConnection.prototype.setupPinger = function(pinger) {\n  var timeout;\n  function ping() {\n    pinger.send(str2ab('ping'));\n    timeout = setTimeout(ping, 1000);\n  }\n  pinger.onmessage = function(ignored) {\n  }\n  pinger.onclose = pinger.onerror = function() {\n    clearTimeout(timeout);\n    this.destroy();\n  }.bind(this);\n  ping();\n}\nGcmRtcConnection.prototype.listenSockets = function() {\n  this.peerConnection.ondatachannel = function(ev) {\n    // console.log('got dc ' + ev.channel.label, ev.channel.id, ev.channel.readyState)\n    ev.channel.inbound = true;\n    this.waitForCommand(ev.channel);\n  }.bind(this);\n}\nGcmRtcConnection.prototype.prepareChannel = function(label) {\n  var dc = this.peerConnection.createDataChannel(label || 'gcm', {\n    ordered: true\n  });\n  dc.binaryType = 'arraybuffer';\n  return dc;\n}\nGcmRtcConnection.prototype.newSocket = function(label, connectCallback) {\n  if (this.peerConnection.signalingState == 'closed') {\n    connectCallback();\n    return;\n  }\n  if (this.outboundChannels) {\n    // console.log('using recycled channel');\n    var dc = this.outboundChannels.shift();\n    this.compactChannels();\n    dc.send(str2ab(label));\n    var socket = new GcmRtcSocket(this, dc);\n    connectCallback(socket, this);\n    return;\n  }\n\n  // console.log('using new channel');\n  var dc = this.prepareChannel('gcm');\n  var hasOpened;\n  dc.onopen = function() {\n    // node-webrtc seems to have an issue not firing onopen\n    // as the datachannel is immediately open?\n    // let's just watch for double callbacks just in case.\n    if (hasOpened)\n      return;\n    hasOpened = true;\n\n    dc.send(str2ab(label));\n    var socket = new GcmRtcSocket(this, dc);\n    connectCallback(socket, this);\n  }.bind(this);\n  if (dc.readyState == 'open')\n    dc.onopen();\n\n  // console.log('socket status', dc.readyState);\n}\nGcmRtcConnection.prototype.destroy = function() {\n  delete this.manager.gcmRtcConnections[this.key];\n  if (this.peerConnection.signalingState != 'closed') {\n    this.peerConnection.close();\n  }\n  var cb = this.onClose;\n  if (cb) {\n    delete this.onClose;\n    cb();\n  }\n}\n\nfunction GcmRtcManager(senders, registrationId, rtcc) {\n  this.senders = senders;\n  this.registrationId = registrationId;\n  this.rtcc = rtcc;\n  this.gcmRtcConnections = {};\n  this.gcmRtcListeners = {};\n  this.amazonTokens = {};\n}\n\nGcmRtcManager.prototype.onMessage = function(data) {\n  var message = JSON.parse(data.message);\n  // console.log('gcm message', message);\n  var type = data.type;\n  var senderId = data.senderId;\n  var src = data.src;\n  var srcPort = data.srcPort;\n  var dst = data.dst || this.registrationId;\n  var dstPort = data.dstPort;\n\n  if (type == 'offer') {\n    var listener = this.gcmRtcListeners[dstPort]\n    if (!listener)\n      console.log('not listening on ' + dstPort);\n    else\n      listener.listener.incoming(senderId, src, srcPort, dst, dstPort, message, listener.listenCallback);\n    return;\n  }\n  else if (type == 'answer') {\n    var key = GcmRtcManager.getKey(src, srcPort, dstPort);\n    var conn = this.gcmRtcConnections[key];\n    if (!conn) {\n      console.error('pending connection not found');\n      console.error(data);\n      return;\n    }\n    conn.manager.incoming(senderId, src, srcPort, dst, dstPort, message);\n    return;\n  }\n  else if (GcmRtcManager.onUnknownMessage) {\n    GcmRtcManager.onUnknownMessage(data);\n  }\n  else {\n    console.log('unknown message ' + type);\n  }\n}\n\nvar isChromeGcm = false;\ntry {\n  isChromeGcm = !!(chrome && chrome.gcm);\n}\ncatch (ignored) {\n}\n\n\nGcmRtcManager.hasLoadedChannels = false;\nGcmRtcManager.start = function(senders, rtcc, cb) {\n  console.log('starting GtcRtcManger');\n  if (isChromeGcm) {\n    var senderIds = Object.keys(senders);\n    chrome.gcm.register(senderIds, function(registrationId) {\n      // must read this to prevent log spam\n      chrome.runtime.lastError;\n      // console.log('gcm registration ' + registrationId);\n      if (!registrationId) {\n        cb();\n        return;\n      }\n\n      var s = new GcmRtcManager(senders, registrationId, rtcc);\n      chrome.gcm.onMessage.addListener(function(data) {\n        s.onMessage(data.data);\n      })\n      cb(s);\n    })\n  }\n  else {\n    function withIO(io) {\n      var socket = io(\"https://push.clockworkmod.com\");\n      // socket.emit('register');\n      socket.on('registration', function(registrationId) {\n        registrationId = 'web:' + registrationId;\n        if (!self.registrationId) {\n          self.registrationId = registrationId;\n          cb(self);\n        }\n        else {\n          self.registrationId = registrationId;\n          if (self.onRegistrationIdChanged)\n            self.onRegistrationIdChanged(registrationId);\n        }\n      })\n\n      socket.on('data', function(data) {\n        self.onMessage(data)\n      })\n    }\n\n    var self = new GcmRtcManager(senders, null, rtcc);\n    if (!isNode()) {\n      function getScript(source, callback) {\n        var script = document.createElement('script');\n        var prior = document.getElementsByTagName('script')[0];\n        script.async = 1;\n\n        script.onload = script.onreadystatechange = function(_, isAbort) {\n          if (isAbort || !script.readyState || /loaded|complete/.test(script.readyState)) {\n            script.onload = script.onreadystatechange = null;\n            script = undefined;\n\n            if (!isAbort) {\n              if (callback) callback();\n            }\n          }\n        };\n\n        script.src = source;\n        prior.parentNode.insertBefore(script, prior);\n      }\n      getScript('https://push.clockworkmod.com/socket.io/socket.io.js', function() {\n        withIO(io);\n      });\n    }\n    else {\n      withIO(require('socket.io-client'))\n    }\n  }\n}\n\nGcmRtcManager.prototype.wrapMessage = function(senderId, dst, dstPort, src, srcPort, type, message) {\n  return {\n    senderId: senderId,\n    src: src,\n    srcPort: srcPort,\n    dst: dst,\n    dstPort: dstPort,\n    type: type,\n    message: JSON.stringify(message)\n  }\n}\n\nGcmRtcManager.prototype.sendGcm = function(senderId, registrationId, dstPort, src, srcPort, type, message) {\n  var wrappedMessage = this.wrapMessage(senderId, registrationId, dstPort, src, srcPort, type, message);\n  return this.sendWrappedMessage(senderId, registrationId, wrappedMessage);\n}\n\nGcmRtcManager.prototype.sendWrappedMessage = function(senderId, registrationId, wrappedMessage) {\n  if (!senderId)\n    senderId = this.defaultSenderId;\n\n  if (registrationId.startsWith('web:')) {\n    return fetch(registrationId.substring(4), {\n      method: \"POST\",\n      body: JSON.stringify(wrappedMessage),\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    })\n    .then(response => response.json());\n  }\n  else if (registrationId.startsWith('amzn')) {\n    var tokenPromise;\n    if (!this.amazonTokens[senderId] || this.amazonTokens[senderId].accessTokenExpiration < Date.now()) {\n      var secret = this.senders[senderId];\n      console.log(senderId, secret);\n      var params = {\n        'grant_type': 'client_credentials',\n        'scope': 'messaging:push',\n        'client_id': senderId,\n        'client_secret': secret,\n      };\n      var encoded = Object.entries(params).map(([k, v]) => `${encodeURIComponent(k)}=${encodeURIComponent(v)}`).join('&');\n\n      tokenPromise = fetch('https://api.amazon.com/auth/O2/token', {\n        method: 'POST',\n        body: encoded,\n        headers: {\n          'Content-type': 'application/x-www-form-urlencoded;charset=UTF-8'\n        },\n      })\n      .then(response => response.json())\n      .then(tokenInfo => {\n        this.amazonTokens[senderId] = {};\n        this.amazonTokens[senderId].accessToken = tokenInfo.access_token;\n        this.amazonTokens[senderId].accessTokenExpiration = Date.now() + tokenInfo.expires_in - 30;\n\n        return tokenInfo.access_token;\n      })\n    }\n    else {\n      console.log('token valid for', this.amazonTokens[senderId].accessTokenExpiration - Date.now());\n      tokenPromise = Promise.resolve(this.amazonTokens[senderId].accessToken);\n    }\n\n    return tokenPromise.then(accessToken => {\n      return fetch(`https://api.amazon.com/messaging/registrations/${registrationId}/messages`, {\n        method: \"POST\",\n        body: JSON.stringify({\n          data: wrappedMessage,\n        }),\n        headers: {\n            'Content-Type': 'application/json',\n            'Accept': 'application/json',\n            'Authorization': `Bearer ${accessToken}`,\n            'X-Amzn-Type-Version': 'com.amazon.device.messaging.ADMMessage@1.0',\n            'X-Amzn-Accept-Type': 'com.amazon.device.messaging.ADMSendResult@1.0',\n        },\n      })\n      .then(response => response.json());\n    });\n  }\n  else {\n    return fetch(\"https://fcm.googleapis.com/fcm/send\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        to: registrationId,\n        data: wrappedMessage\n      }),\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": \"key=\" + this.senders[senderId]\n      },\n    })\n    .then(response => response.json())\n  }\n}\n\nGcmRtcManager.getKey = function(registrationId, dstPort, srcPort) {\n  return srcPort + ':' + dstPort + ':' + registrationId;\n}\n\nGcmRtcManager.dictionaryKeys = \"0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v w x y z\".split(\" \");\nGcmRtcManager.sdpDictionary = {};\nGcmRtcManager.addDictionary = function(token) {\n  var curKey = GcmRtcManager.dictionaryKeys[Object.keys(GcmRtcManager.sdpDictionary).length];\n  GcmRtcManager.sdpDictionary[curKey] = token;\n}\nGcmRtcManager.replaceAll = function(str, replaceWhat, replaceTo){\n    replaceWhat = replaceWhat.replace(/[-\\/\\\\^$*+?.()|[\\]{}]/g, '\\\\$&');\n    var re = new RegExp(replaceWhat, 'g');\n    return str.replace(re,replaceTo);\n  }\nGcmRtcManager.compressSdp = function(sdp) {\n  sdp = sdp.replace('\\\\', '\\\\\\\\');\n  for (var key in GcmRtcManager.sdpDictionary) {\n    var val = GcmRtcManager.sdpDictionary[key];\n    sdp = GcmRtcManager.replaceAll(sdp, val, '\\\\' + key);\n  }\n  return sdp;\n};\nGcmRtcManager.decompressSdp = function(sdp) {\n  for (var key in GcmRtcManager.sdpDictionary) {\n    var val = GcmRtcManager.sdpDictionary[key];\n    sdp = sdp.replace(new RegExp(`([^\\\\\\\\])\\\\\\\\${key}`, 'g'), \"$1\" + val);\n    // sdp = sdp.replace(new RegExp(\"^(\\\\\\\\${key})\", 'g'))\n  }\n  return sdp;\n};\n(function() {\n  var ad = GcmRtcManager.addDictionary;\n\n  ad(\"a=rtpmap:\");\n  ad(\"a=extmap:\");\n  ad(\"a=rtcp-fb:\");\n  ad(\"a=fmtp:\");\n  ad(\"level-asymmetry-allowed=\");\n  ad(\"packetization-mode=\");\n  ad(\"profile-level-id=\");\n  ad(\"90000\");\n  ad(\"rtx/90000\");\n  ad(\"H264/90000\")\n  ad(\"transport-cc\");\n  ad(\"x-google-profile-id\");\n  ad(\"nack pli\");\n  ad(\"goog-remb\");\n  ad(\"ccm fir\");\n  ad(\"telephone-event/\");\n  ad(\"http://www.webrtc.org/experiments/rtp-hdrext/\");\n  ad(\"urn:ietf:params:rtp-hdrext:toffset\");\n  ad(\"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\");\n  ad(\"urn:3gpp:video-orientation\");\n  ad(\"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\")\n  ad(\"http://www.webrtc.org/experiments/rtp-hdrext/playout-delay\")\n  ad(\"http://www.webrtc.org/experiments/rtp-hdrext/video-content-type\")\n  ad(\"http://www.webrtc.org/experiments/rtp-hdrext/video-timing\")\n  ad(\"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\")\n})();\n\nGcmRtcManager.prototype.setupPeerConnection = function(type, senderId, registrationId, dstPort, src, srcPort, getDesc) {\n  var pc = new RTCPeerConnection(this.rtcc);\n  var token;\n  var sendConnect = function(candidates) {\n    var portion = [];\n\n    var desc = getDesc();\n    var sdp = desc.sdp;\n    var compressedDesc = {\n      type: desc.type,\n      sdp: GcmRtcManager.compressSdp(desc.sdp),\n    }\n    var descLen = JSON.stringify(compressedDesc).length;\n\n    // gaurantee that the desc is sent at least once.\n    var sentOnce;\n    for (var candidate in candidates) {\n      candidate = candidates[candidate];\n      if (candidate == null)\n        continue;\n      portion.push(candidate);\n      if (descLen + JSON.stringify(portion).length > 3200) {\n        sentOnce = true;\n        this.sendGcm(senderId, registrationId, dstPort, src, srcPort, type,\n        {\n          desc: compressedDesc,\n          candidates: portion\n        });\n        portion = [];\n      }\n    }\n\n    if (portion.length > 0 || !sentOnce) {\n      this.sendGcm(senderId, registrationId, dstPort, src, srcPort, type,\n      {\n        desc: compressedDesc,\n        candidates: portion\n      });\n    }\n  }.bind(this);\n\n  pc.onicecandidate = function (evt) {\n    // uncomment to force TURN\n    // if (evt.candidate.candidate.indexOf('relay') == -1)\n    //   return;\n    if (evt.candidate) {\n      console.log('candidate', evt.candidate);\n      token = throttleTimeout(token, evt.candidate, 500, sendConnect);\n    }\n    else {\n      console.log('done sending ice candidates');\n    }\n  }.bind(this);\n\n  var key = GcmRtcManager.getKey(registrationId, dstPort, srcPort);\n  var conn = new GcmRtcConnection(this, pc, key);\n  conn.sendConnect = sendConnect;\n\n  pc.onsignalingstatechange = function(ev) {\n    // console.log('pcs', pc.signalingState)\n    if (pc.signalingState == 'stable') {\n      if (this.gcmRtcConnections[key] == conn) {\n        // keep allowing ice candidates?\n        // delete this.gcmRtcConnections[key];\n      }\n    }\n    else if (pc.signalingState == 'closed') {\n      conn.destroy();\n    }\n  }.bind(this);\n\n  this.gcmRtcConnections[key] = conn;\n  return conn;\n}\n\nGcmRtcManager.prototype.connect = function(options) {\n  return new Promise((resolve, reject) => {\n\n    var senderId = options.senderId;\n    var registrationId = options.registrationId;\n    var port = options.port;\n\n    if (!registrationId) {\n      throw new Error('registrationId was null on connect');\n    }\n\n    // ports can be any old random string\n    var localPort = Math.random().toString(16);\n    var d;\n    var conn = this.setupPeerConnection('offer', senderId, registrationId, port, this.registrationId, localPort, function() {\n      return d;\n    });\n    var pc = conn.peerConnection;\n    try {\n      if (navigator.userAgent.indexOf('Safari') != -1 && navigator.userAgent.indexOf('Chrome') == -1 && options.offerToReceiveAudio && options.offerToReceiveVideo) {\n        pc.addTransceiver('audio');\n        pc.addTransceiver('video');\n      }\n    }\n    catch (e) {\n    }\n\n    var failureTimeout = setTimeout(function() {\n      conn.destroy();\n      reject(new Error('Timeout waiting for RTC Connection'));\n    }, 30000);\n\n    function doOffer(options) {\n      pc.createOffer(options).then(function(desc) {\n        d = desc;\n        console.log(desc);\n        pc.setLocalDescription(desc);\n        // force the desc to be sent. safari doesn't trigger onicecandidate on receive only?\n        conn.sendConnect([]);\n      });\n    }\n\n    if (options.offerToReceiveAudio || options.offerToReceiveVideo || options.audio) {\n      function internal() {\n        pc.ontrack = function(e) {\n          conn.streams = e.streams;\n          console.log('got the remote stream');\n          clearTimeout(failureTimeout);\n          resolve(conn);\n        }\n        doOffer({\n          offerToReceiveAudio: !!options.offerToReceiveAudio,\n          offerToReceiveVideo: !!options.offerToReceiveVideo,\n          voiceActivityDetection: false\n        });\n      }\n\n      if (!options.audio) {\n        internal();\n        return;\n      }\n\n      navigator.mediaDevices.getUserMedia({ \"audio\": true })\n      .then(function(stream) {\n        stream.getTracks().forEach(function(track) {\n          pc.addTrack(track, stream);\n        });\n        internal();\n      })\n      .catch(e => {\n        console.error('audio fail', e);\n        internal();\n      });\n    }\n    else {\n      var pinger = conn.prepareChannel('pinger');\n      pinger.onopen = function() {\n        console.log('got rtc pinger')\n        conn.setupPinger(pinger);\n        clearTimeout(failureTimeout);\n        resolve(conn);\n      }\n      conn.listenSockets();\n      doOffer({});\n    }\n\n  });\n}\n\nGcmRtcManager.prototype.isListening = function(port) {\n  return this.gcmRtcListeners[port] != null;\n}\nGcmRtcManager.prototype.stopListen = function(port) {\n  delete this.gcmRtcListeners[port];\n}\n\nGcmRtcManager.prototype.listen = function(port, cb) {\n  if (this.gcmRtcListeners[port]) {\n    console.log('already listening on gcm port ' + port)\n    return;\n  }\n  this.gcmRtcListeners[port] = {\n    listener: this,\n    listenCallback: cb\n  };\n}\n\nGcmRtcManager.prototype.incoming = function(senderId, src, srcPort, dst, dstPort, message, listenCallback) {\n  var key = GcmRtcManager.getKey(src, srcPort, dstPort);\n  var conn = this.gcmRtcConnections[key];\n  if (!conn) {\n    if (!src) {\n      console.warn('received null registraition on incoming message. ignoring');\n      return;\n    }\n\n    // new connection\n    var d;\n    conn = this.setupPeerConnection('answer', senderId, src, srcPort, dst, dstPort, function() {\n      return d;\n    });\n    var sdp = message.desc.sdp;\n    message.desc.sdp = GcmRtcManager.decompressSdp(sdp);\n    conn.remoteDesc = new RTCSessionDescription(message.desc);\n    var pc = conn.peerConnection;\n    pc.ondatachannel = function(ev) {\n      console.log('got rtc pinger')\n      this.setupPinger(ev.channel);\n      listenCallback(conn);\n      this.listenSockets();\n    }.bind(conn);\n    pc.setRemoteDescription(conn.remoteDesc, function() {\n      pc.createAnswer()\n      .then(function(answer) {\n        d = answer;\n        pc.setLocalDescription(answer);\n      }, function() {\n        console.error('answer error', arguments);\n      })\n    });\n  }\n  else if (!conn.remoteDesc) {\n    var sdp = message.desc.sdp;\n    message.desc.sdp = GcmRtcManager.decompressSdp(sdp);\n    conn.remoteDesc = new RTCSessionDescription(message.desc);\n    var pc = conn.peerConnection;\n    pc.setRemoteDescription(conn.remoteDesc);\n  }\n  else {\n    // console.log('more ice candidates received')\n  }\n\n  conn.addCandidates(message);\n}\n\nexports.GcmRtcSocket = GcmRtcSocket;\nexports.GcmRtcManager = GcmRtcManager;\n","\"use strict\";\n\n// ref: https://github.com/tc39/proposal-global\nvar getGlobal = function () {\n\t// the only reliable means to get the global object is\n\t// `Function('return this')()`\n\t// However, this causes CSP violations in Chrome apps.\n\tif (typeof self !== 'undefined') { return self; }\n\tif (typeof window !== 'undefined') { return window; }\n\tif (typeof global !== 'undefined') { return global; }\n\tthrow new Error('unable to locate global object');\n}\n\nvar global = getGlobal();\n\nmodule.exports = exports = global.fetch;\n\n// Needed for TypeScript and Webpack.\nexports.default = global.fetch.bind(global);\n\nexports.Headers = global.Headers;\nexports.Request = global.Request;\nexports.Response = global.Response;","\n/**\n * Module dependencies.\n */\n\nvar url = require('./url');\nvar parser = require('socket.io-parser');\nvar Manager = require('./manager');\nvar debug = require('debug')('socket.io-client');\n\n/**\n * Module exports.\n */\n\nmodule.exports = exports = lookup;\n\n/**\n * Managers cache.\n */\n\nvar cache = exports.managers = {};\n\n/**\n * Looks up an existing `Manager` for multiplexing.\n * If the user summons:\n *\n *   `io('http://localhost/a');`\n *   `io('http://localhost/b');`\n *\n * We reuse the existing instance based on same scheme/port/host,\n * and we initialize sockets for each namespace.\n *\n * @api public\n */\n\nfunction lookup (uri, opts) {\n  if (typeof uri === 'object') {\n    opts = uri;\n    uri = undefined;\n  }\n\n  opts = opts || {};\n\n  var parsed = url(uri);\n  var source = parsed.source;\n  var id = parsed.id;\n  var path = parsed.path;\n  var sameNamespace = cache[id] && path in cache[id].nsps;\n  var newConnection = opts.forceNew || opts['force new connection'] ||\n                      false === opts.multiplex || sameNamespace;\n\n  var io;\n\n  if (newConnection) {\n    debug('ignoring socket cache for %s', source);\n    io = Manager(source, opts);\n  } else {\n    if (!cache[id]) {\n      debug('new io instance for %s', source);\n      cache[id] = Manager(source, opts);\n    }\n    io = cache[id];\n  }\n  if (parsed.query && !opts.query) {\n    opts.query = parsed.query;\n  }\n  return io.socket(parsed.path, opts);\n}\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nexports.protocol = parser.protocol;\n\n/**\n * `connect`.\n *\n * @param {String} uri\n * @api public\n */\n\nexports.connect = lookup;\n\n/**\n * Expose constructors for standalone build.\n *\n * @api public\n */\n\nexports.Manager = require('./manager');\nexports.Socket = require('./socket');\n","\n/**\n * Module dependencies.\n */\n\nvar parseuri = require('parseuri');\nvar debug = require('debug')('socket.io-client:url');\n\n/**\n * Module exports.\n */\n\nmodule.exports = url;\n\n/**\n * URL parser.\n *\n * @param {String} url\n * @param {Object} An object meant to mimic window.location.\n *                 Defaults to window.location.\n * @api public\n */\n\nfunction url (uri, loc) {\n  var obj = uri;\n\n  // default to window.location\n  loc = loc || global.location;\n  if (null == uri) uri = loc.protocol + '//' + loc.host;\n\n  // relative path support\n  if ('string' === typeof uri) {\n    if ('/' === uri.charAt(0)) {\n      if ('/' === uri.charAt(1)) {\n        uri = loc.protocol + uri;\n      } else {\n        uri = loc.host + uri;\n      }\n    }\n\n    if (!/^(https?|wss?):\\/\\//.test(uri)) {\n      debug('protocol-less url %s', uri);\n      if ('undefined' !== typeof loc) {\n        uri = loc.protocol + '//' + uri;\n      } else {\n        uri = 'https://' + uri;\n      }\n    }\n\n    // parse\n    debug('parse %s', uri);\n    obj = parseuri(uri);\n  }\n\n  // make sure we treat `localhost:80` and `localhost` equally\n  if (!obj.port) {\n    if (/^(http|ws)$/.test(obj.protocol)) {\n      obj.port = '80';\n    } else if (/^(http|ws)s$/.test(obj.protocol)) {\n      obj.port = '443';\n    }\n  }\n\n  obj.path = obj.path || '/';\n\n  var ipv6 = obj.host.indexOf(':') !== -1;\n  var host = ipv6 ? '[' + obj.host + ']' : obj.host;\n\n  // define unique id\n  obj.id = obj.protocol + '://' + host + ':' + obj.port;\n  // define href\n  obj.href = obj.protocol + '://' + host + (loc && loc.port === obj.port ? '' : (':' + obj.port));\n\n  return obj;\n}\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n *\n * Expose `debug()` as the module.\n */\n\nexports = module.exports = createDebug.debug = createDebug['default'] = createDebug;\nexports.coerce = coerce;\nexports.disable = disable;\nexports.enable = enable;\nexports.enabled = enabled;\nexports.humanize = require('ms');\n\n/**\n * Active `debug` instances.\n */\nexports.instances = [];\n\n/**\n * The currently active debug mode names, and names to skip.\n */\n\nexports.names = [];\nexports.skips = [];\n\n/**\n * Map of special \"%n\" handling functions, for the debug \"format\" argument.\n *\n * Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n */\n\nexports.formatters = {};\n\n/**\n * Select a color.\n * @param {String} namespace\n * @return {Number}\n * @api private\n */\n\nfunction selectColor(namespace) {\n  var hash = 0, i;\n\n  for (i in namespace) {\n    hash  = ((hash << 5) - hash) + namespace.charCodeAt(i);\n    hash |= 0; // Convert to 32bit integer\n  }\n\n  return exports.colors[Math.abs(hash) % exports.colors.length];\n}\n\n/**\n * Create a debugger with the given `namespace`.\n *\n * @param {String} namespace\n * @return {Function}\n * @api public\n */\n\nfunction createDebug(namespace) {\n\n  var prevTime;\n\n  function debug() {\n    // disabled?\n    if (!debug.enabled) return;\n\n    var self = debug;\n\n    // set `diff` timestamp\n    var curr = +new Date();\n    var ms = curr - (prevTime || curr);\n    self.diff = ms;\n    self.prev = prevTime;\n    self.curr = curr;\n    prevTime = curr;\n\n    // turn the `arguments` into a proper Array\n    var args = new Array(arguments.length);\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i];\n    }\n\n    args[0] = exports.coerce(args[0]);\n\n    if ('string' !== typeof args[0]) {\n      // anything else let's inspect with %O\n      args.unshift('%O');\n    }\n\n    // apply any `formatters` transformations\n    var index = 0;\n    args[0] = args[0].replace(/%([a-zA-Z%])/g, function(match, format) {\n      // if we encounter an escaped % then don't increase the array index\n      if (match === '%%') return match;\n      index++;\n      var formatter = exports.formatters[format];\n      if ('function' === typeof formatter) {\n        var val = args[index];\n        match = formatter.call(self, val);\n\n        // now we need to remove `args[index]` since it's inlined in the `format`\n        args.splice(index, 1);\n        index--;\n      }\n      return match;\n    });\n\n    // apply env-specific formatting (colors, etc.)\n    exports.formatArgs.call(self, args);\n\n    var logFn = debug.log || exports.log || console.log.bind(console);\n    logFn.apply(self, args);\n  }\n\n  debug.namespace = namespace;\n  debug.enabled = exports.enabled(namespace);\n  debug.useColors = exports.useColors();\n  debug.color = selectColor(namespace);\n  debug.destroy = destroy;\n\n  // env-specific initialization logic for debug instances\n  if ('function' === typeof exports.init) {\n    exports.init(debug);\n  }\n\n  exports.instances.push(debug);\n\n  return debug;\n}\n\nfunction destroy () {\n  var index = exports.instances.indexOf(this);\n  if (index !== -1) {\n    exports.instances.splice(index, 1);\n    return true;\n  } else {\n    return false;\n  }\n}\n\n/**\n * Enables a debug mode by namespaces. This can include modes\n * separated by a colon and wildcards.\n *\n * @param {String} namespaces\n * @api public\n */\n\nfunction enable(namespaces) {\n  exports.save(namespaces);\n\n  exports.names = [];\n  exports.skips = [];\n\n  var i;\n  var split = (typeof namespaces === 'string' ? namespaces : '').split(/[\\s,]+/);\n  var len = split.length;\n\n  for (i = 0; i < len; i++) {\n    if (!split[i]) continue; // ignore empty strings\n    namespaces = split[i].replace(/\\*/g, '.*?');\n    if (namespaces[0] === '-') {\n      exports.skips.push(new RegExp('^' + namespaces.substr(1) + '$'));\n    } else {\n      exports.names.push(new RegExp('^' + namespaces + '$'));\n    }\n  }\n\n  for (i = 0; i < exports.instances.length; i++) {\n    var instance = exports.instances[i];\n    instance.enabled = exports.enabled(instance.namespace);\n  }\n}\n\n/**\n * Disable debug output.\n *\n * @api public\n */\n\nfunction disable() {\n  exports.enable('');\n}\n\n/**\n * Returns true if the given mode name is enabled, false otherwise.\n *\n * @param {String} name\n * @return {Boolean}\n * @api public\n */\n\nfunction enabled(name) {\n  if (name[name.length - 1] === '*') {\n    return true;\n  }\n  var i, len;\n  for (i = 0, len = exports.skips.length; i < len; i++) {\n    if (exports.skips[i].test(name)) {\n      return false;\n    }\n  }\n  for (i = 0, len = exports.names.length; i < len; i++) {\n    if (exports.names[i].test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\n/**\n * Coerce `val`.\n *\n * @param {Mixed} val\n * @return {Mixed}\n * @api private\n */\n\nfunction coerce(val) {\n  if (val instanceof Error) return val.stack || val.message;\n  return val;\n}\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function(val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isNaN(val) === false) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^((?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  if (ms >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (ms >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (ms >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (ms >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  return plural(ms, d, 'day') ||\n    plural(ms, h, 'hour') ||\n    plural(ms, m, 'minute') ||\n    plural(ms, s, 'second') ||\n    ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, n, name) {\n  if (ms < n) {\n    return;\n  }\n  if (ms < n * 1.5) {\n    return Math.floor(ms / n) + ' ' + name;\n  }\n  return Math.ceil(ms / n) + ' ' + name + 's';\n}\n","/*global Blob,File*/\n\n/**\n * Module requirements\n */\n\nvar isArray = require('isarray');\nvar isBuf = require('./is-buffer');\nvar toString = Object.prototype.toString;\nvar withNativeBlob = typeof global.Blob === 'function' || toString.call(global.Blob) === '[object BlobConstructor]';\nvar withNativeFile = typeof global.File === 'function' || toString.call(global.File) === '[object FileConstructor]';\n\n/**\n * Replaces every Buffer | ArrayBuffer in packet with a numbered placeholder.\n * Anything with blobs or files should be fed through removeBlobs before coming\n * here.\n *\n * @param {Object} packet - socket.io event packet\n * @return {Object} with deconstructed packet and list of buffers\n * @api public\n */\n\nexports.deconstructPacket = function(packet) {\n  var buffers = [];\n  var packetData = packet.data;\n  var pack = packet;\n  pack.data = _deconstructPacket(packetData, buffers);\n  pack.attachments = buffers.length; // number of binary 'attachments'\n  return {packet: pack, buffers: buffers};\n};\n\nfunction _deconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (isBuf(data)) {\n    var placeholder = { _placeholder: true, num: buffers.length };\n    buffers.push(data);\n    return placeholder;\n  } else if (isArray(data)) {\n    var newData = new Array(data.length);\n    for (var i = 0; i < data.length; i++) {\n      newData[i] = _deconstructPacket(data[i], buffers);\n    }\n    return newData;\n  } else if (typeof data === 'object' && !(data instanceof Date)) {\n    var newData = {};\n    for (var key in data) {\n      newData[key] = _deconstructPacket(data[key], buffers);\n    }\n    return newData;\n  }\n  return data;\n}\n\n/**\n * Reconstructs a binary packet from its placeholder packet and buffers\n *\n * @param {Object} packet - event packet with placeholders\n * @param {Array} buffers - binary buffers to put in placeholder positions\n * @return {Object} reconstructed packet\n * @api public\n */\n\nexports.reconstructPacket = function(packet, buffers) {\n  packet.data = _reconstructPacket(packet.data, buffers);\n  packet.attachments = undefined; // no longer useful\n  return packet;\n};\n\nfunction _reconstructPacket(data, buffers) {\n  if (!data) return data;\n\n  if (data && data._placeholder) {\n    return buffers[data.num]; // appropriate buffer (should be natural order anyway)\n  } else if (isArray(data)) {\n    for (var i = 0; i < data.length; i++) {\n      data[i] = _reconstructPacket(data[i], buffers);\n    }\n  } else if (typeof data === 'object') {\n    for (var key in data) {\n      data[key] = _reconstructPacket(data[key], buffers);\n    }\n  }\n\n  return data;\n}\n\n/**\n * Asynchronously removes Blobs or Files from data via\n * FileReader's readAsArrayBuffer method. Used before encoding\n * data as msgpack. Calls callback with the blobless data.\n *\n * @param {Object} data\n * @param {Function} callback\n * @api private\n */\n\nexports.removeBlobs = function(data, callback) {\n  function _removeBlobs(obj, curKey, containingObject) {\n    if (!obj) return obj;\n\n    // convert any blob\n    if ((withNativeBlob && obj instanceof Blob) ||\n        (withNativeFile && obj instanceof File)) {\n      pendingBlobs++;\n\n      // async filereader\n      var fileReader = new FileReader();\n      fileReader.onload = function() { // this.result == arraybuffer\n        if (containingObject) {\n          containingObject[curKey] = this.result;\n        }\n        else {\n          bloblessData = this.result;\n        }\n\n        // if nothing pending its callback time\n        if(! --pendingBlobs) {\n          callback(bloblessData);\n        }\n      };\n\n      fileReader.readAsArrayBuffer(obj); // blob -> arraybuffer\n    } else if (isArray(obj)) { // handle array\n      for (var i = 0; i < obj.length; i++) {\n        _removeBlobs(obj[i], i, obj);\n      }\n    } else if (typeof obj === 'object' && !isBuf(obj)) { // and object\n      for (var key in obj) {\n        _removeBlobs(obj[key], key, obj);\n      }\n    }\n  }\n\n  var pendingBlobs = 0;\n  var bloblessData = data;\n  _removeBlobs(bloblessData);\n  if (!pendingBlobs) {\n    callback(bloblessData);\n  }\n};\n","\nmodule.exports = require('./socket');\n\n/**\n * Exports parser\n *\n * @api public\n *\n */\nmodule.exports.parser = require('engine.io-parser');\n","/**\n * Module dependencies.\n */\n\nvar transports = require('./transports/index');\nvar Emitter = require('component-emitter');\nvar debug = require('debug')('engine.io-client:socket');\nvar index = require('indexof');\nvar parser = require('engine.io-parser');\nvar parseuri = require('parseuri');\nvar parseqs = require('parseqs');\n\n/**\n * Module exports.\n */\n\nmodule.exports = Socket;\n\n/**\n * Socket constructor.\n *\n * @param {String|Object} uri or options\n * @param {Object} options\n * @api public\n */\n\nfunction Socket (uri, opts) {\n  if (!(this instanceof Socket)) return new Socket(uri, opts);\n\n  opts = opts || {};\n\n  if (uri && 'object' === typeof uri) {\n    opts = uri;\n    uri = null;\n  }\n\n  if (uri) {\n    uri = parseuri(uri);\n    opts.hostname = uri.host;\n    opts.secure = uri.protocol === 'https' || uri.protocol === 'wss';\n    opts.port = uri.port;\n    if (uri.query) opts.query = uri.query;\n  } else if (opts.host) {\n    opts.hostname = parseuri(opts.host).host;\n  }\n\n  this.secure = null != opts.secure ? opts.secure\n    : (global.location && 'https:' === location.protocol);\n\n  if (opts.hostname && !opts.port) {\n    // if no port is specified manually, use the protocol default\n    opts.port = this.secure ? '443' : '80';\n  }\n\n  this.agent = opts.agent || false;\n  this.hostname = opts.hostname ||\n    (global.location ? location.hostname : 'localhost');\n  this.port = opts.port || (global.location && location.port\n      ? location.port\n      : (this.secure ? 443 : 80));\n  this.query = opts.query || {};\n  if ('string' === typeof this.query) this.query = parseqs.decode(this.query);\n  this.upgrade = false !== opts.upgrade;\n  this.path = (opts.path || '/engine.io').replace(/\\/$/, '') + '/';\n  this.forceJSONP = !!opts.forceJSONP;\n  this.jsonp = false !== opts.jsonp;\n  this.forceBase64 = !!opts.forceBase64;\n  this.enablesXDR = !!opts.enablesXDR;\n  this.timestampParam = opts.timestampParam || 't';\n  this.timestampRequests = opts.timestampRequests;\n  this.transports = opts.transports || ['polling', 'websocket'];\n  this.transportOptions = opts.transportOptions || {};\n  this.readyState = '';\n  this.writeBuffer = [];\n  this.prevBufferLen = 0;\n  this.policyPort = opts.policyPort || 843;\n  this.rememberUpgrade = opts.rememberUpgrade || false;\n  this.binaryType = null;\n  this.onlyBinaryUpgrades = opts.onlyBinaryUpgrades;\n  this.perMessageDeflate = false !== opts.perMessageDeflate ? (opts.perMessageDeflate || {}) : false;\n\n  if (true === this.perMessageDeflate) this.perMessageDeflate = {};\n  if (this.perMessageDeflate && null == this.perMessageDeflate.threshold) {\n    this.perMessageDeflate.threshold = 1024;\n  }\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx || null;\n  this.key = opts.key || null;\n  this.passphrase = opts.passphrase || null;\n  this.cert = opts.cert || null;\n  this.ca = opts.ca || null;\n  this.ciphers = opts.ciphers || null;\n  this.rejectUnauthorized = opts.rejectUnauthorized === undefined ? true : opts.rejectUnauthorized;\n  this.forceNode = !!opts.forceNode;\n\n  // other options for Node.js client\n  var freeGlobal = typeof global === 'object' && global;\n  if (freeGlobal.global === freeGlobal) {\n    if (opts.extraHeaders && Object.keys(opts.extraHeaders).length > 0) {\n      this.extraHeaders = opts.extraHeaders;\n    }\n\n    if (opts.localAddress) {\n      this.localAddress = opts.localAddress;\n    }\n  }\n\n  // set on handshake\n  this.id = null;\n  this.upgrades = null;\n  this.pingInterval = null;\n  this.pingTimeout = null;\n\n  // set on heartbeat\n  this.pingIntervalTimer = null;\n  this.pingTimeoutTimer = null;\n\n  this.open();\n}\n\nSocket.priorWebsocketSuccess = false;\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Socket.prototype);\n\n/**\n * Protocol version.\n *\n * @api public\n */\n\nSocket.protocol = parser.protocol; // this is an int\n\n/**\n * Expose deps for legacy compatibility\n * and standalone browser access.\n */\n\nSocket.Socket = Socket;\nSocket.Transport = require('./transport');\nSocket.transports = require('./transports/index');\nSocket.parser = require('engine.io-parser');\n\n/**\n * Creates transport of the given type.\n *\n * @param {String} transport name\n * @return {Transport}\n * @api private\n */\n\nSocket.prototype.createTransport = function (name) {\n  debug('creating transport \"%s\"', name);\n  var query = clone(this.query);\n\n  // append engine.io protocol identifier\n  query.EIO = parser.protocol;\n\n  // transport name\n  query.transport = name;\n\n  // per-transport options\n  var options = this.transportOptions[name] || {};\n\n  // session id if we already have one\n  if (this.id) query.sid = this.id;\n\n  var transport = new transports[name]({\n    query: query,\n    socket: this,\n    agent: options.agent || this.agent,\n    hostname: options.hostname || this.hostname,\n    port: options.port || this.port,\n    secure: options.secure || this.secure,\n    path: options.path || this.path,\n    forceJSONP: options.forceJSONP || this.forceJSONP,\n    jsonp: options.jsonp || this.jsonp,\n    forceBase64: options.forceBase64 || this.forceBase64,\n    enablesXDR: options.enablesXDR || this.enablesXDR,\n    timestampRequests: options.timestampRequests || this.timestampRequests,\n    timestampParam: options.timestampParam || this.timestampParam,\n    policyPort: options.policyPort || this.policyPort,\n    pfx: options.pfx || this.pfx,\n    key: options.key || this.key,\n    passphrase: options.passphrase || this.passphrase,\n    cert: options.cert || this.cert,\n    ca: options.ca || this.ca,\n    ciphers: options.ciphers || this.ciphers,\n    rejectUnauthorized: options.rejectUnauthorized || this.rejectUnauthorized,\n    perMessageDeflate: options.perMessageDeflate || this.perMessageDeflate,\n    extraHeaders: options.extraHeaders || this.extraHeaders,\n    forceNode: options.forceNode || this.forceNode,\n    localAddress: options.localAddress || this.localAddress,\n    requestTimeout: options.requestTimeout || this.requestTimeout,\n    protocols: options.protocols || void (0)\n  });\n\n  return transport;\n};\n\nfunction clone (obj) {\n  var o = {};\n  for (var i in obj) {\n    if (obj.hasOwnProperty(i)) {\n      o[i] = obj[i];\n    }\n  }\n  return o;\n}\n\n/**\n * Initializes transport to use and starts probe.\n *\n * @api private\n */\nSocket.prototype.open = function () {\n  var transport;\n  if (this.rememberUpgrade && Socket.priorWebsocketSuccess && this.transports.indexOf('websocket') !== -1) {\n    transport = 'websocket';\n  } else if (0 === this.transports.length) {\n    // Emit error on next tick so it can be listened to\n    var self = this;\n    setTimeout(function () {\n      self.emit('error', 'No transports available');\n    }, 0);\n    return;\n  } else {\n    transport = this.transports[0];\n  }\n  this.readyState = 'opening';\n\n  // Retry with the next transport if the transport is disabled (jsonp: false)\n  try {\n    transport = this.createTransport(transport);\n  } catch (e) {\n    this.transports.shift();\n    this.open();\n    return;\n  }\n\n  transport.open();\n  this.setTransport(transport);\n};\n\n/**\n * Sets the current transport. Disables the existing one (if any).\n *\n * @api private\n */\n\nSocket.prototype.setTransport = function (transport) {\n  debug('setting transport %s', transport.name);\n  var self = this;\n\n  if (this.transport) {\n    debug('clearing existing transport %s', this.transport.name);\n    this.transport.removeAllListeners();\n  }\n\n  // set up transport\n  this.transport = transport;\n\n  // set up transport listeners\n  transport\n  .on('drain', function () {\n    self.onDrain();\n  })\n  .on('packet', function (packet) {\n    self.onPacket(packet);\n  })\n  .on('error', function (e) {\n    self.onError(e);\n  })\n  .on('close', function () {\n    self.onClose('transport close');\n  });\n};\n\n/**\n * Probes a transport.\n *\n * @param {String} transport name\n * @api private\n */\n\nSocket.prototype.probe = function (name) {\n  debug('probing transport \"%s\"', name);\n  var transport = this.createTransport(name, { probe: 1 });\n  var failed = false;\n  var self = this;\n\n  Socket.priorWebsocketSuccess = false;\n\n  function onTransportOpen () {\n    if (self.onlyBinaryUpgrades) {\n      var upgradeLosesBinary = !this.supportsBinary && self.transport.supportsBinary;\n      failed = failed || upgradeLosesBinary;\n    }\n    if (failed) return;\n\n    debug('probe transport \"%s\" opened', name);\n    transport.send([{ type: 'ping', data: 'probe' }]);\n    transport.once('packet', function (msg) {\n      if (failed) return;\n      if ('pong' === msg.type && 'probe' === msg.data) {\n        debug('probe transport \"%s\" pong', name);\n        self.upgrading = true;\n        self.emit('upgrading', transport);\n        if (!transport) return;\n        Socket.priorWebsocketSuccess = 'websocket' === transport.name;\n\n        debug('pausing current transport \"%s\"', self.transport.name);\n        self.transport.pause(function () {\n          if (failed) return;\n          if ('closed' === self.readyState) return;\n          debug('changing transport and sending upgrade packet');\n\n          cleanup();\n\n          self.setTransport(transport);\n          transport.send([{ type: 'upgrade' }]);\n          self.emit('upgrade', transport);\n          transport = null;\n          self.upgrading = false;\n          self.flush();\n        });\n      } else {\n        debug('probe transport \"%s\" failed', name);\n        var err = new Error('probe error');\n        err.transport = transport.name;\n        self.emit('upgradeError', err);\n      }\n    });\n  }\n\n  function freezeTransport () {\n    if (failed) return;\n\n    // Any callback called by transport should be ignored since now\n    failed = true;\n\n    cleanup();\n\n    transport.close();\n    transport = null;\n  }\n\n  // Handle any error that happens while probing\n  function onerror (err) {\n    var error = new Error('probe error: ' + err);\n    error.transport = transport.name;\n\n    freezeTransport();\n\n    debug('probe transport \"%s\" failed because of error: %s', name, err);\n\n    self.emit('upgradeError', error);\n  }\n\n  function onTransportClose () {\n    onerror('transport closed');\n  }\n\n  // When the socket is closed while we're probing\n  function onclose () {\n    onerror('socket closed');\n  }\n\n  // When the socket is upgraded while we're probing\n  function onupgrade (to) {\n    if (transport && to.name !== transport.name) {\n      debug('\"%s\" works - aborting \"%s\"', to.name, transport.name);\n      freezeTransport();\n    }\n  }\n\n  // Remove all listeners on the transport and on self\n  function cleanup () {\n    transport.removeListener('open', onTransportOpen);\n    transport.removeListener('error', onerror);\n    transport.removeListener('close', onTransportClose);\n    self.removeListener('close', onclose);\n    self.removeListener('upgrading', onupgrade);\n  }\n\n  transport.once('open', onTransportOpen);\n  transport.once('error', onerror);\n  transport.once('close', onTransportClose);\n\n  this.once('close', onclose);\n  this.once('upgrading', onupgrade);\n\n  transport.open();\n};\n\n/**\n * Called when connection is deemed open.\n *\n * @api public\n */\n\nSocket.prototype.onOpen = function () {\n  debug('socket open');\n  this.readyState = 'open';\n  Socket.priorWebsocketSuccess = 'websocket' === this.transport.name;\n  this.emit('open');\n  this.flush();\n\n  // we check for `readyState` in case an `open`\n  // listener already closed the socket\n  if ('open' === this.readyState && this.upgrade && this.transport.pause) {\n    debug('starting upgrade probes');\n    for (var i = 0, l = this.upgrades.length; i < l; i++) {\n      this.probe(this.upgrades[i]);\n    }\n  }\n};\n\n/**\n * Handles a packet.\n *\n * @api private\n */\n\nSocket.prototype.onPacket = function (packet) {\n  if ('opening' === this.readyState || 'open' === this.readyState ||\n      'closing' === this.readyState) {\n    debug('socket receive: type \"%s\", data \"%s\"', packet.type, packet.data);\n\n    this.emit('packet', packet);\n\n    // Socket is live - any packet counts\n    this.emit('heartbeat');\n\n    switch (packet.type) {\n      case 'open':\n        this.onHandshake(JSON.parse(packet.data));\n        break;\n\n      case 'pong':\n        this.setPing();\n        this.emit('pong');\n        break;\n\n      case 'error':\n        var err = new Error('server error');\n        err.code = packet.data;\n        this.onError(err);\n        break;\n\n      case 'message':\n        this.emit('data', packet.data);\n        this.emit('message', packet.data);\n        break;\n    }\n  } else {\n    debug('packet received with socket readyState \"%s\"', this.readyState);\n  }\n};\n\n/**\n * Called upon handshake completion.\n *\n * @param {Object} handshake obj\n * @api private\n */\n\nSocket.prototype.onHandshake = function (data) {\n  this.emit('handshake', data);\n  this.id = data.sid;\n  this.transport.query.sid = data.sid;\n  this.upgrades = this.filterUpgrades(data.upgrades);\n  this.pingInterval = data.pingInterval;\n  this.pingTimeout = data.pingTimeout;\n  this.onOpen();\n  // In case open handler closes socket\n  if ('closed' === this.readyState) return;\n  this.setPing();\n\n  // Prolong liveness of socket on heartbeat\n  this.removeListener('heartbeat', this.onHeartbeat);\n  this.on('heartbeat', this.onHeartbeat);\n};\n\n/**\n * Resets ping timeout.\n *\n * @api private\n */\n\nSocket.prototype.onHeartbeat = function (timeout) {\n  clearTimeout(this.pingTimeoutTimer);\n  var self = this;\n  self.pingTimeoutTimer = setTimeout(function () {\n    if ('closed' === self.readyState) return;\n    self.onClose('ping timeout');\n  }, timeout || (self.pingInterval + self.pingTimeout));\n};\n\n/**\n * Pings server every `this.pingInterval` and expects response\n * within `this.pingTimeout` or closes connection.\n *\n * @api private\n */\n\nSocket.prototype.setPing = function () {\n  var self = this;\n  clearTimeout(self.pingIntervalTimer);\n  self.pingIntervalTimer = setTimeout(function () {\n    debug('writing ping packet - expecting pong within %sms', self.pingTimeout);\n    self.ping();\n    self.onHeartbeat(self.pingTimeout);\n  }, self.pingInterval);\n};\n\n/**\n* Sends a ping packet.\n*\n* @api private\n*/\n\nSocket.prototype.ping = function () {\n  var self = this;\n  this.sendPacket('ping', function () {\n    self.emit('ping');\n  });\n};\n\n/**\n * Called on `drain` event\n *\n * @api private\n */\n\nSocket.prototype.onDrain = function () {\n  this.writeBuffer.splice(0, this.prevBufferLen);\n\n  // setting prevBufferLen = 0 is very important\n  // for example, when upgrading, upgrade packet is sent over,\n  // and a nonzero prevBufferLen could cause problems on `drain`\n  this.prevBufferLen = 0;\n\n  if (0 === this.writeBuffer.length) {\n    this.emit('drain');\n  } else {\n    this.flush();\n  }\n};\n\n/**\n * Flush write buffers.\n *\n * @api private\n */\n\nSocket.prototype.flush = function () {\n  if ('closed' !== this.readyState && this.transport.writable &&\n    !this.upgrading && this.writeBuffer.length) {\n    debug('flushing %d packets in socket', this.writeBuffer.length);\n    this.transport.send(this.writeBuffer);\n    // keep track of current length of writeBuffer\n    // splice writeBuffer and callbackBuffer on `drain`\n    this.prevBufferLen = this.writeBuffer.length;\n    this.emit('flush');\n  }\n};\n\n/**\n * Sends a message.\n *\n * @param {String} message.\n * @param {Function} callback function.\n * @param {Object} options.\n * @return {Socket} for chaining.\n * @api public\n */\n\nSocket.prototype.write =\nSocket.prototype.send = function (msg, options, fn) {\n  this.sendPacket('message', msg, options, fn);\n  return this;\n};\n\n/**\n * Sends a packet.\n *\n * @param {String} packet type.\n * @param {String} data.\n * @param {Object} options.\n * @param {Function} callback function.\n * @api private\n */\n\nSocket.prototype.sendPacket = function (type, data, options, fn) {\n  if ('function' === typeof data) {\n    fn = data;\n    data = undefined;\n  }\n\n  if ('function' === typeof options) {\n    fn = options;\n    options = null;\n  }\n\n  if ('closing' === this.readyState || 'closed' === this.readyState) {\n    return;\n  }\n\n  options = options || {};\n  options.compress = false !== options.compress;\n\n  var packet = {\n    type: type,\n    data: data,\n    options: options\n  };\n  this.emit('packetCreate', packet);\n  this.writeBuffer.push(packet);\n  if (fn) this.once('flush', fn);\n  this.flush();\n};\n\n/**\n * Closes the connection.\n *\n * @api private\n */\n\nSocket.prototype.close = function () {\n  if ('opening' === this.readyState || 'open' === this.readyState) {\n    this.readyState = 'closing';\n\n    var self = this;\n\n    if (this.writeBuffer.length) {\n      this.once('drain', function () {\n        if (this.upgrading) {\n          waitForUpgrade();\n        } else {\n          close();\n        }\n      });\n    } else if (this.upgrading) {\n      waitForUpgrade();\n    } else {\n      close();\n    }\n  }\n\n  function close () {\n    self.onClose('forced close');\n    debug('socket closing - telling transport to close');\n    self.transport.close();\n  }\n\n  function cleanupAndClose () {\n    self.removeListener('upgrade', cleanupAndClose);\n    self.removeListener('upgradeError', cleanupAndClose);\n    close();\n  }\n\n  function waitForUpgrade () {\n    // wait for upgrade to finish since we can't send packets while pausing a transport\n    self.once('upgrade', cleanupAndClose);\n    self.once('upgradeError', cleanupAndClose);\n  }\n\n  return this;\n};\n\n/**\n * Called upon transport error\n *\n * @api private\n */\n\nSocket.prototype.onError = function (err) {\n  debug('socket error %j', err);\n  Socket.priorWebsocketSuccess = false;\n  this.emit('error', err);\n  this.onClose('transport error', err);\n};\n\n/**\n * Called upon transport close.\n *\n * @api private\n */\n\nSocket.prototype.onClose = function (reason, desc) {\n  if ('opening' === this.readyState || 'open' === this.readyState || 'closing' === this.readyState) {\n    debug('socket close with reason: \"%s\"', reason);\n    var self = this;\n\n    // clear timers\n    clearTimeout(this.pingIntervalTimer);\n    clearTimeout(this.pingTimeoutTimer);\n\n    // stop event from firing again for transport\n    this.transport.removeAllListeners('close');\n\n    // ensure transport won't stay open\n    this.transport.close();\n\n    // ignore further transport communication\n    this.transport.removeAllListeners();\n\n    // set ready state\n    this.readyState = 'closed';\n\n    // clear session id\n    this.id = null;\n\n    // emit close event\n    this.emit('close', reason, desc);\n\n    // clean buffers after, so users can still\n    // grab the buffers on `close` event\n    self.writeBuffer = [];\n    self.prevBufferLen = 0;\n  }\n};\n\n/**\n * Filters upgrades, returning only those matching client transports.\n *\n * @param {Array} server upgrades\n * @api private\n *\n */\n\nSocket.prototype.filterUpgrades = function (upgrades) {\n  var filteredUpgrades = [];\n  for (var i = 0, j = upgrades.length; i < j; i++) {\n    if (~index(this.transports, upgrades[i])) filteredUpgrades.push(upgrades[i]);\n  }\n  return filteredUpgrades;\n};\n","\n/**\n * Module exports.\n *\n * Logic borrowed from Modernizr:\n *\n *   - https://github.com/Modernizr/Modernizr/blob/master/feature-detects/cors.js\n */\n\ntry {\n  module.exports = typeof XMLHttpRequest !== 'undefined' &&\n    'withCredentials' in new XMLHttpRequest();\n} catch (err) {\n  // if XMLHttp support is disabled in IE then it will throw\n  // when trying to create\n  module.exports = false;\n}\n","/**\n * Module requirements.\n */\n\nvar XMLHttpRequest = require('xmlhttprequest-ssl');\nvar Polling = require('./polling');\nvar Emitter = require('component-emitter');\nvar inherit = require('component-inherit');\nvar debug = require('debug')('engine.io-client:polling-xhr');\n\n/**\n * Module exports.\n */\n\nmodule.exports = XHR;\nmodule.exports.Request = Request;\n\n/**\n * Empty function\n */\n\nfunction empty () {}\n\n/**\n * XHR Polling constructor.\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction XHR (opts) {\n  Polling.call(this, opts);\n  this.requestTimeout = opts.requestTimeout;\n  this.extraHeaders = opts.extraHeaders;\n\n  if (global.location) {\n    var isSSL = 'https:' === location.protocol;\n    var port = location.port;\n\n    // some user agents have empty `location.port`\n    if (!port) {\n      port = isSSL ? 443 : 80;\n    }\n\n    this.xd = opts.hostname !== global.location.hostname ||\n      port !== opts.port;\n    this.xs = opts.secure !== isSSL;\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(XHR, Polling);\n\n/**\n * XHR supports binary\n */\n\nXHR.prototype.supportsBinary = true;\n\n/**\n * Creates a request.\n *\n * @param {String} method\n * @api private\n */\n\nXHR.prototype.request = function (opts) {\n  opts = opts || {};\n  opts.uri = this.uri();\n  opts.xd = this.xd;\n  opts.xs = this.xs;\n  opts.agent = this.agent || false;\n  opts.supportsBinary = this.supportsBinary;\n  opts.enablesXDR = this.enablesXDR;\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n  opts.requestTimeout = this.requestTimeout;\n\n  // other options for Node.js client\n  opts.extraHeaders = this.extraHeaders;\n\n  return new Request(opts);\n};\n\n/**\n * Sends data.\n *\n * @param {String} data to send.\n * @param {Function} called upon flush.\n * @api private\n */\n\nXHR.prototype.doWrite = function (data, fn) {\n  var isBinary = typeof data !== 'string' && data !== undefined;\n  var req = this.request({ method: 'POST', data: data, isBinary: isBinary });\n  var self = this;\n  req.on('success', fn);\n  req.on('error', function (err) {\n    self.onError('xhr post error', err);\n  });\n  this.sendXhr = req;\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nXHR.prototype.doPoll = function () {\n  debug('xhr poll');\n  var req = this.request();\n  var self = this;\n  req.on('data', function (data) {\n    self.onData(data);\n  });\n  req.on('error', function (err) {\n    self.onError('xhr poll error', err);\n  });\n  this.pollXhr = req;\n};\n\n/**\n * Request constructor\n *\n * @param {Object} options\n * @api public\n */\n\nfunction Request (opts) {\n  this.method = opts.method || 'GET';\n  this.uri = opts.uri;\n  this.xd = !!opts.xd;\n  this.xs = !!opts.xs;\n  this.async = false !== opts.async;\n  this.data = undefined !== opts.data ? opts.data : null;\n  this.agent = opts.agent;\n  this.isBinary = opts.isBinary;\n  this.supportsBinary = opts.supportsBinary;\n  this.enablesXDR = opts.enablesXDR;\n  this.requestTimeout = opts.requestTimeout;\n\n  // SSL options for Node.js client\n  this.pfx = opts.pfx;\n  this.key = opts.key;\n  this.passphrase = opts.passphrase;\n  this.cert = opts.cert;\n  this.ca = opts.ca;\n  this.ciphers = opts.ciphers;\n  this.rejectUnauthorized = opts.rejectUnauthorized;\n\n  // other options for Node.js client\n  this.extraHeaders = opts.extraHeaders;\n\n  this.create();\n}\n\n/**\n * Mix in `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Creates the XHR object and sends the request.\n *\n * @api private\n */\n\nRequest.prototype.create = function () {\n  var opts = { agent: this.agent, xdomain: this.xd, xscheme: this.xs, enablesXDR: this.enablesXDR };\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n\n  var xhr = this.xhr = new XMLHttpRequest(opts);\n  var self = this;\n\n  try {\n    debug('xhr open %s: %s', this.method, this.uri);\n    xhr.open(this.method, this.uri, this.async);\n    try {\n      if (this.extraHeaders) {\n        xhr.setDisableHeaderCheck && xhr.setDisableHeaderCheck(true);\n        for (var i in this.extraHeaders) {\n          if (this.extraHeaders.hasOwnProperty(i)) {\n            xhr.setRequestHeader(i, this.extraHeaders[i]);\n          }\n        }\n      }\n    } catch (e) {}\n\n    if ('POST' === this.method) {\n      try {\n        if (this.isBinary) {\n          xhr.setRequestHeader('Content-type', 'application/octet-stream');\n        } else {\n          xhr.setRequestHeader('Content-type', 'text/plain;charset=UTF-8');\n        }\n      } catch (e) {}\n    }\n\n    try {\n      xhr.setRequestHeader('Accept', '*/*');\n    } catch (e) {}\n\n    // ie6 check\n    if ('withCredentials' in xhr) {\n      xhr.withCredentials = true;\n    }\n\n    if (this.requestTimeout) {\n      xhr.timeout = this.requestTimeout;\n    }\n\n    if (this.hasXDR()) {\n      xhr.onload = function () {\n        self.onLoad();\n      };\n      xhr.onerror = function () {\n        self.onError(xhr.responseText);\n      };\n    } else {\n      xhr.onreadystatechange = function () {\n        if (xhr.readyState === 2) {\n          try {\n            var contentType = xhr.getResponseHeader('Content-Type');\n            if (self.supportsBinary && contentType === 'application/octet-stream') {\n              xhr.responseType = 'arraybuffer';\n            }\n          } catch (e) {}\n        }\n        if (4 !== xhr.readyState) return;\n        if (200 === xhr.status || 1223 === xhr.status) {\n          self.onLoad();\n        } else {\n          // make sure the `error` event handler that's user-set\n          // does not throw in the same tick and gets caught here\n          setTimeout(function () {\n            self.onError(xhr.status);\n          }, 0);\n        }\n      };\n    }\n\n    debug('xhr data %s', this.data);\n    xhr.send(this.data);\n  } catch (e) {\n    // Need to defer since .create() is called directly fhrom the constructor\n    // and thus the 'error' event can only be only bound *after* this exception\n    // occurs.  Therefore, also, we cannot throw here at all.\n    setTimeout(function () {\n      self.onError(e);\n    }, 0);\n    return;\n  }\n\n  if (global.document) {\n    this.index = Request.requestsCount++;\n    Request.requests[this.index] = this;\n  }\n};\n\n/**\n * Called upon successful response.\n *\n * @api private\n */\n\nRequest.prototype.onSuccess = function () {\n  this.emit('success');\n  this.cleanup();\n};\n\n/**\n * Called if we have data.\n *\n * @api private\n */\n\nRequest.prototype.onData = function (data) {\n  this.emit('data', data);\n  this.onSuccess();\n};\n\n/**\n * Called upon error.\n *\n * @api private\n */\n\nRequest.prototype.onError = function (err) {\n  this.emit('error', err);\n  this.cleanup(true);\n};\n\n/**\n * Cleans up house.\n *\n * @api private\n */\n\nRequest.prototype.cleanup = function (fromError) {\n  if ('undefined' === typeof this.xhr || null === this.xhr) {\n    return;\n  }\n  // xmlhttprequest\n  if (this.hasXDR()) {\n    this.xhr.onload = this.xhr.onerror = empty;\n  } else {\n    this.xhr.onreadystatechange = empty;\n  }\n\n  if (fromError) {\n    try {\n      this.xhr.abort();\n    } catch (e) {}\n  }\n\n  if (global.document) {\n    delete Request.requests[this.index];\n  }\n\n  this.xhr = null;\n};\n\n/**\n * Called upon load.\n *\n * @api private\n */\n\nRequest.prototype.onLoad = function () {\n  var data;\n  try {\n    var contentType;\n    try {\n      contentType = this.xhr.getResponseHeader('Content-Type');\n    } catch (e) {}\n    if (contentType === 'application/octet-stream') {\n      data = this.xhr.response || this.xhr.responseText;\n    } else {\n      data = this.xhr.responseText;\n    }\n  } catch (e) {\n    this.onError(e);\n  }\n  if (null != data) {\n    this.onData(data);\n  }\n};\n\n/**\n * Check if it has XDomainRequest.\n *\n * @api private\n */\n\nRequest.prototype.hasXDR = function () {\n  return 'undefined' !== typeof global.XDomainRequest && !this.xs && this.enablesXDR;\n};\n\n/**\n * Aborts the request.\n *\n * @api public\n */\n\nRequest.prototype.abort = function () {\n  this.cleanup();\n};\n\n/**\n * Aborts pending requests when unloading the window. This is needed to prevent\n * memory leaks (e.g. when using IE) and to ensure that no spurious error is\n * emitted.\n */\n\nRequest.requestsCount = 0;\nRequest.requests = {};\n\nif (global.document) {\n  if (global.attachEvent) {\n    global.attachEvent('onunload', unloadHandler);\n  } else if (global.addEventListener) {\n    global.addEventListener('beforeunload', unloadHandler, false);\n  }\n}\n\nfunction unloadHandler () {\n  for (var i in Request.requests) {\n    if (Request.requests.hasOwnProperty(i)) {\n      Request.requests[i].abort();\n    }\n  }\n}\n","\n/**\n * Gets the keys for an object.\n *\n * @return {Array} keys\n * @api private\n */\n\nmodule.exports = Object.keys || function keys (obj){\n  var arr = [];\n  var has = Object.prototype.hasOwnProperty;\n\n  for (var i in obj) {\n    if (has.call(obj, i)) {\n      arr.push(i);\n    }\n  }\n  return arr;\n};\n","/**\n * An abstraction for slicing an arraybuffer even when\n * ArrayBuffer.prototype.slice is not supported\n *\n * @api public\n */\n\nmodule.exports = function(arraybuffer, start, end) {\n  var bytes = arraybuffer.byteLength;\n  start = start || 0;\n  end = end || bytes;\n\n  if (arraybuffer.slice) { return arraybuffer.slice(start, end); }\n\n  if (start < 0) { start += bytes; }\n  if (end < 0) { end += bytes; }\n  if (end > bytes) { end = bytes; }\n\n  if (start >= bytes || start >= end || bytes === 0) {\n    return new ArrayBuffer(0);\n  }\n\n  var abv = new Uint8Array(arraybuffer);\n  var result = new Uint8Array(end - start);\n  for (var i = start, ii = 0; i < end; i++, ii++) {\n    result[ii] = abv[i];\n  }\n  return result.buffer;\n};\n","module.exports = after\n\nfunction after(count, callback, err_cb) {\n    var bail = false\n    err_cb = err_cb || noop\n    proxy.count = count\n\n    return (count === 0) ? callback() : proxy\n\n    function proxy(err, result) {\n        if (proxy.count <= 0) {\n            throw new Error('after called too many times')\n        }\n        --proxy.count\n\n        // after first error, rest are passed to err_cb\n        if (err) {\n            bail = true\n            callback(err)\n            // future error callbacks will go to error handler\n            callback = err_cb\n        } else if (proxy.count === 0 && !bail) {\n            callback(null, result)\n        }\n    }\n}\n\nfunction noop() {}\n","/*! https://mths.be/utf8js v2.1.2 by @mathias */\n\nvar stringFromCharCode = String.fromCharCode;\n\n// Taken from https://mths.be/punycode\nfunction ucs2decode(string) {\n\tvar output = [];\n\tvar counter = 0;\n\tvar length = string.length;\n\tvar value;\n\tvar extra;\n\twhile (counter < length) {\n\t\tvalue = string.charCodeAt(counter++);\n\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t// high surrogate, and there is a next character\n\t\t\textra = string.charCodeAt(counter++);\n\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t} else {\n\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\toutput.push(value);\n\t\t\t\tcounter--;\n\t\t\t}\n\t\t} else {\n\t\t\toutput.push(value);\n\t\t}\n\t}\n\treturn output;\n}\n\n// Taken from https://mths.be/punycode\nfunction ucs2encode(array) {\n\tvar length = array.length;\n\tvar index = -1;\n\tvar value;\n\tvar output = '';\n\twhile (++index < length) {\n\t\tvalue = array[index];\n\t\tif (value > 0xFFFF) {\n\t\t\tvalue -= 0x10000;\n\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t}\n\t\toutput += stringFromCharCode(value);\n\t}\n\treturn output;\n}\n\nfunction checkScalarValue(codePoint, strict) {\n\tif (codePoint >= 0xD800 && codePoint <= 0xDFFF) {\n\t\tif (strict) {\n\t\t\tthrow Error(\n\t\t\t\t'Lone surrogate U+' + codePoint.toString(16).toUpperCase() +\n\t\t\t\t' is not a scalar value'\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\treturn true;\n}\n/*--------------------------------------------------------------------------*/\n\nfunction createByte(codePoint, shift) {\n\treturn stringFromCharCode(((codePoint >> shift) & 0x3F) | 0x80);\n}\n\nfunction encodeCodePoint(codePoint, strict) {\n\tif ((codePoint & 0xFFFFFF80) == 0) { // 1-byte sequence\n\t\treturn stringFromCharCode(codePoint);\n\t}\n\tvar symbol = '';\n\tif ((codePoint & 0xFFFFF800) == 0) { // 2-byte sequence\n\t\tsymbol = stringFromCharCode(((codePoint >> 6) & 0x1F) | 0xC0);\n\t}\n\telse if ((codePoint & 0xFFFF0000) == 0) { // 3-byte sequence\n\t\tif (!checkScalarValue(codePoint, strict)) {\n\t\t\tcodePoint = 0xFFFD;\n\t\t}\n\t\tsymbol = stringFromCharCode(((codePoint >> 12) & 0x0F) | 0xE0);\n\t\tsymbol += createByte(codePoint, 6);\n\t}\n\telse if ((codePoint & 0xFFE00000) == 0) { // 4-byte sequence\n\t\tsymbol = stringFromCharCode(((codePoint >> 18) & 0x07) | 0xF0);\n\t\tsymbol += createByte(codePoint, 12);\n\t\tsymbol += createByte(codePoint, 6);\n\t}\n\tsymbol += stringFromCharCode((codePoint & 0x3F) | 0x80);\n\treturn symbol;\n}\n\nfunction utf8encode(string, opts) {\n\topts = opts || {};\n\tvar strict = false !== opts.strict;\n\n\tvar codePoints = ucs2decode(string);\n\tvar length = codePoints.length;\n\tvar index = -1;\n\tvar codePoint;\n\tvar byteString = '';\n\twhile (++index < length) {\n\t\tcodePoint = codePoints[index];\n\t\tbyteString += encodeCodePoint(codePoint, strict);\n\t}\n\treturn byteString;\n}\n\n/*--------------------------------------------------------------------------*/\n\nfunction readContinuationByte() {\n\tif (byteIndex >= byteCount) {\n\t\tthrow Error('Invalid byte index');\n\t}\n\n\tvar continuationByte = byteArray[byteIndex] & 0xFF;\n\tbyteIndex++;\n\n\tif ((continuationByte & 0xC0) == 0x80) {\n\t\treturn continuationByte & 0x3F;\n\t}\n\n\t// If we end up here, it’s not a continuation byte\n\tthrow Error('Invalid continuation byte');\n}\n\nfunction decodeSymbol(strict) {\n\tvar byte1;\n\tvar byte2;\n\tvar byte3;\n\tvar byte4;\n\tvar codePoint;\n\n\tif (byteIndex > byteCount) {\n\t\tthrow Error('Invalid byte index');\n\t}\n\n\tif (byteIndex == byteCount) {\n\t\treturn false;\n\t}\n\n\t// Read first byte\n\tbyte1 = byteArray[byteIndex] & 0xFF;\n\tbyteIndex++;\n\n\t// 1-byte sequence (no continuation bytes)\n\tif ((byte1 & 0x80) == 0) {\n\t\treturn byte1;\n\t}\n\n\t// 2-byte sequence\n\tif ((byte1 & 0xE0) == 0xC0) {\n\t\tbyte2 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x1F) << 6) | byte2;\n\t\tif (codePoint >= 0x80) {\n\t\t\treturn codePoint;\n\t\t} else {\n\t\t\tthrow Error('Invalid continuation byte');\n\t\t}\n\t}\n\n\t// 3-byte sequence (may include unpaired surrogates)\n\tif ((byte1 & 0xF0) == 0xE0) {\n\t\tbyte2 = readContinuationByte();\n\t\tbyte3 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x0F) << 12) | (byte2 << 6) | byte3;\n\t\tif (codePoint >= 0x0800) {\n\t\t\treturn checkScalarValue(codePoint, strict) ? codePoint : 0xFFFD;\n\t\t} else {\n\t\t\tthrow Error('Invalid continuation byte');\n\t\t}\n\t}\n\n\t// 4-byte sequence\n\tif ((byte1 & 0xF8) == 0xF0) {\n\t\tbyte2 = readContinuationByte();\n\t\tbyte3 = readContinuationByte();\n\t\tbyte4 = readContinuationByte();\n\t\tcodePoint = ((byte1 & 0x07) << 0x12) | (byte2 << 0x0C) |\n\t\t\t(byte3 << 0x06) | byte4;\n\t\tif (codePoint >= 0x010000 && codePoint <= 0x10FFFF) {\n\t\t\treturn codePoint;\n\t\t}\n\t}\n\n\tthrow Error('Invalid UTF-8 detected');\n}\n\nvar byteArray;\nvar byteCount;\nvar byteIndex;\nfunction utf8decode(byteString, opts) {\n\topts = opts || {};\n\tvar strict = false !== opts.strict;\n\n\tbyteArray = ucs2decode(byteString);\n\tbyteCount = byteArray.length;\n\tbyteIndex = 0;\n\tvar codePoints = [];\n\tvar tmp;\n\twhile ((tmp = decodeSymbol(strict)) !== false) {\n\t\tcodePoints.push(tmp);\n\t}\n\treturn ucs2encode(codePoints);\n}\n\nmodule.exports = {\n\tversion: '2.1.2',\n\tencode: utf8encode,\n\tdecode: utf8decode\n};\n","/*\n * base64-arraybuffer\n * https://github.com/niklasvh/base64-arraybuffer\n *\n * Copyright (c) 2012 Niklas von Hertzen\n * Licensed under the MIT license.\n */\n(function(){\n  \"use strict\";\n\n  var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\n  // Use a lookup table to find the index.\n  var lookup = new Uint8Array(256);\n  for (var i = 0; i < chars.length; i++) {\n    lookup[chars.charCodeAt(i)] = i;\n  }\n\n  exports.encode = function(arraybuffer) {\n    var bytes = new Uint8Array(arraybuffer),\n    i, len = bytes.length, base64 = \"\";\n\n    for (i = 0; i < len; i+=3) {\n      base64 += chars[bytes[i] >> 2];\n      base64 += chars[((bytes[i] & 3) << 4) | (bytes[i + 1] >> 4)];\n      base64 += chars[((bytes[i + 1] & 15) << 2) | (bytes[i + 2] >> 6)];\n      base64 += chars[bytes[i + 2] & 63];\n    }\n\n    if ((len % 3) === 2) {\n      base64 = base64.substring(0, base64.length - 1) + \"=\";\n    } else if (len % 3 === 1) {\n      base64 = base64.substring(0, base64.length - 2) + \"==\";\n    }\n\n    return base64;\n  };\n\n  exports.decode =  function(base64) {\n    var bufferLength = base64.length * 0.75,\n    len = base64.length, i, p = 0,\n    encoded1, encoded2, encoded3, encoded4;\n\n    if (base64[base64.length - 1] === \"=\") {\n      bufferLength--;\n      if (base64[base64.length - 2] === \"=\") {\n        bufferLength--;\n      }\n    }\n\n    var arraybuffer = new ArrayBuffer(bufferLength),\n    bytes = new Uint8Array(arraybuffer);\n\n    for (i = 0; i < len; i+=4) {\n      encoded1 = lookup[base64.charCodeAt(i)];\n      encoded2 = lookup[base64.charCodeAt(i+1)];\n      encoded3 = lookup[base64.charCodeAt(i+2)];\n      encoded4 = lookup[base64.charCodeAt(i+3)];\n\n      bytes[p++] = (encoded1 << 2) | (encoded2 >> 4);\n      bytes[p++] = ((encoded2 & 15) << 4) | (encoded3 >> 2);\n      bytes[p++] = ((encoded3 & 3) << 6) | (encoded4 & 63);\n    }\n\n    return arraybuffer;\n  };\n})();\n","/**\r\n * Create a blob builder even when vendor prefixes exist\r\n */\r\n\r\nvar BlobBuilder = typeof BlobBuilder !== 'undefined' ? BlobBuilder :\r\n  typeof WebKitBlobBuilder !== 'undefined' ? WebKitBlobBuilder :\r\n  typeof MSBlobBuilder !== 'undefined' ? MSBlobBuilder :\r\n  typeof MozBlobBuilder !== 'undefined' ? MozBlobBuilder : \r\n  false;\r\n\r\n/**\r\n * Check if Blob constructor is supported\r\n */\r\n\r\nvar blobSupported = (function() {\r\n  try {\r\n    var a = new Blob(['hi']);\r\n    return a.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if Blob constructor supports ArrayBufferViews\r\n * Fails in Safari 6, so we need to map to ArrayBuffers there.\r\n */\r\n\r\nvar blobSupportsArrayBufferView = blobSupported && (function() {\r\n  try {\r\n    var b = new Blob([new Uint8Array([1,2])]);\r\n    return b.size === 2;\r\n  } catch(e) {\r\n    return false;\r\n  }\r\n})();\r\n\r\n/**\r\n * Check if BlobBuilder is supported\r\n */\r\n\r\nvar blobBuilderSupported = BlobBuilder\r\n  && BlobBuilder.prototype.append\r\n  && BlobBuilder.prototype.getBlob;\r\n\r\n/**\r\n * Helper function that maps ArrayBufferViews to ArrayBuffers\r\n * Used by BlobBuilder constructor and old browsers that didn't\r\n * support it in the Blob constructor.\r\n */\r\n\r\nfunction mapArrayBufferViews(ary) {\r\n  return ary.map(function(chunk) {\r\n    if (chunk.buffer instanceof ArrayBuffer) {\r\n      var buf = chunk.buffer;\r\n\r\n      // if this is a subarray, make a copy so we only\r\n      // include the subarray region from the underlying buffer\r\n      if (chunk.byteLength !== buf.byteLength) {\r\n        var copy = new Uint8Array(chunk.byteLength);\r\n        copy.set(new Uint8Array(buf, chunk.byteOffset, chunk.byteLength));\r\n        buf = copy.buffer;\r\n      }\r\n\r\n      return buf;\r\n    }\r\n\r\n    return chunk;\r\n  });\r\n}\r\n\r\nfunction BlobBuilderConstructor(ary, options) {\r\n  options = options || {};\r\n\r\n  var bb = new BlobBuilder();\r\n  mapArrayBufferViews(ary).forEach(function(part) {\r\n    bb.append(part);\r\n  });\r\n\r\n  return (options.type) ? bb.getBlob(options.type) : bb.getBlob();\r\n};\r\n\r\nfunction BlobConstructor(ary, options) {\r\n  return new Blob(mapArrayBufferViews(ary), options || {});\r\n};\r\n\r\nif (typeof Blob !== 'undefined') {\r\n  BlobBuilderConstructor.prototype = Blob.prototype;\r\n  BlobConstructor.prototype = Blob.prototype;\r\n}\r\n\r\nmodule.exports = (function() {\r\n  if (blobSupported) {\r\n    return blobSupportsArrayBufferView ? Blob : BlobConstructor;\r\n  } else if (blobBuilderSupported) {\r\n    return BlobBuilderConstructor;\r\n  } else {\r\n    return undefined;\r\n  }\r\n})();\r\n","\n/**\n * Module requirements.\n */\n\nvar Polling = require('./polling');\nvar inherit = require('component-inherit');\n\n/**\n * Module exports.\n */\n\nmodule.exports = JSONPPolling;\n\n/**\n * Cached regular expressions.\n */\n\nvar rNewline = /\\n/g;\nvar rEscapedNewline = /\\\\n/g;\n\n/**\n * Global JSONP callbacks.\n */\n\nvar callbacks;\n\n/**\n * Noop.\n */\n\nfunction empty () { }\n\n/**\n * JSONP Polling constructor.\n *\n * @param {Object} opts.\n * @api public\n */\n\nfunction JSONPPolling (opts) {\n  Polling.call(this, opts);\n\n  this.query = this.query || {};\n\n  // define global callbacks array if not present\n  // we do this here (lazily) to avoid unneeded global pollution\n  if (!callbacks) {\n    // we need to consider multiple engines in the same page\n    if (!global.___eio) global.___eio = [];\n    callbacks = global.___eio;\n  }\n\n  // callback identifier\n  this.index = callbacks.length;\n\n  // add callback to jsonp global\n  var self = this;\n  callbacks.push(function (msg) {\n    self.onData(msg);\n  });\n\n  // append to query string\n  this.query.j = this.index;\n\n  // prevent spurious errors from being emitted when the window is unloaded\n  if (global.document && global.addEventListener) {\n    global.addEventListener('beforeunload', function () {\n      if (self.script) self.script.onerror = empty;\n    }, false);\n  }\n}\n\n/**\n * Inherits from Polling.\n */\n\ninherit(JSONPPolling, Polling);\n\n/*\n * JSONP only supports binary as base64 encoded strings\n */\n\nJSONPPolling.prototype.supportsBinary = false;\n\n/**\n * Closes the socket.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doClose = function () {\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  if (this.form) {\n    this.form.parentNode.removeChild(this.form);\n    this.form = null;\n    this.iframe = null;\n  }\n\n  Polling.prototype.doClose.call(this);\n};\n\n/**\n * Starts a poll cycle.\n *\n * @api private\n */\n\nJSONPPolling.prototype.doPoll = function () {\n  var self = this;\n  var script = document.createElement('script');\n\n  if (this.script) {\n    this.script.parentNode.removeChild(this.script);\n    this.script = null;\n  }\n\n  script.async = true;\n  script.src = this.uri();\n  script.onerror = function (e) {\n    self.onError('jsonp poll error', e);\n  };\n\n  var insertAt = document.getElementsByTagName('script')[0];\n  if (insertAt) {\n    insertAt.parentNode.insertBefore(script, insertAt);\n  } else {\n    (document.head || document.body).appendChild(script);\n  }\n  this.script = script;\n\n  var isUAgecko = 'undefined' !== typeof navigator && /gecko/i.test(navigator.userAgent);\n\n  if (isUAgecko) {\n    setTimeout(function () {\n      var iframe = document.createElement('iframe');\n      document.body.appendChild(iframe);\n      document.body.removeChild(iframe);\n    }, 100);\n  }\n};\n\n/**\n * Writes with a hidden iframe.\n *\n * @param {String} data to send\n * @param {Function} called upon flush.\n * @api private\n */\n\nJSONPPolling.prototype.doWrite = function (data, fn) {\n  var self = this;\n\n  if (!this.form) {\n    var form = document.createElement('form');\n    var area = document.createElement('textarea');\n    var id = this.iframeId = 'eio_iframe_' + this.index;\n    var iframe;\n\n    form.className = 'socketio';\n    form.style.position = 'absolute';\n    form.style.top = '-1000px';\n    form.style.left = '-1000px';\n    form.target = id;\n    form.method = 'POST';\n    form.setAttribute('accept-charset', 'utf-8');\n    area.name = 'd';\n    form.appendChild(area);\n    document.body.appendChild(form);\n\n    this.form = form;\n    this.area = area;\n  }\n\n  this.form.action = this.uri();\n\n  function complete () {\n    initIframe();\n    fn();\n  }\n\n  function initIframe () {\n    if (self.iframe) {\n      try {\n        self.form.removeChild(self.iframe);\n      } catch (e) {\n        self.onError('jsonp polling iframe removal error', e);\n      }\n    }\n\n    try {\n      // ie6 dynamic iframes with target=\"\" support (thanks Chris Lambacher)\n      var html = '<iframe src=\"javascript:0\" name=\"' + self.iframeId + '\">';\n      iframe = document.createElement(html);\n    } catch (e) {\n      iframe = document.createElement('iframe');\n      iframe.name = self.iframeId;\n      iframe.src = 'javascript:0';\n    }\n\n    iframe.id = self.iframeId;\n\n    self.form.appendChild(iframe);\n    self.iframe = iframe;\n  }\n\n  initIframe();\n\n  // escape \\n to prevent it from being converted into \\r\\n by some UAs\n  // double escaping is required for escaped new lines because unescaping of new lines can be done safely on server-side\n  data = data.replace(rEscapedNewline, '\\\\\\n');\n  this.area.value = data.replace(rNewline, '\\\\n');\n\n  try {\n    this.form.submit();\n  } catch (e) {}\n\n  if (this.iframe.attachEvent) {\n    this.iframe.onreadystatechange = function () {\n      if (self.iframe.readyState === 'complete') {\n        complete();\n      }\n    };\n  } else {\n    this.iframe.onload = complete;\n  }\n};\n","/**\n * Module dependencies.\n */\n\nvar Transport = require('../transport');\nvar parser = require('engine.io-parser');\nvar parseqs = require('parseqs');\nvar inherit = require('component-inherit');\nvar yeast = require('yeast');\nvar debug = require('debug')('engine.io-client:websocket');\nvar BrowserWebSocket = global.WebSocket || global.MozWebSocket;\nvar NodeWebSocket;\nif (typeof window === 'undefined') {\n  try {\n    NodeWebSocket = require('ws');\n  } catch (e) { }\n}\n\n/**\n * Get either the `WebSocket` or `MozWebSocket` globals\n * in the browser or try to resolve WebSocket-compatible\n * interface exposed by `ws` for Node-like environment.\n */\n\nvar WebSocket = BrowserWebSocket;\nif (!WebSocket && typeof window === 'undefined') {\n  WebSocket = NodeWebSocket;\n}\n\n/**\n * Module exports.\n */\n\nmodule.exports = WS;\n\n/**\n * WebSocket transport constructor.\n *\n * @api {Object} connection options\n * @api public\n */\n\nfunction WS (opts) {\n  var forceBase64 = (opts && opts.forceBase64);\n  if (forceBase64) {\n    this.supportsBinary = false;\n  }\n  this.perMessageDeflate = opts.perMessageDeflate;\n  this.usingBrowserWebSocket = BrowserWebSocket && !opts.forceNode;\n  this.protocols = opts.protocols;\n  if (!this.usingBrowserWebSocket) {\n    WebSocket = NodeWebSocket;\n  }\n  Transport.call(this, opts);\n}\n\n/**\n * Inherits from Transport.\n */\n\ninherit(WS, Transport);\n\n/**\n * Transport name.\n *\n * @api public\n */\n\nWS.prototype.name = 'websocket';\n\n/*\n * WebSockets support binary\n */\n\nWS.prototype.supportsBinary = true;\n\n/**\n * Opens socket.\n *\n * @api private\n */\n\nWS.prototype.doOpen = function () {\n  if (!this.check()) {\n    // let probe timeout\n    return;\n  }\n\n  var uri = this.uri();\n  var protocols = this.protocols;\n  var opts = {\n    agent: this.agent,\n    perMessageDeflate: this.perMessageDeflate\n  };\n\n  // SSL options for Node.js client\n  opts.pfx = this.pfx;\n  opts.key = this.key;\n  opts.passphrase = this.passphrase;\n  opts.cert = this.cert;\n  opts.ca = this.ca;\n  opts.ciphers = this.ciphers;\n  opts.rejectUnauthorized = this.rejectUnauthorized;\n  if (this.extraHeaders) {\n    opts.headers = this.extraHeaders;\n  }\n  if (this.localAddress) {\n    opts.localAddress = this.localAddress;\n  }\n\n  try {\n    this.ws = this.usingBrowserWebSocket ? (protocols ? new WebSocket(uri, protocols) : new WebSocket(uri)) : new WebSocket(uri, protocols, opts);\n  } catch (err) {\n    return this.emit('error', err);\n  }\n\n  if (this.ws.binaryType === undefined) {\n    this.supportsBinary = false;\n  }\n\n  if (this.ws.supports && this.ws.supports.binary) {\n    this.supportsBinary = true;\n    this.ws.binaryType = 'nodebuffer';\n  } else {\n    this.ws.binaryType = 'arraybuffer';\n  }\n\n  this.addEventListeners();\n};\n\n/**\n * Adds event listeners to the socket\n *\n * @api private\n */\n\nWS.prototype.addEventListeners = function () {\n  var self = this;\n\n  this.ws.onopen = function () {\n    self.onOpen();\n  };\n  this.ws.onclose = function () {\n    self.onClose();\n  };\n  this.ws.onmessage = function (ev) {\n    self.onData(ev.data);\n  };\n  this.ws.onerror = function (e) {\n    self.onError('websocket error', e);\n  };\n};\n\n/**\n * Writes data to socket.\n *\n * @param {Array} array of packets.\n * @api private\n */\n\nWS.prototype.write = function (packets) {\n  var self = this;\n  this.writable = false;\n\n  // encodePacket efficient as it uses WS framing\n  // no need for encodePayload\n  var total = packets.length;\n  for (var i = 0, l = total; i < l; i++) {\n    (function (packet) {\n      parser.encodePacket(packet, self.supportsBinary, function (data) {\n        if (!self.usingBrowserWebSocket) {\n          // always create a new object (GH-437)\n          var opts = {};\n          if (packet.options) {\n            opts.compress = packet.options.compress;\n          }\n\n          if (self.perMessageDeflate) {\n            var len = 'string' === typeof data ? global.Buffer.byteLength(data) : data.length;\n            if (len < self.perMessageDeflate.threshold) {\n              opts.compress = false;\n            }\n          }\n        }\n\n        // Sometimes the websocket has already been closed but the browser didn't\n        // have a chance of informing us about it yet, in that case send will\n        // throw an error\n        try {\n          if (self.usingBrowserWebSocket) {\n            // TypeError is thrown when passing the second argument on Safari\n            self.ws.send(data);\n          } else {\n            self.ws.send(data, opts);\n          }\n        } catch (e) {\n          debug('websocket closed before onclose event');\n        }\n\n        --total || done();\n      });\n    })(packets[i]);\n  }\n\n  function done () {\n    self.emit('flush');\n\n    // fake drain\n    // defer to next tick to allow Socket to clear writeBuffer\n    setTimeout(function () {\n      self.writable = true;\n      self.emit('drain');\n    }, 0);\n  }\n};\n\n/**\n * Called upon close\n *\n * @api private\n */\n\nWS.prototype.onClose = function () {\n  Transport.prototype.onClose.call(this);\n};\n\n/**\n * Closes socket.\n *\n * @api private\n */\n\nWS.prototype.doClose = function () {\n  if (typeof this.ws !== 'undefined') {\n    this.ws.close();\n  }\n};\n\n/**\n * Generates uri for connection.\n *\n * @api private\n */\n\nWS.prototype.uri = function () {\n  var query = this.query || {};\n  var schema = this.secure ? 'wss' : 'ws';\n  var port = '';\n\n  // avoid port if default for schema\n  if (this.port && (('wss' === schema && Number(this.port) !== 443) ||\n    ('ws' === schema && Number(this.port) !== 80))) {\n    port = ':' + this.port;\n  }\n\n  // append timestamp to URI\n  if (this.timestampRequests) {\n    query[this.timestampParam] = yeast();\n  }\n\n  // communicate binary support capabilities\n  if (!this.supportsBinary) {\n    query.b64 = 1;\n  }\n\n  query = parseqs.encode(query);\n\n  // prepend ? to query\n  if (query.length) {\n    query = '?' + query;\n  }\n\n  var ipv6 = this.hostname.indexOf(':') !== -1;\n  return schema + '://' + (ipv6 ? '[' + this.hostname + ']' : this.hostname) + port + this.path + query;\n};\n\n/**\n * Feature detection for WebSocket.\n *\n * @return {Boolean} whether this transport is available.\n * @api public\n */\n\nWS.prototype.check = function () {\n  return !!WebSocket && !('__initialize' in WebSocket && this.name === WS.prototype.name);\n};\n","module.exports = toArray\n\nfunction toArray(list, index) {\n    var array = []\n\n    index = index || 0\n\n    for (var i = index || 0; i < list.length; i++) {\n        array[i - index] = list[i]\n    }\n\n    return array\n}\n","\n/**\n * Expose `Backoff`.\n */\n\nmodule.exports = Backoff;\n\n/**\n * Initialize backoff timer with `opts`.\n *\n * - `min` initial timeout in milliseconds [100]\n * - `max` max timeout [10000]\n * - `jitter` [0]\n * - `factor` [2]\n *\n * @param {Object} opts\n * @api public\n */\n\nfunction Backoff(opts) {\n  opts = opts || {};\n  this.ms = opts.min || 100;\n  this.max = opts.max || 10000;\n  this.factor = opts.factor || 2;\n  this.jitter = opts.jitter > 0 && opts.jitter <= 1 ? opts.jitter : 0;\n  this.attempts = 0;\n}\n\n/**\n * Return the backoff duration.\n *\n * @return {Number}\n * @api public\n */\n\nBackoff.prototype.duration = function(){\n  var ms = this.ms * Math.pow(this.factor, this.attempts++);\n  if (this.jitter) {\n    var rand =  Math.random();\n    var deviation = Math.floor(rand * this.jitter * ms);\n    ms = (Math.floor(rand * 10) & 1) == 0  ? ms - deviation : ms + deviation;\n  }\n  return Math.min(ms, this.max) | 0;\n};\n\n/**\n * Reset the number of attempts.\n *\n * @api public\n */\n\nBackoff.prototype.reset = function(){\n  this.attempts = 0;\n};\n\n/**\n * Set the minimum duration\n *\n * @api public\n */\n\nBackoff.prototype.setMin = function(min){\n  this.ms = min;\n};\n\n/**\n * Set the maximum duration\n *\n * @api public\n */\n\nBackoff.prototype.setMax = function(max){\n  this.max = max;\n};\n\n/**\n * Set the jitter\n *\n * @api public\n */\n\nBackoff.prototype.setJitter = function(jitter){\n  this.jitter = jitter;\n};\n\n","function showModal(opts) {\n  var modal = $('#notificationModal');\n  var ok = modal.find('#modal-ok');\n  var cancel = modal.find('#modal-cancel');\n\n  ok.unbind('click');\n  cancel.unbind('click');\n  modal.unbind('hidden.bs.modal');\n\n  opts.cancelButton = opts.cancelButton || 'Cancel';\n  opts.okButton = opts.okButton || 'OK';\n  opts.title = opts.title || chrome.runtime.getManifest().name;\n  opts.body = opts.body || '';\n\n  if (opts.hideCancel)\n    cancel.hide();\n  else\n    cancel.show();\n\n  ok.text(opts.okButton);\n  cancel.text(opts.cancelButton);\n  modal.find('#modal-title').text(opts.title);\n  modal.find('#modal-body').html(opts.body);\n\n  var clickedOk;\n  ok.click(function() {\n    clickedOk = true;\n    if (!opts.ok || !opts.ok())\n      $('#notificationModal').modal('hide');\n  });\n\n  if (opts.cancel) {\n    modal.on('hidden.bs.modal', function() {\n      if (!clickedOk)\n        opts.cancel();\n    })\n    cancel.click(opts.cancel);\n  }\n\n  $('#notificationModal').modal();\n\n  if (opts.duration) {\n    setTimeout(function() {\n      $('#notificationModal').modal('hide');\n    }, opts.duration)\n  }\n}\n\nfunction shortModal(title, body) {\n  showModal({\n    title: title,\n    body: body,\n    duration: 8000,\n    hideCancel: true\n  })\n}\n\nexports.showModal = showModal;\nexports.shortModal = shortModal;\n","function getDefaultDeviceSettings() {\n  var defaults = {\n    showSoftKeys: true,\n    pinTitleBar: true,\n    alwaysOnTop: false,\n    bitrate: 0,\n    resolution: 0,\n    decoder: 0,\n    displaySettings: commonDisplaySettings[0],\n    dimDisplay: false,\n  };\n  return defaults;\n}\n\nfunction sanitizeDeviceSettings(deviceSettings) {\n  if (!deviceSettings)\n    return null;\n  if (deviceSettings.friendlyName && !deviceSettings.friendlyName.length)\n    delete deviceSettings.friendlyName;\n  return deviceSettings;\n}\n\nfunction loadAllDeviceSettings(cb) {\n  if (window.chrome && window.chrome.storage) {\n    chrome.storage.local.get('device-settings', function(vals) {\n      cb(vals['device-settings'] || {});\n    });\n  }\n  else {\n    cb({});\n  }\n}\n\nfunction loadDeviceSettings(serialno, cb) {\n  if (!serialno)\n    serialno = 'web';\n  var defaults = getDefaultDeviceSettings();\n  if (serialno == 'inkwire') {\n    defaults.pinTitleBar = false;\n    defaults.showSoftKeys = false;\n  }\n  loadAllDeviceSettings(function(vals) {\n    cb(sanitizeDeviceSettings(vals[serialno] || defaults));\n  });\n}\n\nfunction saveDeviceSettings(serialno, deviceSettings, cb) {\n  sanitizeDeviceSettings(deviceSettings);\n  if (!window.chrome || !window.chrome.storage) {\n    if (cb)\n      cb();\n    return;\n  }\n\n  if (!serialno || serialno.indexOf('127.0.0.1') != -1) {\n    if (cb)\n      cb();\n    return;\n  }\n\n  loadAllDeviceSettings(function(vals) {\n    vals[serialno] = deviceSettings;\n    chrome.storage.local.set({\n      'device-settings': vals\n    }, cb);\n  })\n}\n\nfunction populateDisplaySettings() {\n  for (var i in commonDisplaySettings) {\n    var m = commonDisplaySettings[i];\n    var o = new Option();\n    $(o).html(m.name);\n    $(\"#display-settings\").append(o);\n  }\n}\n\nfunction applyDeviceSettings(deviceSettings) {\n  // must be || null cause undefined doesn't trigger a change\n  $('#new-display-name').prop('value', deviceSettings.friendlyName || null);\n  $(\"#softkeys-check\").prop('checked', deviceSettings.showSoftKeys ? true : false).change();\n  $(\"#pin-title-check\").prop('checked', deviceSettings.pinTitleBar ? true : false).change();\n  $(\"#always-on-top-check\").prop('checked', deviceSettings.alwaysOnTop ? true : false).change();\n  $(\"#bitrate\").prop('selectedIndex', deviceSettings.bitrate || 0);\n  $(\"#decoder\").prop('selectedIndex', deviceSettings.decoder || 0);\n  $(\"#resolution\").prop('selectedIndex', deviceSettings.resolution || 0);\n\n  var dname = deviceSettings.displaySettings && deviceSettings.displaySettings.name;\n  var matched = 0;\n  for (var i in commonDisplaySettings) {\n    var m = commonDisplaySettings[i];\n    if (m.name == dname) {\n      matched = i;\n      break;\n    }\n  }\n\n  $(\"#display-settings\").prop('selectedIndex', matched);\n  $(\"#dim-display\").prop('checked', deviceSettings.dimDisplay ? true : false);\n  $(\"#auto-audio\").prop('checked', deviceSettings.autoAudio ? true : false);\n}\n\nvar commonDisplaySettings = [\n  {\n    name: 'Default Settings',\n    size: 'reset',\n    density: 'reset',\n  },\n  {\n    name: 'Resizable (96dpi)',\n    size: 'reset',\n    density: '96',\n    freeSize: true,\n  },\n  {\n    name: 'Resizable (144dpi)',\n    size: 'reset',\n    density: '144',\n    freeSize: true,\n  },\n  {\n    name: '1080p (96dpi)',\n    size: '1920x1080',\n    density: '96',\n  },\n  {\n    name: '4K (144dpi)',\n    size: '3840x2160',\n    density: '144',\n  },\n  {\n    name: 'Galaxy Nexus',\n    size: '720x1280',\n    density: '320',\n  },\n  {\n    name: 'Nexus 4',\n    size: '768x1280',\n    density: '320',\n  },\n  {\n    name: 'Nexus 5',\n    size: '1080x1920',\n    density: '480',\n  },\n  {\n    name: 'Nexus 6',\n    size: '1440x2560',\n    density: '560',\n  },\n  {\n    name: 'Nexus 6p',\n    size: '1440x2560',\n    density: '560',\n  },\n  {\n    name: 'Nexus 7 (2012)',\n    size: '800x1280',\n    density: '213',\n  },\n  {\n    name: 'Nexus 7 (2013)',\n    size: '1200x1920',\n    density: '320',\n  },\n  {\n    name: 'Nexus 9',\n    size: '1536x2048',\n    density: '320',\n  },\n]\n\nexports.populateDisplaySettings = populateDisplaySettings;\nexports.loadDeviceSettings = loadDeviceSettings;\nexports.applyDeviceSettings = applyDeviceSettings;\nexports.saveDeviceSettings = saveDeviceSettings;","module.exports = function() {\n  return new Worker(__webpack_public_path__ + \"a792e79601db595bfb45.worker.js\");\n};","var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar Module = function () {\n  var _scriptDir = typeof document !== 'undefined' && document.currentScript ? document.currentScript.src : undefined;\n\n  return function (Module) {\n    Module = Module || {};\n\n    var Module;if (!Module) Module = typeof Module !== 'undefined' ? Module : {};var moduleOverrides = {};var key;for (key in Module) {\n      if (Module.hasOwnProperty(key)) {\n        moduleOverrides[key] = Module[key];\n      }\n    }var arguments_ = [];var thisProgram = \"./this.program\";var quit_ = function quit_(status, toThrow) {\n      throw toThrow;\n    };var ENVIRONMENT_IS_WEB = false;var ENVIRONMENT_IS_WORKER = true;var scriptDirectory = \"\";function locateFile(path) {\n      if (Module[\"locateFile\"]) {\n        return Module[\"locateFile\"](path, scriptDirectory);\n      }return scriptDirectory + path;\n    }var read_, readAsync, readBinary, setWindowTitle;if (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER) {\n      if (ENVIRONMENT_IS_WORKER) {\n        scriptDirectory = self.location.href;\n      } else if (document.currentScript) {\n        scriptDirectory = document.currentScript.src;\n      }if (_scriptDir) {\n        scriptDirectory = _scriptDir;\n      }if (scriptDirectory.indexOf(\"blob:\") !== 0) {\n        scriptDirectory = scriptDirectory.substr(0, scriptDirectory.lastIndexOf(\"/\") + 1);\n      } else {\n        scriptDirectory = \"\";\n      }{\n        read_ = function shell_read(url) {\n          var xhr = new XMLHttpRequest();xhr.open(\"GET\", url, false);xhr.send(null);return xhr.responseText;\n        };if (ENVIRONMENT_IS_WORKER) {\n          readBinary = function readBinary(url) {\n            var xhr = new XMLHttpRequest();xhr.open(\"GET\", url, false);xhr.responseType = \"arraybuffer\";xhr.send(null);return new Uint8Array(xhr.response);\n          };\n        }readAsync = function readAsync(url, onload, onerror) {\n          var xhr = new XMLHttpRequest();xhr.open(\"GET\", url, true);xhr.responseType = \"arraybuffer\";xhr.onload = function xhr_onload() {\n            if (xhr.status == 200 || xhr.status == 0 && xhr.response) {\n              onload(xhr.response);return;\n            }onerror();\n          };xhr.onerror = onerror;xhr.send(null);\n        };\n      }setWindowTitle = function setWindowTitle(title) {\n        document.title = title;\n      };\n    } else {}var out = Module[\"print\"] || console.log.bind(console);var err = Module[\"printErr\"] || console.warn.bind(console);for (key in moduleOverrides) {\n      if (moduleOverrides.hasOwnProperty(key)) {\n        Module[key] = moduleOverrides[key];\n      }\n    }moduleOverrides = null;if (Module[\"arguments\"]) arguments_ = Module[\"arguments\"];if (Module[\"thisProgram\"]) thisProgram = Module[\"thisProgram\"];if (Module[\"quit\"]) quit_ = Module[\"quit\"];var wasmBinary;if (Module[\"wasmBinary\"]) wasmBinary = Module[\"wasmBinary\"];var noExitRuntime;if (Module[\"noExitRuntime\"]) noExitRuntime = Module[\"noExitRuntime\"];if ((typeof WebAssembly === 'undefined' ? 'undefined' : _typeof(WebAssembly)) !== \"object\") {\n      err(\"no native wasm support detected\");\n    }function getValue(ptr, type, noSafe) {\n      type = type || \"i8\";if (type.charAt(type.length - 1) === \"*\") type = \"i32\";switch (type) {case \"i1\":\n          return HEAP8[ptr >> 0];case \"i8\":\n          return HEAP8[ptr >> 0];case \"i16\":\n          return HEAP16[ptr >> 1];case \"i32\":\n          return HEAP32[ptr >> 2];case \"i64\":\n          return HEAP32[ptr >> 2];case \"float\":\n          return HEAPF32[ptr >> 2];case \"double\":\n          return HEAPF64[ptr >> 3];default:\n          abort(\"invalid type for getValue: \" + type);}return null;\n    }var wasmMemory;var wasmTable = new WebAssembly.Table({ \"initial\": 1, \"maximum\": 1 + 0, \"element\": \"anyfunc\" });var ABORT = false;var EXITSTATUS = 0;var UTF8Decoder = typeof TextDecoder !== \"undefined\" ? new TextDecoder(\"utf8\") : undefined;var UTF16Decoder = typeof TextDecoder !== \"undefined\" ? new TextDecoder(\"utf-16le\") : undefined;var WASM_PAGE_SIZE = 65536;function alignUp(x, multiple) {\n      if (x % multiple > 0) {\n        x += multiple - x % multiple;\n      }return x;\n    }var buffer, HEAP8, HEAPU8, HEAP16, HEAPU16, HEAP32, HEAPU32, HEAPF32, HEAPF64;function updateGlobalBufferAndViews(buf) {\n      buffer = buf;Module[\"HEAP8\"] = HEAP8 = new Int8Array(buf);Module[\"HEAP16\"] = HEAP16 = new Int16Array(buf);Module[\"HEAP32\"] = HEAP32 = new Int32Array(buf);Module[\"HEAPU8\"] = HEAPU8 = new Uint8Array(buf);Module[\"HEAPU16\"] = HEAPU16 = new Uint16Array(buf);Module[\"HEAPU32\"] = HEAPU32 = new Uint32Array(buf);Module[\"HEAPF32\"] = HEAPF32 = new Float32Array(buf);Module[\"HEAPF64\"] = HEAPF64 = new Float64Array(buf);\n    }var DYNAMIC_BASE = 5251792,\n        DYNAMICTOP_PTR = 8752;var INITIAL_TOTAL_MEMORY = Module[\"TOTAL_MEMORY\"] || 16777216;if (Module[\"wasmMemory\"]) {\n      wasmMemory = Module[\"wasmMemory\"];\n    } else {\n      wasmMemory = new WebAssembly.Memory({ \"initial\": INITIAL_TOTAL_MEMORY / WASM_PAGE_SIZE });\n    }if (wasmMemory) {\n      buffer = wasmMemory.buffer;\n    }INITIAL_TOTAL_MEMORY = buffer.byteLength;updateGlobalBufferAndViews(buffer);HEAP32[DYNAMICTOP_PTR >> 2] = DYNAMIC_BASE;function callRuntimeCallbacks(callbacks) {\n      while (callbacks.length > 0) {\n        var callback = callbacks.shift();if (typeof callback == \"function\") {\n          callback();continue;\n        }var func = callback.func;if (typeof func === \"number\") {\n          if (callback.arg === undefined) {\n            Module[\"dynCall_v\"](func);\n          } else {\n            Module[\"dynCall_vi\"](func, callback.arg);\n          }\n        } else {\n          func(callback.arg === undefined ? null : callback.arg);\n        }\n      }\n    }var __ATPRERUN__ = [];var __ATINIT__ = [];var __ATMAIN__ = [];var __ATPOSTRUN__ = [];var runtimeInitialized = false;function preRun() {\n      if (Module[\"preRun\"]) {\n        if (typeof Module[\"preRun\"] == \"function\") Module[\"preRun\"] = [Module[\"preRun\"]];while (Module[\"preRun\"].length) {\n          addOnPreRun(Module[\"preRun\"].shift());\n        }\n      }callRuntimeCallbacks(__ATPRERUN__);\n    }function initRuntime() {\n      runtimeInitialized = true;callRuntimeCallbacks(__ATINIT__);\n    }function preMain() {\n      callRuntimeCallbacks(__ATMAIN__);\n    }function postRun() {\n      if (Module[\"postRun\"]) {\n        if (typeof Module[\"postRun\"] == \"function\") Module[\"postRun\"] = [Module[\"postRun\"]];while (Module[\"postRun\"].length) {\n          addOnPostRun(Module[\"postRun\"].shift());\n        }\n      }callRuntimeCallbacks(__ATPOSTRUN__);\n    }function addOnPreRun(cb) {\n      __ATPRERUN__.unshift(cb);\n    }function addOnPostRun(cb) {\n      __ATPOSTRUN__.unshift(cb);\n    }var runDependencies = 0;var runDependencyWatcher = null;var dependenciesFulfilled = null;function addRunDependency(id) {\n      runDependencies++;if (Module[\"monitorRunDependencies\"]) {\n        Module[\"monitorRunDependencies\"](runDependencies);\n      }\n    }function removeRunDependency(id) {\n      runDependencies--;if (Module[\"monitorRunDependencies\"]) {\n        Module[\"monitorRunDependencies\"](runDependencies);\n      }if (runDependencies == 0) {\n        if (runDependencyWatcher !== null) {\n          clearInterval(runDependencyWatcher);runDependencyWatcher = null;\n        }if (dependenciesFulfilled) {\n          var callback = dependenciesFulfilled;dependenciesFulfilled = null;callback();\n        }\n      }\n    }Module[\"preloadedImages\"] = {};Module[\"preloadedAudios\"] = {};function abort(what) {\n      if (Module[\"onAbort\"]) {\n        Module[\"onAbort\"](what);\n      }what += \"\";out(what);err(what);ABORT = true;EXITSTATUS = 1;what = \"abort(\" + what + \"). Build with -s ASSERTIONS=1 for more info.\";throw new WebAssembly.RuntimeError(what);\n    }var dataURIPrefix = \"data:application/octet-stream;base64,\";function isDataURI(filename) {\n      return String.prototype.startsWith ? filename.startsWith(dataURIPrefix) : filename.indexOf(dataURIPrefix) === 0;\n    }var wasmBinaryFile = \"TinyH264.wasm\";if (!isDataURI(wasmBinaryFile)) {\n      wasmBinaryFile = locateFile(wasmBinaryFile);\n    }function getBinary() {\n      try {\n        if (wasmBinary) {\n          return new Uint8Array(wasmBinary);\n        }if (readBinary) {\n          return readBinary(wasmBinaryFile);\n        } else {\n          throw \"both async and sync fetching of the wasm failed\";\n        }\n      } catch (err) {\n        abort(err);\n      }\n    }function getBinaryPromise() {\n      if (!wasmBinary && (ENVIRONMENT_IS_WEB || ENVIRONMENT_IS_WORKER) && typeof fetch === \"function\") {\n        return fetch(wasmBinaryFile, { credentials: \"same-origin\" }).then(function (response) {\n          if (!response[\"ok\"]) {\n            throw \"failed to load wasm binary file at '\" + wasmBinaryFile + \"'\";\n          }return response[\"arrayBuffer\"]();\n        }).catch(function () {\n          return getBinary();\n        });\n      }return new Promise(function (resolve, reject) {\n        resolve(getBinary());\n      });\n    }function createWasm() {\n      var info = { \"env\": asmLibraryArg, \"wasi_snapshot_preview1\": asmLibraryArg };function receiveInstance(instance, module) {\n        var exports = instance.exports;Module[\"asm\"] = exports;removeRunDependency(\"wasm-instantiate\");\n      }addRunDependency(\"wasm-instantiate\");function receiveInstantiatedSource(output) {\n        receiveInstance(output[\"instance\"]);\n      }function instantiateArrayBuffer(receiver) {\n        return getBinaryPromise().then(function (binary) {\n          return WebAssembly.instantiate(binary, info);\n        }).then(receiver, function (reason) {\n          err(\"failed to asynchronously prepare wasm: \" + reason);abort(reason);\n        });\n      }function instantiateAsync() {\n        if (!wasmBinary && typeof WebAssembly.instantiateStreaming === \"function\" && !isDataURI(wasmBinaryFile) && typeof fetch === \"function\") {\n          fetch(wasmBinaryFile, { credentials: \"same-origin\" }).then(function (response) {\n            var result = WebAssembly.instantiateStreaming(response, info);return result.then(receiveInstantiatedSource, function (reason) {\n              err(\"wasm streaming compile failed: \" + reason);err(\"falling back to ArrayBuffer instantiation\");instantiateArrayBuffer(receiveInstantiatedSource);\n            });\n          });\n        } else {\n          return instantiateArrayBuffer(receiveInstantiatedSource);\n        }\n      }if (Module[\"instantiateWasm\"]) {\n        try {\n          var exports = Module[\"instantiateWasm\"](info, receiveInstance);return exports;\n        } catch (e) {\n          err(\"Module.instantiateWasm callback failed with error: \" + e);return false;\n        }\n      }instantiateAsync();return {};\n    }__ATINIT__.push({ func: function func() {\n        ___wasm_call_ctors();\n      } });function _emscripten_get_heap_size() {\n      return HEAP8.length;\n    }function _emscripten_memcpy_big(dest, src, num) {\n      HEAPU8.set(HEAPU8.subarray(src, src + num), dest);\n    }function emscripten_realloc_buffer(size) {\n      try {\n        wasmMemory.grow(size - buffer.byteLength + 65535 >> 16);updateGlobalBufferAndViews(wasmMemory.buffer);return 1;\n      } catch (e) {}\n    }function _emscripten_resize_heap(requestedSize) {\n      var oldSize = _emscripten_get_heap_size();var PAGE_MULTIPLE = 65536;var maxHeapSize = 2147483648 - PAGE_MULTIPLE;if (requestedSize > maxHeapSize) {\n        return false;\n      }var minHeapSize = 16777216;for (var cutDown = 1; cutDown <= 4; cutDown *= 2) {\n        var overGrownHeapSize = oldSize * (1 + .2 / cutDown);overGrownHeapSize = Math.min(overGrownHeapSize, requestedSize + 100663296);var newSize = Math.min(maxHeapSize, alignUp(Math.max(minHeapSize, requestedSize, overGrownHeapSize), PAGE_MULTIPLE));var replacement = emscripten_realloc_buffer(newSize);if (replacement) {\n          return true;\n        }\n      }return false;\n    }var asmLibraryArg = { \"a\": _emscripten_memcpy_big, \"b\": _emscripten_resize_heap, \"memory\": wasmMemory, \"table\": wasmTable };var asm = createWasm();Module[\"asm\"] = asm;var ___wasm_call_ctors = Module[\"___wasm_call_ctors\"] = function () {\n      return (___wasm_call_ctors = Module[\"___wasm_call_ctors\"] = Module[\"asm\"][\"c\"]).apply(null, arguments);\n    };var _h264bsdInit = Module[\"_h264bsdInit\"] = function () {\n      return (_h264bsdInit = Module[\"_h264bsdInit\"] = Module[\"asm\"][\"d\"]).apply(null, arguments);\n    };var _malloc = Module[\"_malloc\"] = function () {\n      return (_malloc = Module[\"_malloc\"] = Module[\"asm\"][\"e\"]).apply(null, arguments);\n    };var _free = Module[\"_free\"] = function () {\n      return (_free = Module[\"_free\"] = Module[\"asm\"][\"f\"]).apply(null, arguments);\n    };var _h264bsdDecode = Module[\"_h264bsdDecode\"] = function () {\n      return (_h264bsdDecode = Module[\"_h264bsdDecode\"] = Module[\"asm\"][\"g\"]).apply(null, arguments);\n    };var _h264bsdShutdown = Module[\"_h264bsdShutdown\"] = function () {\n      return (_h264bsdShutdown = Module[\"_h264bsdShutdown\"] = Module[\"asm\"][\"h\"]).apply(null, arguments);\n    };var _h264bsdAlloc = Module[\"_h264bsdAlloc\"] = function () {\n      return (_h264bsdAlloc = Module[\"_h264bsdAlloc\"] = Module[\"asm\"][\"i\"]).apply(null, arguments);\n    };var _h264bsdFree = Module[\"_h264bsdFree\"] = function () {\n      return (_h264bsdFree = Module[\"_h264bsdFree\"] = Module[\"asm\"][\"j\"]).apply(null, arguments);\n    };Module[\"asm\"] = asm;Module[\"getValue\"] = getValue;var calledRun;Module[\"then\"] = function (func) {\n      if (calledRun) {\n        func(Module);\n      } else {\n        var old = Module[\"onRuntimeInitialized\"];Module[\"onRuntimeInitialized\"] = function () {\n          if (old) old();func(Module);\n        };\n      }return Module;\n    };dependenciesFulfilled = function runCaller() {\n      if (!calledRun) run();if (!calledRun) dependenciesFulfilled = runCaller;\n    };function run(args) {\n      args = args || arguments_;if (runDependencies > 0) {\n        return;\n      }preRun();if (runDependencies > 0) return;function doRun() {\n        if (calledRun) return;calledRun = true;if (ABORT) return;initRuntime();preMain();if (Module[\"onRuntimeInitialized\"]) Module[\"onRuntimeInitialized\"]();postRun();\n      }if (Module[\"setStatus\"]) {\n        Module[\"setStatus\"](\"Running...\");setTimeout(function () {\n          setTimeout(function () {\n            Module[\"setStatus\"](\"\");\n          }, 1);doRun();\n        }, 1);\n      } else {\n        doRun();\n      }\n    }Module[\"run\"] = run;if (Module[\"preInit\"]) {\n      if (typeof Module[\"preInit\"] == \"function\") Module[\"preInit\"] = [Module[\"preInit\"]];while (Module[\"preInit\"].length > 0) {\n        Module[\"preInit\"].pop()();\n      }\n    }noExitRuntime = true;run();\n\n    return Module;\n  };\n}();\nif ((typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) === 'object' && (typeof module === 'undefined' ? 'undefined' : _typeof(module)) === 'object') module.exports = Module;else if (typeof define === 'function' && define['amd']) define([], function () {\n  return Module;\n});else if ((typeof exports === 'undefined' ? 'undefined' : _typeof(exports)) === 'object') exports[\"Module\"] = Module;","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","const {isElectron} = require('koush-utils/lib/base/util');\n\nfunction PepperDecoder(encodeWidth, encodeHeight, decoder) {\n  $('#listener').empty();\n  var tool;\n  var toolPath;\n  var type;\n  if (isElectron()) {\n    tool = \"host\";\n    toolPath = null;\n    type = \"application/x-ppapi-vysor\";\n  }\n  else {\n    tool = \"pnacl\";\n    toolPath = \"video_decode/pnacl/Release\";\n    type = null;\n  }\n\n  var hasInitialized;\n  common.createNaClModule(\"video_decode\", type, tool, toolPath, encodeWidth, encodeHeight, {}, function(message) {\n    if (message.data == 'decoder-falling-behind') {\n      if (this.onDecoderFallingBehind)\n        this.onDecoderFallingBehind();\n    }\n    else if (message.data == 'paint-falling-behind') {\n    }\n    else if (message.data == 'graphics-context-null') {\n      showModal({\n        title: 'Graphics Error: assert !context_->is_null()',\n        body: 'Vysor encountered an error with your graphics card. There is a possible solution available on the <a href=\"https://support.vysor.io/support/technical/graphics/\" target=\"_blank\">support page</a>.',\n        hideCancel: true,\n      })\n    }\n    else if (message.data == 'decoder-ready') {\n      if (this.onReady)\n        this.onReady();\n      else\n        console.error('no listener for decoder-ready')\n    }\n  }.bind(this), function() {\n    if (hasInitialized) {\n      console.error('NACL module has already initalized');\n      console.error(hasInitialized);\n      console.error(new Error('NACL New Initialization Stack'))\n      return;\n    }\n    hasInitialized = new Error(\"NACL Initialization Stack\");\n    console.log('NACL module initialized')\n    console.log('decoder:', decoder);\n    common.naclModule.postMessage(decoder);\n  }.bind(this));\n}\n\nPepperDecoder.prototype.connectH264 = function(serialno, password) {\n  if (!common.naclModule || !common.naclModule.postMessage) {\n    console.error('connectH264 called before initialization');\n    return;\n  }\n\n  common.naclModule.postMessage({\n    type: 'connectH264',\n    hostCommand: prefixLen416('host:transport:' + serialno),\n    clientCommand: prefixLen416('tcp:53517'),\n    password: password + '\\n'\n  });\n}\n\nPepperDecoder.prototype.decode = function(video, presentationTimeMs, syncFrame) {\n  if (!common.naclModule || !common.naclModule.postMessage) {\n    console.error('decode called before initialization');\n    return;\n  }\n\n  common.naclModule.postMessage({\n    buffer: video.buffer,\n    byteOffset: video.byteOffset,\n    byteLength: video.byteLength,\n    presentationTimeMs: presentationTimeMs,\n    syncFrame: syncFrame,\n  });\n}\n\nPepperDecoder.prototype.queueAudio = function(offset, audioBuffer0, audioBuffer1) {\n  common.naclModule.postMessage({\n    type: 'queueAudio',\n    audioBuffer0: audioBuffer0.buffer,\n    audioBuffer1: audioBuffer1.buffer,\n    offset: offset,\n    length: audioBuffer0.byteLength,\n  });\n}\n\nmodule.exports = PepperDecoder;","const {Server} = require('koush-utils/lib/socket/socket');\nconst AudioQueue = require('./audio-queue');\nconst DummySocket = require('koush-utils/lib/socket/dummysocket');\nconst {appendBuffer, Success, hexToBuffer, writeLine, readLenLoop, arrayBufferToBase64, writeLenData, makeUUID} = require('koush-utils/lib/base/util');\nconst {parseRTPPacket} = require('./rtp');\n\nfunction CastServer() {\n  // this.clients = [];\n\n  var audioListener = this.audioListener = new Server();\n  audioListener.listen({\n    port: 0,\n    address: '127.0.0.1'\n  }, function(socket) {\n    // this.clients.push(socket);\n    // socket.onClose = function() {\n    //   var index = this.clients.indexOf(socket);\n    //   if (index != -1) {\n    //     this.clients.splice(index, 1);\n    //     socket.destroy();\n    //   }\n    // }.bind(this);\n\n    socket.bufferWrites = true;\n    readLenLoop(socket, function(data) {\n      if (!data)\n        return;\n      var msg = $protobuf.roots.default.cast_channel.CastMessage.decode(data);\n      var json;\n      if (msg.payloadUtf8)\n        json = JSON.parse(msg.payloadUtf8);\n\n      console.log('received', msg, json);\n\n      var handler = this.onMessage[msg.namespace];\n      if (!handler) {\n        console.error('unhandled cast message', msg)\n        return;\n      }\n      handler.bind(this)(socket, msg, json).async();\n    }.bind(this));\n  }.bind(this),\n  function() {\n    if (this.onListening) {\n      this.onListening();\n    }\n  }.bind(this));\n\n  this.castId = \"fb720c4cbabca202da80e378fc8474dee136e04f\";\n}\n\nCastServer.prototype.sendUDP = function(address, port, bytes) {\n  var prefix = new DataView(new ArrayBuffer(4 + 4 + address.byteLength + 4));\n  prefix.setUint32(0, prefix.byteLength - 4 + bytes.byteLength);\n  prefix.setUint32(4, address.byteLength);\n  for (var i = 0; i < address.byteLength; i++) {\n    prefix.setUint8(4 + 4 + i, address[i]);\n  }\n  prefix.setUint32(4 + 4 + address.byteLength, port);\n\n  var buffer = appendBuffer(new Uint8Array(prefix.buffer, prefix.byteOffset, prefix.byteLength),\n    new Uint8Array(bytes.buffer, bytes.byteOffset, bytes.byteLength));\n  this.udpSocket.write(buffer);\n}\n\nCastServer.prototype.resolveFile = function(filename) {\n  return '/assets/' + MD5(filename);\n}\n\nCastServer.prototype.resolveAjax = function*(filename) {\n  return yield $.ajax({\n            url: this.resolveFile(filename),\n            type: \"GET\",\n            dataType: 'binary',\n            responseType: 'arraybuffer',\n            processData: false,\n            success: yield Success,\n            error: yield Error,\n  });\n}\n\nCastServer.prototype.stop = function() {\n  // for (var i = 0; i < this.clients.length; i++) {\n  //   this.clients[i].destroy();\n  // }\n  // this.clients = [];\n\n  if (this.audioQueue) {\n    this.audioQueue.stop();\n    this.audioQueue = null;\n  }\n  if (this.udpSocket != null) {\n    this.udpSocket.destroy();\n    this.udpSocket = null;\n  }\n\n  this.sessionUUID = null;\n\n  if (this.onStop)\n    this.onStop();\n}\n\nCastServer.prototype.timeout = function() {\n  delete this.rtpTimeout;\n  this.stop();\n}\n\nCastServer.prototype.resetTimeout = function(timeout) {\n  timeout = timeout || 10000;\n  clearTimeout(this.rtpTimeout);\n  // timeout after 10 seconds of no packets...\n  // better way to do this on slow as shit devices?\n  this.rtpTimeout = setTimeout(this.timeout.bind(this), timeout);\n}\n\nCastServer.prototype.connectUDP = function(adbSocketFactory, context) {\n  this.stop();\n  if (this.onStart)\n    this.onStart();\n  this.resetTimeout(60000);\n\n  this.udpSocket = new DummySocket();\n  this.context = context;\n\n  var rtpAckBytes = hexToBuffer('8fce000400000002000000014341535400000064')\n  var rtpReceiverReportBytes = hexToBuffer('81c90007000000020000000100000000000000ef0000000027bfaff00000000080cf0004000000020400000283aff46335954e18');\n\n  var lastSequenceNumber = 0;\n  var rolloverCount = 0;\n\n  var lastAck = 0;\n  var onRtpPacket = function(addr, port, packet) {\n    this.resetTimeout();\n\n    // if the last (typically highest) sequence number is WAY higher\n    // than the incoming packet, that means that the packet id probably rolled over 2^16\n    // this needs to be tracked (as far as I can tell, as I don't see a 32 bit integer anywhere)\n    // this functions as a hacky 32 bit counter for the aesIvMask\n    if (packet.id < lastSequenceNumber - (1 << 15))\n      rolloverCount++;\n\n    lastSequenceNumber = packet.id;\n\n    // var now = Date.now();\n    // if (now > lastAck + 100) {\n    //   lastAck = now;\n    //   var ack = rtpAckBytes.slice(0);\n    //   ack = new DataView(ack)\n    //   ack.setUint8(ack.byteLength - 4, packet.id % 256);\n    //   this.sendUDP(addr, port, ack)\n    // }\n\n\n    var maski = 11;\n    var mask = new Uint8Array(this.aesIvMask).slice(0);\n    mask[maski] ^= packet.id & 0x00ff;\n    mask[maski - 1] ^= (packet.id >> 8) & 0x00ff;\n    // there seems to be an issue after 8 rollovers... are only 3 more bits being used for the aes counter?\n    mask[maski - 2] ^= rolloverCount % 8;\n\n    var useLegacy = false;\n\n    // var start = Date.now();\n    var withDecryptedBytes = function(decryptedBytes) {\n      // console.log('decryption', Date.now() - start);\n      // console.log(decryptedBytes);\n\n      // used for flv export siphon\n      this.writeAudio((rolloverCount << 16) + packet.id, decryptedBytes.slice(0))\n      var debugInfo = {\n        aesKey: this.aesKey,\n        aesIvMask: this.aesIvMask,\n        packet: packet,\n        rolloverCount: rolloverCount,\n      }\n\n      this.audioQueue.queue(packet.id, decryptedBytes, debugInfo);\n    }.bind(this)\n\n    if (useLegacy) {\n      var aesCtr = new aesjs.ModeOfOperation.ctr(new Uint8Array(this.aesKey), new aesjs.Counter(mask));\n      var decryptedBytes = aesCtr.decrypt(new Uint8Array(packet.payload.slice(10)));\n      withDecryptedBytes(decryptedBytes);\n      return;\n    }\n\n    window.crypto.subtle.decrypt(\n      {\n        name: \"AES-CTR\",\n        counter: mask,\n        length: 16\n      },\n      this.cryptoAesKey,\n      packet.payload.slice(10)\n    ).then(ab => withDecryptedBytes(new Uint8Array(ab)))\n  }.bind(this);\n\n  var onRtcpPacket = function(addr, port, data) {\n    var ssrc = data.getUint32(4)\n    var lastSRTimestamp = data.getUint32(10)\n\n    var report = rtpReceiverReportBytes.slice(0);\n    report = new DataView(report)\n    report.setUint32(4, ssrc + 1)\n    report.setUint32(8, ssrc)\n    report.setUint32(16, lastSequenceNumber)\n    report.setUint32(24, lastSRTimestamp)\n\n    report.setUint32(report.byteLength - 4, new Date().getTime() % 4294967295)\n    report.setUint32(report.byteLength - 16, ssrc + 1)\n\n    this.sendUDP(addr, port, report);\n  }.bind(this);\n\n  var onPacket = function(packet) {\n    var view = new DataView(packet.buffer, packet.byteOffset, packet.byteLength);\n    var addrLen = view.getInt32(0);\n    var addr = packet.slice(4, 4 + addrLen);\n    var port = view.getInt32(4 + addrLen);\n    var data = packet.slice(4 + addrLen + 4);\n\n    // console.log('udp packet', addr, port, packet);\n    var dataView = new DataView(data.buffer, data.byteOffset, data.byteLength);\n    var rtpPacket = parseRTPPacket(dataView)\n    // console.log('rtp packet', rtpPacket);\n    if (rtpPacket.marker)\n      onRtcpPacket(addr, port, dataView);\n    else\n      onRtpPacket(addr, port, rtpPacket);\n  }.bind(this);\n\n\n  function* internal() {\n    var now = new Date;\n    var timestamp = now.getUTCFullYear() + (now.getUTCMonth() + 1).pad(2) + now.getUTCDate().pad(2) + '000000Z';\n    try {\n      var key = yield this.resolveAjax(timestamp + '.key.der');\n      var cert = yield this.resolveAjax(timestamp + '.der');\n\n      var socket = yield adbSocketFactory.newSocket('tcp:53519', yield);\n      if (!socket)\n        throw new Error('unable to connect to audio socket');\n\n      this.udpSocket = socket;\n      var audioQueue = this.audioQueue = new AudioQueue(context);\n      audioQueue.sampleRate = this.sampleRate;\n      audioQueue.numberOfChannels = this.numberOfChannels;\n\n      var cleanupSelf = function(debugInfo) {\n        // if (debugInfo)\n          console.error('error decoding', debugInfo, arguments);\n\n        if (this.audioQueue == audioQueue)\n          this.audioQueue = null;\n        audioQueue.stop();\n\n        if (this.udpSocket == socket)\n          this.udpSocket = null;\n        socket.destroy();\n      }.bind(this);\n\n      audioQueue.onError = cleanupSelf;\n      socket.onClose = cleanupSelf;\n\n      socket.bufferWrites = true;\n      yield writeLine(socket, password, yield);\n      yield writeLine(socket, arrayBufferToBase64(key), yield);\n      yield writeLine(socket, arrayBufferToBase64(cert), yield);\n      yield writeLine(socket, this.castId, yield);\n\n      readLenLoop(socket, onPacket);\n    }\n    catch (e) {\n      console.error('error connecting to udp', e);\n    }\n  }\n\n  internal.bind(this)().async();\n}\n\nCastServer.prototype.getPort = function(socket, message) {\n  return this.audioListener.localPort;\n}\n\nCastServer.prototype.respond = function(socket, message, payload) {\n  return this.sendMessage(socket, message.destinationId, message.sourceId, message.namespace, payload);\n}\n\nCastServer.prototype.sendMessage = function(socket, sourceId, destinationId, namespace, payload) {\n  if (payload.constructor.name == 'Object')\n    payload = JSON.stringify(payload);\n\n  var message = {\n    protocolVersion: 0, // CASTV2_1_0\n    sourceId: sourceId,\n    destinationId: destinationId,\n    namespace: namespace,\n    payloadType: payload.constructor.name === 'String' ? 0 : 1,\n  }\n\n  if (message.payloadType)\n    message.payloadBinary = payload.constructor.encode(payload).finish();\n  else\n    message.payloadUtf8 = payload;\n\n  // console.log('sent', message);\n\n  var bytes = $protobuf.roots.default.cast_channel.CastMessage.encode(message).finish();\n  writeLenData(socket, bytes.buffer.slice(bytes.byteOffset, bytes.byteOffset + bytes.byteLength))\n}\n\nCastServer.prototype.onMessage = {};\n\nCastServer.prototype.onMessage['urn:x-cast:com.google.cast.tp.deviceauth'] = function*(socket, message) {\n  try {\n    var now = new Date;\n    var timestamp = now.getUTCFullYear() + (now.getUTCMonth() + 1).pad(2) + now.getUTCDate().pad(2) + '000000Z';\n\n    var sig = yield this.resolveAjax(timestamp + '.sig');\n    var cert = yield this.resolveAjax('cert-aa.der');\n    var ca1 = yield this.resolveAjax('cert-ab.der');\n    var ca2 = yield this.resolveAjax('cert-ac.der');\n    var ca3 = yield this.resolveAjax('cert-ad.der');\n\n    sig = new Uint8Array(sig);\n    cert = new Uint8Array(cert);\n    ca1 = new Uint8Array(ca1);\n    ca2 = new Uint8Array(ca2);\n    ca3 = new Uint8Array(ca3);\n\n    var response = {\n      response: {\n        signature: sig,\n        clientAuthCertificate: cert,\n        intermediateCertificate: [ ca1, ca2, ca3 ],\n        signatureAlgorithm: 1,\n        senderNonce: null,\n        hashAlgorithm: 0,\n        crl: null,\n      },\n      error: null,\n    }\n\n    this.respond(socket, message, $protobuf.roots.default.cast_channel.DeviceAuthMessage.fromObject(response));\n  }\n  catch (e) {\n    console.error('error getting certs', e)\n  }\n}\n\nCastServer.prototype.onJSONMessage = {};\n\nCastServer.prototype.onJSONMessage['GET_APP_AVAILABILITY'] = function*(socket, message, json) {\n  var status = {\n    \"availability\": {\n    },\n    \"requestId\": json.requestId,\n    \"responseType\": \"GET_APP_AVAILABILITY\"\n  }\n\n  $.each(json.appId, function(index, appId) {\n    status.availability[appId] = 'APP_UNAVAILABLE';\n  })\n\n  status['8E6C866D'] = 'APP_AVAILABLE';\n  // status['CC1AD845'] = 'APP_AVAILABLE';\n\n  this.respond(socket, message, status);\n}\n\nCastServer.prototype.onJSONMessage['STOP'] = function*(socket, message, json) {\n  this.sessionUUID = null;\n\n  yield this.onJSONMessage['RECEIVER_STATUS'].bind(this)(socket, message, json, true).async();\n}\n\nCastServer.prototype.onJSONMessage['LAUNCH'] = function*(socket, message, json) {\n  this.sessionUUID = makeUUID();\n  yield this.onJSONMessage['RECEIVER_STATUS'].bind(this)(socket, message, json, true).async();\n}\n\nCastServer.prototype.onJSONMessage['GET_STATUS'] = function*(socket, message, json) {\n  yield this.onJSONMessage['RECEIVER_STATUS'].bind(this)(socket, message, json).async();\n}\n\nCastServer.prototype.onJSONMessage['RECEIVER_STATUS'] = function*(socket, message, json, broadcast) {\n  /*\n  var sample = {\n    \"requestId\": 617,\n    \"status\": {\n      \"applications\": [{\n        \"appId\": \"8E6C866D\",\n        \"displayName\": \"Audio Mirroring\",\n        \"isIdleScreen\": false,\n        \"launchedFromCloud\": false,\n        \"namespaces\": [{\n          \"name\": \"urn:x-cast:com.google.cast.webrtc\"\n        }, {\n          \"name\": \"urn:x-cast:com.google.cast.media\"\n        }, {\n          \"name\": \"urn:x-cast:com.google.cast.debug\"\n        }, {\n          \"name\": \"urn:x-cast:com.google.cast.remoting\"\n        }],\n        \"sessionId\": \"a1f52c92-4566-456a-90bd-ff35499dc83d\",\n        \"statusText\": \"Audio Mirroring\",\n        \"transportId\": \"a1f52c92-4566-456a-90bd-ff35499dc83d\"\n      }],\n      \"userEq\": {\n        \"high_shelf\": {\n          \"frequency\": 4500.0,\n          \"gain_db\": 0.0,\n          \"quality\": 0.707\n        },\n        \"low_shelf\": {\n          \"frequency\": 150.0,\n          \"gain_db\": 0.0,\n          \"quality\": 0.707\n        },\n        \"max_peaking_eqs\": 0,\n        \"peaking_eqs\": []\n      },\n      \"volume\": {\n        \"controlType\": \"master\",\n        \"level\": 1.0,\n        \"muted\": false,\n        \"stepInterval\": 0.019999999552965164\n      }\n    },\n    \"type\": \"RECEIVER_STATUS\"\n  }\n  */\n\n\n  var status = {\n    \"requestId\": json.requestId,\n    \"status\": {\n      \"userEq\": {\n        \"high_shelf\": {\n          \"frequency\": 4500,\n          \"gain_db\": 0,\n          \"quality\": 0.707\n        },\n        \"low_shelf\": {\n          \"frequency\": 150,\n          \"gain_db\": 0,\n          \"quality\": 0.707\n        },\n        \"max_peaking_eqs\": 0,\n        \"peaking_eqs\": []\n      },\n      \"volume\": {\n        \"controlType\": \"master\",\n        \"level\": 1,\n        \"muted\": false,\n        \"stepInterval\": 0.02\n      }\n    },\n    \"type\": \"RECEIVER_STATUS\"\n  }\n\n  if (this.sessionUUID) {\n    status.status.applications = [\n      {\n        \"appId\": \"8E6C866D\",\n        \"displayName\": \"Audio Mirroring\",\n        \"isIdleScreen\": false,\n        \"launchedFromCloud\": false,\n        \"namespaces\": [\n          {\n            \"name\": \"urn:x-cast:com.google.cast.webrtc\"\n          },\n          {\n            \"name\": \"urn:x-cast:com.google.cast.media\"\n          },\n          {\n            \"name\": \"urn:x-cast:com.google.cast.debug\"\n          },\n          {\n            \"name\": \"urn:x-cast:com.google.cast.remoting\"\n          }\n        ],\n        \"sessionId\": this.sessionUUID,\n        \"statusText\": \"Audio Mirroring\",\n        \"transportId\": this.sessionUUID\n      }\n    ]\n  }\n\n  if (broadcast)\n    this.sendMessage(socket, message.destinationId, '*', message.namespace, status);\n  else\n    this.respond(socket, message, status);\n}\n\nCastServer.prototype.onMessage['urn:x-cast:com.google.cast.receiver'] = function*(socket, message, json) {\n  var handler = this.onJSONMessage[json.type];\n  if (!handler) {\n    console.error('unhandled cast json message', json);\n    return;\n  }\n\n  yield handler.bind(this)(socket, message, json).async();\n}\n\nCastServer.prototype.onMessage['urn:x-cast:com.google.cast.media'] = CastServer.prototype.onMessage['urn:x-cast:com.google.cast.receiver'];\n\nCastServer.prototype.onMessage['urn:x-cast:com.google.cast.tp.heartbeat'] = function*(socket, message) {\n  this.respond(socket, message, {\n    type: \"PONG\"\n  });\n}\n\nCastServer.prototype.onMessage['urn:x-cast:com.google.cast.tp.connection'] = function*(socket, message) {\n  this.respond(socket, message, {\n    protocolVersion:0,\n    type: \"CONNECTED\"\n  });\n}\n\nCastServer.prototype.onMessage['urn:x-cast:com.google.cast.receiver.discovery'] = function*(socket, message, json) {\n  var status = {\n    \"controlNotifications\": 1,\n    \"deviceCapabilities\": 2052,\n    \"deviceIconUrl\": \"/setup/icon.png\",\n    \"deviceId\": this.castId,\n    \"deviceModel\": \"Google Home\",\n    \"friendlyName\": \"Kitchen\",\n    \"receiverMetricsId\": \"5C1CC5224680F4B2\",\n    \"requestId\": json.requestId,\n    \"type\": \"DEVICE_INFO\",\n    \"wifiProximityId\": \"FA8FCA7A7F1C\"\n  }\n\n  this.respond(socket, message, status);\n}\n\nCastServer.prototype.onMessage['urn:x-cast:com.google.cast.webrtc'] = function*(socket, message, json) {\n  for (var stream in json.offer.supportedStreams) {\n    stream = json.offer.supportedStreams[stream];\n    console.log('audio offer:', stream);\n    this.sampleRate = stream.sampleRate;\n    this.numberOfChannels = stream.channels;\n    if (this.audioQueue != null) {\n      var audioQueue = this.audioQueue;\n      audioQueue.sampleRate = this.sampleRate;\n      audioQueue.numberOfChannels = this.numberOfChannels;\n    }\n\n    if (stream.sampleRate != 48000)\n      console.warn('Offered sample rate is not 48000?', stream.sampleRate);\n    if (stream.channels != 2)\n      console.warn('Offered channels is not 2?', stream.channels);\n  }\n\n  var answer = {\n    \"answer\": {\n      \"castMode\": \"mirroring\",\n      \"receiverRtcpEventLog\": [0],\n      \"rtpExtensions\": [\n        [\"adaptive_playout_delay\"]\n      ],\n      \"sendIndexes\": [0],\n      \"ssrcs\": [2],\n      \"udpPort\": 8010\n    },\n    \"result\": \"ok\",\n    \"seqNum\": 0,\n    \"type\": \"ANSWER\"\n  }\n\n  this.aesKey = hexToBuffer(json.offer.supportedStreams[0].aesKey)\n  this.aesIvMask = hexToBuffer(json.offer.supportedStreams[0].aesIvMask);\n\n  crypto.subtle.importKey('raw', this.aesKey, 'AES-CTR', false, ['decrypt'])\n  .then(key => {\n    this.cryptoAesKey = key;\n    this.respond(socket, message, answer);\n  });\n}\n\nCastServer.prototype.siphon = function(dump) {\n  this.pendingAudio = [];\n  this.audioDump = dump;\n}\n\nCastServer.prototype.writeAudio = function(id, decryptedBytes) {\n  if (!this.audioDump)\n    return;\n  this.pendingAudio.push({\n    id,\n    decryptedBytes,\n  })\n\n  this.pendingAudio.sort(function(a, b) {\n    return a.id - b.id;\n  });\n\n  var keep = this.pendingAudio.splice(0, 50);\n  var send = this.pendingAudio;\n  this.pendingAudio = keep;\n\n  for (var i = 0; i < send.length; i++) {\n    this.audioDump.dataReceived(send[i].decryptedBytes);\n  }\n}\n\nmodule.exports = CastServer;","const PepperAudio = require('../pepper-audio');\nconst {appendBuffer, isBrowser, throttleTimeout} = require('koush-utils/lib/base/util');\n\nfunction resampleAudio(audioBuffer, outputSampleRate, offset, sampleLength) {\n  var floatSample = new Float32Array(sampleLength);\n  var outputSampleLength = Math.round(outputSampleRate * sampleLength / audioBuffer.sampleRate);\n  var offlineContext = new OfflineAudioContext(audioBuffer.numberOfChannels, outputSampleLength, outputSampleRate);\n  var buffer = offlineContext.createBuffer(audioBuffer.numberOfChannels, sampleLength, audioBuffer.sampleRate);\n\n  for (var i = 0; i < audioBuffer.numberOfChannels; i++) {\n    audioBuffer.copyFromChannel(floatSample, 0, offset);\n    buffer.copyToChannel(floatSample, i);\n  }\n\n  var source = offlineContext.createBufferSource();\n  source.buffer = buffer;\n  source.connect(offlineContext.destination);\n  source.start();\n\n  return offlineContext.startRendering();\n}\n\nfunction AudioQueue(context) {\n  this.context = context;\n  this.numSamples = 1024;\n  this.numSamplesDiv2 = this.numSamples / 2;\n  this.numSamplesDiv4 = this.numSamples / 4;\n  this.cleanup = this.numSamples / 2;\n  this.samples = new Array(this.numSamples);\n  this.lastIndex = 0;\n}\n\nAudioQueue.prototype.verify = function(sample) {\n  if (!sample)\n    return;\n  if (sample[0] != 0xff || (sample[1] & 0xf0) != 0xf0) {\n    this.malformed = throttleTimeout(this.malformed, null, 5000, function() {\n      console.error('got a malformed adts sample?');\n    })\n  }\n}\n\nAudioQueue.prototype.stop = function() {\n  if (this.source != null)\n    this.source.stop();\n  if (this.pepperAudio)\n    this.pepperAudio.stop();\n  this.pepperAudio = null;\n  this.source = null;\n}\n\nAudioQueue.prototype.queuePCMData = function(index, floatSample0, floatSample1) {\n  this.audioBuffer.copyToChannel(floatSample0, 0, index * this.sampleLength);\n  this.audioBuffer.copyToChannel(floatSample1, 1, index * this.sampleLength);\n\n  if (this.samplesDecoded == 10)\n    this.source.start();\n  this.samplesDecoded++;\n}\n\nAudioQueue.prototype.decode = function(id, debugInfo) {\n  var index = (id + this.numSamples) % this.numSamples;\n  var useLegacy = isBrowser();\n\n  var adts = this.samples[index];\n\n  if (adts == null) {\n    // if we don't have a sample, we gotta clear out the looping buffer\n    // or we end up getting audio jitters (old valid packets) on new missing packets.\n\n    // maybe move the silencing to when the timestamps roll over?\n    if (this.silence) {\n      this.audioBuffer.copyToChannel(this.silence, 0, index * this.sampleLength);\n      this.audioBuffer.copyToChannel(this.silence, 1, index * this.sampleLength);\n    }\n    return;\n  }\n\n  var before = (id - 1 + this.numSamples) % this.numSamples;\n  var after = (id + 1) % this.numSamples;\n\n  // decodes seem to fail with less than 3 samples? i don't understand.\n  if (!useLegacy) {\n    before = this.samples[before];\n    after = this.samples[after];\n    if (!before || !after) {\n      // can't get a seamless decode here.\n      return;\n    }\n  }\n  else {\n    before = this.samples[before] || adts;\n    after = this.samples[after] || adts;\n}\n\n  // before = this.samples[before];\n  // after = this.samples[after];\n\n  var combined;\n  var samples = 1;\n  if (before) {\n    samples++;\n    combined = appendBuffer(before, adts);\n  }\n  else {\n    combined = adts;\n  }\n\n  if (after) {\n    samples++;\n    combined = appendBuffer(combined, after);\n  }\n\n  // this.verify(before);\n  // this.verify(adts);\n  // this.verify(after);\n\n\n  // var start = Date.now();\n  this.context.decodeAudioData(combined.sliceArrayBuffer(), function(decoded) {\n    // console.log('decode', Date.now() - start);\n\n    if (!useLegacy && !this.pepperAudio) {\n      console.log('pepper audio plugin created');\n      this.pepperAudio = new PepperAudio();\n    }\n\n    if (useLegacy && !this.source) {\n      this.sampleLength = decoded.length / samples;\n\n      var sampleRate = decoded.sampleRate;\n      console.log('audio sample rate', sampleRate);\n\n      // seems xiaomi phones advertise 48000 during the protocol buffers sessions,\n      // then it sends adts that says it is 192000 in the header\n      // but then the actual sample rate is 48000...\n      if (this.sampleRate && sampleRate != this.sampleRate) {\n        console.log('Decoded sampleRate does not match', sampleRate, this.sampleRate);\n        sampleRate = this.sampleRate;\n      }\n\n      // sanity check this as well\n      var numberOfChannels = decoded.numberOfChannels;\n      if (this.numberOfChannels && decoded.numberOfChannels != this.numberOfChannels) {\n        console.log('Decoded numberOfChannels does not match', numberOfChannels, this.numberOfChannels);\n        numberOfChannels = this.numberOfChannels;\n      }\n\n      var silence = new AudioBuffer({\n        length: this.sampleLength,\n        numberOfChannels: numberOfChannels,\n        sampleRate: sampleRate,\n      })\n      this.silence = new Float32Array(this.sampleLength);\n      silence.copyFromChannel(this.silence, 0);\n\n      this.audioBuffer = new AudioBuffer({\n        length: this.sampleLength * this.numSamples,\n        numberOfChannels: numberOfChannels,\n        sampleRate: sampleRate,\n      })\n\n      this.source = this.context.createBufferSource();\n      this.source.buffer = this.audioBuffer;\n      this.source.loop = true;\n      this.source.connect(this.context.destination);\n\n      this.samplesDecoded = 0;\n    }\n\n    if (useLegacy && decoded.length != this.sampleLength * samples) {\n      console.error('unexpected decoded length');\n      return;\n    }\n\n    // Need to use per channel allocated samples, the copyFrom and copyTo seem to be async... or something?\n    // there is a lot of jittering as what appears to be reads happening during writes. By throwing these\n    // away, it stopped.\n\n    // grab the portion we are interested in\n    var sampleLength = decoded.length / samples;\n\n    if (false && decoded.sampleRate != this.context.sampleRate) {\n      resampleAudio(decoded, decoded.sampleRate, 192000, before ? sampleLength : 0, sampleLength)\n      .then(function(resampledBuffer) {\n        this.queuePCMData(index, resampledBuffer.getChannelData(0), resampledBuffer.getChannelData(1))\n      }.bind(this))\n      return;\n    }\n\n    var floatSample = new Float32Array(sampleLength);\n    var floatSample1 = new Float32Array(sampleLength);\n    decoded.copyFromChannel(floatSample, 0, before ? sampleLength : 0);\n    decoded.copyFromChannel(floatSample1, 1, before ? sampleLength : 0);\n\n    if (useLegacy) {\n      this.queuePCMData(index, floatSample, floatSample1);\n    }\n    else {\n      this.pepperAudio.queueAudio(id, floatSample, floatSample1);\n    }\n\n  }.bind(this),\n  function(error) {\n    if (this.onError)\n      this.onError(debugInfo, samples, combined, error);\n  }.bind(this))\n  // no longer needed cause decoding stops after the first error anyways, keeping this for posterity though\n  // .catch(function() {\n  //   // this needs to be here or we get some spam in the error log\n  // });\n\n}\n\nAudioQueue.prototype.queue = function(id, adts, debugInfo) {\n  var index = id % this.numSamples;\n\n  // divide the looping buffer into 4 parts, and when we start\n  // receiving new packets for a quadrant, clear out the opposite quadrant\n  if (index >= this.cleanup && index < this.cleanup + this.numSamplesDiv4) {\n    var start = (this.cleanup + this.numSamplesDiv2) % this.numSamples;\n    var end = start + this.numSamplesDiv4;\n    for (var i = start; i < end; i++) {\n      this.samples[i] = null;\n    }\n    this.cleanup = (this.cleanup + this.numSamplesDiv4) % this.numSamples;\n  }\n\n  this.samples[index] = adts;\n\n  // whenever we get a new sample, we need to redecode everything around it to remove audio seams (or we get jitters)\n\n  // var before = (index - 1 + this.numSamples) % this.numSamples;\n  // var after = (index + 1) % this.numSamples;\n\n  this.decode(id - 1, debugInfo);\n  this.decode(id, debugInfo);\n  this.decode(id + 1, debugInfo);\n}\n\nmodule.exports = AudioQueue;","const {isElectron} = require('koush-utils/lib/base/util');\n\nfunction PepperAudio() {\n  $('#listener2').empty();\n  var tool;\n  var toolPath;\n  var type;\n  if (isElectron()) {\n    tool = \"host\";\n    toolPath = null;\n    type = \"application/x-ppapi-vysor-audio\";\n  }\n  else {\n    tool = \"pnacl\";\n    toolPath = \"audio_playback/pnacl/Release\";\n    type = null;\n  }\n\n  var hasInitialized;\n  common2.createNaClModule(\"audio_playback\", type, tool, toolPath, 1, 1, {}, function() {\n  }.bind(this), function() {\n    if (hasInitialized) {\n      console.error('NACL module has already initalized');\n      console.error(hasInitialized);\n      console.error(new Error('NACL New Initialization Stack'))\n      return;\n    }\n    hasInitialized = new Error(\"NACL Initialization Stack\");\n    console.log('NACL Audio module initialized')\n  }.bind(this));\n}\n\nPepperAudio.prototype.queueAudio = function(id, audioBuffer0, audioBuffer1) {\n  if (!common2.naclModule || !common2.naclModule.postMessage)\n    return;\n  common2.naclModule.postMessage({\n    type: 'queueAudio',\n    audioBuffer0: audioBuffer0.buffer,\n    audioBuffer1: audioBuffer1.buffer,\n    id: id,\n    sampleLength: audioBuffer0.byteLength / 4,\n  });\n}\n\nPepperAudio.prototype.stop = function() {\n  if (!common2.naclModule || !common2.naclModule.postMessage)\n    return;\n  common2.naclModule.postMessage({\n    type: 'stop',\n  });\n}\n\nmodule.exports = PepperAudio;",";\nfunction parseRTPPacket(buffer) {\n  const buffer0 = buffer.getUint8(0);\n  const buffer1 = buffer.getUint8(1);\n  const hasExtensions = (buffer0 >> 4) & 0x01;\n  const marker = (buffer1) >>> 7;\n  const num_csrc_identifiers = (buffer0 & 0x0F);\n\n  const payloadOffset = (num_csrc_identifiers * 4) + (hasExtensions ? 16 : 12);\n  const payload = buffer.buffer.slice(buffer.byteOffset + payloadOffset);\n\n  return {\n    id: buffer.getUint16(2),\n    timestamp: buffer.getUint32(4),\n    ssrc: buffer.getUint32(8),\n    length: payload.byteLength,\n    marker,\n    payload,\n  };\n}\n\nfunction parseRTCPPacket(buffer) {\n  const buffer1 = buffer.getUint8(1);\n  const packetType = buffer1;\n  const timestamp = buffer.getUint32(16);\n\n  return {\n    timestamp,\n    packetType,\n    buffer,\n    get payload() {\n      console.log(\"yellowstone: Please don't use payload. To remove confusion, this was renamed to simply 'buffer'.\");\n      return buffer;\n    }\n  };\n}\n\nfunction parseTransport(transport) {\n  const obj = {};\n  const parts = transport.split(\";\");\n  const protocol = parts[0];\n\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n    const index = part.indexOf(\"=\");\n\n    if (index > -1 && index !== part.length - 1) {\n      obj[part.substring(0, index)] = part.substring(index + 1);\n    }\n  }\n\n  return {\n    protocol,\n    parameters: obj\n  };\n}\n\nfunction generateSSRC() {\n  return getRandomIntInclusive(1,0xffffffff);\n}\n\nfunction getRandomIntInclusive(min, max) {\n  min = Math.ceil(min);\n  max = Math.floor(max);\n  return Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nexports.parseRTPPacket = parseRTPPacket;","export default class ShaderProgram {\n  /**\n   * @param {WebGLRenderingContext}gl\n   */\n  constructor (gl) {\n    this.gl = gl\n    this.program = this.gl.createProgram()\n  }\n\n  /**\n   * @param {WebGLShader}shader\n   */\n  attach (shader) {\n    this.gl.attachShader(this.program, shader)\n  }\n\n  link () {\n    this.gl.linkProgram(this.program)\n    // If creating the shader program failed, alert.\n    if (!this.gl.getProgramParameter(this.program, this.gl.LINK_STATUS)) {\n      console.error('Unable to initialize the shader program.')\n    }\n  }\n\n  use () {\n    this.gl.useProgram(this.program)\n  }\n\n  /**\n   * @param {string}name\n   * @return {number}\n   */\n  getAttributeLocation (name) {\n    return this.gl.getAttribLocation(this.program, name)\n  }\n\n  /**\n   * @param {string}name\n   * @return {WebGLUniformLocation | null}\n   */\n  getUniformLocation (name) {\n    return this.gl.getUniformLocation(this.program, name)\n  }\n\n  /**\n   * @param {WebGLUniformLocation}uniformLocation\n   * @param {Array<number>}array\n   */\n  setUniformM4 (uniformLocation, array) {\n    this.gl.uniformMatrix4fv(uniformLocation, false, array)\n  }\n}\n","/**\n * Represents a WebGL shader object and provides a mechanism to load shaders from HTML\n * script tags.\n */\n\nexport default class ShaderCompiler {\n  /**\n   * @param {WebGLRenderingContext}gl\n   * @param {{type: string, source: string}}script\n   * @return {WebGLShader}\n   */\n  static compile (gl, script) {\n    let shader\n    // Now figure out what type of shader script we have, based on its MIME type.\n    if (script.type === 'x-shader/x-fragment') {\n      shader = gl.createShader(gl.FRAGMENT_SHADER)\n    } else if (script.type === 'x-shader/x-vertex') {\n      shader = gl.createShader(gl.VERTEX_SHADER)\n    } else {\n      throw new Error('Unknown shader type: ' + script.type)\n    }\n\n    // Send the source to the shader object.\n    gl.shaderSource(shader, script.source)\n\n    // Compile the shader program.\n    gl.compileShader(shader)\n\n    // See if it compiled successfully.\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      throw new Error('An error occurred compiling the shaders: ' + gl.getShaderInfoLog(shader))\n    }\n\n    return shader\n  }\n}\n","/**\n * @type {{type: string, source: string}}\n */\nexport const vertexQuad = {\n  type: 'x-shader/x-vertex',\n  source: `\n  precision mediump float;\n\n  uniform mat4 u_projection;\n  attribute vec2 a_position;\n  attribute vec2 a_texCoord;\n  varying vec2 v_texCoord;\n  void main(){\n      v_texCoord = a_texCoord;\n      gl_Position = u_projection * vec4(a_position, 0.0, 1.0);\n  }\n`\n}\n\n/**\n * @type {{type: string, source: string}}\n */\nexport const fragmentYUV = {\n  type: 'x-shader/x-fragment',\n  source: `\n  precision lowp float;\n  \n  varying vec2 v_texCoord;\n  \n  uniform sampler2D yTexture;\n  uniform sampler2D uTexture;\n  uniform sampler2D vTexture;\n    \n  const mat4 conversion = mat4(\n    1.0,     0.0,     1.402,  -0.701,\n    1.0,    -0.344,  -0.714,   0.529,\n    1.0,     1.772,   0.0,    -0.886,\n    0.0,     0.0,     0.0,     0.0\n  );\n\n  void main(void) {\n    float yChannel = texture2D(yTexture, v_texCoord).x;\n    float uChannel = texture2D(uTexture, v_texCoord).x;\n    float vChannel = texture2D(vTexture, v_texCoord).x;\n    vec4 channels = vec4(yChannel, uChannel, vChannel, 1.0);\n    vec3 rgb = (channels * conversion).xyz;\n    gl_FragColor = vec4(rgb, 1.0);\n  }\n`\n}\n","import ShaderProgram from './ShaderProgram'\nimport ShaderCompiler from './ShaderCompiler'\nimport { fragmentYUV, vertexQuad } from './ShaderSources'\n\nexport default class YUVSurfaceShader {\n  /**\n   *\n   * @param {WebGLRenderingContext} gl\n   * @returns {YUVSurfaceShader}\n   */\n  static create (gl) {\n    const program = this._initShaders(gl)\n    const shaderArgs = this._initShaderArgs(gl, program)\n    const vertexBuffer = this._initBuffers(gl)\n\n    return new YUVSurfaceShader(gl, vertexBuffer, shaderArgs, program)\n  }\n\n  static _initShaders (gl) {\n    const program = new ShaderProgram(gl)\n    program.attach(ShaderCompiler.compile(gl, vertexQuad))\n    program.attach(ShaderCompiler.compile(gl, fragmentYUV))\n    program.link()\n    program.use()\n\n    return program\n  }\n\n  static _initShaderArgs (gl, program) {\n    // find shader arguments\n    const shaderArgs = {}\n    shaderArgs.yTexture = program.getUniformLocation('yTexture')\n    shaderArgs.uTexture = program.getUniformLocation('uTexture')\n    shaderArgs.vTexture = program.getUniformLocation('vTexture')\n\n    shaderArgs.u_projection = program.getUniformLocation('u_projection')\n\n    shaderArgs.a_position = program.getAttributeLocation('a_position')\n    gl.enableVertexAttribArray(shaderArgs.a_position)\n    shaderArgs.a_texCoord = program.getAttributeLocation('a_texCoord')\n    gl.enableVertexAttribArray(shaderArgs.a_texCoord)\n\n    return shaderArgs\n  }\n\n  static _initBuffers (gl) {\n    // Create vertex buffer object.\n    return gl.createBuffer()\n  }\n\n  constructor (gl, vertexBuffer, shaderArgs, program) {\n    this.gl = gl\n    this.vertexBuffer = vertexBuffer\n    this.shaderArgs = shaderArgs\n    this.program = program\n  }\n\n  /**\n   *\n   * @param {Texture} textureY\n   * @param {Texture} textureU\n   * @param {Texture} textureV\n   */\n  setTexture (textureY, textureU, textureV) {\n    const gl = this.gl\n\n    gl.uniform1i(this.shaderArgs.yTexture, 0)\n    gl.uniform1i(this.shaderArgs.uTexture, 1)\n    gl.uniform1i(this.shaderArgs.vTexture, 2)\n\n    gl.activeTexture(gl.TEXTURE0)\n    gl.bindTexture(gl.TEXTURE_2D, textureY.texture)\n\n    gl.activeTexture(gl.TEXTURE1)\n    gl.bindTexture(gl.TEXTURE_2D, textureU.texture)\n\n    gl.activeTexture(gl.TEXTURE2)\n    gl.bindTexture(gl.TEXTURE_2D, textureV.texture)\n  }\n\n  use () {\n    this.program.use()\n  }\n\n  release () {\n    const gl = this.gl\n    gl.useProgram(null)\n  }\n\n  /**\n   * @param {{w:number, h:number}}encodedFrameSize\n   * @param {{maxXTexCoord:number, maxYTexCoord:number}} h264RenderState\n   */\n  updateShaderData (encodedFrameSize, h264RenderState) {\n    const { w, h } = encodedFrameSize\n    this.gl.viewport(0, 0, w, h)\n    this.program.setUniformM4(this.shaderArgs.u_projection, [\n      2.0 / w, 0, 0, 0,\n      0, 2.0 / -h, 0, 0,\n      0, 0, 1, 0,\n      -1, 1, 0, 1\n    ])\n    this.gl.bindBuffer(this.gl.ARRAY_BUFFER, this.vertexBuffer)\n    this.gl.bufferData(this.gl.ARRAY_BUFFER, new Float32Array([\n      // First triangle\n      // top left:\n      0, 0, 0, 0,\n      // top right:\n      w, 0, h264RenderState.maxXTexCoord, 0,\n      // bottom right:\n      w, h, h264RenderState.maxXTexCoord, h264RenderState.maxYTexCoord,\n\n      // Second triangle\n      // bottom right:\n      w, h, h264RenderState.maxXTexCoord, h264RenderState.maxYTexCoord,\n      // bottom left:\n      0, h, 0, h264RenderState.maxYTexCoord,\n      // top left:\n      0, 0, 0, 0\n    ]), this.gl.DYNAMIC_DRAW)\n    this.gl.vertexAttribPointer(this.shaderArgs.a_position, 2, this.gl.FLOAT, false, 16, 0)\n    this.gl.vertexAttribPointer(this.shaderArgs.a_texCoord, 2, this.gl.FLOAT, false, 16, 8)\n  }\n\n  draw () {\n    const gl = this.gl\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT | gl.STENCIL_BUFFER_BIT)\n    gl.drawArrays(this.gl.TRIANGLE_STRIP, 0, 6)\n    gl.bindTexture(gl.TEXTURE_2D, null)\n  }\n}\n","// Copyright 2019 Erik De Rijcke\n//\n// This file is part of Greenfield.\n//\n// Greenfield is free software: you can redistribute it and/or modify\n// it under the terms of the GNU Affero General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Greenfield is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU Affero General Public License for more details.\n//\n// You should have received a copy of the GNU Affero General Public License\n// along with Greenfield.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * Represents a WebGL texture object.\n */\nexport default class Texture {\n  /**\n   * @param {!WebGLRenderingContext}gl\n   * @param {!number}format\n   * @return {!Texture}\n   */\n  static create (gl, format) {\n    const texture = gl.createTexture()\n    gl.bindTexture(gl.TEXTURE_2D, texture)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE)\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE)\n    gl.bindTexture(gl.TEXTURE_2D, null)\n    return new Texture(gl, format, texture)\n  }\n\n  /**\n   * Use Texture.create(..) instead.\n   * @param {WebGLRenderingContext}gl\n   * @param {number}format\n   * @param {WebGLTexture}texture\n   * @private\n   */\n  constructor (gl, format, texture) {\n    /**\n     * @type {WebGLRenderingContext}\n     */\n    this.gl = gl\n    /**\n     * @type {WebGLTexture}\n     */\n    this.texture = texture\n    /**\n     * @type {number}\n     */\n    this.format = format\n  }\n\n  /**\n   * @param {!Uint8Array|HTMLVideoElement}buffer\n   * @param {!Rect}geo\n   * @param {number}stride\n   */\n  subImage2dBuffer (buffer, x, y, width, height) {\n    const gl = this.gl\n    gl.bindTexture(gl.TEXTURE_2D, this.texture)\n    gl.texSubImage2D(gl.TEXTURE_2D, 0, x, y, width, height, this.format, gl.UNSIGNED_BYTE, buffer)\n    gl.bindTexture(gl.TEXTURE_2D, null)\n  }\n\n  /**\n   * @param {!Uint8Array|HTMLVideoElement}buffer\n   * @param {number}width\n   * @param {number}height\n   */\n  image2dBuffer (buffer, width, height) {\n    const gl = this.gl\n    gl.bindTexture(gl.TEXTURE_2D, this.texture)\n    gl.texImage2D(gl.TEXTURE_2D, 0, this.format, width, height, 0, this.format, gl.UNSIGNED_BYTE, buffer)\n    gl.bindTexture(gl.TEXTURE_2D, null)\n  }\n\n  delete () {\n    this.gl.deleteTexture(this.texture)\n    this.texture = null\n  }\n}\n","import YUVSurfaceShader from './YUVSurfaceShader'\nimport Texture from './Texture'\n\nclass CanvasRenderer {\n  constructor(canvas) {\n    this.canvas = canvas;\n    const gl = canvas.getContext('webgl')\n    this.yuvSurfaceShader = YUVSurfaceShader.create(gl)\n    this.yTexture = Texture.create(gl, gl.LUMINANCE)\n    this.uTexture = Texture.create(gl, gl.LUMINANCE)\n    this.vTexture = Texture.create(gl, gl.LUMINANCE)\n  }\n\n  /**\n   * @param {Uint8Array}buffer\n   * @param {number}width\n   * @param {number}height\n   */\n  onPicture (buffer, width, height) {\n    let canvas = this.canvas;\n\n    canvas.width = width\n    canvas.height = height\n\n    // the width & height returned are actually padded, so we have to use the frame size to get the real image dimension\n    // when uploading to texture\n    const stride = width // stride\n    // height is padded with filler rows\n\n    // if we knew the size of the video before encoding, we could cut out the black filler pixels. We don't, so just set\n    // it to the size after encoding\n    const sourceWidth = width\n    const sourceHeight = height\n    const maxXTexCoord = sourceWidth / stride\n    const maxYTexCoord = sourceHeight / height\n\n    const lumaSize = stride * height\n    const chromaSize = lumaSize >> 2\n\n    const yBuffer = buffer.subarray(0, lumaSize)\n    const uBuffer = buffer.subarray(lumaSize, lumaSize + chromaSize)\n    const vBuffer = buffer.subarray(lumaSize + chromaSize, lumaSize + (2 * chromaSize))\n\n    const chromaHeight = height >> 1\n    const chromaStride = stride >> 1\n\n    // we upload the entire image, including stride padding & filler rows. The actual visible image will be mapped\n    // from texture coordinates as to crop out stride padding & filler rows using maxXTexCoord and maxYTexCoord.\n\n    let yTexture = this.yTexture;\n    let uTexture = this.uTexture;\n    let vTexture = this.vTexture;\n\n    yTexture.image2dBuffer(yBuffer, stride, height)\n    uTexture.image2dBuffer(uBuffer, chromaStride, chromaHeight)\n    vTexture.image2dBuffer(vBuffer, chromaStride, chromaHeight)\n\n    this.yuvSurfaceShader.setTexture(yTexture, uTexture, vTexture)\n    this.yuvSurfaceShader.updateShaderData({ w: width, h: height }, { maxXTexCoord, maxYTexCoord })\n    this.yuvSurfaceShader.draw()\n  }\n}\n\nexport default CanvasRenderer;","function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\n//\n//  Copyright (c) 2013 Sam Leitch. All rights reserved.\n//\n//  Permission is hereby granted, free of charge, to any person obtaining a copy\n//  of this software and associated documentation files (the \"Software\"), to\n//  deal in the Software without restriction, including without limitation the\n//  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n//  sell copies of the Software, and to permit persons to whom the Software is\n//  furnished to do so, subject to the following conditions:\n//\n//  The above copyright notice and this permission notice shall be included in\n//  all copies or substantial portions of the Software.\n//\n//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n//  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n//  IN THE SOFTWARE.\n//\n\n/**\n * This class wraps the details of the h264bsd library.\n * Module object is an Emscripten module provided globally by TinyH264.js\n *\n * In order to use this class, you first queue encoded data using queueData.\n * Each call to decode() will decode a single encoded element.\n * When decode() returns H264bsdDecoder.PIC_RDY, a picture is ready in the output buffer.\n * You can also use the onPictureReady() function to determine when a picture is ready.\n * The output buffer can be accessed by calling getNextOutputPicture()\n * An output picture may also be decoded using an H264bsdCanvas.\n * When you're done decoding, make sure to call release() to clean up internal buffers.\n */\nvar TinyH264Decoder = function () {\n  function TinyH264Decoder(tinyH264Module, onPictureReady) {\n    _classCallCheck(this, TinyH264Decoder);\n\n    this.tinyH264Module = tinyH264Module;\n\n    this.onPictureReady = onPictureReady;\n\n    this.pStorage = this.tinyH264Module._h264bsdAlloc();\n    this.pWidth = this.tinyH264Module._malloc(4);\n    this.pHeight = this.tinyH264Module._malloc(4);\n    this.pPicture = this.tinyH264Module._malloc(4);\n\n    this._decBuffer = this.tinyH264Module._malloc(1024 * 1024);\n\n    this.tinyH264Module._h264bsdInit(this.pStorage, 0);\n  }\n\n  TinyH264Decoder.prototype.release = function release() {\n    var pStorage = this.pStorage;\n\n    if (pStorage !== 0) {\n      this.tinyH264Module._h264bsdShutdown(pStorage);\n      this.tinyH264Module._h264bsdFree(pStorage);\n    }\n\n    this.tinyH264Module._free(this.pWidth);\n    this.tinyH264Module._free(this.pHeight);\n    this.tinyH264Module._free(this.pPicture);\n\n    this.pStorage = 0;\n\n    this.pWidth = 0;\n    this.pHeight = 0;\n  };\n\n  TinyH264Decoder.prototype.decode = function decode(nal) {\n    if (nal instanceof ArrayBuffer) {\n      nal = new Uint8Array(nal);\n    }\n\n    this.tinyH264Module.HEAPU8.set(nal, this._decBuffer);\n\n    var retCode = this.tinyH264Module._h264bsdDecode(this.pStorage, this._decBuffer, nal.byteLength, this.pPicture, this.pWidth, this.pHeight);\n    if (retCode === TinyH264Decoder.PIC_RDY) {\n      var width = this.tinyH264Module.getValue(this.pWidth, 'i32');\n      var height = this.tinyH264Module.getValue(this.pHeight, 'i32');\n      var picPtr = this.tinyH264Module.getValue(this.pPicture, 'i8*');\n      var pic = new Uint8Array(this.tinyH264Module.HEAPU8.subarray(picPtr, picPtr + width * height * 3 / 2));\n      this.onPictureReady(pic, width, height);\n    }\n  };\n\n  return TinyH264Decoder;\n}();\n\nTinyH264Decoder.RDY = 0;\nTinyH264Decoder.PIC_RDY = 1;\nTinyH264Decoder.HDRS_RDY = 2;\nTinyH264Decoder.ERROR = 3;\nTinyH264Decoder.PARAM_SET_ERROR = 4;\n\nTinyH264Decoder.MEMALLOC_ERROR = 5;\n\nexport default TinyH264Decoder;","import Worker from './H264NALDecoder.worker'\nimport CanvasRenderer from './CanvasRenderer'\nimport TinyH264Decoder from 'tinyh264/es/TinyH264Decoder'\nimport TinyH264 from 'tinyh264/es//TinyH264'\nimport tinyH264WasmURL from 'tinyh264/es//TinyH264.wasm.asset'\n\nconst assets = {\n  'TinyH264.wasm': tinyH264WasmURL\n}\nconst tinyH264 = TinyH264({ locateFile: path => assets[path] })\n\nlet videoStreamIdCounter = 1\n\nclass TinyDecoder {\n  constructor(listener, encodeWidth, encodeHeight) {\n    this.queue = [];\n    this.videoStreamId = videoStreamIdCounter++;\n    this.pendingDecodes = 0;\n\n    // off scren canvas is implemented but is super janky.\n    // must keep in sync with useCanvasWorker in the h264 worker.\n    this.useOffscreenCanvas = true;\n    // useOffscreenCanvas requires worker.\n    // useWorker is preferred because running in the browser thread is janky.\n    this.useWorker = true || this.useOffscreenCanvas;\n\n    if (this.useWorker) {\n      this.tinyH264Worker = new Worker()\n      this.tinyH264Worker.addEventListener('message', (e) => {\n        const message = /** @type {{type:string, width:number, height:number, data:ArrayBuffer, renderStateId:number}} */e.data\n        switch (message.type) {\n          case 'pictureReady':\n            this.onPictureReady(message)\n            break\n          case 'decoded':\n            this.notifyDecoded();\n            break;\n          case 'decoderReady':\n            this.notifyReady(listener);\n            break\n        }\n      })\n    }\n    else {\n      this.decoder = new TinyH264Decoder(tinyH264, (output, width, height) => {\n        this.canvasRenderer.onPicture(output, width, height)\n      });\n      setTimeout(() => this.notifyReady(listener), 0);\n    }\n  }\n\n  notifyDecoded() {\n    this.pendingDecodes--;\n    this.decodeNext();\n  }\n\n  notifyReady(listener) {\n    this.initWebGLCanvas(listener)\n    if (this.onReady)\n      this.onReady();\n    else\n      console.error('no listener for decoder-ready')\n  }\n\n  initWebGLCanvas (listener) {\n    while (listener.firstChild) {\n      listener.removeChild(listener.firstChild);\n    }\n    let canvas = document.createElement('canvas')\n    canvas.style.width ='100%';\n    canvas.style.height='100%';\n    listener.append(canvas)\n\n    if (this.useOffscreenCanvas && canvas.transferControlToOffscreen) {\n      var offscreen = canvas.transferControlToOffscreen();\n\n      this.tinyH264Worker.postMessage({\n        type: 'canvas',\n        canvas: offscreen,\n        renderStateId: this.videoStreamId\n      }, [offscreen]);\n    }\n    else {\n      this.canvasRenderer = new CanvasRenderer(canvas);\n    }\n  }\n\n\n  /**\n   * @param {{width:number, height:number, data: ArrayBuffer}}message\n   */\n  onPictureReady (message) {\n    const { width, height, data } = message\n    this.canvasRenderer.onPicture(new Uint8Array(data), width, height)\n  }\n\n  release () {\n    if (this.tinyH264Worker) {\n      tinyH264Worker.postMessage({ type: 'release', renderStateId: this.videoStreamId })\n      tinyH264Worker = null\n    }\n  }\n\n  /**\n   * @param {Uint8Array} h264Nal\n   */\n  enqueueDecode(h264Nal) {\n    if (this.tinyH264Worker) {\n      this.tinyH264Worker.postMessage({\n        type: 'decode',\n        data: h264Nal.buffer,\n        offset: h264Nal.byteOffset,\n        length: h264Nal.byteLength,\n        renderStateId: this.videoStreamId\n      }, [h264Nal.buffer])\n    }\n    else {\n      this.decoder.decode(h264Nal);\n      this.notifyDecoded();\n    }\n  }\n\n  decodeNext () {\n    if (this.queue.length == 0) {\n      return;\n    }\n\n    if (this.pendingDecodes > 10) {\n      return;\n    }\n    this.pendingDecodes++;\n\n    const packet = this.queue.shift();\n    const nextFrame = packet.video;\n    this.enqueueDecode(nextFrame)\n  }\n\n  decode(video, presentationTimeMs, syncFrame) {\n    if (syncFrame) {\n      this.queue = [];\n    }\n\n    this.queue.push({\n      video,\n      presentationTimeMs,\n    });\n\n    this.decodeNext();\n  }\n}\n\nexport default TinyDecoder;","export default __webpack_public_path__ + \"f99175d3b657e4fac2c971aa69fe9513.asset\";","import TinyDecoder from './tinydecoder'\nconst {copyTextToClipboard, isBrowser, getQueryVariable, throttleTimeout, nextTick, isElectron, readLine, writeLine, readLenPackets} = require('koush-utils/lib/base/util');\nconst Adb = require('koush-utils/adb/adb-client');\nconst {populateDisplaySettings, loadDeviceSettings, applyDeviceSettings, saveDeviceSettings, showNotification} = require('./device-settings');\nconst PepperDecoder = require('./pepper-decoder');\nconst {showModal, shortModal} = require('./modal');\nconst {getUserSelectedDevices, AdbServer} = require('koush-utils/adb/adb');\nconst {GcmRtcManager} = require('koush-utils/lib/socket/gcmsocket');\n\nvar h264Socket;\nvar inputWebSocket;\nvar deviceSettings;\nvar vysorMode;\nvar headFader;\nvar screenWidth;\nvar screenHeight;\nvar encodeWidth;\nvar encodeHeight;\nvar rectWidth;\nvar rectHeight;\nvar titleBarHeight = 36;\nvar bottomBarHeight = 48;\nvar listenerDiv;\nvar downTime;\nvar useLicenseCheck;\nvar videoDumpSocket;\nvar audioDumpSocket;\nvar flash;\nvar needsRestartForVideoDump;\nvar vysorSettings = vysorDefaultSettings;\nvar toggleRecord = function() {}\nvar ignoreNextResize;\nvar audioContext;\n\nconst CastServer = require('./cast/cast-server');\n\nconst sharedGlobals = window.sharedGlobals;\n\nif (!isBrowser()) {\n  var castServer = new CastServer();\n  castServer.onStop = function() {\n    $('#headphones').show();\n  }\n  castServer.onStart = function() {\n    $('#headphones').hide();\n  }\n}\n\nfunction ensureAudioContext() {\n  if (audioContext)\n    return;\n  try {\n    // sample rate is simply a hint... it is not necessarily respected\n    audioContext = new AudioContext({\n      latencyHint: 'interactive',\n      sampleRate: 48000,\n    });\n    console.log('Created AudioContext', audioContext);\n  }\n  catch (e) {\n    console.error('Error creating AudioContext', e);\n  }\n}\n\nif (isElectron())\n  ensureAudioContext();\n\n\nfunction maybeConnectUDP() {\n  if (isBrowser())\n    return;\n\n  if (!window._lm || !window._lm._il)\n    return;\n\n  // move this crap into a password ack event\n  if (h264Socket && !castServer.udpSocket && audioContext) {\n    console.log('Connecting to UDP')\n    if (!deviceSettings.castId) {\n      function makeId(len) {\n        var text = \"\";\n        var possible = \"abcdef0123456789\";\n\n        for (var i = 0; i < len; i++)\n          text += possible.charAt(Math.floor(Math.random() * possible.length));\n\n        return text;\n      }\n\n      deviceSettings.castId = makeId(40);\n      saveMySettings();\n    }\n    castServer.castId = deviceSettings.castId;\n    // castServer.castId = \"02cae733a21da909dfa5a372416a37d3\";\n    castServer.connectUDP(adbSocketFactory, audioContext);\n\n    showModal({\n      title: 'Vysor Audio Output',\n      body: 'Vysor is waiting for the audio stream. Follow the <a target=\"_blank\" href=\"https://github.com/koush/vysor.io/issues/426\">instructions</a> to grant Vysor permission to capture your Android audio output.',\n      okButton: 'Open Instructions',\n      ok: function() {\n        nextTick(function() {\n          chrome.browser.openTab({url: 'https://github.com/koush/vysor.io/issues/426'});\n        })\n      },\n      cancelButton: \"OK\",\n    })\n  }\n\n  Adb.shell({\n    socketFactory: adbSocketFactory,\n    command: 'am start -a android.settings.CAST_SETTINGS',\n    serialno: device.serialno\n  }, function() {\n    console.log('asdsad');\n  });\n}\n\nsharedGlobals.siphonAudio = function(dump) {\n  if (audioDumpSocket) {\n    audioDumpSocket.destroy();\n    audioDumpSocket = null;\n  }\n\n  if (!dump)\n    return;\n\n  if (!isElectron()) {\n    audioDumpSocket = dump;\n  }\n  else {\n    // handle electron remoting quirks\n    audioDumpSocket = {\n      dataReceived: function(data) {\n        if (data.asUint8Array)\n          data = data.asUint8Array();\n        if (data.constructor == ArrayBuffer)\n          data = new Uint8Array(data);\n        dump.dataReceived(data);\n      },\n      destroy: function() {\n        dump.destroy();\n      }\n    }\n  }\n\n  castServer.siphon(audioDumpSocket);\n}\n\nsharedGlobals.siphonFlv = function(dump) {\n  if (videoDumpSocket) {\n    videoDumpSocket.destroy();\n    videoDumpSocket = null;\n    flash = null;\n  }\n\n  if (!dump)\n    return;\n\n  if (!isElectron()) {\n    videoDumpSocket = dump;\n  }\n  else {\n    // handle electron remoting quirks\n    videoDumpSocket = {\n      dataReceived: function(data) {\n        if (data.asUint8Array)\n          data = data.asUint8Array();\n        if (data.constructor == ArrayBuffer)\n          data = new Uint8Array(data);\n        dump.dataReceived(data);\n      },\n      destroy: function() {\n        dump.destroy();\n      }\n    }\n  }\n\n  flash = new FlashPackager(videoDumpSocket, encodeWidth, encodeHeight, 30);\n  needsRestartForVideoDump = true;\n  sendEvent({\n    type: 'resolution',\n    resolution: resolutions[deviceSettings.resolution],\n  })\n}\n\nvar resolutions = [\n  0,\n  .25,\n  .5,\n  .75,\n  1\n];\n\nvar bitrates = [\n  500000,\n  750000,\n  1000000,\n  1500000,\n  2000000,\n  3000000,\n  4000000,\n  6000000,\n  8000000,\n];\n\nvar decoders = [\n  \"software\",\n  \"hardware\",\n  \"hardware_with_fallback\",\n  \"tinyh264\",\n]\n\nvar libind = function(msg, f)  {\n  return f;\n}\n\nif (!window.tracker) {\n  window.tracker = {\n    sendEvent: function() {},\n    sendAppView: function() {},\n  };\n}\n\nfunction sendEvent(e) {\n  if (!inputWebSocket)\n    return;\n  if (e.clientX) {\n    e.downDelta = Date.now() - downTime;\n    if (!listenerDiv)\n      listenerDiv = $('#listener');\n    e.clientX = e.clientX / listenerDiv.width() * screenWidth;\n    if (e.clientX > screenWidth || e.clientX < 0)\n      return;\n  }\n  if (e.clientY) {\n    if (!listenerDiv)\n      listenerDiv = $('#mirror');\n    e.clientY = e.clientY / listenerDiv.height() * screenHeight;\n    if (e.clientY > screenHeight || e.clientY < 0)\n      return;\n  }\n  inputWebSocket.send(JSON.stringify(e));\n}\n\nfunction interpretEvent(e, source) {\n  if (!e)\n    return;\n\n  if (e.constructor.name == 'String') {\n    if (e.startsWith('KEYCODE_')) {\n      sendEvent({\n        type: 'keyevent',\n        keyevent: e\n      })\n      return true;\n    }\n    else {\n      switch (e) {\n        case 'VYSOR_SHOW_TITLE_BAR':\n          delayFadeHead();\n          break;\n        case 'VYSOR_ENTER_FULLSCREEN':\n          setFullscreen(true);\n          break;\n        case 'VYSOR_EXIT_FULLSCREEN':\n          setFullscreen(false);\n          break;\n        case 'VYSOR_RECORD_SCREEN':\n          if (!isBrowser())\n            toggleRecord(source);\n          break;\n        case 'VYSOR_SCREENSHOT':\n          if (!isBrowser())\n            chrome.browser.openTab({url: 'http://127.0.0.1:' + window.httpPort + '/device/' + (device.id || device.serialno) + '/screenshot-' + Date.now() + '.jpg'});\n          break;\n        case 'VYSOR_OPEN_DEVICE_SETTINGS':\n          showSettings();\n          if (!isBrowser())\n            openList();\n          break;\n        case 'VYSOR_ROTATE_SCREEN':\n          sendEvent({\n            type: 'rotate'\n          })\n          break;\n        default:\n          return;\n      }\n      return true;\n    }\n  }\n  else if (e.constructor.name == 'Number') {\n    sendEvent({\n      type: 'keycode',\n      keycode: e\n    })\n    return true;\n  }\n  else {\n    if (e.keyevent) {\n      sendEvent({\n        type: 'keyevent',\n        keyevent: e.keyevent,\n        shift: (e.shiftKey && source && source.shiftKey) ? true : false\n      })\n      return true;\n    }\n    else if (e.keycode) {\n      sendEvent({\n        type: 'keycode',\n        keycode: e.keycode,\n        shift: (e.shiftKey && source && source.shiftKey) ? true : false\n      })\n      return true;\n    }\n  }\n}\n\nfunction delayFadeHead() {\n  if (vysorMode == 'inkwire') {\n    $('.head').hide();\n    return;\n  }\n  if (titleBarHeight) {\n    clearTimeout(headFader);\n    $('.head').fadeTo(0, 1);\n    return;\n  }\n  $('.head').fadeTo(0, .8);\n  clearTimeout(headFader);\n  headFader = setTimeout(function() {\n    $('.head').fadeOut();\n  }, 2000);\n}\n\n$(window).focus(function() {\n  delayFadeHead();\n\n  sendEvent({\n    type: 'wakeup'\n  })\n});\n\n$(window).bind(\"paste\", function(e) {\n  // access the clipboard using the api\n  var pastedData = e.originalEvent.clipboardData.getData('text');\n  if (pastedData && pastedData.length) {\n    sendEvent({\n      type: \"keychar\",\n      keychar: pastedData\n    })\n  }\n});\n\nwindow.addEventListener(\"mousewheel\", function(e) {\n  sendEvent({\n    type: 'scroll',\n    clientX: e.offsetX,\n    clientY: e.offsetY,\n    deltaX: e.wheelDeltaX / 100,\n    deltaY: e.wheelDeltaY / 100\n  })\n}, false);\n\n$(window).keypress(function(e) {\n  var s = String.fromCharCode(e.keyCode);\n  if (!s.length)\n    return;\n  // console.log('sending ' + s)\n  sendEvent({\n    type: \"keychar\",\n    keychar: s\n  })\n})\n\n$(window).keydown(function(e) {\n  if (interpretEvent(vysorSettings.keydown[e.keyCode] || vysorSettings.keydown[e.key], e)) {\n    e.stopPropagation();\n  }\n})\n\nvar resizeTimeout;\n$(window).resize(function() {\n  if (!screenHeight || !screenWidth)\n    return;\n\n  clearTimeout(resizeTimeout);\n  resizeTimeout = setTimeout(function() {\n    if (!isFreeSize()) {\n      // always read inner*, but preferably set innerBounds\n      // if (window.chrome && window.chrome.app && window.chrome.app.window)\n      //   iw = chrome.app.window.current().innerBounds.width;\n      var iw = innerWidth;\n      var newScreenHeight = iw * (screenHeight / screenWidth);\n\n      rectWidth = iw;\n      rectHeight = newScreenHeight;\n\n      resizeWindow();\n    }\n    else {\n      sendEvent({\n        type: 'displaySettings',\n        size: innerWidth + 'x' + (innerHeight - titleBarHeight - bottomBarHeight),\n        density: deviceSettings.displaySettings.density,\n      })\n    }\n  }, 500)\n})\n\nfunction enforceAspectRatio(ow, oh) {\n  if (isFreeSize()) {\n    rectWidth = screenWidth;\n    rectHeight = screenHeight;\n  }\n  else {\n    if (window.chrome && window.chrome.app && window.chrome.app.window && isFullscreen()) {\n      rectWidth = screen.availWidth;\n      rectHeight = screen.availHeight;\n    }\n\n    if (oh == screenWidth && ow == screenHeight) {\n      // orientation change\n      var tmp = rectWidth;\n      rectWidth = rectHeight;\n      rectHeight = tmp;\n    }\n    else {\n      var iw;\n      if (screenWidth > screenHeight)\n        iw = Math.max(innerWidth, innerHeight);\n      else\n        iw = Math.min(innerWidth, innerHeight);\n      // always read inner*, but preferably set innerBounds\n      // if (window.chrome && window.chrome.app && window.chrome.app.window)\n      //   iw = chrome.app.window.current().innerBounds.width;\n\n      var newScreenHeight = iw * (screenHeight / screenWidth);\n      rectWidth = iw;\n      rectHeight = newScreenHeight;\n    }\n  }\n\n  resizeWindow();\n}\n\nfunction isFullscreen() {\n  return document.webkitFullscreenElement || document.msFullscreenElement || document.mozFullscreenElement || document.fullscreenElement;\n}\n\nfunction isFreeSize() {\n  return deviceSettings && deviceSettings.displaySettings && deviceSettings.displaySettings.freeSize;\n}\n\nfunction resizeWindow() {\n  // always read inner*, but preferably set innerBounds\n  var iw = innerWidth;\n  var ih = innerHeight;\n\n  var maxWidth = screen.availWidth;\n  var maxHeight = screen.availHeight;\n\n  if (isFullscreen() || isFreeSize() || isBrowser()) {\n    maxWidth = iw;\n    maxHeight = ih;\n  }\n\n  if (rectWidth > maxWidth) {\n    rectWidth = maxWidth;\n    rectHeight = screenHeight / screenWidth * rectWidth;\n  }\n  // do i need this? we are setting the innerBounds/contentSize\n  // var windowDecorHeight = outerHeight - innerHeight;\n  var windowDecorHeight = 0;\n  if (rectHeight + bottomBarHeight + titleBarHeight + windowDecorHeight > maxHeight) {\n    rectHeight = maxHeight - bottomBarHeight - titleBarHeight - windowDecorHeight;\n    rectWidth = screenWidth / screenHeight * rectHeight;\n  }\n\n  // rectWidth = Math.round(rectWidth);\n  // rectHeight = Math.round(rectHeight);\n\n  // may not have values yet\n  if (!rectWidth || !rectHeight)\n    return;\n\n  // prevent resize noise by allowing some degree of error\n  var rw = Math.round(rectWidth);\n  var rh = Math.round(rectHeight + bottomBarHeight + titleBarHeight);\n  if (!isFullscreen() && !isFreeSize()) {\n    if (ignoreNextResize) {\n      ignoreNextResize = false;\n    }\n    else {\n      ignoreNextResize = true;\n      if (isElectron()) {\n        if (Math.abs(innerWidth - rw) >= 2 || Math.abs(innerHeight - rh) >= 2)\n          chrome.app.window.current().w.setContentSize(rw, rh)\n      }\n      else if (window.chrome && window.chrome.app && window.chrome.app.window) {\n        if (Math.abs(innerWidth - rw) >= 2)\n          chrome.app.window.current().innerBounds.width = rw;\n        if (Math.abs(innerHeight - rh) >= 2)\n          chrome.app.window.current().innerBounds.height = rh;\n      }\n    }\n  }\n\n  var l = (iw - rectWidth) / 2;\n  var c = $('#mirror, #listener');\n  c.css('left', l)\n  c.css('top', (ih - rectHeight - bottomBarHeight + titleBarHeight) / 2);\n  $('.foot').width(rectWidth);\n  $('.foot').css('left', l);\n  $('.overlay').width(rectWidth);\n  $('.overlay').css('left', l);\n\n  c = $('#mirror, embed, #listener');\n  c.width(Math.round(rectWidth));\n  c.height(Math.round(rectHeight));\n\n  $('#dead, #drag, #reconnect').width(rectWidth);\n  $('#dead, #drag, #reconnect').height(rectHeight + bottomBarHeight + titleBarHeight);\n}\n\nfunction trackUsage(elapsed) {\n  if (!window.chrome || !window.chrome.storage)\n    return;\n  chrome.storage.local.get(['vysorUsage', 'vysorDailyUsage', 'lastDailyReport'], function(d) {\n    var vysorUsage = d.vysorUsage;\n    var lastDailyReport = d.lastDailyReport;\n    var vysorDailyUsage = d.vysorDailyUsage;\n    var now = Date.now();\n    if (!vysorUsage)\n      vysorUsage = 0;\n    if (!vysorDailyUsage)\n      vysorDailyUsage = 0;\n\n    if (!lastDailyReport) {\n      chrome.storage.local.set({\n        'lastDailyReport': now\n      })\n    }\n    else {\n      if (now > lastDailyReport + 24 * 60 * 60 * 1000) {\n        // send analytics\n        var hoursUsed = vysorDailyUsage / (60 * 60 * 1000);\n        // half hour\n        hoursUsed = Math.round(hoursUsed * 2) / 2;\n        if (hoursUsed <= 24 && hoursUsed >= 0) {\n          tracker.sendEvent('daily-usage', hoursUsed.toString());\n          tracker.sendEvent('daily-usage-licensed', _lm._il);\n        }\n        // reset\n        vysorDailyUsage = 0;\n        chrome.storage.local.set({\n          'lastDailyReport': now\n        })\n      }\n    }\n\n    var beforeVysorUsage = vysorUsage;\n    vysorUsage += elapsed;\n\n    if (beforeVysorUsage < 2 * 60 * 60 * 1000 && vysorUsage > 2 * 60 * 60 * 1000) {\n      if (!window._lm || !window._lm._il) {\n        recommendProOnce();\n      }\n    }\n    else if (vysorUsage > 3 * 60 * 60 * 1000) {\n      recommendRateOnce();\n    }\n\n    vysorDailyUsage += elapsed;\n    chrome.storage.local.set({\n      'vysorUsage': vysorUsage,\n      'vysorDailyUsage': vysorDailyUsage\n    })\n  })\n}\n\nfunction setFullscreen(fullscreen) {\n  if (!fullscreen) {\n    if (document.exitFullscreen)\n      document.exitFullscreen();\n    else if (document.webkitExitFullscreen)\n      document.webkitExitFullscreen();\n    else if (document.mozExitFullscreen)\n      document.mozExitFullscreen();\n    else if (document.mskitExitFullscreen)\n      document.mskitExitFullscreen();\n  }\n  else {\n    if (document.documentElement.requestFullscreen)\n      document.documentElement.requestFullscreen();\n    else if (document.documentElement.webkitRequestFullscreen)\n      document.documentElement.webkitRequestFullscreen();\n    else if (document.documentElement.msRequestFullscreen)\n      document.documentElement.msRequestFullscreen();\n    else if (document.documentElement.mozRequestFullScreen)\n      document.documentElement.mozRequestFullScreen();\n  }\n};\n\nfunction setupTitleBar() {\n  $('.topbuttonbar>.btn-toolbar').empty();\n  $('.head').attr('style', vysorSettings.titleBar.style)\n  var buttonGroups = vysorSettings.titleBar.buttonGroups;\n\n  (function() {\n    if (isBrowser())\n      return;\n    // audio\n    var outer = $(\"<span id='headphones'></span>\");\n    outer.attr('class', 'btn-group btn-group-xs');\n    outer.attr('role', 'group');\n\n    var el = $(\"<a></a>\");\n    el.attr('class', 'btn btn-default fa fa-headphones');\n    el.attr('title', 'Mute Phone and Mirror Audio');\n    el.click(libind('Audio Mirroring', function() {\n      ensureAudioContext();\n      maybeConnectUDP();\n    }));\n\n    outer.append(el);\n\n    $('.topbuttonbar>.btn-toolbar').append(outer);\n  })();\n\n  $(buttonGroups).each(function(i, buttonGroup) {\n    var outer = $(\"<span></span>\");\n    outer.attr('class', 'btn-group btn-group-xs');\n    outer.attr('role', 'group');\n\n    $(buttonGroup).each(function(j, button) {\n      var el = $(\"<a></a>\");\n      el.attr('class', 'btn btn-default fa ' + button.class);\n      el.attr('title', button.title);\n      el.click(function(e) {\n        interpretEvent(button.event, e);\n      })\n      outer.append(el);\n    });\n\n    $('.topbuttonbar>.btn-toolbar').append(outer);\n  })\n}\n\nfunction setupNavigationBar() {\n  $('.foot-row').empty();\n  $('.foot-row').attr('style', vysorSettings.navigationBar.style)\n  var buttons = vysorSettings.navigationBar.buttons;\n  var width = Math.round(100 / buttons.length) + '%';\n  $(buttons).each(function(i, button) {\n    var el = $(\"<span></span>\");\n    el.attr('class', 'fa fa-lg ' + button.class);\n    el.attr('title', button.title);\n    el.width(width);\n    el.click(function() {\n      interpretEvent(button.event);\n    })\n    $('.foot-row').append(el);\n  })\n}\n\nfunction saveMySettings() {\n  saveDeviceSettings(device.id || device.serialno, deviceSettings);\n}\n\nsharedGlobals.docReady = function() {\n  if (!window._lm) {\n    libind = function(msg, f)  {\n      return f;\n    }\n  }\n  else {\n    libind = function(feature, f, fb) {\n      return function() {\n        if (useLicenseCheck && !_lm._il) {\n          showModal({\n            title: 'Vysor Pro',\n            body: 'The ' + feature + ' feature is only available to Vysor Pro users.',\n            okButton: 'Upgrade',\n            ok: function() {\n              _lm.startPurchase();\n            }\n          })\n          if (fb)\n            fb.apply(this, arguments);\n          return;\n        }\n        f.apply(this, arguments);\n      };\n    }\n  }\n\n  toggleRecord = libind('Record Screen', function(e) {\n    if (!$(e.target).hasClass('fa-stop-circle-o')) {\n      sendEvent({\n        type: 'start-recording'\n      })\n    }\n    else {\n      sendEvent({\n        type: 'stop-recording'\n      })\n    }\n    $(e.target).toggleClass('fa-video-camera fa-stop-circle-o')\n  });\n\n  var dragTimer;\n  $(document).on('dragover', function(e) {\n    $('#drag').fadeIn();\n    clearTimeout(dragTimer);\n    e.preventDefault();\n    e.stopPropagation();\n  })\n\n  $(document).on('dragleave', function() {\n    dragTimer = setTimeout(function() {\n      $('#drag').fadeOut();\n    }, 1000)\n  })\n\n  $(document).on('drop', libind('Drag and Drop', function(e) {\n    $('#drag').fadeOut();\n    e.preventDefault();\n    if (e.originalEvent.dataTransfer.files.length != 1) {\n      showNotification('You may only drag and drop one file at a time.');\n      return;\n    }\n    var file = e.originalEvent.dataTransfer.files[0];\n    console.log(file);\n    Adb.push({\n      socketFactory: adbSocketFactory,\n      socket: new FileSocket(file),\n      file: \"/sdcard/vysor/\" + file.name,\n      serialno: device.serialno\n    }, function() {\n      var command = 'am start -a android.intent.action.VIEW -d file:/sdcard/vysor/' + file.name;\n      if (file.type && file.type.length) {\n        command += ' -t ' + file.type;\n      }\n      else if (file.name.endsWith('.apk')) {\n        Adb.shell({\n          socketFactory: adbSocketFactory,\n          command:'pm install -r /sdcard/vysor/' + file.name,\n          serialno: device.serialno\n        }, function(result) {\n          showNotification('APK installation result: ' + result.trim());\n        });\n        return;\n      }\n\n      Adb.shell({\n        socketFactory: adbSocketFactory,\n        command: command,\n        serialno: device.serialno\n      }, function() {\n        showNotification('File has been transfered and is being opened on the Android.')\n      })\n    })\n  }, function(e) {\n    $('#drag').fadeOut();\n    e.preventDefault();\n  }));\n\n  common.attachDefaultListeners();\n  common2.attachDefaultListeners();\n\n  $('#listener').mouseup(function(e) {\n    if (e.button != 0)\n      return;\n    sendEvent({\n      type: e.type,\n      clientX: e.offsetX,\n      clientY: e.offsetY\n    })\n  })\n\n  $('#listener').bind('touchstart touchend touchmove', function (e) {\n    var eventName;\n    if (e.type == 'touchstart')\n      eventName = 'mousedown';\n    else if (e.type == 'touchend')\n      eventName = 'mouseup';\n    else\n      eventName = 'mousemove';\n\n    var t = e.currentTarget;\n\n    // stop touch event\n    e.stopPropagation();\n    e.preventDefault();\n\n    e = e.originalEvent;\n\n    var touches = e.touches[0];\n    if (!touches)\n      touches = e.changedTouches[0];\n\n    // translate to mouse event\n    var clkEvt = document.createEvent('MouseEvent');\n    clkEvt.initMouseEvent(eventName, true, true, window, e.detail,\n                 touches.screenX, touches.screenY,\n                 touches.clientX, touches.clientY,\n                 false, false, false, false,\n                 0, null);\n    clkEvt.isTouch = true;\n    t.dispatchEvent(clkEvt);\n\n    // or just handle touch event\n//    myMoveHandler(e);\n  });\n  console.log('docReady')\n\n  $('#listener').mousedown(function(e) {\n    if (e.button == 0) {\n      downTime = Date.now();\n      sendEvent({\n        type: e.type,\n        clientX: e.offsetX,\n        clientY: e.offsetY\n      })\n      return;\n    }\n\n    interpretEvent(vysorSettings.mousedown[e.button], e);\n  })\n\n  $('#listener').mousemove(function(e) {\n    if ((e.buttons & 1) == 0 && !e.originalEvent.isTouch)\n      return;\n    sendEvent({\n      type: e.type,\n      clientX: e.offsetX,\n      clientY: e.offsetY\n    })\n  })\n\n  $('.head').bind('mouseup mousedown mousemove', function(e) {\n    e.stopPropagation();\n    delayFadeHead();\n  })\n\n  $('#rotate-button').click(function() {\n    sendEvent({\n      type: 'rotate'\n    })\n  })\n\n  $('#screenshot-button').click(function() {\n    chrome.browser.openTab({url: 'http://127.0.0.1:' + httpPort + '/device/' + (device.id || device.serialno) + '/screenshot-' + Date.now() + '.jpg'});\n  })\n\n  $('#record-button').click(libind('Record Screen', function() {\n    if ($('#record-button>span').hasClass('fa-video-camera')) {\n      sendEvent({\n        type: 'start-recording'\n      })\n    }\n    else {\n      sendEvent({\n        type: 'stop-recording'\n      })\n    }\n    $('#record-button>span').toggleClass('fa-video-camera fa-stop-circle-o')\n  }));\n\n  if (!window.chrome || !window.chrome.app || !window.chrome.app.window) {\n    $('#screenshot-button').hide();\n    $('#record-button').hide();\n  }\n\n  $('#power').click(function() {\n    sendEvent({\n      type: 'keycode',\n      keycode: 26\n    })\n  })\n\n  $('#volume-down').click(function() {\n    sendEvent({\n      type: 'keycode',\n      keycode: 25\n    })\n  })\n\n  $('#volume-up').click(function() {\n    sendEvent({\n      type: 'keycode',\n      keycode: 24\n    })\n  })\n\n  setupNavigationBar();\n  setupTitleBar();\n\n  $('#reconnect-button').click(function() {\n    tryReconnect();\n    $('#reconnect').hide();\n  });\n\n  $('#settings-button').click(function() {\n    showSettings();\n    if (!isBrowser())\n      openList();\n  })\n\n  $('#web-video-stream').click(libind('Web Video Stream', function() {\n    var link = $('#web-video-stream').text();\n    $('#settings-modal').modal('hide');\n    copyTextToClipboard(link);\n    setTimeout(function() {\n      shortModal('Copied Web Video Stream Link', link);\n    }, 500);\n  }));\n\n  var edit = $('#new-display-name');\n\n  function commit() {\n    $('#settings-modal').modal('hide');\n    var newName = $(edit).prop('value');\n    deviceSettings.friendlyName = newName;\n    $('.title, title').text(deviceSettings.friendlyName || device.name);\n    saveMySettings();\n\n    var list = chrome.app.window.get('list');\n    if (list && list.contentWindow.updateDeviceName)\n      list.contentWindow.updateDeviceName(device.id || device.serialno, deviceSettings.friendlyName || device.name);\n  }\n\n  $(edit).bind(\"keypress\", function(e) {\n    e.stopPropagation();\n    var key = e.which;\n    if(key == 13) {\n      commit();\n      return false;\n    }\n  });\n\n  $('#settings-ok').click(commit);\n  $('#settings-defaults').click(function() {\n    deviceSettings = getDefaultDeviceSettings();\n    try {\n      useLicenseCheck = false;\n      applyDeviceSettings(deviceSettings);\n    }\n    finally {\n      useLicenseCheck = true;\n    }\n    // use this to trigger a change?\n    sendEvent({\n      type: 'displaySettings',\n      size: 'reset',\n      density: 'reset',\n      resolution: resolutions[deviceSettings.resolution],\n    })\n  });\n\n\n  // do this after applying settings so license stuff doesn't get triggered\n  $(\"#softkeys-check\").change(function() {\n    deviceSettings.showSoftKeys = this.checked;\n    if (this.checked) {\n      $('.foot').show();\n      bottomBarHeight = 48;\n    }\n    else {\n      $('.foot').hide();\n      bottomBarHeight = 0;\n    }\n    resizeWindow();\n  });\n\n  $('#pin-title-check').change(function() {\n    deviceSettings.pinTitleBar = this.checked;\n    if (this.checked)\n      titleBarHeight = 36;\n    else\n      titleBarHeight = 0;\n    resizeWindow();\n    delayFadeHead();\n  })\n\n  $('#fullscreen-check').change(libind('Fullscreen Mode', function() {\n    setFullscreen(this.checked);\n  }, function() {\n    this.checked = false;\n  }));\n\n  $('#always-on-top-check').change(libind('Always On Top', function() {\n    deviceSettings.alwaysOnTop = this.checked;\n    if (window.chrome && window.chrome.app && window.chrome.app.window)\n      chrome.app.window.current().setAlwaysOnTop(this.checked);\n  }, function() {\n    this.checked = false;\n  }));\n\n  $('#bitrate').change(libind('Video Quality', function() {\n    deviceSettings.bitrate = this.selectedIndex;\n    var bitrate = bitrates[this.selectedIndex];\n    sendEvent({\n      type: 'bitrate',\n      bitrate: bitrate\n    })\n  }, function() {\n    this.selectedIndex = 0;\n  }));\n\n  $('#resolution').change(libind('Video Resolution', function() {\n    deviceSettings.resolution = this.selectedIndex;\n    var resolution = resolutions[this.selectedIndex];\n    sendEvent({\n      type: 'resolution',\n      resolution: resolution\n    })\n  }, function() {\n    this.selectedIndex = 0;\n  }));\n\n  $('#decoder').change(function() {\n    deviceSettings.decoder = this.selectedIndex;\n    // use this to trigger a change?\n    sendEvent({\n      type: 'resolution',\n      resolution: resolutions[deviceSettings.resolution]\n    })\n  });\n\n  function newDefaults(bitrate, resolution) {\n    $(\"#bitrate\").prop('selectedIndex', bitrate);\n    $(\"#resolution\").prop('selectedIndex', resolution);\n\n    deviceSettings.bitrate = bitrate;\n    var bitrate = bitrates[bitrate];\n    sendEvent({\n      type: 'bitrate',\n      bitrate: bitrate\n    })\n\n    deviceSettings.resolution = resolution;\n    var resolution = resolutions[resolution];\n    sendEvent({\n      type: 'resolution',\n      resolution: resolution\n    })\n  }\n\n  $('#low-quality-defaults').click(libind('Video Quality', function() {\n    newDefaults(0, 0);\n  }))\n\n  $('#medium-quality-defaults').click(libind('Video Quality', function() {\n    newDefaults(4, 2);\n  }))\n\n  $('#high-quality-defaults').click(libind('Video Quality', function() {\n    newDefaults(8, 3);\n  }))\n\n  $('#display-settings').change(libind('Display Settings', function() {\n    var applyChange = function() {\n      var displaySettings = commonDisplaySettings[this.selectedIndex];\n      var size = displaySettings.freeSize ? innerWidth + 'x' + (innerHeight - titleBarHeight - bottomBarHeight) : displaySettings.size;\n      deviceSettings.displaySettings = displaySettings;\n      saveMySettings();\n\n      // use this to trigger a change?\n      sendEvent({\n        type: 'displaySettings',\n        size: size,\n        density: displaySettings.density,\n      })\n\n      // show a warning for non-default settings\n      if (this.selectedIndex) {\n        showModal({\n          title: 'Display Settings',\n          body: 'Please close the Vysor window before disconnecting your Android to reset your Display Settings.',\n          hideCancel: true,\n        })\n      }\n    }.bind(this);\n\n    if (this.selectedIndex == 0) {\n      applyChange();\n      return;\n    }\n\n    showModal({\n      title: 'Display Settings',\n      body: 'The Display Settings feature is not recommended for non-Nexus devices and may require you to hard reset your device.',\n      okButton: 'Continue',\n      ok: function() {\n        $('#notificationModal').one('hidden.bs.modal', applyChange);\n      }.bind(this),\n      cancel: function() {\n        this.selectedIndex = 0;\n      }.bind(this)\n    })\n  }, function() {\n    this.selectedIndex = 0;\n  }));\n\n  $('#dim-display').change(libind('Dim Dislay', function() {\n    deviceSettings.dimDisplay = this.checked;\n    saveMySettings();\n\n    sendEvent({\n      type: 'dimDisplay',\n      dimDisplay: this.checked,\n    })\n  }, function() {\n    this.checked = false;\n  }));\n\n  populateDisplaySettings();\n\n  resizeWindow();\n  delayFadeHead();\n\n  if (window.tracker)\n    tracker.sendAppView('screen');\n}\n\nvar forceAds;\nfunction showAd() {\n  if (!window._lm)\n    return;\n  if (!forceAds && _lm._il)\n    return;\n  var countdown = [];\n  for (var i = 1; i <= 9; i++)\n    countdown.unshift(i);\n  var n = countdown.length + 1;\n  $(countdown).each(function(i) {\n    setTimeout(function() {\n      $('.title, title').text('Ad in ' + i + ' seconds.');\n    }, (n - i) * 1000);\n  })\n  sendEvent({\n    type: 'toast',\n    toast: 'Vysor ad in ' + n + ' seconds.\\nUpgrade for an ad free experience.',\n  })\n  setTimeout(function() {\n    $('.title, title').text(deviceSettings.friendlyName || device.name);\n    // can't show ad? clear the interval so it immediately shows upon reconnect.\n    if (!inputWebSocket) {\n      clearInterval(adInterval);\n      adInterval = null;\n    }\n\n    tracker.sendEvent('ad-impression');\n\n    adbSocketFactory.newSocket(\"shell:am start -n com.koushikdutta.vysor/.VysorAdActivity\")\n  }, n * 1000)\n}\n\nvar adInterval;\nfunction startAdViewer() {\n  if (!window._lm)\n    return;\n  if (!forceAds && _lm._il)\n    return;\n  // already got one queued up, so just bail\n  // otherwise a disconnect/reconnect will spam an ad\n  if (adInterval)\n    return;\n  // sanity clear, just in case the impossible happens\n  clearInterval(adInterval);\n  adInterval = setInterval(showAd, 15 * 60 * 1000);\n  setTimeout(function() {\n    showAd();\n  }, 2 * 60 * 1000);\n}\n\nfunction recommendProOnce() {\n  if (deviceSettings.hasRecommendedPro)\n    return;\n\n  deviceSettings.hasRecommendedPro = true;\n  saveMySettings();\n  showModal({\n    title: 'Vysor Pro',\n    body: 'Vysor Pro gives you high quality video, Audio Mirroring, and many more features. Please consider upgrading!',\n    okButton: 'Purchase Vysor Pro',\n    ok: function() {\n      _lm.startPurchase();\n    }.bind(this)\n  })\n}\n\nfunction recommendRateOnce() {\n  if (deviceSettings.hasRecommendedRate)\n    return;\n\n  deviceSettings.hasRecommendedRate = true;\n  saveMySettings();\n  showModal({\n    title: 'Vysor',\n    body: \"You seem to be finding Vysor useful. We'd love to hear your thoughts on the Play Store!'\",\n    okButton: 'Rate Vysor',\n    ok: function() {\n      adbSocketFactory.newSocket(\"shell:am start -d http://play.google.com/store/apps/details?id=com.koushikdutta.vysor -a android.intent.action.VIEW\")\n    }.bind(this)\n  })\n}\n\nfunction recommendAudioMirroringOnce() {\n  if (!window._lm || !window._lm._il)\n    return;\n\n  if (deviceSettings.hasRecommendedAudio)\n    return;\n\n  deviceSettings.hasRecommendedAudio = true;\n  saveMySettings();\n  showModal({\n    title: 'Audio Mirroring',\n    body: 'You can mute your Android and Mirror audio to your computer by clicking the headphone icon in the toolbar above: <span class=\"fa fa-headphones\"></span>',\n    okButton: 'Mirror Audio',\n    ok: function() {\n      ensureAudioContext();\n      maybeConnectUDP();\n    }.bind(this)\n  })\n}\n\nfunction recommendHighQualityOnce() {\n  if (!window._lm || !window._lm._il)\n    return;\n\n  if (deviceSettings.hasRecommendedHighQuality) {\n    recommendAudioMirroringOnce();\n    return;\n  }\n\n  deviceSettings.hasRecommendedHighQuality = true;\n  saveMySettings();\n  showModal({\n    title: 'High Quality Video',\n    body: 'The video quality can be customized by clicking the Settings icon in the toolbar. Would you like to try the recommended High Quality settings?',\n    okButton: 'Use High Quality Settings',\n    ok: function() {\n      $('#high-quality-defaults').click();\n      saveMySettings();\n    }.bind(this)\n  })\n}\n\nsharedGlobals.connectionReady = function() {\n  console.log('connectionReady')\n  $('#loading').fadeIn();\n  $('#dead, #reconnect').fadeOut();\n  delayFadeHead();\n\n  if (!device)\n    console.error('device not defined on window object?');\n\n  if (window.chrome && window.chrome.storage && window.chrome.storage.local) {\n    chrome.storage.local.get('vysorSettings', function(data) {\n      vysorSettings = {};\n      // populate defaults, and overwrite with user defaults.\n      // this will guarantee missing keys on updates.\n      Object.assign(vysorSettings, vysorDefaultSettings, data.vysorSettings);\n      var deviceSpecific = (vysorSettings.devices && vysorSettings.devices[device.id || device.serialno]) || {};\n      // possibly overwrite nav bar and title bar\n      vysorSettings.navigationBar = deviceSpecific.navigationBar || vysorSettings.navigationBar;\n      vysorSettings.titleBar = deviceSpecific.titleBar || vysorSettings.titleBar;\n      // merge keys and mouse\n      Object.assign(vysorSettings.keydown, deviceSpecific.keydown);\n      Object.assign(vysorSettings.mousedown, deviceSpecific.mousedown);\n      setupNavigationBar();\n      setupTitleBar();\n    })\n  }\n\n  var sizeThrottle;\n  function handleData(json) {\n    if (json.type == 'displaySize') {\n      var ow = screenWidth;\n      var oh = screenHeight;\n      screenWidth = json.screenWidth;\n      screenHeight = json.screenHeight;\n\n      enforceAspectRatio(ow, oh);\n    }\n    else if (json.type == 'encodeSize') {\n      encodeWidth = json.encodeWidth;\n      encodeHeight = json.encodeHeight;\n\n      if (!h264Socket) {\n        connect264();\n        return;\n      }\n\n      sizeThrottle = throttleTimeout(sizeThrottle, null, 1000, function() {\n        h264Socket.onClose = null;\n        h264Socket.destroy();\n        h264Socket = null;\n        connect264();\n      });\n    }\n    else if (json.type == 'clip') {\n      copyTextToClipboard(json.clip);\n    }\n    else if (json.type == 'password') {\n      // ignore\n    }\n    else if (json.type == 'recording') {\n      var recording = json.recording.replace('/sdcard/vysor/', '');\n      chrome.browser.openTab({url: 'http://127.0.0.1:' + httpPort + '/device/' + (device.id || device.serialno) + '/sdcard-vysor/' + recording});\n    }\n    else {\n      console.log('unknown', json);\n    }\n  }\n\n  var attemptCount = 0;\n  var maxRetries = 20;\n  function reattempt() {\n    console.log('input websocket failed, retrying. attempt ' + attemptCount + ' out of ' + maxRetries);\n    setTimeout(attemptConnection, 500);\n  }\n\n  function attemptConnection() {\n    // don't do this. websocket disappearing causes the vysor daemon to terminate.\n    // if (inputWebSocket)\n    //   inputWebSocket.close();\n    // inputWebSocket = null;\n\n    attemptCount++;\n    if (attemptCount == maxRetries) {\n      withSocket();\n      return;\n    }\n\n    createWebSocket(function(ws) {\n      if (!ws) {\n        reattempt();\n        return;\n      }\n      inputWebSocket = ws;\n      // force a reconnect with new transport.\n      if (h264Socket) {\n        h264Socket.onClose = null;\n        h264Socket.destroy();\n        h264Socket = null;\n      }\n      inputWebSocket.onopen = function() {\n        console.log('input websocket opened');\n\n        if (!isBrowser()) {\n          Adb.reverse({\n            serialno: device.serialno,\n            from: 'tcp:8010',\n            to: 'tcp:' + castServer.getPort(),\n          }, function(result) {\n            console.log('audio listener', result);\n          })\n        }\n\n        inputWebSocket.onerror = null;\n        var displaySettings = deviceSettings.displaySettings || {};\n        var size = displaySettings.freeSize ? innerWidth + 'x' + (innerHeight - bottomBarHeight - titleBarHeight) : displaySettings.size == 'reset' ? null : displaySettings.size;\n        var density = displaySettings.density == 'reset' ? null : displaySettings.density;\n        // send password, and initial display settings.\n        // password event also wakes phone up\n        sendEvent({\n          type: 'password',\n          password: password,\n          resolution: resolutions[deviceSettings.resolution],\n          size: size,\n          density: density,\n          dimDisplay: deviceSettings.dimDisplay,\n        })\n      }\n      inputWebSocket.onerror = reattempt;\n      inputWebSocket.onmessage = function (event) {\n        console.log('event from phone', event.data);\n        var json = JSON.parse(event.data);\n        handleData(json);\n      }\n    });\n  }\n\n  if (!window.adbSocketFactory) {\n    if (adbSocketFactoryFactory.type == 'adb-client') {\n      adbSocketFactory = Adb.createSocketFactory(adbSocketFactoryFactory.arguments.serialno);\n    }\n    else {\n      console.error('unknown adb socket factory factory', adbSocketFactoryFactory.type)\n    }\n  }\n\n  var createWebSocket = function(cb) {\n    adbSocketFactory.newSocket('tcp:53518', function(ws) {\n      if (!ws) {\n        cb();\n        return;\n      }\n      var queued;\n      var writeCallback = function() {\n        if (!queued)\n          return;\n        var next;\n        if (queued.length)\n          next = queued.shift();\n        else\n          queued = null;\n        if (next)\n          writeLine(ws, next, writeCallback);\n      }\n      ws.close = ws.destroy.bind(ws);\n      ws.send = function(json) {\n        if (queued) {\n          queued.push(json);\n          return;\n        }\n        queued = [];\n        writeLine(ws, json, writeCallback);\n      }.bind(ws);\n      cb(ws);\n      var hasConnected = false;\n      ws.onClose = function() {\n        if (!hasConnected) {\n          if (ws.onerror)\n            ws.onerror();\n        }\n      }\n      function onblob(s) {\n        if (!hasConnected) {\n          hasConnected = true;\n          if (ws.onopen)\n            ws.onopen();\n        }\n        if (ws.onmessage)\n          ws.onmessage({data: s})\n        readLine(ws, onblob);\n      }\n      readLine(ws, onblob);\n    })\n  };\n\n  console.log('init');\n\n  function socketFail() {\n    if (window.tryReconnect) {\n      $('#reconnect').fadeIn();\n    }\n    else {\n      $('#dead').fadeIn();\n    }\n    $('#listener').empty();\n  }\n\n  function withSocket(socket) {\n    console.log('received socket', socket);\n\n    if (h264Socket) {\n      h264Socket.onClose = null;\n      h264Socket.destroy();\n      h264Socket = null;\n    }\n\n    h264Socket = socket;\n\n    $('.overlay').fadeOut();\n    if (!socket) {\n      socketFail();\n      return;\n    }\n\n    socket.name = 'h264';\n\n    socket.onClose = function() {\n      try {\n        socketFail();\n      }\n      catch (e) {\n        console.log('eating error that occurs with jquery if window is being closed...');\n      }\n      console.log('closing input ')\n      if (inputWebSocket)\n        inputWebSocket.close();\n      inputWebSocket = null;\n      if (h264Socket == socket)\n        h264Socket = null;\n    }\n\n    // var decoder = new BroadwayDecoder();\n    var defaultDecoder = isBrowser() ? 3 : 0; // tinyh264 or pnacl software\n    var decoderSetting = decoders[deviceSettings.decoder || defaultDecoder];\n    console.log('decoder: ' + decoderSetting);\n    if (isBrowser() || decoderSetting == 'tinyh264') {\n      var decoder = new TinyDecoder($('#listener')[0], encodeWidth, encodeHeight);\n    }\n    else {\n      var decoder = new PepperDecoder(encodeWidth, encodeHeight, decoderSetting);\n    }\n\n    var isSps = true;\n    var frameTracker;\n    function withPayload(data) {\n      var video = data.subarray(8);\n      var dv = new DataView(data.buffer, data.byteOffset, 8);\n      var presentationTimeMs = dv.getUint32(0, true);\n      var syncFrame = dv.getUint32(4, true) != 0;\n\n      if (flash) {\n        if (socket == h264Socket) {\n          if (isSps)\n            flash.addVideoHeader(video);\n          else if (!needsRestartForVideoDump)\n            flash.addVideoFrame(video, presentationTimeMs, syncFrame);\n        }\n      }\n\n      if (isSps) {\n        needsRestartForVideoDump = false;\n        isSps = false;\n        // if (video[5] != 66 && video.byteLength >= 6)\n        //   showNotification('Your Android needs to send H264 Baseline by default. You may get this error and see a black screen if running a custom ROM.')\n      }\n\n      decoder.decode(video, presentationTimeMs, syncFrame)\n\n      // log every minute\n      var now = Date.now();\n      if (!frameTracker) {\n        frameTracker = now;\n        tracker.sendEvent('view-device');\n      }\n      else {\n        var elapsed = now - frameTracker;\n        if (elapsed > 60 * 1000) {\n          frameTracker = now;\n          trackUsage(elapsed);\n        }\n      }\n    }\n\n    var payloadReader = function(data) {\n      withPayload(data);\n\n      readHeader();\n    }\n\n    var headerReader = function(data) {\n      if (data.byteLength != 4) {\n        throw new Error(\"WTF\");\n      }\n      var lenBuf = new DataView(data.buffer, data.byteOffset, 4);\n      var len = lenBuf.getInt32(0, true);\n      socket.read(len, payloadReader);\n    }\n\n    var readHeader = function() {\n      socket.read(4, headerReader);\n    }\n\n    function startReadLoop() {\n      console.log('starting read loop');\n      var firstRead = setTimeout(function() {\n        showNotification(\"Your Android screen is unavailable right now. This can sometimes be resolved by rebooting your Android.\");\n      }, 5000);\n\n      // this has a timer\n      startAdViewer();\n\n      readLenPackets(socket, function(data) {\n        if (firstRead) {\n          clearTimeout(firstRead);\n          firstRead = undefined;\n          recommendHighQualityOnce();\n\n          if (window.chrome && window.chrome.storage) {\n            sendEvent({\n              type: 'bitrate',\n              bitrate: bitrates[deviceSettings.bitrate]\n            })\n          }\n        }\n\n        for (var packet of data) {\n          withPayload(packet);\n        }\n      }, true);\n    }\n\n    var syncFrameThrottle;\n    function decoderFallingBehind() {\n      syncFrameThrottle = throttleTimeout(syncFrameThrottle, null, 1000, function() {\n        console.log('requesting sync frame');\n        sendEvent({type: \"sync-frame\"});\n      });\n    }\n\n    decoder.onDecoderFallingBehind = decoderFallingBehind;\n    decoder.onReady = startReadLoop;\n    resizeWindow();\n  }\n\n  function connect264() {\n    adbSocketFactory.newSocket('tcp:53517', function(socket) {\n      if (!socket) {\n        withSocket();\n        return;\n      }\n\n      writeLine(socket, password, function() {\n        withSocket(socket);\n      });\n    });\n  }\n\n  loadDeviceSettings(device.id || device.serialno, function(d) {\n    deviceSettings = d;\n\n    attemptConnection();\n\n    // sanitize the settings for the license manager\n    if (!window._lm || !window._lm._il) {\n      deviceSettings.bitrate = 0;\n      deviceSettings.resolution = 0;\n      deviceSettings.alwaysOnTop = false;\n    }\n    applyDeviceSettings(deviceSettings);\n    useLicenseCheck = true;\n    resizeWindow();\n    $('.title, title').text(deviceSettings.friendlyName || device.name);\n  });\n}\n\nif (!window.chrome || !window.chrome.app || !window.chrome.app.window) {\n  window.device = {\n    id: 'web',\n    serialno: 'web',\n  };\n\n  vysorMode = getQueryVariable('mode');\n  if (vysorMode == 'inkwire') {\n    device = {\n      id: 'inkwire',\n      serialno: 'inkwire',\n    };\n  }\n\n  $(document).ready(function() {\n    docReady();\n\n    if (vysorMode == 'inkwire') {\n      $('title').text('Inkwire');\n      titleBarHeight = 0;\n      $('.foot').hide();\n      bottomBarHeight = 0;\n      resizeWindow();\n    }\n\n    var registrationId = getQueryVariable('registrationId');\n    if (!registrationId) {\n      showModal({\n        title: 'Select Android Device',\n        body: 'Select the Android device you want to mirror.',\n        okButton: 'Select',\n        ok: function() {\n          getUserSelectedDevices()\n          .then(devices => {\n            var adbServer = new AdbServer({\n              start: false\n            });\n  \n            adbServer.dummyListen = true;\n  \n            for (let device of devices) {\n              adbServer.refreshDevice(device, adb => {\n                device = adbServer.adbDevices[adb.serialno];\n              })\n            }\n          });\n        }\n      })\n      return;\n    }\n\n    var senderId = getQueryVariable('senderId');\n    if (!senderId)\n      senderId = '64148182473';\n\n    var useAudio = getQueryVariable('audio');\n\n    if (vysorMode == 'inkwire') {\n      senderId = '3505780036';\n      useAudio = true;\n    }\n\n    var gcmSocketManager;\n\n\n    GcmRtcManager.start({\n      // Inkwire\n      '3505780036': 'AIzaSyDt0GimPRhk8_d_4XjOYzQUn50UkvXhMtE',\n      // Vysor\n      '64148182473': 'AIzaSyDd7k1v017osyYbIC92fyf-36s3pv0z73U'\n      },\n      {\n        iceServers: [\n          {\n            urls: [\"turn:n0.clockworkmod.com\",\"turn:n1.clockworkmod.com\"],\n            username: \"foo\",\n            credential: \"bar\"\n          },\n        ],\n    }, function(gcm) {\n      console.log('attempting to connect to vysor from web');\n      gcmSocketManager = gcm;\n\n      gcmSocketManager.sharedDevices = {};\n      var channel = getQueryVariable('channel');\n      gcmSocketManager.connect({\n        senderId: senderId,\n        registrationId: registrationId,\n        port: channel\n      }).then(function(gcmConn) {\n        console.log('web connection established');\n\n        if (useAudio) {\n          console.log('attempting audio');\n          gcmSocketManager.connect({\n            senderId: senderId,\n            registrationId: registrationId,\n            port: channel,\n            audio: true,\n            offerToReceiveAudio: true,\n          })\n          .then(function(conn) {\n            console.log('got audio');\n\n            var audio = new Audio();\n            audio.srcObject = conn.streams[0];\n            audio.play();\n          });\n        }\n\n        console.log('gcmConn', gcmConn);\n        window.adbSocketFactory = gcmConn;\n\n        console.log('starting remote vysor daemon')\n        gcmConn.newSocket('webstart', function(socket) {\n        console.log('waiting for password')\n          readLine(socket, function(password) {\n            socket.destroy();\n\n            console.log('got password', password);\n            window.password = password;\n\n            connectionReady();\n          });\n        })\n      });\n    })\n  })\n}\nelse {\n  $(document).ready(docReady);\n\n  (function() {\n    function noFullscreen() {\n      if (!isFullscreen()) {\n        showSettings();\n        shortModal(null, 'Vysor has been maximized. If you wish enable Fullscreen Mode, it can be enabled in Settings.');\n        setTimeout(function() {\n          chrome.app.window.current().restore();\n        }, 1000)\n        return;\n      }\n    }\n\n    chrome.app.window.current().onFullscreened.addListener(noFullscreen);\n    chrome.app.window.current().onMaximized.addListener(noFullscreen);\n  })();\n}\n\nsharedGlobals.updateWindowStatusText = function(text) {\n  $('#loading-text').html(text);\n}\n\nsharedGlobals.showSettings = function() {\n  var edit = $('#new-display-name');\n  edit.prop('value', deviceSettings.friendlyName);\n  edit.prop('placeholder', device.name);\n  $('#web-video-stream').text('http://127.0.0.1:' + window.httpPort + '/device/' + (device.id || device.serialno) + '/video.flv');\n  $('#web-audio-stream').text('http://127.0.0.1:' + window.httpPort + '/device/' + (device.id || device.serialno) + '/audio.adts');\n\n  $('#settings-modal').modal();\n}\n"],"sourceRoot":""}