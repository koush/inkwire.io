/*! For license information please see background.js.LICENSE.txt */
!function(t){var n={};function i(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=n,i.d=function(t,n,e){i.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,n){if(1&n&&(t=i(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(i.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var r in t)i.d(e,r,function(n){return t[n]}.bind(null,r));return e},i.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(n,"a",n),n},i.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},i.p="",i(i.s=60)}([function(t,n){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,n,i){(function(t){function i(t){for(var n=t.toString(16);n.length<4;)n="0"+n;return n}function e(t){return"ArrayBuffer"==t.constructor.name&&(t=new Uint8Array(t)),n=String.fromCharCode.apply(null,t),decodeURIComponent(escape(n));var n}function r(t,n,i){var e=(t=unescape(encodeURIComponent(t))).length;i&&e++,n||(n=new ArrayBuffer(e));var r=new Uint8Array(n);i&&(r[t.length]=0);for(var o=0,s=t.length;o<s;o++)r[o]=t.charCodeAt(o);return n}var o="\n".charCodeAt(0);function s(t,n,i){"Object"==n.constructor.name&&(n=JSON.stringify(n)),t.write(r(n),i)}function c(t,n){var i=new Uint8Array(t.byteLength+n.byteLength);return i.set(t,0),i.set(n,t.byteLength),i}Uint8Array.prototype.sliceArrayBuffer=function(){return this.buffer.slice(this.byteOffset,this.byteOffset+this.byteLength)},Number.prototype.pad=function(t){for(var n=String(this);n.length<(t||2);)n="0"+n;return n};(new Date).getTime();var u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{enumerable:!1,configurable:!1,writable:!1,value:function(t,n){return n=n||0,this.lastIndexOf(t,n)===n}}),Object.fromArray=function(t){var n={};for(var i in t){var e=t[i];n[e]=e}return n};try{$.ajaxTransport("+binary",(function(t,n,i){if(window.FormData&&(t.dataType&&"binary"==t.dataType||t.data&&(window.ArrayBuffer&&t.data instanceof ArrayBuffer||window.Blob&&t.data instanceof Blob)))return{send:function(n,i){var e=new XMLHttpRequest,r=t.url,o=t.type,s=t.async||!0,c=t.responseType||"blob",u=t.data||null,a=t.username||null,f=t.password||null;for(var h in e.addEventListener("load",(function(){var n={};n[t.dataType]=e.response,i(e.status,e.statusText,n,e.getAllResponseHeaders())})),e.addEventListener("error",(function(){i(e.status,e.statusText,null,e.getAllResponseHeaders())})),e.open(o,r,s,a,f),n)e.setRequestHeader(h,n[h]);e.responseType=c,e.send(u)},abort:function(){i.abort()}}}))}catch(t){}var a,f,h;a={};function l(){}(f=function*(){}()).constructor.prototype.async=function(){var t=this,n=t.next();if(!n.done){var i,e,r=new Promise((function(t,n){i=t,e=n}));return c(),r}function o(){n=t.throw(new Error(arguments)),c()}function s(){var i=arguments[0];n=t.next(i),c()}function c(r){var c,u;if(n.done)i(n.value);else if(n.value)if(n.value.constructor!=Promise)if(n.value.constructor!=f.constructor){if(n.value==Error)c=!0,n=t.next(o);else{if(n.value!=l)throw new Error("Unexpected yield value for callback. Only Error and Success allowed.");u=!0,n=t.next(s)}if(!n.value)throw new Error("Double yield callbacks must explicitly define both Error and Success");if(n.value==Error&&c)throw new Error("Error callback already defined");if(n.value==l&&u)throw new Error("Success callback already defined");if(n.value!=Error&&n.value!=l)throw new Error("Unexpected yield value for callback. Only Error and Success allowed.");try{n=c?t.next(s):t.next(o)}catch(t){e(t)}}else n.value.async().then(s).catch(o);else n.value.then(s).catch(o);else n=t.next(s)}};try{h=!navigator}catch(t){h=!0}function d(){return h}function v(){return-1!=navigator.userAgent.indexOf("Electron")}d()||v()||(window.sharedGlobals=window),function(){if(!d()){var t="";if(window.IS_RELEASE){console.log,console.error,console.warn,console.info;function n(t){return function(){t.apply(console,arguments),i(Array.prototype.slice.call(arguments))}}console.error=n(console.error),console.log=n(console.log),console.warn=n(console.warn),console.info=n(console.info)}sharedGlobals.getConsoleLog=function(n){n(t)},window.gistConsoleLog=function(t,n){chrome.runtime.getBackgroundPage((function(i){e(i).then((function(n){t["background.txt"]=n;var i=chrome.app.window.getAll().map((function(n){return e(n.contentWindow).then((function(i){t["window-"+n.id+".txt"]=i}))}));return Promise.all(i)})).then((function(){var i={description:chrome.runtime.getManifest().name+" console log",public:!1,files:t};fetch("https://vysor.io/gist",{method:"POST",body:JSON.stringify(i)}).then((function(t){t.json().then((function(t){n(t.html_url)}))}))}))}))}}function i(n){try{for(var i in n)n[i]&&n[i].constructor!=String&&(n[i]=JSON.stringify(n[i]));t+=n.join(" ")+"\n"}catch(t){}}function e(t){return new Promise((function(n,i){t.getConsoleLog?t.getConsoleLog((function(t){n({content:t&&t.length?t:"log is empty"})})):n("getConsoleLog not found")}))}}(),n.str2ab=r,n.ab2str=e,n.readString=function(t,n){var i="";t.onClose=function(){n(i)},t.read((function n(r){i+=e(r),t.read(n)}))},n.readLine=function(t,n){var i=[];!function r(){t.read((function(s){for(var c=0;c<s.byteLength;c++)if(s[c]==o){var u=s.subarray(0,c);i.push(u);var a="";for(var f in i)a+=e(f=i[f]);var h=s.subarray(c+1);return t.unshift(h),void n(a)}i.push(s),r()}))}()},n.writeLine=function(t,n,i){"Object"==n.constructor.name&&(n=JSON.stringify(n)),s(t,n+"\n",i)},n.writeString=s,n.isNode=d,n.isElectron=v,n.base64ToArrayBuffer=function(t){for(var n=window.atob(t),i=n.length,e=new Uint8Array(i),r=0;r<i;r++){var o=n.charCodeAt(r);e[r]=o}return e.buffer},n.nextTick=function(t){setTimeout(t,0)},n.getAuthToken=function(n,i){if(!window.chrome||!window.chrome.identity)return console.error("no auth token implemented"),void t.nextTick(i);chrome.identity.getAuthToken({interactive:n,scopes:["https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/chromewebstore.readonly"]},(function(t){t||console.error("unable to get authToken",chrome.runtime.lastError),i(t)}))},n.make4Len16=i,n.throttleTimeout=function(t,n,i,e,r){if(t||(t={items:[]}),t.items.push(n),!t.timeout){function o(){delete t.timeout,e(t.items),t.items=[]}r&&o(t.items),t.timeout=setTimeout(o,i)}return t},n.bufferToHex=function(t){var n=new Uint8Array(t),i="";for(var e in n)i+=(e=n[e])<16?"0"+e.toString(16):e.toString(16);return i},n.hexToBuffer=function(t){for(var n=new ArrayBuffer(t.length/2),i=new Uint8Array(n),e=0;e<t.length/2;e++){var r=t.substr(2*e,2);i[e]=parseInt(r,16)}return n},n.Success=l,n.readLenLoop=function(t,n,i){var e=function(e){if(4!=e.byteLength)return t.destroy(),void n(null);var o=new DataView(e.buffer,e.byteOffset,4).getInt32(0,i);t.read(o,r)},r=function(t){n(t),o()},o=function(){t.read(4,e)};o()},n.arrayBufferToBase64=function(t){for(var n="",i=new Uint8Array(t),e=i.byteLength,r=0;r<e;r++)n+=String.fromCharCode(i[r]);return window.btoa(n)},n.writeLenData=function(t,n,i,e){var r=new ArrayBuffer(4);new DataView(r).setInt32(0,n.byteLength,e),t.write(c(new Uint8Array(r),new Uint8Array(n)).buffer,i)},n.makeUUID=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()},n.appendBuffer=c,n.readLenPackets=function(t,n,i){var e,r=function(r){if(4!=r.byteLength)return t.destroy(),void n(null);var s=new DataView(r.buffer,r.byteOffset,4).getInt32(0,i);if(e)t.read(s,o);else{e=[],t.read(s,o);var c=e;e=void 0,c.length&&n(c)}},o=function(t){e?e.push(t):n([t]),s()},s=function(){t.read(4,r)};s()},n.hex2b64=function(t){var n,i,e="";for(n=0;n+3<=t.length;n+=3)i=parseInt(t.substring(n,n+3),16),e+=u.charAt(i>>6)+u.charAt(63&i);for(n+1==t.length?(i=parseInt(t.substring(n,n+1),16),e+=u.charAt(i<<2)):n+2==t.length&&(i=parseInt(t.substring(n,n+2),16),e+=u.charAt(i>>2)+u.charAt((3&i)<<4));(3&e.length)>0;)e+="=";return e},n.showNotification=function(t,n){if(console.log("notification:",t),window.chrome&&window.chrome.notifications){var i=chrome.runtime.getManifest(),e=i.name;n=n||i.icons[128],chrome.notifications.create({type:"basic",iconUrl:n,title:e,message:t})}},n.getQueryVariable=function(t,n){n||(n=window.location);for(var i=n.search.substring(1).split("&"),e=0;e<i.length;e++){var r=i[e].split("=");if(decodeURIComponent(r[0])==t)return decodeURIComponent(r[1])}},n.isBrowser=function(){return!window.chrome||!window.chrome.app||!window.chrome.app.window},n.copyTextToClipboard=function(t){var n=document.createElement("textarea");n.style.position="fixed",n.style.top=0,n.style.left=0,n.style.width="2em",n.style.height="2em",n.style.padding=0,n.style.border="none",n.style.outline="none",n.style.boxShadow="none",n.style.background="transparent",n.value=t,document.body.appendChild(n),n.select();try{document.execCommand("copy")}catch(t){console.log("Oops, unable to copy")}document.body.removeChild(n)}}).call(this,i(6))},function(t,n,i){(function(e){function r(){var t;try{t=n.storage.debug}catch(t){}return!t&&void 0!==e&&"env"in e&&(t=e.env.DEBUG),t}(n=t.exports=i(37)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},n.formatArgs=function(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+n.humanize(this.diff),!i)return;var e="color: "+this.color;t.splice(1,0,e,"color: inherit");var r=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(function(t){"%%"!==t&&(r++,"%c"===t&&(o=r))})),t.splice(o,0,e)},n.save=function(t){try{null==t?n.storage.removeItem("debug"):n.storage.debug=t}catch(t){}},n.load=r,n.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},n.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},n.enable(r())}).call(this,i(6))},function(t,n,i){(function(t){var e=i(9).Buffer,r=!1;try{chrome&&chrome.sockets&&(chrome.sockets.tcp.onReceive.addListener((function(t){var n=o.readers[t.socketId];null!=n&&n.dataReceived(new Uint8Array(t.data))})),chrome.sockets.tcp.onReceiveError.addListener((function(t){var n=o.readers[t.socketId];null!=n&&(n.destroy(),n.dataReceived(null))})),chrome.sockets.tcpServer.onAccept.addListener((function(t){chrome.sockets.tcp.setPaused(t.clientSocketId,!1);var n=s.listeners[t.socketId];null!=n&&n(new o({socketId:t.clientSocketId}))})),r=!0)}catch(t){console.log("chrome app socket initialization failed"),console.warn(t)}function o(t,n){if(t.socketId)this.socketId=t.socketId,o.readers[this.socketId]=this;else if(r)chrome.sockets.tcp.create(function(i){this.socketId=i.socketId,chrome.sockets.tcp.connect(this.socketId,t.host,t.port,function(t){t?(chrome.runtime.lastError,this.destroy(),n(null)):(o.readers[i.socketId]=this,n(this))}.bind(this))}.bind(this));else{var i;t.ns?(this.ns=t.ns,i=!0):(this.ns=new require("net").Socket(),this.ns.connect({port:t.port,host:t.host},function(){i=!0,n(this)}.bind(this))),this.ns.on("close",function(){this.destroy(),i||n(null)}.bind(this)),this.ns.on("data",function(t){this.dataReceived(t)}.bind(this))}}function s(){}o.readers={},o.connect=function(t,n){return new o(t,n)},o.pump=function(t,n,i){if(!t||!n)return console.error("Socket.pump called with null socket",t,n),void i();var e=function(){t.read(r)}.bind(t),r=function(t){var i=t.buffer;(t.byteOffset||t.length!=i.byteLength)&&(i=i.slice(t.byteOffset,t.byteOffset+t.length)),n.write(i,e)}.bind(n);t.read(r),t.onClose=i},o.stream=function(t,n,i){o.pump(t,n,(function(){if(n&&n.destroy(),i){var t=i;i=null,t()}})),o.pump(n,t,(function(){if(t&&t.destroy(),i){var n=i;i=null,n()}}))},o.eat=function(t){!function n(){t.read(n)}()},o.prototype.read=function(){if(this.pendingCallback)throw new Error("double callback");if(!this.closed||this.pending){var t=0;"Number"==arguments[t].constructor.name?this.pendingLength=arguments[t++]:this.pendingLength=0;u=arguments[t];if(this.pending&&!this.paused){if(this.pendingLength){if(this.pendingLength>this.buffered())return void(this.pendingCallback=u)}else this.pendingLength=this.buffered();for(var n,i=0;i<this.pendingLength;){var e=this.pending.shift();this.bufferedLength-=e.length,this.pending.length||delete this.pending;var r=e,o=Math.min(r.byteLength,this.pendingLength-i);if(o!=r.byteLength){var s=r.subarray(0,o),c=r.subarray(o);this.unshift(c),r=s.slice()}n||r.byteLength==this.pendingLength||(n=new Uint8Array(this.pendingLength)),n?n.set(r,i):n=r,i+=r.byteLength}u(n)}else this.pendingCallback=u}else{var u;(u=this.onClose)&&(delete this.onClose,u())}},o.prototype.write=function(n,i){if(this.pendingWrite)if(this.bufferWrites){null!=i&&console.error("using callbacks in buffered mode?");var o=this.pendingWrite;this.pendingWrite=function(){o&&o(),this.write(n,i)}.bind(this)}else console.error("write is already in progress!");if(null==i&&(this.bufferWrites||console.error("write callback is null?"),i=function(){}),this.pendingWrite=i,r)chrome.sockets.tcp.send(this.socketId,n,function(t){chrome.runtime.lastError,t&&!t.resultCode?t.bytesSent<n.byteLength?this.write(n.slice(t.bytesSent),i):(delete this.pendingWrite,i()):delete this.pendingWrite}.bind(this));else{if(!this.ns)return;if(!n.byteLength)return void t.nextTick(function(){delete this.pendingWrite,i()}.bind(this));this.ns.write(e.from(n),function(){delete this.pendingWrite,i()}.bind(this))}},o.prototype.destroy=function(t,n){r?chrome.sockets.tcp.close(this.socketId,(function(){chrome.runtime.lastError})):(this.dataReceived(null),this.ns&&(this.ns.destroy(),delete this.ns))},o.prototype.unshift=function(t){0!=t.byteLength&&(this.pending?this.pending.unshift(t):this.pending=[t],this.bufferedLength||(this.bufferedLength=0),this.bufferedLength+=t.length)},o.prototype.dataReceived=function(t){if(t&&(t.asUint8Array&&(t=t.asUint8Array()),t.constructor==ArrayBuffer&&(t=new Uint8Array(t))),t&&t.length){var n=new Uint8Array(t);this.pending?this.pending.push(n):this.pending=[n]}if(null==t?this.closed=!0:(this.bufferedLength||(this.bufferedLength=0),this.bufferedLength+=t.length),!this.paused&&this.pending&&this.pending.length){var i=this.pendingLength;(e=this.pendingCallback)&&(delete this.pendingCallback,this.read(i,e))}else{var e=this.onClose;this.closed&&e&&(delete this.onClose,e())}},o.prototype.buffered=function(){return this.bufferedLength},o.prototype.pause=function(){this.paused||(this.paused=!0,this.onPause())},o.prototype.resume=function(){this.paused&&(this.paused=!1,this.onResume())},o.prototype.onResume=function(){chrome.sockets.tcp.setPaused(this.socketId,!1,(function(){}))},o.prototype.onPause=function(){chrome.sockets.tcp.setPaused(this.socketId,!0,(function(){}))},s.listeners={},s.prototype.__proto__=o.prototype,s.prototype.destroy=function(){r?chrome.sockets.tcpServer.close(this.socketId,(function(){chrome.runtime.lastError})):this.ns&&(this.ns.close(),delete this.ns)},s.prototype.listen=function(t,n,i){var e,c;"Number"==t.constructor.name?(e=t,c="0.0.0.0"):(c=t.address,e=t.port),r?chrome.sockets.tcpServer.create(function(t){this.socketId=t.socketId,s.listeners[this.socketId]=n,chrome.sockets.tcpServer.listen(t.socketId,c,e,function(t){if(chrome.runtime.lastError,t)return this.destroy(),void(i&&i(t));chrome.sockets.tcpServer.getInfo(this.socketId,function(n){this.localAddress=n.localAddress,this.localPort=n.localPort,i&&i(t)}.bind(this))}.bind(this))}.bind(this)):(this.ns=require("net").createServer(function(t){n(new o({ns:t}))}.bind(this)),this.ns.on("close",function(){this.destroy()}.bind(this)),this.ns.on("error",function(t){i&&i(t)}.bind(this)),this.ns.on("listening",function(){var t=this.ns.address();this.localAddress=t.address,this.localPort=t.port,i&&i()}.bind(this)),this.ns.listen({port:e,host:c}))},n.Socket=o,n.Server=s}).call(this,i(6))},function(t,n,i){function e(t){if(t)return function(t){for(var n in e.prototype)t[n]=e.prototype[n];return t}(t)}t.exports=e,e.prototype.on=e.prototype.addEventListener=function(t,n){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(n),this},e.prototype.once=function(t,n){function i(){this.off(t,i),n.apply(this,arguments)}return i.fn=n,this.on(t,i),this},e.prototype.off=e.prototype.removeListener=e.prototype.removeAllListeners=e.prototype.removeEventListener=function(t,n){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,e=this._callbacks["$"+t];if(!e)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<e.length;r++)if((i=e[r])===n||i.fn===n){e.splice(r,1);break}return this},e.prototype.emit=function(t){this._callbacks=this._callbacks||{};var n=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i)for(var e=0,r=(i=i.slice(0)).length;e<r;++e)i[e].apply(this,n);return this},e.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},e.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,n,i){var e,r=i(44),o=i(26),s=i(45),c=i(46),u=i(47);"undefined"!=typeof ArrayBuffer&&(e=i(48));var a="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),f="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),h=a||f;n.protocol=3;var l=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=r(l),v={type:"error",data:"parser error"},p=i(49);function m(t,n,i){for(var e=new Array(t.length),r=c(t.length,i),o=function(t,i,r){n(i,(function(n,i){e[t]=i,r(n,e)}))},s=0;s<t.length;s++)o(s,t[s],r)}n.encodePacket=function(t,i,e,r){"function"==typeof i&&(r=i,i=!1),"function"==typeof e&&(r=e,e=null);var o=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(t,i,e){if(!i)return n.encodeBase64Packet(t,e);var r=t.data,o=new Uint8Array(r),s=new Uint8Array(1+r.byteLength);s[0]=l[t.type];for(var c=0;c<o.length;c++)s[c+1]=o[c];return e(s.buffer)}(t,i,r);if(void 0!==p&&o instanceof p)return function(t,i,e){if(!i)return n.encodeBase64Packet(t,e);if(h)return function(t,i,e){if(!i)return n.encodeBase64Packet(t,e);var r=new FileReader;return r.onload=function(){n.encodePacket({type:t.type,data:r.result},i,!0,e)},r.readAsArrayBuffer(t.data)}(t,i,e);var r=new Uint8Array(1);r[0]=l[t.type];var o=new p([r.buffer,t.data]);return e(o)}(t,i,r);if(o&&o.base64)return function(t,i){var e="b"+n.packets[t.type]+t.data.data;return i(e)}(t,r);var s=l[t.type];return void 0!==t.data&&(s+=e?u.encode(String(t.data),{strict:!1}):String(t.data)),r(""+s)},n.encodeBase64Packet=function(t,i){var e,r="b"+n.packets[t.type];if(void 0!==p&&t.data instanceof p){var o=new FileReader;return o.onload=function(){var t=o.result.split(",")[1];i(r+t)},o.readAsDataURL(t.data)}try{e=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(n){for(var s=new Uint8Array(t.data),c=new Array(s.length),u=0;u<s.length;u++)c[u]=s[u];e=String.fromCharCode.apply(null,c)}return r+=btoa(e),i(r)},n.decodePacket=function(t,i,e){if(void 0===t)return v;if("string"==typeof t){if("b"===t.charAt(0))return n.decodeBase64Packet(t.substr(1),i);if(e&&!1===(t=function(t){try{t=u.decode(t,{strict:!1})}catch(t){return!1}return t}(t)))return v;var r=t.charAt(0);return Number(r)==r&&d[r]?t.length>1?{type:d[r],data:t.substring(1)}:{type:d[r]}:v}r=new Uint8Array(t)[0];var o=s(t,1);return p&&"blob"===i&&(o=new p([o])),{type:d[r],data:o}},n.decodeBase64Packet=function(t,n){var i=d[t.charAt(0)];if(!e)return{type:i,data:{base64:!0,data:t.substr(1)}};var r=e.decode(t.substr(1));return"blob"===n&&p&&(r=new p([r])),{type:i,data:r}},n.encodePayload=function(t,i,e){"function"==typeof i&&(e=i,i=null);var r=o(t);if(i&&r)return p&&!h?n.encodePayloadAsBlob(t,e):n.encodePayloadAsArrayBuffer(t,e);if(!t.length)return e("0:");m(t,(function(t,e){n.encodePacket(t,!!r&&i,!1,(function(t){e(null,function(t){return t.length+":"+t}(t))}))}),(function(t,n){return e(n.join(""))}))},n.decodePayload=function(t,i,e){if("string"!=typeof t)return n.decodePayloadAsBinary(t,i,e);var r;if("function"==typeof i&&(e=i,i=null),""===t)return e(v,0,1);for(var o,s,c="",u=0,a=t.length;u<a;u++){var f=t.charAt(u);if(":"===f){if(""===c||c!=(o=Number(c)))return e(v,0,1);if(c!=(s=t.substr(u+1,o)).length)return e(v,0,1);if(s.length){if(r=n.decodePacket(s,i,!1),v.type===r.type&&v.data===r.data)return e(v,0,1);if(!1===e(r,u+o,a))return}u+=o,c=""}else c+=f}return""!==c?e(v,0,1):void 0},n.encodePayloadAsArrayBuffer=function(t,i){if(!t.length)return i(new ArrayBuffer(0));m(t,(function(t,i){n.encodePacket(t,!0,!0,(function(t){return i(null,t)}))}),(function(t,n){var e=n.reduce((function(t,n){var i;return t+(i="string"==typeof n?n.length:n.byteLength).toString().length+i+2}),0),r=new Uint8Array(e),o=0;return n.forEach((function(t){var n="string"==typeof t,i=t;if(n){for(var e=new Uint8Array(t.length),s=0;s<t.length;s++)e[s]=t.charCodeAt(s);i=e.buffer}r[o++]=n?0:1;var c=i.byteLength.toString();for(s=0;s<c.length;s++)r[o++]=parseInt(c[s]);r[o++]=255;for(e=new Uint8Array(i),s=0;s<e.length;s++)r[o++]=e[s]})),i(r.buffer)}))},n.encodePayloadAsBlob=function(t,i){m(t,(function(t,i){n.encodePacket(t,!0,!0,(function(t){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++)e[r]=t.charCodeAt(r);t=e.buffer,n[0]=0}var o=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(o.length+1);for(r=0;r<o.length;r++)s[r]=parseInt(o[r]);if(s[o.length]=255,p){var c=new p([n.buffer,s.buffer,t]);i(null,c)}}))}),(function(t,n){return i(new p(n))}))},n.decodePayloadAsBinary=function(t,i,e){"function"==typeof i&&(e=i,i=null);for(var r=t,o=[];r.byteLength>0;){for(var c=new Uint8Array(r),u=0===c[0],a="",f=1;255!==c[f];f++){if(a.length>310)return e(v,0,1);a+=c[f]}r=s(r,2+a.length),a=parseInt(a);var h=s(r,0,a);if(u)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(t){var l=new Uint8Array(h);h="";for(f=0;f<l.length;f++)h+=String.fromCharCode(l[f])}o.push(h),r=s(r,a)}var d=o.length;o.forEach((function(t,r){e(n.decodePacket(t,i,!0),r,d)}))}},function(t,n){var i,e,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function c(t){if(i===setTimeout)return setTimeout(t,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(n){try{return i.call(null,t,0)}catch(n){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:o}catch(t){i=o}try{e="function"==typeof clearTimeout?clearTimeout:s}catch(t){e=s}}();var u,a=[],f=!1,h=-1;function l(){f&&u&&(f=!1,u.length?a=u.concat(a):h=-1,a.length&&d())}function d(){if(!f){var t=c(l);f=!0;for(var n=a.length;n;){for(u=a,a=[];++h<n;)u&&u[h].run();h=-1,n=a.length}u=null,f=!1,function(t){if(e===clearTimeout)return clearTimeout(t);if((e===s||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}(t)}}function v(t,n){this.fun=t,this.array=n}function p(){}r.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)n[i-1]=arguments[i];a.push(new v(t,n)),1!==a.length||f||c(d)},v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,n){n.encode=function(t){var n="";for(var i in t)t.hasOwnProperty(i)&&(n.length&&(n+="&"),n+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return n},n.decode=function(t){for(var n={},i=t.split("&"),e=0,r=i.length;e<r;e++){var o=i[e].split("=");n[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return n}},function(t,n){t.exports=function(t,n){var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,n,i){"use strict";(function(t){var e=i(15),r=i(16),o=i(17);function s(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function c(t,n){if(s()<n)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(n)).__proto__=u.prototype:(null===t&&(t=new u(n)),t.length=n),t}function u(t,n,i){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(t,n,i);if("number"==typeof t){if("string"==typeof n)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return a(this,t,n,i)}function a(t,n,i,e){if("number"==typeof n)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&n instanceof ArrayBuffer?function(t,n,i,e){if(n.byteLength,i<0||n.byteLength<i)throw new RangeError("'offset' is out of bounds");if(n.byteLength<i+(e||0))throw new RangeError("'length' is out of bounds");n=void 0===i&&void 0===e?new Uint8Array(n):void 0===e?new Uint8Array(n,i):new Uint8Array(n,i,e);u.TYPED_ARRAY_SUPPORT?(t=n).__proto__=u.prototype:t=l(t,n);return t}(t,n,i,e):"string"==typeof n?function(t,n,i){"string"==typeof i&&""!==i||(i="utf8");if(!u.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var e=0|v(n,i),r=(t=c(t,e)).write(n,i);r!==e&&(t=t.slice(0,r));return t}(t,n,i):function(t,n){if(u.isBuffer(n)){var i=0|d(n.length);return 0===(t=c(t,i)).length?t:(n.copy(t,0,0,i),t)}if(n){if("undefined"!=typeof ArrayBuffer&&n.buffer instanceof ArrayBuffer||"length"in n)return"number"!=typeof n.length||(e=n.length)!=e?c(t,0):l(t,n);if("Buffer"===n.type&&o(n.data))return l(t,n.data)}var e;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,n)}function f(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,n){if(f(n),t=c(t,n<0?0:0|d(n)),!u.TYPED_ARRAY_SUPPORT)for(var i=0;i<n;++i)t[i]=0;return t}function l(t,n){var i=n.length<0?0:0|d(n.length);t=c(t,i);for(var e=0;e<i;e+=1)t[e]=255&n[e];return t}function d(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function v(t,n){if(u.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var e=!1;;)switch(n){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return L(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return V(t).length;default:if(e)return L(t).length;n=(""+n).toLowerCase(),e=!0}}function p(t,n,i){var e=!1;if((void 0===n||n<0)&&(n=0),n>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(n>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return B(this,n,i);case"utf8":case"utf-8":return T(this,n,i);case"ascii":return U(this,n,i);case"latin1":case"binary":return F(this,n,i);case"base64":return E(this,n,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,n,i);default:if(e)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),e=!0}}function m(t,n,i){var e=t[n];t[n]=t[i],t[i]=e}function w(t,n,i,e,r){if(0===t.length)return-1;if("string"==typeof i?(e=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof n&&(n=u.from(n,e)),u.isBuffer(n))return 0===n.length?-1:y(t,n,i,e,r);if("number"==typeof n)return n&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,n,i):Uint8Array.prototype.lastIndexOf.call(t,n,i):y(t,[n],i,e,r);throw new TypeError("val must be string, number or Buffer")}function y(t,n,i,e,r){var o,s=1,c=t.length,u=n.length;if(void 0!==e&&("ucs2"===(e=String(e).toLowerCase())||"ucs-2"===e||"utf16le"===e||"utf-16le"===e)){if(t.length<2||n.length<2)return-1;s=2,c/=2,u/=2,i/=2}function a(t,n){return 1===s?t[n]:t.readUInt16BE(n*s)}if(r){var f=-1;for(o=i;o<c;o++)if(a(t,o)===a(n,-1===f?0:o-f)){if(-1===f&&(f=o),o-f+1===u)return f*s}else-1!==f&&(o-=o-f),f=-1}else for(i+u>c&&(i=c-u),o=i;o>=0;o--){for(var h=!0,l=0;l<u;l++)if(a(t,o+l)!==a(n,l)){h=!1;break}if(h)return o}return-1}function g(t,n,i,e){i=Number(i)||0;var r=t.length-i;e?(e=Number(e))>r&&(e=r):e=r;var o=n.length;if(o%2!=0)throw new TypeError("Invalid hex string");e>o/2&&(e=o/2);for(var s=0;s<e;++s){var c=parseInt(n.substr(2*s,2),16);if(isNaN(c))return s;t[i+s]=c}return s}function b(t,n,i,e){return q(L(n,t.length-i),t,i,e)}function k(t,n,i,e){return q(function(t){for(var n=[],i=0;i<t.length;++i)n.push(255&t.charCodeAt(i));return n}(n),t,i,e)}function A(t,n,i,e){return k(t,n,i,e)}function C(t,n,i,e){return q(V(n),t,i,e)}function S(t,n,i,e){return q(function(t,n){for(var i,e,r,o=[],s=0;s<t.length&&!((n-=2)<0);++s)i=t.charCodeAt(s),e=i>>8,r=i%256,o.push(r),o.push(e);return o}(n,t.length-i),t,i,e)}function E(t,n,i){return 0===n&&i===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,i))}function T(t,n,i){i=Math.min(t.length,i);for(var e=[],r=n;r<i;){var o,s,c,u,a=t[r],f=null,h=a>239?4:a>223?3:a>191?2:1;if(r+h<=i)switch(h){case 1:a<128&&(f=a);break;case 2:128==(192&(o=t[r+1]))&&(u=(31&a)<<6|63&o)>127&&(f=u);break;case 3:o=t[r+1],s=t[r+2],128==(192&o)&&128==(192&s)&&(u=(15&a)<<12|(63&o)<<6|63&s)>2047&&(u<55296||u>57343)&&(f=u);break;case 4:o=t[r+1],s=t[r+2],c=t[r+3],128==(192&o)&&128==(192&s)&&128==(192&c)&&(u=(15&a)<<18|(63&o)<<12|(63&s)<<6|63&c)>65535&&u<1114112&&(f=u)}null===f?(f=65533,h=1):f>65535&&(f-=65536,e.push(f>>>10&1023|55296),f=56320|1023&f),e.push(f),r+=h}return function(t){var n=t.length;if(n<=4096)return String.fromCharCode.apply(String,t);var i="",e=0;for(;e<n;)i+=String.fromCharCode.apply(String,t.slice(e,e+=4096));return i}(e)}n.Buffer=u,n.SlowBuffer=function(t){+t!=t&&(t=0);return u.alloc(+t)},n.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),n.kMaxLength=s(),u.poolSize=8192,u._augment=function(t){return t.__proto__=u.prototype,t},u.from=function(t,n,i){return a(null,t,n,i)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(t,n,i){return function(t,n,i,e){return f(n),n<=0?c(t,n):void 0!==i?"string"==typeof e?c(t,n).fill(i,e):c(t,n).fill(i):c(t,n)}(null,t,n,i)},u.allocUnsafe=function(t){return h(null,t)},u.allocUnsafeSlow=function(t){return h(null,t)},u.isBuffer=function(t){return!(null==t||!t._isBuffer)},u.compare=function(t,n){if(!u.isBuffer(t)||!u.isBuffer(n))throw new TypeError("Arguments must be Buffers");if(t===n)return 0;for(var i=t.length,e=n.length,r=0,o=Math.min(i,e);r<o;++r)if(t[r]!==n[r]){i=t[r],e=n[r];break}return i<e?-1:e<i?1:0},u.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(t,n){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return u.alloc(0);var i;if(void 0===n)for(n=0,i=0;i<t.length;++i)n+=t[i].length;var e=u.allocUnsafe(n),r=0;for(i=0;i<t.length;++i){var s=t[i];if(!u.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(e,r),r+=s.length}return e},u.byteLength=v,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var n=0;n<t;n+=2)m(this,n,n+1);return this},u.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var n=0;n<t;n+=4)m(this,n,n+3),m(this,n+1,n+2);return this},u.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var n=0;n<t;n+=8)m(this,n,n+7),m(this,n+1,n+6),m(this,n+2,n+5),m(this,n+3,n+4);return this},u.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?T(this,0,t):p.apply(this,arguments)},u.prototype.equals=function(t){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===u.compare(this,t)},u.prototype.inspect=function(){var t="",i=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},u.prototype.compare=function(t,n,i,e,r){if(!u.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===n&&(n=0),void 0===i&&(i=t?t.length:0),void 0===e&&(e=0),void 0===r&&(r=this.length),n<0||i>t.length||e<0||r>this.length)throw new RangeError("out of range index");if(e>=r&&n>=i)return 0;if(e>=r)return-1;if(n>=i)return 1;if(this===t)return 0;for(var o=(r>>>=0)-(e>>>=0),s=(i>>>=0)-(n>>>=0),c=Math.min(o,s),a=this.slice(e,r),f=t.slice(n,i),h=0;h<c;++h)if(a[h]!==f[h]){o=a[h],s=f[h];break}return o<s?-1:s<o?1:0},u.prototype.includes=function(t,n,i){return-1!==this.indexOf(t,n,i)},u.prototype.indexOf=function(t,n,i){return w(this,t,n,i,!0)},u.prototype.lastIndexOf=function(t,n,i){return w(this,t,n,i,!1)},u.prototype.write=function(t,n,i,e){if(void 0===n)e="utf8",i=this.length,n=0;else if(void 0===i&&"string"==typeof n)e=n,i=this.length,n=0;else{if(!isFinite(n))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");n|=0,isFinite(i)?(i|=0,void 0===e&&(e="utf8")):(e=i,i=void 0)}var r=this.length-n;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||n<0)||n>this.length)throw new RangeError("Attempt to write outside buffer bounds");e||(e="utf8");for(var o=!1;;)switch(e){case"hex":return g(this,t,n,i);case"utf8":case"utf-8":return b(this,t,n,i);case"ascii":return k(this,t,n,i);case"latin1":case"binary":return A(this,t,n,i);case"base64":return C(this,t,n,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,n,i);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(""+e).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(t,n,i){var e="";i=Math.min(t.length,i);for(var r=n;r<i;++r)e+=String.fromCharCode(127&t[r]);return e}function F(t,n,i){var e="";i=Math.min(t.length,i);for(var r=n;r<i;++r)e+=String.fromCharCode(t[r]);return e}function B(t,n,i){var e=t.length;(!n||n<0)&&(n=0),(!i||i<0||i>e)&&(i=e);for(var r="",o=n;o<i;++o)r+=_(t[o]);return r}function N(t,n,i){for(var e=t.slice(n,i),r="",o=0;o<e.length;o+=2)r+=String.fromCharCode(e[o]+256*e[o+1]);return r}function O(t,n,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+n>i)throw new RangeError("Trying to access beyond buffer length")}function I(t,n,i,e,r,o){if(!u.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>r||n<o)throw new RangeError('"value" argument is out of bounds');if(i+e>t.length)throw new RangeError("Index out of range")}function M(t,n,i,e){n<0&&(n=65535+n+1);for(var r=0,o=Math.min(t.length-i,2);r<o;++r)t[i+r]=(n&255<<8*(e?r:1-r))>>>8*(e?r:1-r)}function D(t,n,i,e){n<0&&(n=4294967295+n+1);for(var r=0,o=Math.min(t.length-i,4);r<o;++r)t[i+r]=n>>>8*(e?r:3-r)&255}function j(t,n,i,e,r,o){if(i+e>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function x(t,n,i,e,o){return o||j(t,0,i,4),r.write(t,n,i,e,23,4),i+4}function R(t,n,i,e,o){return o||j(t,0,i,8),r.write(t,n,i,e,52,8),i+8}u.prototype.slice=function(t,n){var i,e=this.length;if((t=~~t)<0?(t+=e)<0&&(t=0):t>e&&(t=e),(n=void 0===n?e:~~n)<0?(n+=e)<0&&(n=0):n>e&&(n=e),n<t&&(n=t),u.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,n)).__proto__=u.prototype;else{var r=n-t;i=new u(r,void 0);for(var o=0;o<r;++o)i[o]=this[o+t]}return i},u.prototype.readUIntLE=function(t,n,i){t|=0,n|=0,i||O(t,n,this.length);for(var e=this[t],r=1,o=0;++o<n&&(r*=256);)e+=this[t+o]*r;return e},u.prototype.readUIntBE=function(t,n,i){t|=0,n|=0,i||O(t,n,this.length);for(var e=this[t+--n],r=1;n>0&&(r*=256);)e+=this[t+--n]*r;return e},u.prototype.readUInt8=function(t,n){return n||O(t,1,this.length),this[t]},u.prototype.readUInt16LE=function(t,n){return n||O(t,2,this.length),this[t]|this[t+1]<<8},u.prototype.readUInt16BE=function(t,n){return n||O(t,2,this.length),this[t]<<8|this[t+1]},u.prototype.readUInt32LE=function(t,n){return n||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},u.prototype.readUInt32BE=function(t,n){return n||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},u.prototype.readIntLE=function(t,n,i){t|=0,n|=0,i||O(t,n,this.length);for(var e=this[t],r=1,o=0;++o<n&&(r*=256);)e+=this[t+o]*r;return e>=(r*=128)&&(e-=Math.pow(2,8*n)),e},u.prototype.readIntBE=function(t,n,i){t|=0,n|=0,i||O(t,n,this.length);for(var e=n,r=1,o=this[t+--e];e>0&&(r*=256);)o+=this[t+--e]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*n)),o},u.prototype.readInt8=function(t,n){return n||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},u.prototype.readInt16LE=function(t,n){n||O(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},u.prototype.readInt16BE=function(t,n){n||O(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},u.prototype.readInt32LE=function(t,n){return n||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},u.prototype.readInt32BE=function(t,n){return n||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},u.prototype.readFloatLE=function(t,n){return n||O(t,4,this.length),r.read(this,t,!0,23,4)},u.prototype.readFloatBE=function(t,n){return n||O(t,4,this.length),r.read(this,t,!1,23,4)},u.prototype.readDoubleLE=function(t,n){return n||O(t,8,this.length),r.read(this,t,!0,52,8)},u.prototype.readDoubleBE=function(t,n){return n||O(t,8,this.length),r.read(this,t,!1,52,8)},u.prototype.writeUIntLE=function(t,n,i,e){(t=+t,n|=0,i|=0,e)||I(this,t,n,i,Math.pow(2,8*i)-1,0);var r=1,o=0;for(this[n]=255&t;++o<i&&(r*=256);)this[n+o]=t/r&255;return n+i},u.prototype.writeUIntBE=function(t,n,i,e){(t=+t,n|=0,i|=0,e)||I(this,t,n,i,Math.pow(2,8*i)-1,0);var r=i-1,o=1;for(this[n+r]=255&t;--r>=0&&(o*=256);)this[n+r]=t/o&255;return n+i},u.prototype.writeUInt8=function(t,n,i){return t=+t,n|=0,i||I(this,t,n,1,255,0),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[n]=255&t,n+1},u.prototype.writeUInt16LE=function(t,n,i){return t=+t,n|=0,i||I(this,t,n,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):M(this,t,n,!0),n+2},u.prototype.writeUInt16BE=function(t,n,i){return t=+t,n|=0,i||I(this,t,n,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):M(this,t,n,!1),n+2},u.prototype.writeUInt32LE=function(t,n,i){return t=+t,n|=0,i||I(this,t,n,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[n+3]=t>>>24,this[n+2]=t>>>16,this[n+1]=t>>>8,this[n]=255&t):D(this,t,n,!0),n+4},u.prototype.writeUInt32BE=function(t,n,i){return t=+t,n|=0,i||I(this,t,n,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):D(this,t,n,!1),n+4},u.prototype.writeIntLE=function(t,n,i,e){if(t=+t,n|=0,!e){var r=Math.pow(2,8*i-1);I(this,t,n,i,r-1,-r)}var o=0,s=1,c=0;for(this[n]=255&t;++o<i&&(s*=256);)t<0&&0===c&&0!==this[n+o-1]&&(c=1),this[n+o]=(t/s>>0)-c&255;return n+i},u.prototype.writeIntBE=function(t,n,i,e){if(t=+t,n|=0,!e){var r=Math.pow(2,8*i-1);I(this,t,n,i,r-1,-r)}var o=i-1,s=1,c=0;for(this[n+o]=255&t;--o>=0&&(s*=256);)t<0&&0===c&&0!==this[n+o+1]&&(c=1),this[n+o]=(t/s>>0)-c&255;return n+i},u.prototype.writeInt8=function(t,n,i){return t=+t,n|=0,i||I(this,t,n,1,127,-128),u.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[n]=255&t,n+1},u.prototype.writeInt16LE=function(t,n,i){return t=+t,n|=0,i||I(this,t,n,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8):M(this,t,n,!0),n+2},u.prototype.writeInt16BE=function(t,n,i){return t=+t,n|=0,i||I(this,t,n,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>8,this[n+1]=255&t):M(this,t,n,!1),n+2},u.prototype.writeInt32LE=function(t,n,i){return t=+t,n|=0,i||I(this,t,n,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[n]=255&t,this[n+1]=t>>>8,this[n+2]=t>>>16,this[n+3]=t>>>24):D(this,t,n,!0),n+4},u.prototype.writeInt32BE=function(t,n,i){return t=+t,n|=0,i||I(this,t,n,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),u.TYPED_ARRAY_SUPPORT?(this[n]=t>>>24,this[n+1]=t>>>16,this[n+2]=t>>>8,this[n+3]=255&t):D(this,t,n,!1),n+4},u.prototype.writeFloatLE=function(t,n,i){return x(this,t,n,!0,i)},u.prototype.writeFloatBE=function(t,n,i){return x(this,t,n,!1,i)},u.prototype.writeDoubleLE=function(t,n,i){return R(this,t,n,!0,i)},u.prototype.writeDoubleBE=function(t,n,i){return R(this,t,n,!1,i)},u.prototype.copy=function(t,n,i,e){if(i||(i=0),e||0===e||(e=this.length),n>=t.length&&(n=t.length),n||(n=0),e>0&&e<i&&(e=i),e===i)return 0;if(0===t.length||0===this.length)return 0;if(n<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(e<0)throw new RangeError("sourceEnd out of bounds");e>this.length&&(e=this.length),t.length-n<e-i&&(e=t.length-n+i);var r,o=e-i;if(this===t&&i<n&&n<e)for(r=o-1;r>=0;--r)t[r+n]=this[r+i];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(r=0;r<o;++r)t[r+n]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+o),n);return o},u.prototype.fill=function(t,n,i,e){if("string"==typeof t){if("string"==typeof n?(e=n,n=0,i=this.length):"string"==typeof i&&(e=i,i=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==e&&"string"!=typeof e)throw new TypeError("encoding must be a string");if("string"==typeof e&&!u.isEncoding(e))throw new TypeError("Unknown encoding: "+e)}else"number"==typeof t&&(t&=255);if(n<0||this.length<n||this.length<i)throw new RangeError("Out of range index");if(i<=n)return this;var o;if(n>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(o=n;o<i;++o)this[o]=t;else{var s=u.isBuffer(t)?t:L(new u(t,e).toString()),c=s.length;for(o=0;o<i-n;++o)this[o+n]=s[o%c]}return this};var P=/[^+\/0-9A-Za-z-_]/g;function _(t){return t<16?"0"+t.toString(16):t.toString(16)}function L(t,n){var i;n=n||1/0;for(var e=t.length,r=null,o=[],s=0;s<e;++s){if((i=t.charCodeAt(s))>55295&&i<57344){if(!r){if(i>56319){(n-=3)>-1&&o.push(239,191,189);continue}if(s+1===e){(n-=3)>-1&&o.push(239,191,189);continue}r=i;continue}if(i<56320){(n-=3)>-1&&o.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(n-=3)>-1&&o.push(239,191,189);if(r=null,i<128){if((n-=1)<0)break;o.push(i)}else if(i<2048){if((n-=2)<0)break;o.push(i>>6|192,63&i|128)}else if(i<65536){if((n-=3)<0)break;o.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((n-=4)<0)break;o.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return o}function V(t){return e.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(P,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,n,i,e){for(var r=0;r<e&&!(r+i>=n.length||r>=t.length);++r)n[r+i]=t[r];return r}}).call(this,i(0))},function(t,n,i){var e=i(2)("socket.io-parser"),r=i(4),o=i(39),s=i(11),c=i(22);function u(){}n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=u,n.Decoder=h;var a=n.ERROR+'"encode error"';function f(t){var i=""+t.type;if(n.BINARY_EVENT!==t.type&&n.BINARY_ACK!==t.type||(i+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(i+=t.nsp+","),null!=t.id&&(i+=t.id),null!=t.data){var r=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===r)return a;i+=r}return e("encoded %j as %s",t,i),i}function h(){this.reconstructor=null}function l(t){this.reconPack=t,this.buffers=[]}function d(t){return{type:n.ERROR,data:"parser error: "+t}}u.prototype.encode=function(t,i){(e("encoding packet %j",t),n.BINARY_EVENT===t.type||n.BINARY_ACK===t.type)?function(t,n){o.removeBlobs(t,(function(t){var i=o.deconstructPacket(t),e=f(i.packet),r=i.buffers;r.unshift(e),n(r)}))}(t,i):i([f(t)])},r(h.prototype),h.prototype.add=function(t){var i;if("string"==typeof t)i=function(t){var i=0,r={type:Number(t.charAt(0))};if(null==n.types[r.type])return d("unknown packet type "+r.type);if(n.BINARY_EVENT===r.type||n.BINARY_ACK===r.type){for(var o="";"-"!==t.charAt(++i)&&(o+=t.charAt(i),i!=t.length););if(o!=Number(o)||"-"!==t.charAt(i))throw new Error("Illegal attachments");r.attachments=Number(o)}if("/"===t.charAt(i+1))for(r.nsp="";++i;){if(","===(u=t.charAt(i)))break;if(r.nsp+=u,i===t.length)break}else r.nsp="/";var c=t.charAt(i+1);if(""!==c&&Number(c)==c){for(r.id="";++i;){var u;if(null==(u=t.charAt(i))||Number(u)!=u){--i;break}if(r.id+=t.charAt(i),i===t.length)break}r.id=Number(r.id)}if(t.charAt(++i)){var a=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(i));if(!(!1!==a&&(r.type===n.ERROR||s(a))))return d("invalid payload");r.data=a}return e("decoded %s as %j",t,r),r}(t),n.BINARY_EVENT===i.type||n.BINARY_ACK===i.type?(this.reconstructor=new l(i),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",i)):this.emit("decoded",i);else{if(!c(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(i=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",i))}},h.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},l.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var n=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),n}return null},l.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,n){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,n,i){(function(n){var e=i(42);t.exports=function(t){var i=t.xdomain,r=t.xscheme,o=t.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!i||e))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!r&&o)return new XDomainRequest}catch(t){}if(!i)try{return new(n[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}).call(this,i(0))},function(t,n,i){var e=i(5),r=i(4);function o(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}t.exports=o,r(o.prototype),o.prototype.onError=function(t,n){var i=new Error(t);return i.type="TransportError",i.description=n,this.emit("error",i),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(t){var n=e.decodePacket(t,this.socket.binaryType);this.onPacket(n)},o.prototype.onPacket=function(t){this.emit("packet",t)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,n,i){const{Socket:e,Server:r}=i(3),{nextTick:o,readString:s,str2ab:c,ab2str:u,make4Len16:a,appendBuffer:f,hex2b64:h,showNotification:l}=i(1),d=i(18),v=i(19);let p;function m(t){this.socket=t,this.zero_mask=(1<<30)-1,this.type="tcp",t.onClose=function(){var t=this.currentRead;t&&(delete this.currentRead,t({resultCode:-1}))}.bind(this)}function w(t,n){this.onConnected=n,this.transport=t,this.currentSocketId=0,this.sockets={},this.forwards={},this.maxPayload=w.MAX_PAYLOAD}function y(t){var n={};"String"!=t.constructor.name&&(t=u(t));var i=t.replace("device::","").split(";");for(var e in i){var r=(e=i[e]).split("=");2==r.length&&(n[r[0]]=r[1])}return n}function g(t,n,i){i||(i=function(){}),this.device=t,this.localId=n,this.onConnected=i}function b(t){var n=(t=t||{}).port||5037,i=!1!==t.start;this.currentSocketId=1,this.pendingDevices={},this.port=n,this.adbDevices={},this.clients={},i&&this.start()}function k(t,n){this.server=t,this.socket=n}p=window.chrome&&window.chrome.usb?d.getUserSelectedDevices:v.getUserSelectedDevices,m.prototype.destroy=function(){this.socket.destroy()},m.prototype.write=function(t,n){if(this.writing)return this.pendingWrites||(this.pendingWrites=[]),void this.pendingWrites.push({data:t,callback:n});this.writing=!0,this.socket.write(t,function(){if(this.writing=!1,n({resultCode:0}),this.pendingWrites){var t=this.pendingWrites.shift();this.pendingWrites.length||(this.pendingWrites=null),this.write(t.data,t.callback)}}.bind(this))},m.prototype.read=function(t,n){this.currentRead=n,this.socket.read(t,(function(t){delete this.currentRead,n({resultCode:0,data:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)})}))},w.prototype.fatal=function(t){console.log("fatal error",JSON.stringify(t));var n=this.onConnected;n?(delete this.onConnected,n()):this.onError&&(this.onError(),delete this.onError),this.destroy()},w.prototype.destroy=function(){for(var t in this.sockets)(t=this.sockets[t]).dataReceived(null);this.forwards&&$.each(this.forwards,(function(t,n){n.destroy()})),this.transport.destroy()},w.kCommandSYNC=1129208147,w.kCommandCNXN=1314410051,w.kCommandOPEN=1313165391,w.kCommandOKAY=1497451343,w.kCommandCLSE=1163086915,w.kCommandWRTE=1163154007,w.kCommandAUTH=1213486401,w.kAuthToken=1,w.kAuthSignature=2,w.kAuthRSAPublicKey=3,w.ADB_PROTOCOL_VERSION=16777216,w.ADB_VERSION=40,w.MAX_PAYLOAD=4096,w.checksum=function(t){t=new Uint8Array(t);for(var n=0,i=0;i<t.byteLength;i++)n+=t[i];return 4294967295&n},w.prototype.sendMessage=function(t,n,i,e,r){e||(e=""),"String"==e.constructor.name&&(e=c(e));var o=!0;e.byteLength||(o=!1),t==w.kCommandAUTH&&n==w.kAuthSignature&&(o=!1),t==w.kCommandWRTE&&(o=!1);var s=e.byteLength;if(o&&s++,o){var u=new ArrayBuffer(e.byteLength+1);(a=new Uint8Array(u)).set(new Uint8Array(e)),a[u.byteLength-1]=0,e=u}var a,f=new ArrayBuffer(24);(a=new DataView(f)).setUint32(0,t,!0),a.setUint32(4,n,!0),a.setUint32(8,i,!0),a.setUint32(12,s,!0),a.setUint32(16,w.checksum(e),!0),a.setUint32(20,4294967295^t,!0),this.transport.write(f,function(t){t.resultCode&&this.fatal(t),!e.byteLength&&r&&r()}.bind(this)),e.byteLength&&this.transport.write(e,function(t){t.resultCode&&this.fatal(t),r&&r()}.bind(this))},w.prototype.getKey=function(t){if(window.chrome&&window.chrome.storage)chrome.storage.local.get("adbkey",(function(n){var i=n.adbkey,e=new JSEncrypt({default_key_size:2048});i?e.setPrivateKey(i):(i=e.getPrivateKeyB64(),e.setPrivateKey(i),chrome.storage.local.set({adbkey:i})),t(e)}));else{var n=new JSEncrypt({default_key_size:2048});try{var i=localStorage.getItem("adbkey");if(!i)throw new Error;var e=JSON.parse(i);n.setPrivateKey(e)}catch(t){e=n.getPrivateKeyB64(),n.setPrivateKey(e),localStorage.setItem("adbkey",JSON.stringify(e))}o(()=>t(n))}},w.prototype._convertToMinCrypt=function(t){var n=BigInteger.ONE.shiftLeft(32),i=t.n.clone(),e=BigInteger.ONE.shiftLeft(1).pow(2048),r=e.multiply(e).mod(i),o=new Uint32Array(131);o[0]=64,o[1]=n.subtract(i.modInverse(n)).intValue();for(var s=2,c=66;s<66;++s,++c)o[s]=i.mod(n).intValue(),i=i.divide(n),o[c]=r.mod(n).intValue(),r=r.divide(n);o[o.length-1]=t.e;var u="",a=new Uint8Array(o.buffer);for(s=0;s<a.length;++s){var f=a[s].toString(16);1==f.length&&(u+="0"),u+=f}return h(u)+" adb@chrome"},w.prototype.sign=function(t,n){if(null==t)throw"AuthManager is not initialized";var i=new Uint8Array(256);i[0]=0,i[1]=1;for(var e=[0,48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],r=256-e.length-n.byteLength,o=2;o<r;o++)i[o]=255;i.set(new Uint8Array(e),r),r+=e.length,i.set(new Uint8Array(n),r);var s=new BigInteger(Array.apply([],i));return new Uint8Array(t.doPrivate(s).toByteArray()).buffer},w.parseConnectionPayload=y,w.prototype.handleUnknown=function(t,n){console.log("no idea what this socket is."),this.sendMessage(w.kCommandCLSE,t,n)},w.prototype.handleMessage=function(t,n){var i=t.getUint32(0,!0),e=t.getUint32(4,!0),r=t.getUint32(8,!0);switch(i){case w.kCommandOPEN:this.onOpenSocket&&this.onOpenSocket(n,e);break;case w.kCommandAUTH:console.log("auth:",this),this.getKey(function(t){if(this.sentSignature){var i=this._convertToMinCrypt(t.getKey());this.sendMessage(w.kCommandAUTH,w.kAuthRSAPublicKey,0,i),l('Check your Android device and click "Allow USB Debugging".')}else{this.sentSignature=!0;var e=this.sign(t.getKey(),n);this.sendMessage(w.kCommandAUTH,w.kAuthSignature,0,e,(function(){}))}}.bind(this));break;case w.kCommandOKAY:var o=e,s=r;if(!(a=this.sockets[s]))return void this.handleUnknown(s,o);(f=a.onConnected)&&(delete a.onConnected,a.remoteId=o,f(a));var c=a.pendingWrite;if(c)return f=a.wrote,delete a.wrote,delete a.pendingWrite,void a.write(c,f);(f=a.wrote)&&(delete a.wrote,f());break;case w.kCommandCNXN:this.rawProperties=u(n),this.properties=y(n),(f=this.onConnected)&&(delete this.onConnected,f(this));break;case w.kCommandWRTE:o=e,s=r;if(!(a=this.sockets[s]))return void this.handleUnknown(s,o);a.paused||this.sendMessage(w.kCommandOKAY,a.localId,a.remoteId),a.dataReceived(new Uint8Array(n));break;case w.kCommandCLSE:var a,f;o=e,s=r;if(!(a=this.sockets[s]))return void console.log("asked to close unknown socket?");delete this.sockets[s],a.destroy(),(f=a.onConnected)&&(delete a.onConnected,f());break;default:console.log("unknown command: ",i.toString(16),e,r,n)}},w.prototype.onReceiveMessage=function(t){if(t.resultCode)this.fatal(t);else{var n=new DataView(t.data),i=n.getUint32(12,!0);if(i)this.transport.read(i,function(t){if(t.resultCode)this.fatal(t);else{var i=t.data;if(w.checksum(i)==n.getUint32(16,!0))try{this.handleMessage(n,i)}finally{this.receiveMessages()}else this.receiveMessages()}}.bind(this));else try{this.handleMessage(n,null)}finally{this.receiveMessages()}}},w.prototype.receiveMessages=function(){this.transport.read(24,this.onReceiveMessage.bind(this))},w.prototype.forwardPort=function(t){var n=new r;n.listen({port:t.fromPort,address:"127.0.0.1"},function(n){this.newSocket(t.to,function(t){t?e.stream(n,t):n.destroy()}.bind(this))}.bind(this),function(){this.forwards[t.fromPort]=n}.bind(this))},w.prototype.newAdbSocket=function(t,n){return this.createSocket?this.createSocket(t,n):new g(this,t,n)},w.prototype.newSocket=function(t,n){var i=++this.currentSocketId;this.sockets[i]=this.newAdbSocket(i,n),this.sendMessage(w.kCommandOPEN,i,0,t)},g.prototype.write=function(t,n){if(this.pendingWrite||this.wrote)throw console.log("bad adb socket state, already writing"),new Error("bad adb socket state, already writing");var i=Math.min(this.device.transport.zero_mask,this.device.maxPayload);i<t.byteLength?(this.pendingWrite=t.slice(i),t=t.slice(0,i)):this.pendingWrite=null,this.wrote=n,this.device.sendMessage(w.kCommandWRTE,this.localId,this.remoteId,t)},g.prototype.destroy=function(){this.device.sendMessage(w.kCommandCLSE,this.localId,this.remoteId),this.dataReceived(null)},g.prototype.buffered=e.prototype.buffered,g.prototype.dataReceived=e.prototype.dataReceived,g.prototype.read=e.prototype.read,g.prototype.pause=e.prototype.pause,g.prototype.resume=e.prototype.resume,g.prototype.unshift=e.prototype.unshift,g.prototype.onPause=function(){},g.prototype.onResume=function(){this.device.sendMessage(w.kCommandOKAY,this.localId,this.remoteId)},b.prototype.onOpenSocket=function(t,n){var i=this,r=u(t).split(":"),o=Number.parseInt(r[1]);e.connect({host:"127.0.0.1",port:o},(function(t){if(t){var r=++i.currentSocketId,o=i.newAdbSocket(r);o.remoteId=n,i.sockets[r]=o,i.sendMessage(w.kCommandOKAY,r,n),e.stream(t,o)}else i.sendMessage(w.kCommandOKAY,0,n)}))},b.prototype.start=function(){if(this.server)console.log("ADB Server started while already started");else{this.clients={},this.adbDevices={},this.pendingDevices={},this.refreshing={};var t=new r;this.dummyListen||t.listen({port:this.port,address:"127.0.0.1"},function(t){var n=new k(this,t),i=++this.currentSocketId;this.clients[i]=n,t.onClose=function(){delete this.clients[i]}.bind(this),n.receiveHeader()}.bind(this),function(n){n?console.log("adb server failed to listen: "+n):(console.log("ADB Server started"),this.server=t)}.bind(this))}},b.prototype.isRunning=function(){return null!=this.server},b.prototype.kill=function(){for(var t in this.server.destroy(),this.server=null,this.refreshing={},this.clients)(t=this.clients[t]).socket.destroy();for(var n in this.clients={},this.adbDevices)(n=this.adbDevices[n]).destroy();this.adbDevices={},this.pendingDevices={}},b.prototype.withAdbDevice=function(t,n){t.onError=function(){delete this.adbDevices[t.serialno],this.internalOnDevicesChanged()}.bind(this);var i=function(i){t.serialno=i.trim(),this.adbDevices[t.serialno]=t,console.log("found device: "+t.serialno),this.internalOnDevicesChanged(),n(t)}.bind(this);t.serialno?i(t.serialno):t.newSocket("shell:getprop ro.serialno",function(t){s(t,function(t){i(t)}.bind(this))}.bind(this))},b.prototype.tryDevice=function(t,n){var i=t.serialno,e=this.pendingDevices,r=this;function o(o){console.log("trying intrface",o);var s=o.interfaceNumber;return!e[s]&&(e[s]=t,console.log("claiming:",JSON.stringify(o)),t.claimInterface(o.interfaceNumber).then(()=>{console.log("claimed interface"),function(t,n,i){console.log("connecting");var e=new w(t.newTransport(n),i);console.log("sending CNXN"),e.sendMessage(w.kCommandCNXN,w.ADB_PROTOCOL_VERSION,w.MAX_PAYLOAD,"host::"),console.log("starting receive loop"),e.receiveMessages()}(t,o,(function(t){if(console.log("usb adb connected"),!t)return delete e[s],void n();t.serialno=i,t.onOpenSocket=r.onOpenSocket,r.withAdbDevice(t,(function(t){delete e[s],n(t)}))}))}).catch(t=>{console.log("unable claim interface",JSON.stringify(t))}),!0)}t.listInterfaces().then(n=>{console.log("got interfaces",JSON.stringify(n));var i=!1;for(var e in n)255==(e=n[e]).interfaceClass&&66==e.interfaceSubclass&&1==e.interfaceProtocol&&(i|=o(e));i||t.close()}).catch(t=>{console.log("unable list interfaces",t),n&&n()})},b.prototype.refreshDevice=function(t,n){t.open().then(()=>{this.start(),console.log("opened "+t.serialNumber),this.tryDevice(t,i=>{console.log("try device done",i),i&&(i.usbDevice=t.device),n(i)})}).catch(t=>{console.log("unable to open device",JSON.stringify(t)),n()})},b.prototype.internalOnDevicesChanged=function(){for(var t in this.clients)if((t=this.clients[t]).tracking){var n=t.getDevicesString();n.length||(n="0000\n"),t.socket.write(c(n),(function(){}))}},b.prototype.stop=function(){this.server.destroy()},k.prototype.resolveTransport=function(t,n){if(n){var i=this.server.adbDevices[n];return i||"device not found"}var e=Object.keys(this.server.adbDevices);if(e>1)return"more than one device";if(0==e)return"no devices connected";for(var r in this.server.adbDevices)return this.server.adbDevices[r]},k.prototype.write=function(t,n,i){n||(n="OKAY");var e=(t=c(t)).byteLength,r=a(e);r=c(n+r);var o=f(new Uint8Array(r),new Uint8Array(t)).buffer;i||(i=function(){this.socket.destroy()}.bind(this)),this.socket.write(o,i)},k.prototype.getDevicesString=function(t){var n=(t=t||{}).longformDevices,i="";for(var e in this.server.adbDevices)i+=(e=this.server.adbDevices[e]).serialno+"\tdevice",n&&("usb"==e.transport.type?i+=" usb:"+e.transport.iface.interfaceNumber:i+=" tpcip:something",i+=" product:"+e.properties["ro.product.name"],i+=" model:"+e.properties["ro.product.model"],i+=" device:"+e.properties["ro.product.device"]),i+="\n";return i},k.prototype.writeDevices=function(t,n){this.write(this.getDevicesString(t),null,n)},k.prototype.handlePayload=function(t){var n=(t=u(t)).split(":"),i=t;switch("host-serial"==n[0]&&(n[0]="host",b=n.splice(1,1)[0],Number.isInteger(parseInt(n[1]))&&(b+=":"+n.splice(1,1)[0])),n.length>=2&&(i=n[0]+":"+n[1]),i){case"host:version":this.write(a(w.ADB_VERSION));break;case"host:devices-l":case"host:devices":var r="host:devices-l"==t;this.writeDevices({longformDevices:r});break;case"host:features":if("String"==(g=this.resolveTransport(t,b)).constructor.name){this.write(g,"FAIL");break}var o=g.properties.features;o||(o=""),this.write(a(o));break;case"host:transport-usb":case"host:transport-any":if("String"==(g=this.resolveTransport(t,b)).constructor.name){this.write(g,"FAIL");break}this.transport=g,this.socket.write(c("OKAY"),(function(){}));break;case"host:kill":this.server.kill();break;case"host:disconnect":if(n.length>4){this.write("host:disconnect only takes 1 argument","FAIL");break}if(n.length>2)if((d=n[2]).length){var s=5555;n.length>3&&(s=Number.parseInt(n[3]));var f=d+":"+s;(h=this.server.adbDevices[f])&&"tcp"==h.transport.type&&h.destroy(),this.write("disconnected");break}for(var h in this.server.adbDevices)"tcp"==(h=this.server.adbDevices[h]).transport.type&&h.destroy();this.write("disconnected");break;case"host:connect":if(n.length<3){this.write("need more arguments for connect <host>[:<port>]","FAIL");break}var d=n[2];s=5555;n.length>3&&(s=Number.parseInt(n[3])),e.connect({host:d,port:s},function(t,n){if(!t)return console.error("connect failed"),this.write("unable to connect to "+d+" "+s+": "+n,"FAIL"),this;var i=new w(new m(t),function(t){this.server.withAdbDevice(t,function(){var t="connected to "+d+":"+s;console.log(t),this.write(t)}.bind(this))}.bind(this));i.onOpenSocket=this.onOpenSocket,i.serialno=d+":"+s,t.onClose=function(){i.fatal("socket closed")}.bind(this),i.sendMessage(w.kCommandCNXN,w.ADB_PROTOCOL_VERSION,w.MAX_PAYLOAD,"host::"),i.receiveMessages()}.bind(this));break;case"host:track-devices":this.tracking=(new Date).getTime(),this.writeDevices({},(function(){}));break;case"host:forward":var v=n.join(":").substring(i.length+1).split(";"),p=v[0].split(":"),y=parseInt(p[1]);if("String"==(g=this.resolveTransport(t,b)).constructor.name){this.write(g,"FAIL");break}g.forwardPort({fromPort:y,to:v[1]}),this.socket.write(c("OKAYOKAY"),function(){}.bind(this));break;default:var g;if(this.transport)return void(g=this.transport).newSocket(t,function(t){t?(this.socket.write(c("OKAY"),(function(){})),e.stream(t,this.socket)):this.socket.write(c("OKAY"),function(){this.socket.destroy()}.bind(this))}.bind(this));if(t.startsWith("host:transport:")){var b=t.substr("host:transport:".length);if(!(h=this.server.adbDevices[b]))return void this.write("device not found","FAIL");this.transport=h,this.socket.write(c("OKAY"),(function(){}));break}console.log("unknown request: "+t),this.write("unknown command: "+t,"FAIL"),l(appName+"'s adb server encountered an unknown adb command.\nYou may want to close "+appName+" and start your adb binary manually.")}this.receiveHeader()},k.prototype.receivePayload=function(t){var n=parseInt(u(t),16);this.socket.read(n,this.handlePayload.bind(this))},k.prototype.receiveHeader=function(){this.socket.read(4,this.receivePayload.bind(this))},n.AdbDevice=w,n.AdbServer=b,n.AdbTcpTransport=m,n.getUserSelectedDevices=p},function(t,n,i){"use strict";n.byteLength=function(t){var n=a(t),i=n[0],e=n[1];return 3*(i+e)/4-e},n.toByteArray=function(t){var n,i,e=a(t),s=e[0],c=e[1],u=new o(function(t,n,i){return 3*(n+i)/4-i}(0,s,c)),f=0,h=c>0?s-4:s;for(i=0;i<h;i+=4)n=r[t.charCodeAt(i)]<<18|r[t.charCodeAt(i+1)]<<12|r[t.charCodeAt(i+2)]<<6|r[t.charCodeAt(i+3)],u[f++]=n>>16&255,u[f++]=n>>8&255,u[f++]=255&n;2===c&&(n=r[t.charCodeAt(i)]<<2|r[t.charCodeAt(i+1)]>>4,u[f++]=255&n);1===c&&(n=r[t.charCodeAt(i)]<<10|r[t.charCodeAt(i+1)]<<4|r[t.charCodeAt(i+2)]>>2,u[f++]=n>>8&255,u[f++]=255&n);return u},n.fromByteArray=function(t){for(var n,i=t.length,r=i%3,o=[],s=0,c=i-r;s<c;s+=16383)o.push(f(t,s,s+16383>c?c:s+16383));1===r?(n=t[i-1],o.push(e[n>>2]+e[n<<4&63]+"==")):2===r&&(n=(t[i-2]<<8)+t[i-1],o.push(e[n>>10]+e[n>>4&63]+e[n<<2&63]+"="));return o.join("")};for(var e=[],r=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=s.length;c<u;++c)e[c]=s[c],r[s.charCodeAt(c)]=c;function a(t){var n=t.length;if(n%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=n),[i,i===n?0:4-i%4]}function f(t,n,i){for(var r,o,s=[],c=n;c<i;c+=3)r=(t[c]<<16&16711680)+(t[c+1]<<8&65280)+(255&t[c+2]),s.push(e[(o=r)>>18&63]+e[o>>12&63]+e[o>>6&63]+e[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,n){n.read=function(t,n,i,e,r){var o,s,c=8*r-e-1,u=(1<<c)-1,a=u>>1,f=-7,h=i?r-1:0,l=i?-1:1,d=t[n+h];for(h+=l,o=d&(1<<-f)-1,d>>=-f,f+=c;f>0;o=256*o+t[n+h],h+=l,f-=8);for(s=o&(1<<-f)-1,o>>=-f,f+=e;f>0;s=256*s+t[n+h],h+=l,f-=8);if(0===o)o=1-a;else{if(o===u)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,e),o-=a}return(d?-1:1)*s*Math.pow(2,o-e)},n.write=function(t,n,i,e,r,o){var s,c,u,a=8*o-r-1,f=(1<<a)-1,h=f>>1,l=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=e?0:o-1,v=e?1:-1,p=n<0||0===n&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(c=isNaN(n)?1:0,s=f):(s=Math.floor(Math.log(n)/Math.LN2),n*(u=Math.pow(2,-s))<1&&(s--,u*=2),(n+=s+h>=1?l/u:l*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=f?(c=0,s=f):s+h>=1?(c=(n*u-1)*Math.pow(2,r),s+=h):(c=n*Math.pow(2,h-1)*Math.pow(2,r),s=0));r>=8;t[i+d]=255&c,d+=v,c/=256,r-=8);for(s=s<<r|c,a+=r;a>0;t[i+d]=255&s,d+=v,s/=256,a-=8);t[i+d-v]|=128*p}},function(t,n){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,n,i){const{Socket:e,Server:r}=i(3),{str2ab:o,ab2str:s,make4Len16:c,appendBuffer:u,hex2b64:a,showNotification:f}=i(1);class h{constructor(t){this.device=t}get vendorId(){return this.device.vendorId}get productId(){return this.device.productId}get serialNumber(){return this.device.serialNumber}claimInterface(t){return new Promise((n,i)=>{chrome.usb.claimInterface(this.connectionHandle,t,()=>{var t=chrome.runtime.lastError;t?i(t):n()})})}listInterfaces(){return new Promise((t,n)=>{chrome.usb.listInterfaces(this.connectionHandle,i=>{i?t(i):n(chrome.runtime.lastError)})})}open(){return new Promise((t,n)=>{chrome.usb.openDevice(this.device,i=>{this.connectionHandle=i,i?(console.log("opened adb"),t()):n(chrome.runtime.lastError)})})}close(){chrome.usb.closeDevice(this.connectionHandle)}newTransport(t){return new l(this.connectionHandle,t)}}function l(t,n){for(var i in this.handle=t,this.iface=n,this.type="usb",n.endpoints)"bulk"==(i=n.endpoints[i]).type&&(this.zero_mask=i.maximumPacketSize-1,"in"==i.direction?this.in=i:this.out=i)}l.prototype.destroy=function(){chrome.usb.releaseInterface(this.handle,this.iface.interfaceNumber,function(){chrome.runtime.lastError,chrome.usb.closeDevice(this.handle,(function(){chrome.runtime.lastError}))}.bind(this))},l.prototype.write=function(t,n){if(this.writing)return this.pendingWrites||(this.pendingWrites=[]),void this.pendingWrites.push({data:t,callback:n});var i={direction:"out",endpoint:this.out.address,data:t};this.writing=!0,chrome.usb.bulkTransfer(this.handle,i,function(t){if(chrome.runtime.lastError,this.writing=!1,n(t),this.pendingWrites){var i=this.pendingWrites.shift();this.pendingWrites.length||(this.pendingWrites=null),this.write(i.data,i.callback)}}.bind(this))},l.prototype.read=function(t,n){var i={direction:"in",endpoint:this.in.address,length:t};chrome.usb.bulkTransfer(this.handle,i,(function(t){chrome.runtime.lastError,n(t)}))},n.getUserSelectedDevices=function(){return new Promise((t,n)=>{chrome.usb.getUserSelectedDevices({filters:[{interfaceClass:255,interfaceSubclass:66,interfaceProtocol:1}]},(function(n){t(n.map(t=>new h(t)))}))})}},function(t,n){class i{constructor(t){this.device=t}get vendorId(){return this.device.vendorId}get productId(){return this.device.productId}get serialNumber(){return this.device.serialNumber}async open(){await this.device.open()}async close(){await this.device.close()}async claimInterface(t){return await this.device.claimInterface(t)}async listInterfaces(){return null===this.device.configuration&&await this.device.selectConfiguration(1),this.device.configuration.interfaces.map(t=>{let n=t.alternate||t.alternates[0],{interfaceClass:i,interfaceName:e,interfaceProtocol:r,interfaceSubclass:o,endpoints:s}=n;return{interfaceNumber:t.interfaceNumber,interfaceClass:i,interfaceName:e,interfaceProtocol:r,interfaceSubclass:o,endpoints:s}})}newTransport(t){return new e(this.device,t)}}class e{constructor(t,n){for(var i of(this.device=t,this.iface=n,n.endpoints))"bulk"==i.type&&(this.zero_mask=i.packetSize-1,"in"==i.direction?this.in=i:this.out=i)}destroy(){this.device.releaseInterface(iface.interfaceNumber)}async write(t,n){if(this.writing)return this.pendingWrites||(this.pendingWrites=[]),void this.pendingWrites.push({data:t,callback:n});var i;this.writing=!0;try{i=await this.device.transferOut(this.out.endpointNumber,t)}catch(t){i={resultCode:t}}finally{this.writing=!1}if(n(i),this.pendingWrites){var e=this.pendingWrites.shift();this.pendingWrites.length||(this.pendingWrites=null),this.write(e.data,e.callback)}}async read(t,n){var i;try{i={data:(i=await this.device.transferIn(this.in.endpointNumber,t)).data.buffer}}catch(t){i={resultCode:t}}n(i)}}n.getUserSelectedDevices=async function(){let t=await navigator.usb.requestDevice({filters:[{classCode:255,subclassCode:66,protocolCode:1}]});return[new i(t)]}},function(t,n,i){const{Socket:e}=i(3);function r(t){t&&(this.dataReceived(t),this.dataReceived(null))}r.prototype.write=function(t,n){throw new Error("write not supported on dummy socket")},r.prototype.destroy=function(){this.dataReceived(null)},r.prototype.buffered=e.prototype.buffered,r.prototype.unshift=e.prototype.unshift,r.prototype.dataReceived=e.prototype.dataReceived,r.prototype.read=e.prototype.read,r.prototype.pause=e.prototype.pause,r.prototype.resume=e.prototype.resume,r.prototype.buffered=e.prototype.buffered,r.prototype.onPause=function(){},r.prototype.onResume=function(){},t.exports=r},function(t,n){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,e=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var n=t,r=t.indexOf("["),o=t.indexOf("]");-1!=r&&-1!=o&&(t=t.substring(0,r)+t.substring(r,o).replace(/:/g,";")+t.substring(o,t.length));for(var s=i.exec(t||""),c={},u=14;u--;)c[e[u]]=s[u]||"";return-1!=r&&-1!=o&&(c.source=n,c.host=c.host.substring(1,c.host.length-1).replace(/;/g,":"),c.authority=c.authority.replace("[","").replace("]","").replace(/;/g,":"),c.ipv6uri=!0),c}},function(t,n,i){(function(n){t.exports=function(t){return i&&n.Buffer.isBuffer(t)||e&&(t instanceof n.ArrayBuffer||r(t))};var i="function"==typeof n.Buffer&&"function"==typeof n.Buffer.isBuffer,e="function"==typeof n.ArrayBuffer,r=e&&"function"==typeof n.ArrayBuffer.isView?n.ArrayBuffer.isView:function(t){return t.buffer instanceof n.ArrayBuffer}}).call(this,i(0))},function(t,n,i){var e=i(40),r=i(29),o=i(4),s=i(10),c=i(30),u=i(31),a=i(2)("socket.io-client:manager"),f=i(28),h=i(54),l=Object.prototype.hasOwnProperty;function d(t,n){if(!(this instanceof d))return new d(t,n);t&&"object"==typeof t&&(n=t,t=void 0),(n=n||{}).path=n.path||"/socket.io",this.nsps={},this.subs=[],this.opts=n,this.reconnection(!1!==n.reconnection),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor(n.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==n.timeout?2e4:n.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var i=n.parser||s;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=!1!==n.autoConnect,this.autoConnect&&this.open()}t.exports=d,d.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)l.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},d.prototype.updateSocketIds=function(){for(var t in this.nsps)l.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},d.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},o(d.prototype),d.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},d.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},d.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},d.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},d.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},d.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},d.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},d.prototype.open=d.prototype.connect=function(t,n){if(a("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;a("opening %s",this.uri),this.engine=e(this.uri,this.opts);var i=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=c(i,"open",(function(){r.onopen(),t&&t()})),s=c(i,"error",(function(n){if(a("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",n),t){var i=new Error("Connection error");i.data=n,t(i)}else r.maybeReconnectOnOpen()}));if(!1!==this._timeout){var u=this._timeout;a("connect attempt will timeout after %d",u);var f=setTimeout((function(){a("connect attempt timed out after %d",u),o.destroy(),i.close(),i.emit("error","timeout"),r.emitAll("connect_timeout",u)}),u);this.subs.push({destroy:function(){clearTimeout(f)}})}return this.subs.push(o),this.subs.push(s),this},d.prototype.onopen=function(){a("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(c(t,"data",u(this,"ondata"))),this.subs.push(c(t,"ping",u(this,"onping"))),this.subs.push(c(t,"pong",u(this,"onpong"))),this.subs.push(c(t,"error",u(this,"onerror"))),this.subs.push(c(t,"close",u(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",u(this,"ondecoded")))},d.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},d.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},d.prototype.ondata=function(t){this.decoder.add(t)},d.prototype.ondecoded=function(t){this.emit("packet",t)},d.prototype.onerror=function(t){a("error",t),this.emitAll("error",t)},d.prototype.socket=function(t,n){var i=this.nsps[t];if(!i){i=new r(this,t,n),this.nsps[t]=i;var e=this;i.on("connecting",o),i.on("connect",(function(){i.id=e.generateId(t)})),this.autoConnect&&o()}function o(){~f(e.connecting,i)||e.connecting.push(i)}return i},d.prototype.destroy=function(t){var n=f(this.connecting,t);~n&&this.connecting.splice(n,1),this.connecting.length||this.close()},d.prototype.packet=function(t){a("writing packet %j",t);var n=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),n.encoding?n.packetBuffer.push(t):(n.encoding=!0,this.encoder.encode(t,(function(i){for(var e=0;e<i.length;e++)n.engine.write(i[e],t.options);n.encoding=!1,n.processPacketQueue()})))},d.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},d.prototype.cleanup=function(){a("cleanup");for(var t=this.subs.length,n=0;n<t;n++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},d.prototype.close=d.prototype.disconnect=function(){a("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},d.prototype.onclose=function(t){a("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},d.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)a("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var n=this.backoff.duration();a("will wait %dms before reconnect attempt",n),this.reconnecting=!0;var i=setTimeout((function(){t.skipReconnect||(a("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open((function(n){n?(a("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",n.data)):(a("reconnect success"),t.onreconnect())})))}),n);this.subs.push({destroy:function(){clearTimeout(i)}})}},d.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,n,i){(function(t){var e=i(12),r=i(43),o=i(50),s=i(51);n.polling=function(n){var i=!1,s=!1,c=!1!==n.jsonp;if(t.location){var u="https:"===location.protocol,a=location.port;a||(a=u?443:80),i=n.hostname!==location.hostname||a!==n.port,s=n.secure!==u}if(n.xdomain=i,n.xscheme=s,"open"in new e(n)&&!n.forceJSONP)return new r(n);if(!c)throw new Error("JSONP disabled");return new o(n)},n.websocket=s}).call(this,i(0))},function(t,n,i){var e=i(13),r=i(7),o=i(5),s=i(8),c=i(27),u=i(2)("engine.io-client:polling");t.exports=f;var a=null!=new(i(12))({xdomain:!1}).responseType;function f(t){var n=t&&t.forceBase64;a&&!n||(this.supportsBinary=!1),e.call(this,t)}s(f,e),f.prototype.name="polling",f.prototype.doOpen=function(){this.poll()},f.prototype.pause=function(t){var n=this;function i(){u("paused"),n.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var e=0;this.polling&&(u("we are currently polling - waiting to pause"),e++,this.once("pollComplete",(function(){u("pre-pause polling complete"),--e||i()}))),this.writable||(u("we are currently writing - waiting to pause"),e++,this.once("drain",(function(){u("pre-pause writing complete"),--e||i()})))}else i()},f.prototype.poll=function(){u("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},f.prototype.onData=function(t){var n=this;u("polling got data %s",t);o.decodePayload(t,this.socket.binaryType,(function(t,i,e){if("opening"===n.readyState&&n.onOpen(),"close"===t.type)return n.onClose(),!1;n.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():u('ignoring poll - transport state "%s"',this.readyState))},f.prototype.doClose=function(){var t=this;function n(){u("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(u("transport open - closing"),n()):(u("transport not open - deferring close"),this.once("open",n))},f.prototype.write=function(t){var n=this;this.writable=!1;var i=function(){n.writable=!0,n.emit("drain")};o.encodePayload(t,this.supportsBinary,(function(t){n.doWrite(t,i)}))},f.prototype.uri=function(){var t=this.query||{},n=this.secure?"https":"http",i="";return!1!==this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||t.sid||(t.b64=1),t=r.encode(t),this.port&&("https"===n&&443!==Number(this.port)||"http"===n&&80!==Number(this.port))&&(i=":"+this.port),t.length&&(t="?"+t),n+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t}},function(t,n,i){(function(n){var e=i(11),r=Object.prototype.toString,o="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);t.exports=function t(i){if(!i||"object"!=typeof i)return!1;if(e(i)){for(var r=0,c=i.length;r<c;r++)if(t(i[r]))return!0;return!1}if("function"==typeof n&&n.isBuffer&&n.isBuffer(i)||"function"==typeof ArrayBuffer&&i instanceof ArrayBuffer||o&&i instanceof Blob||s&&i instanceof File)return!0;if(i.toJSON&&"function"==typeof i.toJSON&&1===arguments.length)return t(i.toJSON(),!0);for(var u in i)if(Object.prototype.hasOwnProperty.call(i,u)&&t(i[u]))return!0;return!1}}).call(this,i(9).Buffer)},function(t,n,i){"use strict";var e,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o={},s=0,c=0;function u(t){var n="";do{n=r[t%64]+n,t=Math.floor(t/64)}while(t>0);return n}function a(){var t=u(+new Date);return t!==e?(s=0,e=t):t+"."+u(s++)}for(;c<64;c++)o[r[c]]=c;a.encode=u,a.decode=function(t){var n=0;for(c=0;c<t.length;c++)n=64*n+o[t.charAt(c)];return n},t.exports=a},function(t,n){var i=[].indexOf;t.exports=function(t,n){if(i)return t.indexOf(n);for(var e=0;e<t.length;++e)if(t[e]===n)return e;return-1}},function(t,n,i){var e=i(10),r=i(4),o=i(53),s=i(30),c=i(31),u=i(2)("socket.io-client:socket"),a=i(7),f=i(26);t.exports=d;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},l=r.prototype.emit;function d(t,n,i){this.io=t,this.nsp=n,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}r(d.prototype),d.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[s(t,"open",c(this,"onopen")),s(t,"packet",c(this,"onpacket")),s(t,"close",c(this,"onclose"))]}},d.prototype.open=d.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},d.prototype.send=function(){var t=o(arguments);return t.unshift("message"),this.emit.apply(this,t),this},d.prototype.emit=function(t){if(h.hasOwnProperty(t))return l.apply(this,arguments),this;var n=o(arguments),i={type:(void 0!==this.flags.binary?this.flags.binary:f(n))?e.BINARY_EVENT:e.EVENT,data:n,options:{}};return i.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof n[n.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=n.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this},d.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},d.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?a.encode(this.query):this.query;u("sending connect packet with query %s",t),this.packet({type:e.CONNECT,query:t})}else this.packet({type:e.CONNECT})},d.prototype.onclose=function(t){u("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},d.prototype.onpacket=function(t){var n=t.nsp===this.nsp,i=t.type===e.ERROR&&"/"===t.nsp;if(n||i)switch(t.type){case e.CONNECT:this.onconnect();break;case e.EVENT:case e.BINARY_EVENT:this.onevent(t);break;case e.ACK:case e.BINARY_ACK:this.onack(t);break;case e.DISCONNECT:this.ondisconnect();break;case e.ERROR:this.emit("error",t.data)}},d.prototype.onevent=function(t){var n=t.data||[];u("emitting event %j",n),null!=t.id&&(u("attaching ack callback to event"),n.push(this.ack(t.id))),this.connected?l.apply(this,n):this.receiveBuffer.push(n)},d.prototype.ack=function(t){var n=this,i=!1;return function(){if(!i){i=!0;var r=o(arguments);u("sending ack %j",r),n.packet({type:f(r)?e.BINARY_ACK:e.ACK,id:t,data:r})}}},d.prototype.onack=function(t){var n=this.acks[t.id];"function"==typeof n?(u("calling ack %s with %j",t.id,t.data),n.apply(this,t.data),delete this.acks[t.id]):u("bad ack %s",t.id)},d.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},d.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)l.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},d.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},d.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},d.prototype.close=d.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:e.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},d.prototype.compress=function(t){return this.flags.compress=t,this},d.prototype.binary=function(t){return this.flags.binary=t,this}},function(t,n){t.exports=function(t,n,i){return t.on(n,i),{destroy:function(){t.removeListener(n,i)}}}},function(t,n){var i=[].slice;t.exports=function(t,n){if("string"==typeof n&&(n=t[n]),"function"!=typeof n)throw new Error("bind() requires a function");var e=i.call(arguments,2);return function(){return n.apply(t,e.concat(i.call(arguments)))}}},function(t,n,i){const{Socket:e}=i(3),{ab2str:r,str2ab:o,make4Len16:s,readString:c}=i(1),u=i(20);var a={};function f(){}a.sendHostCommand=function(t,n){e.connect({host:"127.0.0.1",port:5037},(function(i){if(i){var e=t;t=s(t.length)+t,i.read(4,(function(t){var o=r(t);if("OKAY"!=o)return console.error("error in response to adb host command",e,o),i.destroy(),void n();i.read(4,(function(t){var e=r(t);0!=(t=parseInt(e,16))&&"OKAY"!=e?i.read(t,(function(t){n(i,t)})):n(i,new ArrayBuffer(0))}))})),i.write(o(t),(function(){}))}else n()}))},a.devices=function(t){var n={};function i(t){var i=t,e=(t=t.replace("\t"," ")).indexOf(" ");if(-1!=e){var r,o=t.substring(0,e);for(t=t.substring(e).trim();r!=t;)r=t,t=t.replace("  "," ");var s={},c=t.indexOf(" ");-1==c&&(c=t.length);var u,a=t.substring(0,c);for(t=t.substring(c+1);t.length&&-1!=(e=t.indexOf(":"));){var f,h=t.substring(0,e),l=t.substring(e+1),d=l.indexOf(" "),v=l.indexOf(":");if(-1==d||-1==v)f=l,t="";else for(;-1!=d&&d<v;)f=l.substring(0,d),t=l.substring(d+1),d=l.indexOf(" ",d+1);s[h]=f}u=s.model?s.model.replace("_"," "):o,n[o]={serialno:o,name:u,status:a,properties:i}}}a.sendHostCommand("host:devices-l",(function(e,o){if(e){e.destroy(),o=r(o),console.log("ADB devices:",o);var s=(o=o.trim()).split("\n");for(var c in s)i(c=s[c]);console.log("parsed ADB devices:",n),t(n)}else t()}))},a.killServer=function(t){a.sendHostCommand("host:kill-server",(function(n,i){n?(n.destroy(),i=r(i),t&&t()):t()}))},a.sendClientCommand=function(t,n){var i=t.command,c=t.serialno;e.connect({host:"127.0.0.1",port:5037},(function(t){if(t){t.read(4,(function(e){if("OKAY"!=r(e))return t.destroy(),void n(null);var c=i;c=s(c.length)+c,t.read(4,(function(i){if("OKAY"!=r(i))return t.destroy(),void n(null);n(t)})),t.write(o(c),(function(){}))}));var e="host:transport:"+c;e=s(e.length)+e,t.write(o(e),(function(){}))}else n()}))},a.shell=function(t,n){var i=t.command;t.serialno;a.getOrCreateSockFactory(t).newSocket("shell:"+i,(function(t){t?c(t,(function(t){n(t)})):n()}))},a.forward=function(t,n){var i="host-serial:"+t.serialno+":forward:"+t.from+";"+t.to;a.sendHostCommand(i,(function(t,i){t&&t.destroy(),n(t,i)}))},a.reverse=function(t,n){var i="reverse:forward:"+t.from+";"+t.to;a.sendClientCommand({serialno:t.serialno,command:i},(function(t,i){t?c(t,n):n()}))},f.MKID=function(t,n,i,e){return t.charCodeAt(0)|n.charCodeAt(0)<<8|i.charCodeAt(0)<<16|e.charCodeAt(0)<<24},f.ID_RECV=f.MKID("R","E","C","V"),f.ID_SEND=f.MKID("S","E","N","D"),f.ID_DONE=f.MKID("D","O","N","E"),f.ID_DATA=f.MKID("D","A","T","A"),f.DATA_MAX=65536,a.pull=function(t,n){var i,r=t.file,s=(t.serialno,t.fileEntry),c=t.socket;c||(c={write:function(t,n){i?(i.onwriteend=n,i.write(new Blob([t]))):s.createWriter((function(e){i=e,c.write(t,n)}))}});var h=new u;e.pump(h,c,(function(){n(s)})),a.getOrCreateSockFactory(t).newSocket("sync:",(function(t){if(t){var i=new ArrayBuffer(8),e=new DataView(i);e.setUint32(0,f.ID_RECV,!0),e.setUint32(4,r.length,!0),t.write(i,(function(){t.write(o(r),(function(){s()}))}))}else n();function s(){t.read(8,(function(i){var e=new DataView(i.buffer,i.byteOffset,i.byteLength),r=e.getUint32(0,!0);r!=f.ID_DATA?(t.destroy(),r!=f.ID_DONE?n():h.dataReceived(null)):function(n){t.read(n,(function(t){h.dataReceived(t),s()}))}(e.getUint32(4,!0))}))}}))},a.createSocketFactory=function(t){return{newSocket:function(n,i){a.sendClientCommand({serialno:t,command:n},i)}}},a.getOrCreateSockFactory=function(t){return t.socketFactory||a.createSocketFactory(t.serialno)},a.push=function(t,n){var i=t.file,e=(t.serialno,t.socket);a.getOrCreateSockFactory(t).newSocket("sync:",(function(t){if(t){var r=new ArrayBuffer(8),s=new DataView(r),c=i+",0644";s.setUint32(0,f.ID_SEND,!0),s.setUint32(4,c.length,!0),t.write(r,(function(){t.write(o(c),(function(){function i(){e.read((function(n){if(n.byteLength>f.DATA_MAX){var r=n.subarray(f.DATA_MAX);n=n.subarray(0,f.DATA_MAX),e.unshift(r)}!function(n){var e=new ArrayBuffer(8),r=new DataView(e);r.setUint32(0,f.ID_DATA,!0),r.setUint32(4,n.byteLength,!0),t.write(e,(function(){var e=n.buffer;(n.byteOffset||n.length!=e.byteLength)&&(e=e.slice(n.byteOffset,n.byteOffset+n.byteLength)),t.write(e,(function(){i()}))}))}(n)}))}e.onClose=function(){var i=new ArrayBuffer(8),e=new DataView(i);e.setUint32(0,f.ID_DONE,!0),e.setUint32(4,0,!0),t.write(i,(function(){t.read(8,(function(){n()}))}))},i()}))}))}else n()}))},t.exports=a},function(t,n,i){{let t=window.RTCSessionDescription||window.webkitRTCSessionDescription?window:require("wrtc");var e=t.RTCSessionDescription||t.webkitRTCSessionDescription,r=t.RTCPeerConnection||t.webkitRTCPeerConnection,o=t.RTCIceCandidate||t.webkitRTCIceCandidate}var s=i(3).Socket,c=i(34),{str2ab:u,ab2str:a,isNode:f}=i(1);function h(t,n){this.conn=t,this.dc=n,this.gotEof=!1,n.onmessage=function(t){var n=new Uint8Array(t.data),i=1==n[n.byteLength-1];this.dataReceived(n.subarray(0,n.byteLength-1)),i&&(this.gotEof=!0,this.destroy())}.bind(this),n.onclose=n.onerror=this.destroy.bind(this);try{this.needsBufferShim=f()||parseInt(/Chrome\/(\d\d)/.exec(navigator.userAgent)[1])<70}catch(t){}this.needsBufferShim||(n.bufferedAmountLowThreshold=0,n.onbufferedamountlow=this.writeable.bind(this))}function l(t,n,i){this.manager=t,this.peerConnection=n,this.key=i,this.peerConnection.oniceconnectionstatechange=function(){"disconnected"!=this.peerConnection.iceConnectionState&&"closed"!=this.peerConnection.iceConnectionState&&"failed"!=this.peerConnection.iceConnectionState||this.destroy()}.bind(this)}function d(t,n,i){this.senders=t,this.registrationId=n,this.rtcc=i,this.gcmRtcConnections={},this.gcmRtcListeners={},this.amazonTokens={}}h.prototype.buffered=s.prototype.buffered,h.prototype.unshift=s.prototype.unshift,h.prototype.dataReceived=s.prototype.dataReceived,h.prototype.read=s.prototype.read,h.prototype.pause=s.prototype.pause,h.prototype.resume=s.prototype.resume,h.prototype.buffered=s.prototype.buffered,h.prototype.writeable=function(){var t=this.writeCallback;t&&(delete this.writeCallback,t())},h.prototype.write=function(t,n){if(this.dc&&"open"==this.dc.readyState){this.writeCallback=n;var i=new Uint8Array(t.byteLength+1);if(i.set(new Uint8Array(t)),this.dc.send(i.buffer),!this.reentrantWrite)try{for(this.reentrantWrite=!0;this.writeCallback&&(0==this.dc.bufferedAmount||this.needsBufferShim);)this.writeable();this.writeCallback&&console.log("waiting for writable")}finally{this.reentrantWrite=!1}}else this.destroy()},h.prototype.destroy=function(){if(this.dataReceived(null),null!=this.dc){var t=this.dc;if(this.dc=null,t.onclose=null,t.onerror=null,"open"==t.readyState)try{t.send(new Uint8Array([1])),this.gotEof?this.conn.recycleChannel(t):this.conn.waitForEof(t)}catch(t){}}},l.prototype.waitForCommand=function(t){t.onmessage=function(n){if(1!=n.data.byteLength){this.removeChannel(t);var i=a(n.data),e=new h(this,t);this.openSocket(i,e)}}.bind(this)},l.prototype.compactChannels=function(){this.inboundChannels&&!this.inboundChannels.length&&(this.inboundChannels=null),this.outboundChannels&&!this.outboundChannels.length&&(this.outboundChannels=null)},l.prototype.getAppropriateChannels=function(t,n){var i;return t.inbound?(!this.inboundChannels&&n&&(this.inboundChannels=[]),i=this.inboundChannels):(!this.outboundChannels&&n&&(this.outboundChannels=[]),i=this.outboundChannels),i},l.prototype.removeChannel=function(t){if(channels=this.getAppropriateChannels(t),channels){var n=channels.indexOf(t);-1!=n&&(channels.splice(n,1),this.compactChannels())}},l.prototype.waitForEof=function(t){t.onmessage=function(n){var i=new Uint8Array(n.data);1==i[i.byteLength-1]&&this.recycleChannel(t)}.bind(this)},l.prototype.recycleChannel=function(t){this.getAppropriateChannels(t,!0).push(t),t.onclose=t.onerror=function(){this.removeChannel(t)}.bind(this),this.waitForCommand(t)},l.prototype.addCandidates=function(t){for(var n in t.candidates)console.log("remote candidate",t.candidates[n]),this.peerConnection.addIceCandidate(new o(t.candidates[n]))},l.prototype.setupPinger=function(t){var n;t.onmessage=function(t){},t.onclose=t.onerror=function(){clearTimeout(n),this.destroy()}.bind(this),function i(){t.send(u("ping")),n=setTimeout(i,1e3)}()},l.prototype.listenSockets=function(){this.peerConnection.ondatachannel=function(t){t.channel.inbound=!0,this.waitForCommand(t.channel)}.bind(this)},l.prototype.prepareChannel=function(t){var n=this.peerConnection.createDataChannel(t||"gcm",{ordered:!0});return n.binaryType="arraybuffer",n},l.prototype.newSocket=function(t,n){if("closed"!=this.peerConnection.signalingState)if(this.outboundChannels){var i=this.outboundChannels.shift();this.compactChannels(),i.send(u(t));var e=new h(this,i);n(e,this)}else{var r;(i=this.prepareChannel("gcm")).onopen=function(){if(!r){r=!0,i.send(u(t));var e=new h(this,i);n(e,this)}}.bind(this),"open"==i.readyState&&i.onopen()}else n()},l.prototype.destroy=function(){delete this.manager.gcmRtcConnections[this.key],"closed"!=this.peerConnection.signalingState&&this.peerConnection.close();var t=this.onClose;t&&(delete this.onClose,t())},d.prototype.onMessage=function(t){var n=JSON.parse(t.message),i=t.type,e=t.senderId,r=t.src,o=t.srcPort,s=t.dst||this.registrationId,c=t.dstPort;if("offer"!=i){if("answer"==i){var u=d.getKey(r,o,c),a=this.gcmRtcConnections[u];return a?void a.manager.incoming(e,r,o,s,c,n):(console.error("pending connection not found"),void console.error(t))}d.onUnknownMessage?d.onUnknownMessage(t):console.log("unknown message "+i)}else{var f=this.gcmRtcListeners[c];f?f.listener.incoming(e,r,o,s,c,n,f.listenCallback):console.log("not listening on "+c)}};var v,p=!1;try{p=!(!chrome||!chrome.gcm)}catch(t){}d.hasLoadedChannels=!1,d.start=function(t,n,e){if(console.log("starting GtcRtcManger"),p){var r=Object.keys(t);chrome.gcm.register(r,(function(i){if(chrome.runtime.lastError,i){var r=new d(t,i,n);chrome.gcm.onMessage.addListener((function(t){r.onMessage(t.data)})),e(r)}else e()}))}else{function o(t){var n=t("https://push.clockworkmod.com");n.on("registration",(function(t){t="web:"+t,s.registrationId?(s.registrationId=t,s.onRegistrationIdChanged&&s.onRegistrationIdChanged(t)):(s.registrationId=t,e(s))})),n.on("data",(function(t){s.onMessage(t)}))}var s=new d(t,null,n);if(f())o(i(35));else{c="https://push.clockworkmod.com/socket.io/socket.io.js",u=function(){o(io)},a=document.createElement("script"),h=document.getElementsByTagName("script")[0],a.async=1,a.onload=a.onreadystatechange=function(t,n){(n||!a.readyState||/loaded|complete/.test(a.readyState))&&(a.onload=a.onreadystatechange=null,a=void 0,n||u&&u())},a.src=c,h.parentNode.insertBefore(a,h)}}var c,u,a,h},d.prototype.wrapMessage=function(t,n,i,e,r,o,s){return{senderId:t,src:e,srcPort:r,dst:n,dstPort:i,type:o,message:JSON.stringify(s)}},d.prototype.sendGcm=function(t,n,i,e,r,o,s){var c=this.wrapMessage(t,n,i,e,r,o,s);return this.sendWrappedMessage(t,n,c)},d.prototype.sendWrappedMessage=function(t,n,i){if(t||(t=this.defaultSenderId),n.startsWith("web:"))return c(n.substring(4),{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json"}}).then(t=>t.json());if(n.startsWith("amzn")){var e;if(!this.amazonTokens[t]||this.amazonTokens[t].accessTokenExpiration<Date.now()){var r=this.senders[t];console.log(t,r);var o={grant_type:"client_credentials",scope:"messaging:push",client_id:t,client_secret:r},s=Object.entries(o).map(([t,n])=>`${encodeURIComponent(t)}=${encodeURIComponent(n)}`).join("&");e=c("https://api.amazon.com/auth/O2/token",{method:"POST",body:s,headers:{"Content-type":"application/x-www-form-urlencoded;charset=UTF-8"}}).then(t=>t.json()).then(n=>(this.amazonTokens[t]={},this.amazonTokens[t].accessToken=n.access_token,this.amazonTokens[t].accessTokenExpiration=Date.now()+n.expires_in-30,n.access_token))}else console.log("token valid for",this.amazonTokens[t].accessTokenExpiration-Date.now()),e=Promise.resolve(this.amazonTokens[t].accessToken);return e.then(t=>c(`https://api.amazon.com/messaging/registrations/${n}/messages`,{method:"POST",body:JSON.stringify({data:i}),headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${t}`,"X-Amzn-Type-Version":"com.amazon.device.messaging.ADMMessage@1.0","X-Amzn-Accept-Type":"com.amazon.device.messaging.ADMSendResult@1.0"}}).then(t=>t.json()))}return c("https://fcm.googleapis.com/fcm/send",{method:"POST",body:JSON.stringify({to:n,data:i}),headers:{"Content-Type":"application/json",Authorization:"key="+this.senders[t]}}).then(t=>t.json())},d.getKey=function(t,n,i){return i+":"+n+":"+t},d.dictionaryKeys="0 1 2 3 4 5 6 7 8 9 a b c d e f g h i j k l m n o p q r s t u v w x y z".split(" "),d.sdpDictionary={},d.addDictionary=function(t){var n=d.dictionaryKeys[Object.keys(d.sdpDictionary).length];d.sdpDictionary[n]=t},d.replaceAll=function(t,n,i){n=n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var e=new RegExp(n,"g");return t.replace(e,i)},d.compressSdp=function(t){for(var n in t=t.replace("\\","\\\\"),d.sdpDictionary){var i=d.sdpDictionary[n];t=d.replaceAll(t,i,"\\"+n)}return t},d.decompressSdp=function(t){for(var n in d.sdpDictionary){var i=d.sdpDictionary[n];t=t.replace(new RegExp(`([^\\\\])\\\\${n}`,"g"),"$1"+i)}return t},(v=d.addDictionary)("a=rtpmap:"),v("a=extmap:"),v("a=rtcp-fb:"),v("a=fmtp:"),v("level-asymmetry-allowed="),v("packetization-mode="),v("profile-level-id="),v("90000"),v("rtx/90000"),v("H264/90000"),v("transport-cc"),v("x-google-profile-id"),v("nack pli"),v("goog-remb"),v("ccm fir"),v("telephone-event/"),v("http://www.webrtc.org/experiments/rtp-hdrext/"),v("urn:ietf:params:rtp-hdrext:toffset"),v("http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time"),v("urn:3gpp:video-orientation"),v("http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"),v("http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"),v("http://www.webrtc.org/experiments/rtp-hdrext/video-content-type"),v("http://www.webrtc.org/experiments/rtp-hdrext/video-timing"),v("http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01"),d.prototype.setupPeerConnection=function(t,n,i,e,o,s,c){var u,a=new r(this.rtcc),f=function(r){var u,a=[],f=c(),h=(f.sdp,{type:f.type,sdp:d.compressSdp(f.sdp)}),l=JSON.stringify(h).length;for(var v in r)null!=(v=r[v])&&(a.push(v),l+JSON.stringify(a).length>3200&&(u=!0,this.sendGcm(n,i,e,o,s,t,{desc:h,candidates:a}),a=[]));(a.length>0||!u)&&this.sendGcm(n,i,e,o,s,t,{desc:h,candidates:a})}.bind(this);a.onicecandidate=function(t){t.candidate?(console.log("candidate",t.candidate),u=function(t,n,i,e,r){if(t||(t={items:[]}),t.items.push(n),!t.timeout){function o(){delete t.timeout,e(t.items),t.items=[]}r&&o(t.items),t.timeout=setTimeout(o,i)}return t}(u,t.candidate,500,f)):console.log("done sending ice candidates")}.bind(this);var h=d.getKey(i,e,s),v=new l(this,a,h);return v.sendConnect=f,a.onsignalingstatechange=function(t){"stable"==a.signalingState?this.gcmRtcConnections[h]:"closed"==a.signalingState&&v.destroy()}.bind(this),this.gcmRtcConnections[h]=v,v},d.prototype.connect=function(t){return new Promise((n,i)=>{var e=t.senderId,r=t.registrationId,o=t.port;if(!r)throw new Error("registrationId was null on connect");var s,c=Math.random().toString(16),u=this.setupPeerConnection("offer",e,r,o,this.registrationId,c,(function(){return s})),a=u.peerConnection;try{-1!=navigator.userAgent.indexOf("Safari")&&-1==navigator.userAgent.indexOf("Chrome")&&t.offerToReceiveAudio&&t.offerToReceiveVideo&&(a.addTransceiver("audio"),a.addTransceiver("video"))}catch(t){}var f=setTimeout((function(){u.destroy(),i(new Error("Timeout waiting for RTC Connection"))}),3e4);function h(t){a.createOffer(t).then((function(t){s=t,console.log(t),a.setLocalDescription(t),u.sendConnect([])}))}if(t.offerToReceiveAudio||t.offerToReceiveVideo||t.audio){function l(){a.ontrack=function(t){u.streams=t.streams,console.log("got the remote stream"),clearTimeout(f),n(u)},h({offerToReceiveAudio:!!t.offerToReceiveAudio,offerToReceiveVideo:!!t.offerToReceiveVideo,voiceActivityDetection:!1})}if(!t.audio)return void l();navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){t.getTracks().forEach((function(n){a.addTrack(n,t)})),l()})).catch(t=>{console.error("audio fail",t),l()})}else{var d=u.prepareChannel("pinger");d.onopen=function(){console.log("got rtc pinger"),u.setupPinger(d),clearTimeout(f),n(u)},u.listenSockets(),h({})}})},d.prototype.isListening=function(t){return null!=this.gcmRtcListeners[t]},d.prototype.stopListen=function(t){delete this.gcmRtcListeners[t]},d.prototype.listen=function(t,n){this.gcmRtcListeners[t]?console.log("already listening on gcm port "+t):this.gcmRtcListeners[t]={listener:this,listenCallback:n}},d.prototype.incoming=function(t,n,i,r,o,s,c){var u=d.getKey(n,i,o),a=this.gcmRtcConnections[u];if(a){if(!a.remoteDesc){l=s.desc.sdp;s.desc.sdp=d.decompressSdp(l),a.remoteDesc=new e(s.desc),(h=a.peerConnection).setRemoteDescription(a.remoteDesc)}}else{if(!n)return void console.warn("received null registraition on incoming message. ignoring");var f;a=this.setupPeerConnection("answer",t,n,i,r,o,(function(){return f}));var h,l=s.desc.sdp;s.desc.sdp=d.decompressSdp(l),a.remoteDesc=new e(s.desc),(h=a.peerConnection).ondatachannel=function(t){console.log("got rtc pinger"),this.setupPinger(t.channel),c(a),this.listenSockets()}.bind(a),h.setRemoteDescription(a.remoteDesc,(function(){h.createAnswer().then((function(t){f=t,h.setLocalDescription(t)}),(function(){console.error("answer error",arguments)}))}))}a.addCandidates(s)},n.GcmRtcSocket=h,n.GcmRtcManager=d},function(t,n,i){"use strict";var e=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("unable to locate global object")}();t.exports=n=e.fetch,n.default=e.fetch.bind(e),n.Headers=e.Headers,n.Request=e.Request,n.Response=e.Response},function(t,n,i){var e=i(36),r=i(10),o=i(23),s=i(2)("socket.io-client");t.exports=n=u;var c=n.managers={};function u(t,n){"object"==typeof t&&(n=t,t=void 0),n=n||{};var i,r=e(t),u=r.source,a=r.id,f=r.path,h=c[a]&&f in c[a].nsps;return n.forceNew||n["force new connection"]||!1===n.multiplex||h?(s("ignoring socket cache for %s",u),i=o(u,n)):(c[a]||(s("new io instance for %s",u),c[a]=o(u,n)),i=c[a]),r.query&&!n.query&&(n.query=r.query),i.socket(r.path,n)}n.protocol=r.protocol,n.connect=u,n.Manager=i(23),n.Socket=i(29)},function(t,n,i){(function(n){var e=i(21),r=i(2)("socket.io-client:url");t.exports=function(t,i){var o=t;i=i||n.location,null==t&&(t=i.protocol+"//"+i.host);"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?i.protocol+t:i.host+t),/^(https?|wss?):\/\//.test(t)||(r("protocol-less url %s",t),t=void 0!==i?i.protocol+"//"+t:"https://"+t),r("parse %s",t),o=e(t));o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443"));o.path=o.path||"/";var s=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host;return o.id=o.protocol+"://"+s+":"+o.port,o.href=o.protocol+"://"+s+(i&&i.port===o.port?"":":"+o.port),o}}).call(this,i(0))},function(t,n,i){function e(t){var i;function e(){if(e.enabled){var t=e,r=+new Date,o=r-(i||r);t.diff=o,t.prev=i,t.curr=r,i=r;for(var s=new Array(arguments.length),c=0;c<s.length;c++)s[c]=arguments[c];s[0]=n.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var u=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(i,e){if("%%"===i)return i;u++;var r=n.formatters[e];if("function"==typeof r){var o=s[u];i=r.call(t,o),s.splice(u,1),u--}return i})),n.formatArgs.call(t,s);var a=e.log||n.log||console.log.bind(console);a.apply(t,s)}}return e.namespace=t,e.enabled=n.enabled(t),e.useColors=n.useColors(),e.color=function(t){var i,e=0;for(i in t)e=(e<<5)-e+t.charCodeAt(i),e|=0;return n.colors[Math.abs(e)%n.colors.length]}(t),e.destroy=r,"function"==typeof n.init&&n.init(e),n.instances.push(e),e}function r(){var t=n.instances.indexOf(this);return-1!==t&&(n.instances.splice(t,1),!0)}(n=t.exports=e.debug=e.default=e).coerce=function(t){return t instanceof Error?t.stack||t.message:t},n.disable=function(){n.enable("")},n.enable=function(t){var i;n.save(t),n.names=[],n.skips=[];var e=("string"==typeof t?t:"").split(/[\s,]+/),r=e.length;for(i=0;i<r;i++)e[i]&&("-"===(t=e[i].replace(/\*/g,".*?"))[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")));for(i=0;i<n.instances.length;i++){var o=n.instances[i];o.enabled=n.enabled(o.namespace)}},n.enabled=function(t){if("*"===t[t.length-1])return!0;var i,e;for(i=0,e=n.skips.length;i<e;i++)if(n.skips[i].test(t))return!1;for(i=0,e=n.names.length;i<e;i++)if(n.names[i].test(t))return!0;return!1},n.humanize=i(38),n.instances=[],n.names=[],n.skips=[],n.formatters={}},function(t,n){var i=1e3,e=6e4,r=36e5,o=24*r;function s(t,n,i){if(!(t<n))return t<1.5*n?Math.floor(t/n)+" "+i:Math.ceil(t/n)+" "+i+"s"}t.exports=function(t,n){n=n||{};var c,u=typeof t;if("string"===u&&t.length>0)return function(t){if((t=String(t)).length>100)return;var n=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(!n)return;var s=parseFloat(n[1]);switch((n[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*e;case"seconds":case"second":case"secs":case"sec":case"s":return s*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(t);if("number"===u&&!1===isNaN(t))return n.long?s(c=t,o,"day")||s(c,r,"hour")||s(c,e,"minute")||s(c,i,"second")||c+" ms":function(t){if(t>=o)return Math.round(t/o)+"d";if(t>=r)return Math.round(t/r)+"h";if(t>=e)return Math.round(t/e)+"m";if(t>=i)return Math.round(t/i)+"s";return t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,n,i){(function(t){var e=i(11),r=i(22),o=Object.prototype.toString,s="function"==typeof t.Blob||"[object BlobConstructor]"===o.call(t.Blob),c="function"==typeof t.File||"[object FileConstructor]"===o.call(t.File);n.deconstructPacket=function(t){var n=[],i=t.data,o=t;return o.data=function t(n,i){if(!n)return n;if(r(n)){var o={_placeholder:!0,num:i.length};return i.push(n),o}if(e(n)){for(var s=new Array(n.length),c=0;c<n.length;c++)s[c]=t(n[c],i);return s}if("object"==typeof n&&!(n instanceof Date)){s={};for(var u in n)s[u]=t(n[u],i);return s}return n}(i,n),o.attachments=n.length,{packet:o,buffers:n}},n.reconstructPacket=function(t,n){return t.data=function t(n,i){if(!n)return n;if(n&&n._placeholder)return i[n.num];if(e(n))for(var r=0;r<n.length;r++)n[r]=t(n[r],i);else if("object"==typeof n)for(var o in n)n[o]=t(n[o],i);return n}(t.data,n),t.attachments=void 0,t},n.removeBlobs=function(t,n){var i=0,o=t;!function t(u,a,f){if(!u)return u;if(s&&u instanceof Blob||c&&u instanceof File){i++;var h=new FileReader;h.onload=function(){f?f[a]=this.result:o=this.result,--i||n(o)},h.readAsArrayBuffer(u)}else if(e(u))for(var l=0;l<u.length;l++)t(u[l],l,u);else if("object"==typeof u&&!r(u))for(var d in u)t(u[d],d,u)}(o),i||n(o)}}).call(this,i(0))},function(t,n,i){t.exports=i(41),t.exports.parser=i(5)},function(t,n,i){(function(n){var e=i(24),r=i(4),o=i(2)("engine.io-client:socket"),s=i(28),c=i(5),u=i(21),a=i(7);function f(t,i){if(!(this instanceof f))return new f(t,i);i=i||{},t&&"object"==typeof t&&(i=t,t=null),t?(t=u(t),i.hostname=t.host,i.secure="https"===t.protocol||"wss"===t.protocol,i.port=t.port,t.query&&(i.query=t.query)):i.host&&(i.hostname=u(i.host).host),this.secure=null!=i.secure?i.secure:n.location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.agent=i.agent||!1,this.hostname=i.hostname||(n.location?location.hostname:"localhost"),this.port=i.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=i.query||{},"string"==typeof this.query&&(this.query=a.decode(this.query)),this.upgrade=!1!==i.upgrade,this.path=(i.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!i.forceJSONP,this.jsonp=!1!==i.jsonp,this.forceBase64=!!i.forceBase64,this.enablesXDR=!!i.enablesXDR,this.timestampParam=i.timestampParam||"t",this.timestampRequests=i.timestampRequests,this.transports=i.transports||["polling","websocket"],this.transportOptions=i.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=i.policyPort||843,this.rememberUpgrade=i.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=i.onlyBinaryUpgrades,this.perMessageDeflate=!1!==i.perMessageDeflate&&(i.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=i.pfx||null,this.key=i.key||null,this.passphrase=i.passphrase||null,this.cert=i.cert||null,this.ca=i.ca||null,this.ciphers=i.ciphers||null,this.rejectUnauthorized=void 0===i.rejectUnauthorized||i.rejectUnauthorized,this.forceNode=!!i.forceNode;var e="object"==typeof n&&n;e.global===e&&(i.extraHeaders&&Object.keys(i.extraHeaders).length>0&&(this.extraHeaders=i.extraHeaders),i.localAddress&&(this.localAddress=i.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}t.exports=f,f.priorWebsocketSuccess=!1,r(f.prototype),f.protocol=c.protocol,f.Socket=f,f.Transport=i(13),f.transports=i(24),f.parser=i(5),f.prototype.createTransport=function(t){o('creating transport "%s"',t);var n=function(t){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}(this.query);n.EIO=c.protocol,n.transport=t;var i=this.transportOptions[t]||{};return this.id&&(n.sid=this.id),new e[t]({query:n,socket:this,agent:i.agent||this.agent,hostname:i.hostname||this.hostname,port:i.port||this.port,secure:i.secure||this.secure,path:i.path||this.path,forceJSONP:i.forceJSONP||this.forceJSONP,jsonp:i.jsonp||this.jsonp,forceBase64:i.forceBase64||this.forceBase64,enablesXDR:i.enablesXDR||this.enablesXDR,timestampRequests:i.timestampRequests||this.timestampRequests,timestampParam:i.timestampParam||this.timestampParam,policyPort:i.policyPort||this.policyPort,pfx:i.pfx||this.pfx,key:i.key||this.key,passphrase:i.passphrase||this.passphrase,cert:i.cert||this.cert,ca:i.ca||this.ca,ciphers:i.ciphers||this.ciphers,rejectUnauthorized:i.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:i.perMessageDeflate||this.perMessageDeflate,extraHeaders:i.extraHeaders||this.extraHeaders,forceNode:i.forceNode||this.forceNode,localAddress:i.localAddress||this.localAddress,requestTimeout:i.requestTimeout||this.requestTimeout,protocols:i.protocols||void 0})},f.prototype.open=function(){var t;if(this.rememberUpgrade&&f.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var n=this;return void setTimeout((function(){n.emit("error","No transports available")}),0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},f.prototype.setTransport=function(t){o("setting transport %s",t.name);var n=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",(function(){n.onDrain()})).on("packet",(function(t){n.onPacket(t)})).on("error",(function(t){n.onError(t)})).on("close",(function(){n.onClose("transport close")}))},f.prototype.probe=function(t){o('probing transport "%s"',t);var n=this.createTransport(t,{probe:1}),i=!1,e=this;function r(){if(e.onlyBinaryUpgrades){var r=!this.supportsBinary&&e.transport.supportsBinary;i=i||r}i||(o('probe transport "%s" opened',t),n.send([{type:"ping",data:"probe"}]),n.once("packet",(function(r){if(!i)if("pong"===r.type&&"probe"===r.data){if(o('probe transport "%s" pong',t),e.upgrading=!0,e.emit("upgrading",n),!n)return;f.priorWebsocketSuccess="websocket"===n.name,o('pausing current transport "%s"',e.transport.name),e.transport.pause((function(){i||"closed"!==e.readyState&&(o("changing transport and sending upgrade packet"),l(),e.setTransport(n),n.send([{type:"upgrade"}]),e.emit("upgrade",n),n=null,e.upgrading=!1,e.flush())}))}else{o('probe transport "%s" failed',t);var s=new Error("probe error");s.transport=n.name,e.emit("upgradeError",s)}})))}function s(){i||(i=!0,l(),n.close(),n=null)}function c(i){var r=new Error("probe error: "+i);r.transport=n.name,s(),o('probe transport "%s" failed because of error: %s',t,i),e.emit("upgradeError",r)}function u(){c("transport closed")}function a(){c("socket closed")}function h(t){n&&t.name!==n.name&&(o('"%s" works - aborting "%s"',t.name,n.name),s())}function l(){n.removeListener("open",r),n.removeListener("error",c),n.removeListener("close",u),e.removeListener("close",a),e.removeListener("upgrading",h)}f.priorWebsocketSuccess=!1,n.once("open",r),n.once("error",c),n.once("close",u),this.once("close",a),this.once("upgrading",h),n.open()},f.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",f.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var t=0,n=this.upgrades.length;t<n;t++)this.probe(this.upgrades[t])}},f.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var n=new Error("server error");n.code=t.data,this.onError(n);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else o('packet received with socket readyState "%s"',this.readyState)},f.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},f.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var n=this;n.pingTimeoutTimer=setTimeout((function(){"closed"!==n.readyState&&n.onClose("ping timeout")}),t||n.pingInterval+n.pingTimeout)},f.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout((function(){o("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)}),t.pingInterval)},f.prototype.ping=function(){var t=this;this.sendPacket("ping",(function(){t.emit("ping")}))},f.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},f.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},f.prototype.write=f.prototype.send=function(t,n,i){return this.sendPacket("message",t,n,i),this},f.prototype.sendPacket=function(t,n,i,e){if("function"==typeof n&&(e=n,n=void 0),"function"==typeof i&&(e=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){(i=i||{}).compress=!1!==i.compress;var r={type:t,data:n,options:i};this.emit("packetCreate",r),this.writeBuffer.push(r),e&&this.once("flush",e),this.flush()}},f.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?e():n()})):this.upgrading?e():n()}function n(){t.onClose("forced close"),o("socket closing - telling transport to close"),t.transport.close()}function i(){t.removeListener("upgrade",i),t.removeListener("upgradeError",i),n()}function e(){t.once("upgrade",i),t.once("upgradeError",i)}return this},f.prototype.onError=function(t){o("socket error %j",t),f.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},f.prototype.onClose=function(t,n){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,n),this.writeBuffer=[],this.prevBufferLen=0}},f.prototype.filterUpgrades=function(t){for(var n=[],i=0,e=t.length;i<e;i++)~s(this.transports,t[i])&&n.push(t[i]);return n}}).call(this,i(0))},function(t,n){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(n){t.exports=!1}},function(t,n,i){(function(n){var e=i(12),r=i(25),o=i(4),s=i(8),c=i(2)("engine.io-client:polling-xhr");function u(){}function a(t){if(r.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,n.location){var i="https:"===location.protocol,e=location.port;e||(e=i?443:80),this.xd=t.hostname!==n.location.hostname||e!==t.port,this.xs=t.secure!==i}}function f(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function h(){for(var t in f.requests)f.requests.hasOwnProperty(t)&&f.requests[t].abort()}t.exports=a,t.exports.Request=f,s(a,r),a.prototype.supportsBinary=!0,a.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new f(t)},a.prototype.doWrite=function(t,n){var i="string"!=typeof t&&void 0!==t,e=this.request({method:"POST",data:t,isBinary:i}),r=this;e.on("success",n),e.on("error",(function(t){r.onError("xhr post error",t)})),this.sendXhr=e},a.prototype.doPoll=function(){c("xhr poll");var t=this.request(),n=this;t.on("data",(function(t){n.onData(t)})),t.on("error",(function(t){n.onError("xhr poll error",t)})),this.pollXhr=t},o(f.prototype),f.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var i=this.xhr=new e(t),r=this;try{c("xhr open %s: %s",this.method,this.uri),i.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var o in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(o)&&i.setRequestHeader(o,this.extraHeaders[o])}catch(t){}if("POST"===this.method)try{this.isBinary?i.setRequestHeader("Content-type","application/octet-stream"):i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{i.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in i&&(i.withCredentials=!0),this.requestTimeout&&(i.timeout=this.requestTimeout),this.hasXDR()?(i.onload=function(){r.onLoad()},i.onerror=function(){r.onError(i.responseText)}):i.onreadystatechange=function(){if(2===i.readyState)try{var t=i.getResponseHeader("Content-Type");r.supportsBinary&&"application/octet-stream"===t&&(i.responseType="arraybuffer")}catch(t){}4===i.readyState&&(200===i.status||1223===i.status?r.onLoad():setTimeout((function(){r.onError(i.status)}),0))},c("xhr data %s",this.data),i.send(this.data)}catch(t){return void setTimeout((function(){r.onError(t)}),0)}n.document&&(this.index=f.requestsCount++,f.requests[this.index]=this)},f.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},f.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},f.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},f.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=u:this.xhr.onreadystatechange=u,t)try{this.xhr.abort()}catch(t){}n.document&&delete f.requests[this.index],this.xhr=null}},f.prototype.onLoad=function(){var t;try{var n;try{n=this.xhr.getResponseHeader("Content-Type")}catch(t){}t="application/octet-stream"===n&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},f.prototype.hasXDR=function(){return void 0!==n.XDomainRequest&&!this.xs&&this.enablesXDR},f.prototype.abort=function(){this.cleanup()},f.requestsCount=0,f.requests={},n.document&&(n.attachEvent?n.attachEvent("onunload",h):n.addEventListener&&n.addEventListener("beforeunload",h,!1))}).call(this,i(0))},function(t,n){t.exports=Object.keys||function(t){var n=[],i=Object.prototype.hasOwnProperty;for(var e in t)i.call(t,e)&&n.push(e);return n}},function(t,n){t.exports=function(t,n,i){var e=t.byteLength;if(n=n||0,i=i||e,t.slice)return t.slice(n,i);if(n<0&&(n+=e),i<0&&(i+=e),i>e&&(i=e),n>=e||n>=i||0===e)return new ArrayBuffer(0);for(var r=new Uint8Array(t),o=new Uint8Array(i-n),s=n,c=0;s<i;s++,c++)o[c]=r[s];return o.buffer}},function(t,n){function i(){}t.exports=function(t,n,e){var r=!1;return e=e||i,o.count=t,0===t?n():o;function o(t,i){if(o.count<=0)throw new Error("after called too many times");--o.count,t?(r=!0,n(t),n=e):0!==o.count||r||n(null,i)}}},function(t,n){var i,e,r,o=String.fromCharCode;function s(t){for(var n,i,e=[],r=0,o=t.length;r<o;)(n=t.charCodeAt(r++))>=55296&&n<=56319&&r<o?56320==(64512&(i=t.charCodeAt(r++)))?e.push(((1023&n)<<10)+(1023&i)+65536):(e.push(n),r--):e.push(n);return e}function c(t,n){if(t>=55296&&t<=57343){if(n)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function u(t,n){return o(t>>n&63|128)}function a(t,n){if(0==(4294967168&t))return o(t);var i="";return 0==(4294965248&t)?i=o(t>>6&31|192):0==(4294901760&t)?(c(t,n)||(t=65533),i=o(t>>12&15|224),i+=u(t,6)):0==(4292870144&t)&&(i=o(t>>18&7|240),i+=u(t,12),i+=u(t,6)),i+=o(63&t|128)}function f(){if(r>=e)throw Error("Invalid byte index");var t=255&i[r];if(r++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function h(t){var n,o;if(r>e)throw Error("Invalid byte index");if(r==e)return!1;if(n=255&i[r],r++,0==(128&n))return n;if(192==(224&n)){if((o=(31&n)<<6|f())>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&n)){if((o=(15&n)<<12|f()<<6|f())>=2048)return c(o,t)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&n)&&(o=(7&n)<<18|f()<<12|f()<<6|f())>=65536&&o<=1114111)return o;throw Error("Invalid UTF-8 detected")}t.exports={version:"2.1.2",encode:function(t,n){for(var i=!1!==(n=n||{}).strict,e=s(t),r=e.length,o=-1,c="";++o<r;)c+=a(e[o],i);return c},decode:function(t,n){var c=!1!==(n=n||{}).strict;i=s(t),e=i.length,r=0;for(var u,a=[];!1!==(u=h(c));)a.push(u);return function(t){for(var n,i=t.length,e=-1,r="";++e<i;)(n=t[e])>65535&&(r+=o((n-=65536)>>>10&1023|55296),n=56320|1023&n),r+=o(n);return r}(a)}}},function(t,n){!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=new Uint8Array(256),e=0;e<t.length;e++)i[t.charCodeAt(e)]=e;n.encode=function(n){var i,e=new Uint8Array(n),r=e.length,o="";for(i=0;i<r;i+=3)o+=t[e[i]>>2],o+=t[(3&e[i])<<4|e[i+1]>>4],o+=t[(15&e[i+1])<<2|e[i+2]>>6],o+=t[63&e[i+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o},n.decode=function(t){var n,e,r,o,s,c=.75*t.length,u=t.length,a=0;"="===t[t.length-1]&&(c--,"="===t[t.length-2]&&c--);var f=new ArrayBuffer(c),h=new Uint8Array(f);for(n=0;n<u;n+=4)e=i[t.charCodeAt(n)],r=i[t.charCodeAt(n+1)],o=i[t.charCodeAt(n+2)],s=i[t.charCodeAt(n+3)],h[a++]=e<<2|r>>4,h[a++]=(15&r)<<4|o>>2,h[a++]=(3&o)<<6|63&s;return f}}()},function(t,n){var i=void 0!==i?i:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,e=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),r=e&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),o=i&&i.prototype.append&&i.prototype.getBlob;function s(t){return t.map((function(t){if(t.buffer instanceof ArrayBuffer){var n=t.buffer;if(t.byteLength!==n.byteLength){var i=new Uint8Array(t.byteLength);i.set(new Uint8Array(n,t.byteOffset,t.byteLength)),n=i.buffer}return n}return t}))}function c(t,n){n=n||{};var e=new i;return s(t).forEach((function(t){e.append(t)})),n.type?e.getBlob(n.type):e.getBlob()}function u(t,n){return new Blob(s(t),n||{})}"undefined"!=typeof Blob&&(c.prototype=Blob.prototype,u.prototype=Blob.prototype),t.exports=e?r?Blob:u:o?c:void 0},function(t,n,i){(function(n){var e=i(25),r=i(8);t.exports=a;var o,s=/\n/g,c=/\\n/g;function u(){}function a(t){e.call(this,t),this.query=this.query||{},o||(n.___eio||(n.___eio=[]),o=n.___eio),this.index=o.length;var i=this;o.push((function(t){i.onData(t)})),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",(function(){i.script&&(i.script.onerror=u)}),!1)}r(a,e),a.prototype.supportsBinary=!1,a.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),e.prototype.doClose.call(this)},a.prototype.doPoll=function(){var t=this,n=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),n.async=!0,n.src=this.uri(),n.onerror=function(n){t.onError("jsonp poll error",n)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(n,i):(document.head||document.body).appendChild(n),this.script=n,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)}),100)},a.prototype.doWrite=function(t,n){var i=this;if(!this.form){var e,r=document.createElement("form"),o=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=u,r.method="POST",r.setAttribute("accept-charset","utf-8"),o.name="d",r.appendChild(o),document.body.appendChild(r),this.form=r,this.area=o}function a(){f(),n()}function f(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(t){i.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+i.iframeId+'">';e=document.createElement(t)}catch(t){(e=document.createElement("iframe")).name=i.iframeId,e.src="javascript:0"}e.id=i.iframeId,i.form.appendChild(e),i.iframe=e}this.form.action=this.uri(),f(),t=t.replace(c,"\\\n"),this.area.value=t.replace(s,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===i.iframe.readyState&&a()}:this.iframe.onload=a}}).call(this,i(0))},function(t,n,i){(function(n){var e,r=i(13),o=i(5),s=i(7),c=i(8),u=i(27),a=i(2)("engine.io-client:websocket"),f=n.WebSocket||n.MozWebSocket;if("undefined"==typeof window)try{e=i(52)}catch(t){}var h=f;function l(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=f&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(h=e),r.call(this,t)}h||"undefined"!=typeof window||(h=e),t.exports=l,c(l,r),l.prototype.name="websocket",l.prototype.supportsBinary=!0,l.prototype.doOpen=function(){if(this.check()){var t=this.uri(),n=this.protocols,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.localAddress&&(i.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?n?new h(t,n):new h(t):new h(t,n,i)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},l.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(n){t.onData(n.data)},this.ws.onerror=function(n){t.onError("websocket error",n)}},l.prototype.write=function(t){var i=this;this.writable=!1;for(var e=t.length,r=0,s=e;r<s;r++)!function(t){o.encodePacket(t,i.supportsBinary,(function(r){if(!i.usingBrowserWebSocket){var o={};if(t.options&&(o.compress=t.options.compress),i.perMessageDeflate)("string"==typeof r?n.Buffer.byteLength(r):r.length)<i.perMessageDeflate.threshold&&(o.compress=!1)}try{i.usingBrowserWebSocket?i.ws.send(r):i.ws.send(r,o)}catch(t){a("websocket closed before onclose event")}--e||c()}))}(t[r]);function c(){i.emit("flush"),setTimeout((function(){i.writable=!0,i.emit("drain")}),0)}},l.prototype.onClose=function(){r.prototype.onClose.call(this)},l.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},l.prototype.uri=function(){var t=this.query||{},n=this.secure?"wss":"ws",i="";return this.port&&("wss"===n&&443!==Number(this.port)||"ws"===n&&80!==Number(this.port))&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=u()),this.supportsBinary||(t.b64=1),(t=s.encode(t)).length&&(t="?"+t),n+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t},l.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===l.prototype.name)}}).call(this,i(0))},function(t,n){},function(t,n){t.exports=function(t,n){for(var i=[],e=(n=n||0)||0;e<t.length;e++)i[e-n]=t[e];return i}},function(t,n){function i(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=i,i.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var n=Math.random(),i=Math.floor(n*this.jitter*t);t=0==(1&Math.floor(10*n))?t-i:t+i}return 0|Math.min(t,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(t){this.ms=t},i.prototype.setMax=function(t){this.max=t},i.prototype.setJitter=function(t){this.jitter=t}},,,function(t,n,i){const{base64ToArrayBuffer:e,str2ab:r}=i(1);n.verifySignature=function(t,n,i,o,s){o=e(o),i=r(i),window.crypto.subtle.importKey("jwk",{kty:"RSA",e:t,n:n,alg:"RS1"},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}},!0,["verify"]).then((function(t){window.crypto.subtle.verify({name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-1"}},t,o,i).then((function(t){t?s():s("invalid signature")})).catch((function(t){s("failure to verify",t)}))})).catch((function(t){s("key import failed",t)}))}},,,function(t,n,i){const{AdbServer:e}=i(14),r=i(32),{readString:o,str2ab:s,ab2str:c,throttleTimeout:u,nextTick:a,isElectron:f,getAuthToken:h,showNotification:l}=i(1),{u:d}=i(61),{HttpServer:v,HttpRequest:p}=i(62),{verifySignature:m}=i(57),w=i(63),{Socket:y,Server:g}=i(3),{GcmRtcManager:b}=i(33);console.log(g),console.log("Vysor version",chrome.runtime.getManifest().version),console.log(navigator.userAgent),console.log("Electron",f()),console.log("Date",new Date);var k,A,C,S=new e({start:!1}),E={},T={},U={},F=analytics.getService("vysor_app").getTracker("UA-4956323-6");if(f()){var B=F;F={sendEvent:B.sendEvent.bind(B),sendAppView:B.sendAppView.bind(B)};const{screen:t}=require("electron").remote;console.log("getAllDisplays",t.getAllDisplays()),console.log("getPrimaryDisplay",t.getPrimaryDisplay())}var N,O,I,M=new d,D="Chrome GCM Service is unavailable. Try restarting Chrome?",j=new v;function x(t){t.contentWindow._lm={_il:M.h(),_ilc:M.v(),_cl:M.g.bind(M),_md:M.getManageData(),refresh:M.refresh.bind(M),startPurchase:M.startPurchase.bind(M)},t.contentWindow._rl&&t.contentWindow._rl()}function R(t,n){if(C){var i=C.contentWindow.shortModal;i&&i(t,n)}}function P(){C&&C.contentWindow.updateVysorShareServer&&C.contentWindow.updateVysorShareServer(A)}function _(t,n){var i=K(t);console.log(t,i,"status",n);var e=chrome.app.window.get(i);e&&e.contentWindow.updateWindowStatusText&&e.contentWindow.updateWindowStatusText(n)}function L(t,n){_(t,"Connecting..."),w.getApkPath(t,"com.koushikdutta.vysor",(function(i){i?w.runMain(t,i,"com.koushikdutta.vysor.ProtocolVersionMain",(function(t){var e=t.match(/vysor-io-.*?[\r\n]/);e&&e.length?((t=e[0])&&(t=t.trim()),console.log("protocol version: "+t),n("vysor-io-71"!=t?null:i)):n(null)})):n()}))}function V(t,n){function i(i){var e=Math.round(Math.random()*(1<<30)).toString(16),o="echo -n "+e+" > /data/local/tmp/vysor.pwd ; chmod 600 /data/local/tmp/vysor.pwd";w.runMain(t,i,"com.koushikdutta.vysor.Main password="+e+" keyboard="+k,(function(i){r.shell({serialno:t,command:'sh -c "'+o+'"'},(function(t){y.eat(i),n(e)}))}),(function(t,n){t.command="shell:"+t.command,r.sendClientCommand(t,n)}))}_(t,"Connecting...");K(t);L(t,(function(n){if(!n)return console.log("uninstalling old apk if exists"),void r.shell({command:"pm uninstall com.koushikdutta.vysor",serialno:t},(function(n){console.log("uninstall result",n),console.log("installing apk"),function(t,n){_(t,"Installing Vysor APK..."),w.installApkWithInstaller("/Vysor-release.apk",t,"com.android.vending",n)}(t,(function(n){L(t,(function(e){if(!e)return n||(n=""),l("Error installing APK:\n"+n.trim()),void q(t);i(e)}))}))}));i(n)}))}function q(t){var n=K(t),i=chrome.app.window.get(n);i&&i.close()}function J(t,n,i){f()?(console.log("adb client socket factory path"),t.contentWindow.adbSocketFactory=null,t.contentWindow.adbSocketFactoryFactory={type:"adb-client",arguments:{serialno:n}}):E[n]?(console.log("vysor socket fast path"),t.contentWindow.adbSocketFactory=E[n]):S.isRunning()?(console.log("adb server socket path"),t.contentWindow.adbSocketFactory=S.adbDevices[n]):(console.log("adb client socket path"),t.contentWindow.adbSocketFactory=r.createSocketFactory(n)),x(t),t.contentWindow.openList=tt,t.contentWindow.password=i,j&&j.socket&&(t.contentWindow.httpPort=j.socket.localPort),t.contentWindow.device=E[n]||gt[n],t.contentWindow.tracker=F}function z(){setTimeout((function(){chrome.app.window.getAll().length||chrome.runtime.reload()}),5e3)}function K(t){var n=t;return E[t]&&E[t].id?n=E[t].id:gt[t]&&gt[t].id?n=gt[t].id:yt[t]&&(n=yt[t]),n}function H(t,n,i){et();var e=K(t),r=chrome.app.window.get(e);if(r)return r.show(),n&&V(t,(function(n){J(r,t,n),r.contentWindow.connectionReady()})),void(i&&i(r));chrome.app.window.create("screen.html",{id:e,innerBounds:{width:576,height:1024}},(function(n){var e;n.onClosed.addListener(e=function(){n.onClosed.removeListener(e),z(),n.contentWindow.h264Socket&&(console.log("cleaning up h264 socket"),n.contentWindow.h264Socket.destroy(),n.contentWindow.h264Socket=null),n.contentWindow.inputWebSocket&&(console.log("cleaning up input websocket"),n.contentWindow.inputWebSocket.close(),n.contentWindow.inputWebSocket=null)}),J(n,t,null),n.contentWindow.onload=function(){i&&i(n),gt[t]?V(t,(function(i){J(n,t,i),n.contentWindow.connectionReady()})):console.log("Vysor requested for",t,"which is not available yet")}}))}function X(){A=null,O&&O.stopListen("share"),P()}function Y(t){var n=U[t];n&&n.gcmConn.destroy()}function W(t,n,i){var e=U[t];if(e&&e.devices[n]){var r;e.gcmConn.gcmConns[n]&&e.gcmConn.gcmConns[n].destroy();var o=e.gcmConn.gcmConns[n]={id:n,farm:!0,newSocket:function(t,i){r||e.gcmConn.newSocket(n+":"+t,i)},destroy:function(){r=!0,e.gcmConn.gcmConns[n]==o&&delete e.gcmConn.gcmConns[n],delete gt[o.serialno],e.gcmConn.newSocket("close:"+n,(function(t){t&&t.destroy()}));var t=o.onClose;t&&(delete o.onClose,t()),Ut()}};nt(n,(function(t){t(o)}),i),Ut()}}function G(t,n,i){function e(t){i&&i(null,t)}var r=(t=new URL(t)).hash.replace("#","");$.ajax({url:"https://billing.vysor.io/gcm/"+r,dataType:"json",success:function(t){O?O.connect({senderId:"64148182473",registrationId:t.registration,port:"share"}).then((function(s){F.sendEvent("connected-device-farm");var c,u=U[r];u&&u.gcmConn.destroy();var a=U[r]={info:t,gcmConn:s};function f(){s.newSocket("devices:",(function(t){o(t,(function(t){var n=JSON.parse(t),i=n.devices,e=n.sharedDevices;a.devices?($.each(Object.keys(i),(function(t,n){delete a.devices[n]})),$.each(Object.keys(a.devices),(function(t,n){var i=s.gcmConns[n];i&&i.destroy()})),a.devices=i):a.devices=i,a.sharedDevices=e,Ut()}))}))}s.gcmConns={},s.openSocket=function(t,r){if(t.startsWith("challenge:")){console.log("received challenge",t);var o=t.split(":")[1];$.ajax({type:"post",url:"https://billing.vysor.io/verifyauth",headers:{Authorization:"Bearer "+n},data:{nonce:o},dataType:"json",success:function(t){N=JSON.parse(t.signed_data),console.log("sending challenge response",t),writeLine(r,t,(function(){readLine(r,(function(t){if(r.destroy(),"ok"==t)return f(),void(i&&i(a.info));e("Access denied: "+t)}))}))},error:function(t,n){e("Unable to verify identity."),r.destroy()}})}else if(t.startsWith("close:")){r.destroy();var u=t.split(":")[1],h=s.gcmConns[u];if(!h)return void console.log("can't close unknown subconn");h.destroy()}else if(t.startsWith("tracker:")){console.log("got tracker socket"),c=r,function t(){c.read((function(){f(),t()}))}()}else console.log("got unknown socket request",t),r.destroy()},s.onClose=function(){U[r]==a&&delete U[r],$.each(Object.keys(s.gcmConns),(function(t,n){var i=s.gcmConns[n];i&&i.destroy()})),Ut()},console.log("Connection to device farm established",s)})):e(D)},error:function(t,n){l("Unable to find server: "+n)}})}function Q(t,n){function i(t){Ut(),n?n(null,t):l(t)}function e(){Ut(),n&&n(A)}X(),h(t,(function(t){if(t)if(O){var n;O.onRegistrationIdChanged=a,chrome.storage.local.get(["lastDeviceFarmRegistrationId","lastDeviceFarmServerId"],(function(t){if(t&&t.lastDeviceFarmRegistrationId==O.registrationId&&t.lastDeviceFarmServerId)return console.log("device farm registration unchanged, not registering with server."),A="https://vysor.clockworkmod.com/server#"+t.lastDeviceFarmServerId,void e();a()}));var o,c=[];O.listen("share",(function(t){var n,i,e,s={},a=Math.round(Math.random()*(1<<30)).toString(16)+Math.round(Math.random()*(1<<30)).toString(16);t.onClose=function(){var n=c.indexOf(t);-1!=n&&c.splice(n,1),t.trackerSocket&&(t.trackerSocket.destroy(),delete t.trackerSocket),$.each(Object.keys(s),(function(t,n){s[n].destroy()}))},t.newSocket("challenge:"+a,(function(o){if(!o)return console.error("challenge socket failed"),void t.destroy();readLine(o,(function(s){console.log("received challenge response",s);var u=JSON.parse(s);function f(t){t=t||"fail",console.log("Remote user failed to authorize",t),writeLine(o,t,(function(){o.destroy()}))}m("AQAB","hDuGsIhbjLYXteQX3F3KNriQHwUSZurS5voCkdpA1733A65pqtGOrk9g_yLiF94_vSK0VmL-4stq7WAYEbn6nw",u.signed_data,u.signature,(function(s){function h(){function s(){c.push(t),n=!0,writeLine(o,"ok",(function(){o.destroy()})),l("Vysor is sharing Android devices with "+i.name,e),r.sendHostCommand("host:track-devices",(function(n){n?t.newSocket("tracker:",(function(i){if(!i)return n.destroy(),void console.error("unable to open remote tracker");t.trackerSocket=i,y.stream(i,n)})):console.error("unable to track adb devices",chrome.runtime.lastError)}))}isWhitelisted(i.email,(function(t,n){if(t)s();else if(n){var r=chrome.runtime.getManifest().name;chrome.notifications.create({type:"basic",iconUrl:e,title:r,message:i.name+" is requesting access to Vysor shared Android devices.",buttons:[{title:"Allow"},{title:"Deny"}]},(function(t){var n,e=function(i){i==t&&(chrome.notifications.onClosed.removeListener(e),chrome.notifications.onButtonClicked.removeListener(r),n||f("Denied by user."))},r=function(e,r){e==t&&(chrome.notifications.clear(e),n=!0,0==r?(addToWhitelist(i.email,(function(){P()})),s()):f("Denied by user."))};chrome.notifications.onClosed.addListener(e),chrome.notifications.onButtonClicked.addListener(r)}))}else f("Denied by policy.")}))}s?f("Identify signature verification failed."):(i=JSON.parse(u.signed_data)).nonce==a?i.picture?blobFromUrl(i.picture,(function(t){e=t,h()})):(e="/icon.png",h()):f("Mismatched nonce in authentication.")}))}))})),t.openSocket=function(e,c){if(n)if("devices:"==e)o=u(o,c,500,(function(t){loadAllDeviceSettings((function(n){r.devices((function(i){i||(i={}),$.each(Object.keys(i),(function(t,e){E[e]&&delete i[e],sanitizeDeviceSettings(n[e]),n[e]&&n[e].friendlyName&&(i[e].name=n[e].friendlyName)}));var e={};$.each(Object.keys(T),(function(t,n){e[n]={userInfo:T[n].userInfo}})),$(t).each((function(t,n){writeString(n,{devices:i,sharedDevices:e},(function(){n.destroy()}))}))}))}))}));else if(e.startsWith("close:")){c.destroy();var a=e.split(":")[1];(l=s[a])&&l.destroy()}else{var h=e.indexOf(":");if(-1==h)return console.error("unexpected command received by device farm server"),void c.destroy();var l;a=e.substring(0,h);if(!gt[a]){if(-1==(h=e.indexOf(":",h+1)))return void c.destroy();if(a=e.substring(0,h),!gt[a])return void console.error("request for unknown device",a)}if(!(l=s[a])){var d=r.createSocketFactory(a);(l=s[a]=new GcmDevice(d,gt[a],{})).destroy=function(){try{t.newSocket("close:"+a,(function(t){t&&t.destroy()}))}catch(t){}var n=T[a];n&&(n.userInfo==i&&delete n.userInfo,n.gcmConn==this&&delete n.gcmConn,n.key||n.gcmConn||delete T[a]);var e=this.onClose;e&&(delete this.onClose,e()),f()}.bind(l)}var v=T[a];v||(v=T[a]={}),v.gcmConn!=l&&(rt(a),v.gcmConn=l,v.userInfo=i,T[a]=v),f();var p=e.substring(h+1);l.openSocket(p,c)}else c.destroy()}}))}else i(D);else i("Unable to get Auth Token.");function a(){console.log("registering vysor share server"),$.ajax({type:"post",url:"https://billing.vysor.io/gcm",headers:{Authorization:"Bearer "+t},data:{registration:O.registrationId},dataType:"json",success:function(t){console.log("vysor share server",t),chrome.storage.local.set({lastDeviceFarmRegistrationId:O.registrationId,lastDeviceFarmServerId:t.id}),A="https://vysor.clockworkmod.com/server#"+t.id,e()}.bind(this),error:function(t,n){X(),i("Unable to register server: "+n)}})}function f(){n=u(n,null,500,(function(){$.each(c,(function(t,n){n.trackerSocket&&n.trackerSocket.write(s("0000\n"),(function(){}))})),Ut()}))}}))}function Z(t){k=t}function tt(){C?C.focus():chrome.app.window.create("list.html",{id:"list",innerBounds:{width:768,height:868,minWidth:768,minHeight:868}},(function(t){(C=t).contentWindow.openList=tt,x(C),C.contentWindow.disconnectSharedDevice=St,C.contentWindow.toggleShare=Et,C.contentWindow.unshareDevice=ot,C.contentWindow.quietSerial=Ct,C.contentWindow.openWindow=H,C.contentWindow.closeWindow=q,C.contentWindow.createDeviceFarmConnection=W,C.contentWindow.destroyDeviceFarmConnection=Y,C.contentWindow.adbServer=S,C.contentWindow.tracker=F,C.contentWindow.startWireless=Tt,C.contentWindow.startDeviceFarm=Q,C.contentWindow.stopDeviceFarm=X,C.contentWindow.updateKeyboard=Z,C.contentWindow.onload=function(){x(C),P(),Ut()},C.onClosed.addListener((function(){C=null,z()}))}))}function nt(t,n,i){S.start();var e=new g;e.listen({port:0,address:"127.0.0.1"},function(t){e.destroy();var r=new AdbDaemon(new AdbTcpTransport(t));n((function(t){F.sendEvent("connected-shared-device");var n="127.0.0.1:"+e.localPort;t.serialno=n,t.id||(t.id=n),E[n]=t,console.log("connected gcm socket"),t.openSocket=function(){console.log("got a new socket? this should not happen..."),t.destroy()},r.onClose=t.onClose=function(){delete E[n],r.destroy(),t.destroy()},t.onClose=function(){delete E[n],r.destroy(),t.destroy(),l("Disconnected from shared Android device.")},r.openSocket=function(n,i){t.newSocket(n,(function(t){y.stream(i,t,(function(){}))}))},t.newSocket("properties",(function(e){o(e,(function(e){var o=AdbDevice.parseConnectionPayload(e);t.name=t.name||o["ro.product.model"].replace("_"," "),r.start(e),console.log("got properties",e),i(n)}))}))}))}.bind(this),function(n){if(n)console.log("adb daemon failed to listen: "+n);else{var i="127.0.0.1:"+e.localPort;E[i]={id:t||i,destroy:function(){}},console.log("mapping",i,t),Ut(),r.sendHostCommand("host:connect:"+i,(function(t,n){t&&(t.destroy(),n=c(n),console.log("adb connect result",n))}))}}.bind(this))}function it(t,n){if(l("Vysor is connecting to a remote Android device"),C&&C.show(),console.log("attempting to connect to shared device",t),O){var i=new URL(t),e=getQueryVariable("senderId",i),r=getQueryVariable("registrationId",i),o=getQueryVariable("channel",i);e||(e="64148182473"),nt(null,(function(t){O.connect({senderId:e,registrationId:r,port:o}).then(t)}),n)}else R(null,D)}function et(){chrome.runtime.requestUpdateCheck((function(t,n){console.log("update check",arguments),"update_available"==t&&Ot()}))}function rt(t){var n=T[t];if(n&&n.gcmConn){var i=n.gcmConn;delete n.gcmConn,i.destroy()}}function ot(t){rt(t),delete T[t],Ut()}function st(t,n){var i,e=gt[t];if(!O)return i=D,void(n&&n(null,i));var o=Math.round(Math.random()*(1<<30)).toString(16);T[t]||(T[t]={}),T[t].key=o,Ut();var s="https://vysor.clockworkmod.com/redirect/?registrationId="+encodeURIComponent(O.registrationId)+"&channel="+o;console.log(s),O.listen(o,(function(n){F.sendEvent("shared-device");var i=T[t];if(!i||i.key!=o)return n.destroy(),void console.log("device is no longer being shared.");i.gcmConn&&i.gcmConn.destroy(),i.gcmConn=n,i.userInfo={name:"Someone"},Ut(),console.log("accepted gcm socket");var s=r.createSocketFactory(t);new GcmDevice(s,e,n).onOpenSocket=function(n,i){if("webstart"==n)return V(t,(function(t){writeLine(i,t,(function(){console.log("sent password",t),i.destroy()}))})),!0}}));var c="https://tu3ph.app.goo.gl/?ad=0&apn=com.koushikdutta.inkwire&link="+encodeURIComponent(s);n(c)}function ct(){return I||(console.log("creating persistent gcm connection"),I=new Promise((function(t,n){b.start({3505780036:"AIzaSyDt0GimPRhk8_d_4XjOYzQUn50UkvXhMtE",64148182473:"AIzaSyDd7k1v017osyYbIC92fyf-36s3pv0z73U"},{iceServers:[{urls:["turn:n0.clockworkmod.com","turn:n1.clockworkmod.com"],username:"foo",credential:"bar"}]},(function(n){if(O=n,console.log("persistent gcm connection created",null!=n),!O)return I=null,void t();O.defaultSenderId="64148182473",t(O)}))})))}function ut(t){return function(){var n=arguments;ct().then((function(){t.apply(null,n)}))}}M.globalRefresh=function(){console.log("license global refresh");var t=chrome.app.window.getAll();for(var n in t)x(n=t[n])},chrome.identity.onSignInChanged.addListener((function(){console.log("onSignInChanged, refreshing license"),M.refresh(null,!0)})),chrome.storage.local.get("keyboard",(function(t){k=t.keyboard})),chrome.storage.local.get("vysorHttp",(function(t){if(t){var n=t.vysorHttp||{};n.password=n.password||Math.round(Math.random()*(1<<30)).toString(16);var i={"/device/(.*?)/screenshot-?(.*?).jpg":function(t,n,i){var e=i[1],o=chrome.app.window.get(e);if(!o)return console.error("device window",e,"not found"),n.code(404),void n.write("",(function(){n.end()}));e=o.contentWindow.device.serialno;var c=o.contentWindow.password;r.createSocketFactory(e).newSocket("tcp:53516",(function(t){if(!t)return console.error("no socket",e,"for screenshot"),n.code(404),void n.write("",(function(){n.end()}));n.headers.Connection="close",n.headers["Content-Type"]="application/binary",n.headers["Cache-Control"]="no-cache";var i=new p(null,t,(function(){var t=i.body.buffer.slice(i.body.byteOffset,i.body.byteOffset+i.body.byteLength);n.write(t,(function(){n.end()}))}));t.write(s("GET /screenshot.jpg?password="+c+" HTTP/1.1\r\nConnection: close\r\n\r\n"),(function(t){}))}))},"/device/(.*?)/sdcard-vysor/(.*)":function(t,n,i){var e=i[1],o=chrome.app.window.get(e);if(!o)return console.error("device window",e,"not found"),n.code(404),void n.write("",(function(){n.end()}));e=o.contentWindow.device.serialno;var s=i[2];n.headers.Connection="close",n.headers["Cache-Control"]="no-cache",n.headers["Content-Type"]="application/binary",r.pull({file:"/sdcard/vysor/"+s,serialno:e,socket:n},(function(){n.end()}))},"/device/(.*?)/audio.adts":function(t,n,i){var e=i[1],r=chrome.app.window.get(e);if(!M.h())return console.error("ignoring request, not licensed"),n.code(402),void n.write("This feature is only available in Vysor Pro",(function(){n.end()}));if(!r)return console.error("device window",e,"not found"),n.code(404),void n.write("",(function(){n.end()}));if(!r.contentWindow.siphonAudio)return console.error("siphonAudio",e,"not found"),n.code(404),void n.write("",(function(){n.end()}));var o=new DummySocket;if(n.headers.Connection="close",n.headers["Content-Type"]="audio/aac",y.pump(o,n,(function(){console.log("aac source closed")})),f()){var s=o;o={dataReceived:function(t){s.dataReceived(t)},destroy:s.destroy.bind(o)}}r.contentWindow.siphonAudio(o)},"/device/(.*?)/video.flv":function(t,n,i){var e=i[1],r=chrome.app.window.get(e);if(!M.h())return console.error("ignoring request, not licensed"),n.code(402),void n.write("This feature is only available in Vysor Pro",(function(){n.end()}));if(!r)return console.error("device window",e,"not found"),n.code(404),void n.write("",(function(){n.end()}));if(!r.contentWindow.siphonFlv)return console.error("siphonFlv",e,"not found"),n.code(404),void n.write("",(function(){n.end()}));var o=new DummySocket;if(n.headers.Connection="close",n.headers["Content-Type"]="video/x-flv",y.pump(o,n,(function(){console.log("flv source closed")})),f()){var s=o;o={dataReceived:function(t){s.dataReceived(t)},destroy:s.destroy.bind(o)}}r.contentWindow.siphonFlv(o)}};!function t(){j.listen({port:n.port||0,address:"127.0.0.1"},(function(t,n){var e,r;for(var o in console.log("http request",t.path),i)if(e=t.path.match(o),r=i[o],e)break;if(!e)return n.code(404),void n.write("",(function(){}));r(t,n,e)}),(function(i){if(i)return console.error("http server failed to listen",i),void(n.port&&(console.log("trying port 0"),n.port=0,t()));n.port=j.socket.localPort,console.log("vysor http port: "+n.port),chrome.storage.local.set({vysorHttp:n})}))}()}else console.error("unable to start vysor httpServer, no dict")})),M.refresh(),chrome.app.runtime.onLaunched.addListener((function(t){tt(),t&&t.id,t&&"vysor_presentation"==t.id&&it(t.url,(function(t){H(t)})),t&&"vysor_device_farm"==t.id&&(console.log("device farm",t.url),C&&C.show(),tt(),l("Vysor is connecting to shared Android devices"),h(!0,(function(n){n?G(t.url,n,(function(t,n){R("Vysor Share",n?"Unable to connect to shared devices. "+n:"Connected to "+t.name+"'s remote devices.")})):l("Unable to get auth token")}))),et()})),G=ut(G),Q=ut(Q),st=ut(st),it=ut(it),chrome.storage.local.get("share-all-devices",(function(t){t["share-all-devices"]&&Q(!1,(function(){P()}))}));var at,ft,ht,lt,dt,vt,pt,mt,wt={},yt={},gt={},bt={},kt={};function At(t){var n=kt[t];clearTimeout(n),kt[t]=setTimeout((function(){delete kt[t]}),1e4),delete bt[t]}function Ct(t){var n=bt[t];clearTimeout(n),bt[t]=setTimeout((function(){delete bt[t]}),1e4),delete kt[t]}function St(t){q(t);var n=E[t];n&&n.destroy()}function Et(t,n){T[t]?ot(t):st(t,n),Ut()}function Tt(t){function n(n){var e=n+":5555";wt[t]=e,yt[e]=t;var s=gt[e];function u(t,n){r.sendHostCommand("host:disconnect:"+e,(function(i,o){i&&i.destroy(),delete gt[e],r.sendHostCommand("host:connect:"+e,(function(i,r){return i?(i.destroy(),-1!=(r=c(r)).indexOf("unable to connect")?(l("Unable to connect via wireless. Is your Android on the same network as your PC?"),void(n&&n(r))):(n&&n(),chrome.storage.local.set({lastConnectAddress:e}),console.log("adb connect result",r),void(t&&a()))):(l("Unable to connect via wireless. Is your Android on the same network as your PC?"),void(n&&n("host connect failed")))}))}))}function a(){Ut(),setTimeout((function(){l("Vysor is connected wirelessly. You may disconnect your device."),F.sendEvent("go-wireless"),Ct(e),H(e,!0,(function(t){At(e),t.contentWindow.tryReconnect=function(){At(e),u(!1)}}))}),3e3)}s&&(s.id=t),yt[t]&&(device.id=yt[t]),s&&"device"==s.status?a():(Ct(t),i.newSocket("tcpip:5555",(function(t){t?o(t,(function(t){console.log("tcpip:5555 result",t),u(!0,(function(t){t&&(console.error("host:connect failed, trying again in a few seconds",t),setTimeout((function(){u(!0,(function(t){t&&console.err("host:connect failed again, giving up.",t)}))}),3e3))}))})):l("Failure while switching to wireless mode.")})))}var i=r.createSocketFactory(t);i.newSocket("shell:ip -f inet addr show wlan0",(function(t){t?o(t,(function(t){console.log("ifconfig result",t);var e=t.match("inet addr:(.*?) ");(e||(e=t.match("wlan0: ip (.*?) ")),e)?n(e[1]):i.newSocket("shell:ip -f inet addr show wlan0",(function(t){t?o(t,(function(t){console.log("ifconfig result",t);var i=t.match("inet (.*?)/");i?n(i[1]):l("Unable to switch to wireless mode. Is your Android connected to Wifi?")})):console.log("error running tcpip:5555")}))})):console.log("error running tcpip:5555")}))}function Ut(){ft||(ft=a((function(){ft=null,C&&C.contentWindow.refreshList&&C.contentWindow.refreshList(gt,E,N,U,T,yt,wt,O&&O.isListening("share"),at,S.isRunning(),lt)})))}function Ft(){if(!at){if(f()){var t=i(64).platform(),n=chrome.runtime.getAppDirectory(),e=i(65).join(n,"native",t,"adb");if("win32"==t)e+=".exe";else try{require("fs").chmodSync(e,"755")}catch(t){console.warn("unable to chmod adb",t)}return console.log("attempting to start built in adb binary",e),void require("child_process").execFile(e,["start-server"])}lt||window.chrome&&window.chrome.runtime&&window.chrome.runtime.connectNative&&((lt=chrome.runtime.connectNative("com.clockworkmod.adb")).onDisconnect.addListener((function(){chrome.app.lastError,lt=null})),lt.postMessage({command:"start-server"}))}}function Bt(){pt=u(pt,null,300,(function(){chrome.storage.local.get("connect-automatically",(function(t){var n;n=!1===t["connect-automatically"]?2:!0===t["connect-automatically"]?0:t["connect-automatically"]||1,r.devices((function(t){t?($.each(t,(function(i,e){var r=t[i];yt[i]&&(r.id=yt[i]);var o=gt[i];if(!o||r.status!=o.status){ot(i);var s=-1!=r.properties.indexOf("emulator")||-1!=r.properties.indexOf("vbox"),c=K(i);if(!s&&ht&&!bt[c])if(chrome.app.window.get(c)||S.isRunning()||kt[c])a()&&H(i,!0);else if(2!=n&&a()&&"device"==r.status){var u=chrome.runtime.getManifest().name;if(1!=n)return chrome.notifications.create("never-start-automatically",{type:"basic",iconUrl:"/icon.png",title:u,message:"Vysor has connected to an Android device and is starting.",buttons:[{title:"Never Start Automatically"}]}),void H(i,!0);chrome.notifications.create("never-start-automatically-"+Math.random(),{type:"basic",iconUrl:"/icon.png",title:u,message:"Vysor has detected an Android device.",buttons:[{title:"View Android with Vysor"},{title:"Never Start Automatically"}]},(function(t){var n=function(i){i==t&&(chrome.notifications.onClosed.removeListener(n),chrome.notifications.onButtonClicked.removeListener(e))},e=function(n,e){n==t&&(chrome.notifications.clear(n),0==e?H(i,!0):chrome.storage.local.set({"connect-automatically":!1}))};chrome.notifications.onClosed.addListener(n),chrome.notifications.onButtonClicked.addListener(e)}))}}function a(){return"unauthorized"!=r.status||(l("Vysor has detected an Android device. Please Allow USB Debugging on your Android device to continue."),!1)}})),gt=t):gt={},Ut(),ht=!0}))}))}))}function Nt(){vt||(r.sendHostCommand("host:version",(function(t,n){t&&(t.destroy(),n=c(n),console.log("ADB Server Version: ",n))})),r.sendHostCommand("host:track-devices",(function(t){vt?t.destroy():t&&(console.log("Connected to ADB Server"),S.isRunning()?console.log("Using Vysor ADB"):console.log("Using Android SDK ADB"),at=!0,t.onClose=function(){vt=null,at=!1,Bt()},vt=t,function t(n){n.read((function(i){Bt(),t(n)}))}(t),Bt())})))}function Ot(){mt=u(mt,null,1e4,(function(){var t=chrome.runtime.getManifest().name;chrome.notifications.create("reload",{type:"basic",iconUrl:"/icon.png",title:t,message:"There is an update available for Vysor.",buttons:[{title:"Reload"}]})}))}!function t(){Nt(),dt||Ft(),dt=u(dt,null,1e4,Ft),setTimeout(t,1e3)}(),Bt(),chrome.runtime.onUpdateAvailable.addListener((function(){z()})),chrome.notifications.onButtonClicked.addListener((function(t,n){"reload"==t?chrome.runtime.reload():"never-start-automatically"==t&&(chrome.storage.local.set({"connect-automatically":!1}),chrome.notifications.clear(t))})),chrome.notifications.onClicked.addListener((function(t,n){}))},function(t,n,i){const{verifySignature:e}=i(57),{nextTick:r,getAuthToken:o,Success:s,showNotification:c}=i(1);function u(){}var a,f=!1,h=!1,l="Account Management";u.prototype.refresh=function(t,n){console.log("interactive",n),this.refreshInternal(t,n).async()},u.prototype.refreshInternal=function*(t,n){var i,r,u,d=function(){setTimeout(function(){if(this.h()){var t,n=chrome.app.window.getAll().filter((function(t){return t&&"purchase"==t.id}));n&&n.length,null!=(t=n[0])&&(t.close(),c("Vysor subscription is active. Thank you for your support!"))}}.bind(this),3e3),this.globalRefresh?this.globalRefresh():console.error("no global refresh?"),i||(i=!0,t&&t(this.h()))}.bind(this),v=!1;window.chrome&&window.chrome.runtime&&window.chrome.runtime.connect||(v=!0);var p=function(t,n){return!!n.licensed&&(t!=n.email?(console.log("email mismatch"),!1):(console.log("enterprise license retrieved"),!0))}.bind(this),m=function(t,n){if(0!=n.sandbox)return console.log("sandbox mismatch"),!1;if(t!=n.buyer_id)return console.log("id mismatch"),!1;if("koushd@gmail.com"!=n.seller_id)return console.log("seller mismatch"),!1;var i=!1;return n.subscriptions&&$.each(n.subscriptions,function(t,n){console.log("subscription found",n),n.remote_plan_id.startsWith("vysor")?n.subscription_active&&(console.log("clockwork subscription retrieved"),i=n.license_first_retrieved):console.log("skipping non-vysor subscription")}.bind(this)),$.each(n.orders,function(t,n){console.log("purchase found",n),n.product_id.startsWith("vysor")?n.is_purchased&&(console.log("clockwork license retrieved"),i=n.order_date):console.log("skipping non-vysor purchase")}.bind(this)),i}.bind(this),w=function(t){$.each(t,function(t,n){console.log("subscription status",n),"ACTIVE"==n.state&&(console.log("chrome license retrieved"),f=!0)}.bind(this))}.bind(this),y=function*(){if(u&&!n)return console.log("Skipping enterprise license server check."),void console.log("Use Retrieve License from the purchase page to force refresh.");console.log("checking chrome enterprise licenses");var t=yield o(!1,yield);if(!t)return chrome.runtime.lastError,void console.error("No auth token for enterprise licensing");try{var i=yield chrome.identity.getProfileUserInfo(yield);if(!S)return void console.log("unable to retrieve user info for enterprise");i.id;var e=i.email;try{i=yield $.ajax({url:"https://billing.vysor.io/license",headers:{Authorization:"Bearer "+t},dataType:"json",success:yield s,error:yield Error});var r=JSON.parse(i.signed_data);if(yield chrome.storage.local.set({cachedEnterpriseLicense:i},yield),!p(e,r))return void console.log("No enterprise license found on server");a="https://billing.vysor.io",l="Enterprise Account ("+r.licensing_accounts[0]+")",f=!0,h=!0,d()}catch(n){yield chrome.identity.removeCachedAuthToken({token:t},yield),console.error("Error communicating with vysor enterprise",n)}}catch(n){yield chrome.identity.removeCachedAuthToken({token:t},yield),console.error("Unable to get email for enterprise",n)}}.bind(this),g=function*(){if(r&&!n)return console.log("Skipping clockwork license server check."),void console.log("Use Retrieve License from the purchase page to force refresh.");console.log("checking clockwork purchases");var t=yield o(!1,yield);if(!t)return chrome.runtime.lastError,void console.error("No auth token for clockwork billing");try{var i=yield chrome.identity.getProfileUserInfo(yield);if(!S)return void console.log("unable to retrieve user info for clockwork");var e=i.id,c="https://billing.clockworkmod.com/api/v1/purchase/koushd@gmail.com?sandbox=false&nonce="+Date.now();try{i=yield $.ajax({url:c,dataType:"json",headers:{Authorization:"Bearer "+t},error:yield Error,success:yield s});var u=JSON.parse(i.signed_data);if(yield chrome.storage.local.set({cachedClockworkLicense:i},yield),!m(e,u))return void console.log("no clockwork license found on server");a="https://billing.clockworkmod.com",f=!0,h=!0,d()}catch(t){console.error("error requesting purchases",t)}}catch(n){yield chrome.identity.removeCachedAuthToken({token:t},yield),console.error("Unable to get buyer id for clockworkbilling",n)}}.bind(this),b=function*(){if(!v){var t;console.log("checking chrome store purchases");try{t=yield google.payments.inapp.getPurchases({parameters:{env:"prod"},success:yield s,failure:yield Error})}catch(t){if(console.error("Failed to query license from chrome store.",t),!n)return console.log("Skipping Chrome license server fallback check."),void console.log("Use Retrieve License from the purchase page to force refresh.");console.log("Falling back to server proxied query.");try{yield this.g(!1,yield),yield*k()}catch(t){console.error("failed to do fallback server check",t)}return}w(t.response.details),this.h()?(a="https://payments.google.com/payments/home#subscriptionsAndServices",d(),console.log("Caching Vysor license."),yield this.g(!1,yield),this.v()&&d()):console.log("no chrome license found on server")}}.bind(this),k=function*(){if(!v){console.log("checking cached chrome license");var t=yield chrome.storage.local.get("cachedLicense",yield);if(t)if(t.cachedLicense)if(S){var n=yield e("AQAB","vMGBBmLcMO4lOmg-YAHq2DjZKHTaW-xs9KPNXU_zKJ7ZhFhWH3I6skF9ZO8lKeXOSwVEIW4HVMa7m16S6WTrUw",t.cachedLicense.signed_data,t.cachedLicense.signature,yield);if(n)console.error("error verifying cached signature",n);else{var i=JSON.parse(t.cachedLicense.signed_data);!1;var r=Date.now();if($.each(i.payments,function(t,n){"ACTIVE"==n.state&&(!0,r=Math.min(r,n.createdTime))}.bind(this)),i.date>Date.now())console.log("cached license date from future?");else{var o,s=(new Date-new Date(r))/1e3/60/60/24,c=(o=s<14?4:Math.min(30,4+(s-14)/7))/2;if(i.date+24*o*60*60*1e3<Date.now())console.log("cached license is expired.");else if(S.id==i.userinfo.id)if(w(i.payments),this.h()){if(a="https://payments.google.com/payments/home#subscriptionsAndServices",console.log("cached license is valid for "+(i.date+24*o*60*60*1e3-Date.now())/36e5+" hours"),h=!0,d(),i.date+24*c*60*60*1e3<Date.now()){console.log("Refreshing cached license");try{yield this.g(!1,yield)}catch(n){console.warn("Failed to re-cache license.",n)}}}else console.log("no chrome license found in cache");else console.log("id mismatch")}}}else console.log("unable to retrieve user info for cache");else console.log("no cached chrome license found");else console.error("storage access failed?",chrome.runtime.lastError)}}.bind(this),A=function*(){console.log("Checking cached Clockwork license.");var t=yield chrome.storage.local.get("cachedClockworkLicense",yield);if(t)if(t.cachedClockworkLicense)if(S){var n=S.id,i=yield e("AQAB","vMGBBmLcMO4lOmg-YAHq2DjZKHTaW-xs9KPNXU_zKJ7ZhFhWH3I6skF9ZO8lKeXOSwVEIW4HVMa7m16S6WTrUw",t.cachedClockworkLicense.signed_data,t.cachedClockworkLicense.signature,yield);if(i)console.error("Error verifying cached clockwork signature",i);else{var o=JSON.parse(t.cachedClockworkLicense.signed_data),s=m(n,o);if(!s)return console.log("No Clockwork license found in cache."),void(r=!0);a="https://billing.clockworkmod.com";var c,u=(new Date-new Date(s))/1e3/60/60/24,l=(c=u<14?4:Math.min(30,4+(u-14)/7))/2;o.timestamp+24*c*60*60*1e3<Date.now()?console.log("Cached Clockwork license is expired. Requires server check."):o.timestamp>Date.now()?console.error("Cached Clockwork license date from future?"):(f=!0,console.log("Cached Clockwork license is valid for "+(o.timestamp+24*c*60*60*1e3-Date.now())/36e5+" hours"),h=!0,d(),o.timestamp+24*l*60*60*1e3<Date.now()&&(r=!1,yield*g()))}}else console.error("Unable to retrieve user info for cached Clockwork license.");else console.log("Cached Clockwork payload not found.");else console.error("storage access failed?",chrome.runtime.lastError)}.bind(this),C=function*(){console.log("Checking cached enterprise license.");var t=yield chrome.storage.local.get("cachedEnterpriseLicense",yield);if(t)if(t.cachedEnterpriseLicense)if(S){var n=yield e("AQAB","hDuGsIhbjLYXteQX3F3KNriQHwUSZurS5voCkdpA1733A65pqtGOrk9g_yLiF94_vSK0VmL-4stq7WAYEbn6nw",t.cachedEnterpriseLicense.signed_data,t.cachedEnterpriseLicense.signature,yield);if(n)console.error("Error verifying cached enterprise signature",n);else{var i=JSON.parse(t.cachedEnterpriseLicense.signed_data);if(!p(S.email,i))return u=!0,void console.log("No Enterprise license found in cache.");i.timestamp+3456e5<Date.now()?console.log("Cached Enterprise license is expired. Requires server check."):i.timestamp>Date.now()?console.error("Cached Enterprise license date from future?"):(a="https://billing.vysor.io",l="Enterprise Account ("+i.licensing_accounts[0]+")",f=!0,console.log("Cached Enterprise license is valid for "+(i.timestamp+3456e5-Date.now())/36e5+" hours"),h=!0,d(),i.timestamp+1728e5<Date.now()&&(u=!1,yield*y()))}}else console.error("Unable to retrieve user info for cached Clockwork license.");else console.log("Cached Enterprise payload not found.");else console.error("storage access failed?",chrome.runtime.lastError)}.bind(this);if(this.h())d();else{console.log("starting license check");var S=yield chrome.identity.getProfileUserInfo(yield);S?console.log("user info",S):console.log("unable to retrieve user info"),yield*C(),this.h()||(yield*A(),this.h()||(yield*k(),this.h()||(yield*y(),this.h()||(yield*g(),this.h()||(yield*b(),this.h()||d())))))}},u.prototype.g=function(t,n){console.log("caching chrome license"),o(t,function(i){if(!i)return chrome.runtime.lastError,t&&c("Unable to get auth token: "+chrome.runtime.lastError),console.error("Unable to get auth token while caching license",chrome.runtime.lastError),void(n&&n(chrome.runtime.lastError));$.ajax({type:"post",url:"https://billing.clockworkmod.com/api/v1/verify/google/koushd@gmail.com",data:{token:i,item:chrome.runtime.id,version:chrome.runtime.getManifest().version},dataType:"json",success:function(t){console.log("chrome license cached"),h=!0,chrome.storage.local.set({cachedLicense:t},n)}.bind(this),error:function(t,e){console.error("unable to cache license",e),chrome.identity.removeCachedAuthToken({token:i},(function(){n&&n(e)}))}})}.bind(this))},u.prototype.h=function(){return f},u.prototype.v=function(){return h},u.prototype.getManageData=function(){return{managementUrl:a,managementText:l}},u.prototype.startPurchase=function(){chrome.app.window.create("purchase.html",{id:"purchase",innerBounds:{minWidth:800,minHeight:860}},function(t){this.refresh(),t.contentWindow._rlm=function(t){chrome.storage.local.remove(["cachedLicense","cachedClockworkLicense","cachedEnterpriseLicense"],function(){this.refresh(t,!0)}.bind(this))}.bind(this)}.bind(this))},n.u=u},function(t,n,i){const{Server:e}=i(3),{readLine:r,str2ab:o}=i(1),s={200:"OK",202:"Accepted",206:"Partial Content",101:"Switching Protocols",301:"Moved Permanently",302:"Found",402:"Payment Required",404:"Not Found"};function c(){}function u(t){this.request=t,this.statusLine="HTTP/1.1 200 OK",this.headers={Date:(new Date).toUTCString()}}function a(t,n,i){this.server=t,this.socket=n,this.headers={},this.parseRequest(function(){i(this,new u(this))}.bind(this))}c.prototype.listen=function(t,n,i){this.socket=new e,this.requestCallback=n,this.socket.listen(t,this.onSocket.bind(this),i)},c.prototype.onSocket=function(t){new a(this,t,this.requestCallback)},c.prototype.destroy=function(){this.socket.destroy()},u.prototype.code=function(t){this.statusLine="HTTP/1.1 "+t+" "+s[t]},u.prototype.write=function(t,n){if(t.constructor.name==Object.prototype.constructor.name&&(t=JSON.stringify(t)),t.constructor.name==String.prototype.constructor.name&&(t=o(t)),this.hasWritten)this.request.socket.write(t,n);else{this.hasWritten=!0,this.headers["Content-Length"]||"close"==this.headers.Connection||(this.headers["Content-Length"]=t.byteLength);var i=[this.statusLine];for(var e in this.headers)i.push(e+": "+this.headers[e]);var r=i.join("\r\n")+"\r\n\r\n";this.request.socket.write(o(r),function(){this.write(t,n)}.bind(this))}},u.prototype.end=function(){"close"==this.headers.Connection?this.request.socket.destroy():this.request.server.onSocket(this.request.socket),this.request.socket=null},a.prototype.parseRequest=function(t){var n=function(){r(this.socket,function(i){if(!(i=i.trim()).length){var e=this.headers["content-length"];return e?(e=Number.parseInt(e),void this.socket.read(e,function(n){this.body=n,"application/json"===this.headers["content-type"]&&(this.body=JSON.parse(ab2str(this.body))),t()}.bind(this))):void t()}var r;if(this.statusLine)2==(r=i.split(":",2)).length&&(this.headers[r[0].toLowerCase()]=r[1].trim());else if(this.statusLine=i,(r=i.split(" ")).length>2&&(r=r[1].split("?"),this.path=r[0],this.queries={},r.length>1))for(var o=(this.query=r[1]).split("&"),s=0;s<o.length;s++){var c,u=o[s].split("="),a=u[0];u.length>1&&(c=u[1]),this.queries[a]=c}n()}.bind(this))}.bind(this);n()},n.HttpRequest=a,n.HttpServer=c,n.HttpResponseCodes=s},function(t,n,i){const e=i(32),r=i(20);function o(t,n,i,o){$.ajax({url:t,dataType:"binary",responseType:"arraybuffer",success:function(t){var s=new Uint8Array(t),c=new r(s),u="/data/local/tmp/apk"+(new Date).getTime()+".apk";e.push({serialno:n,file:u,socket:c},(function(){i?e.shell({command:"pm install -i "+i+" -r "+u,serialno:n},o):e.shell({command:"pm install -r "+u,serialno:n},o)}))},error:function(t){console.error("error fetching apk",t),o()}})}t.exports={runMain:function(t,n,i,r,o){o||(o=e.shell),e.shell({command:"ls -l /system/bin/app_process*",serialno:t},(function(e){var s="/system/bin/app_process";e&&-1!=e.indexOf("app_process32")&&(s+="32"),o({command:'sh -c "CLASSPATH='+n+" "+s+" /system/bin "+i+'"',serialno:t},r)}))},installApk:function(t,n,i){return o(t,n,null,i)},installApkWithInstaller:o,getApkPath:function(t,n,i){e.shell({command:"pm path "+n,serialno:t},(function(t){if(""!=t&&t){var n=t.match(/package:\/.*?[\r\n]/);n&&n.length?(t=(t=n[0]).replace("package:","").trim(),i(t)):i(null)}else i(null)}))}}},function(t,n){n.endianness=function(){return"LE"},n.hostname=function(){return"undefined"!=typeof location?location.hostname:""},n.loadavg=function(){return[]},n.uptime=function(){return 0},n.freemem=function(){return Number.MAX_VALUE},n.totalmem=function(){return Number.MAX_VALUE},n.cpus=function(){return[]},n.type=function(){return"Browser"},n.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},n.networkInterfaces=n.getNetworkInterfaces=function(){return{}},n.arch=function(){return"javascript"},n.platform=function(){return"browser"},n.tmpdir=n.tmpDir=function(){return"/tmp"},n.EOL="\n",n.homedir=function(){return"/"}},function(t,n,i){(function(t){function i(t,n){for(var i=0,e=t.length-1;e>=0;e--){var r=t[e];"."===r?t.splice(e,1):".."===r?(t.splice(e,1),i++):i&&(t.splice(e,1),i--)}if(n)for(;i--;i)t.unshift("..");return t}function e(t,n){if(t.filter)return t.filter(n);for(var i=[],e=0;e<t.length;e++)n(t[e],e,t)&&i.push(t[e]);return i}n.resolve=function(){for(var n="",r=!1,o=arguments.length-1;o>=-1&&!r;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(n=s+"/"+n,r="/"===s.charAt(0))}return(r?"/":"")+(n=i(e(n.split("/"),(function(t){return!!t})),!r).join("/"))||"."},n.normalize=function(t){var o=n.isAbsolute(t),s="/"===r(t,-1);return(t=i(e(t.split("/"),(function(t){return!!t})),!o).join("/"))||o||(t="."),t&&s&&(t+="/"),(o?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(e(t,(function(t,n){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t})).join("/"))},n.relative=function(t,i){function e(t){for(var n=0;n<t.length&&""===t[n];n++);for(var i=t.length-1;i>=0&&""===t[i];i--);return n>i?[]:t.slice(n,i-n+1)}t=n.resolve(t).substr(1),i=n.resolve(i).substr(1);for(var r=e(t.split("/")),o=e(i.split("/")),s=Math.min(r.length,o.length),c=s,u=0;u<s;u++)if(r[u]!==o[u]){c=u;break}var a=[];for(u=c;u<r.length;u++)a.push("..");return(a=a.concat(o.slice(c))).join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){if("string"!=typeof t&&(t+=""),0===t.length)return".";for(var n=t.charCodeAt(0),i=47===n,e=-1,r=!0,o=t.length-1;o>=1;--o)if(47===(n=t.charCodeAt(o))){if(!r){e=o;break}}else r=!1;return-1===e?i?"/":".":i&&1===e?"/":t.slice(0,e)},n.basename=function(t,n){var i=function(t){"string"!=typeof t&&(t+="");var n,i=0,e=-1,r=!0;for(n=t.length-1;n>=0;--n)if(47===t.charCodeAt(n)){if(!r){i=n+1;break}}else-1===e&&(r=!1,e=n+1);return-1===e?"":t.slice(i,e)}(t);return n&&i.substr(-1*n.length)===n&&(i=i.substr(0,i.length-n.length)),i},n.extname=function(t){"string"!=typeof t&&(t+="");for(var n=-1,i=0,e=-1,r=!0,o=0,s=t.length-1;s>=0;--s){var c=t.charCodeAt(s);if(47!==c)-1===e&&(r=!1,e=s+1),46===c?-1===n?n=s:1!==o&&(o=1):-1!==n&&(o=-1);else if(!r){i=s+1;break}}return-1===n||-1===e||0===o||1===o&&n===e-1&&n===i+1?"":t.slice(n,e)};var r="b"==="ab".substr(-1)?function(t,n,i){return t.substr(n,i)}:function(t,n,i){return n<0&&(n=t.length+n),t.substr(n,i)}}).call(this,i(6))}]);
//# sourceMappingURL=background.js.map